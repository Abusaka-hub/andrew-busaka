"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["copilot-immersive-v1","ui_packages_code-mirror_CodeMirror_tsx","ui_packages_code-mirror_autocomplete_theme_ts-ui_packages_code-mirror_extensions_help-panels_-d428aa","ui_packages_document-metadata_document-metadata_ts-ui_packages_history_history_ts-ui_packages-417c81","ui_packages_failbot_failbot_ts"],{79929:(e,t,n)=>{n.d(t,{A:()=>a});let a={messageContainer:"ChatMessage-module__messageContainer--A1rW_","message-action":"ChatMessage-module__message-action--gd8kA",user:"ChatMessage-module__user--x7t7S",ai:"ChatMessage-module__ai--NWwZ0",contentContainer:"ChatMessage-module__contentContainer--s3iSV",message:"ChatMessage-module__message--_amJV",messageContent:"ChatMessage-module__messageContent--cNCus",hasClientConfirmations:"ChatMessage-module__hasClientConfirmations--nYPDm",agentUnauthorizedAvatar:"ChatMessage-module__agentUnauthorizedAvatar--q02uE",skillExecutionText:"ChatMessage-module__skillExecutionText--Fl5HE",fileListItem:"ChatMessage-module__fileListItem--jEMb9",avatar:"ChatMessage-module__avatar--rn6Gb"}},50045:(e,t,n)=>{n.d(t,{I:()=>a});let a=(0,n(96540).createContext)(null)},13080:(e,t,n)=>{n.d(t,{C:()=>s,i:()=>o});var a=n(47584),i=n(75632),r=n(46493);function s(e,t){(0,i.G7)("arianotify_comprehensive_migration")?o(l(e),{...t,element:t?.element??e}):(0,i.G7)("primer_live_region_element")&&t?.element===void 0?(0,r.Cj)(e,{politeness:t?.assertive?"assertive":"polite"}):o(l(e),t)}function o(e,t){let{assertive:n,element:s}=t??{};(0,i.G7)("arianotify_comprehensive_migration")&&"ariaNotify"in Element.prototype?(s||document.body).ariaNotify(e,{interrupt:t?.assertive?"all":"none"}):(0,i.G7)("primer_live_region_element")&&void 0===s?(0,r.iP)(e,{politeness:n?"assertive":"polite"}):function(e,t,n){let i=n??a.XC?.querySelector(t?"#js-global-screen-reader-notice-assertive":"#js-global-screen-reader-notice");i&&(i.textContent===e?i.textContent=`${e}\u00A0`:i.textContent=e)}(e,n,s)}function l(e){return(e.getAttribute("aria-label")||e.innerText||"").trim()}},56176:(e,t,n)=>{let a;function i(){if(!a)throw Error("Client env was requested before it was loaded. This likely means you are attempting to use client env at the module level in SSR, which is not supported. Please move your client env usage into a function.");return a}function r(){return a?.locale??"en-US"}function s(){return!!i().login}n.d(t,{JK:()=>r,M3:()=>s,_$:()=>i}),!function(){if("undefined"!=typeof document){let e=document.getElementById("client-env");if(e)try{a=JSON.parse(e.textContent||"")}catch(e){console.error("Error parsing client-env",e)}}}()},48741:(e,t,n)=>{n.d(t,{E:()=>a});let a=n(24774).Lz.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{border:0,backgroundColor:"transparent"},".cm-tooltip.cm-tooltip-autocomplete > ul":{fontFamily:"SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace",fontSize:"12px",backgroundColor:"var(--bgColor-default, var(--color-canvas-default))",border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"var(--borderRadius-medium)",boxShadow:"var(--shadow-resting-medium, var(--color-shadow-medium))",minWidth:"auto"},'.cm-tooltip.cm-tooltip-autocomplete li[role="option"]':{padding:"2px 8px",margin:0,color:"var(--fgColor-default, var(--color-fg-default))",whiteSpace:"pre"},'.cm-tooltip.cm-tooltip-autocomplete li[role="option"]:first-child':{borderTopLeftRadius:"var(--borderRadius-medium)",borderTopRightRadius:"var(--borderRadius-medium)"},'.cm-tooltip.cm-tooltip-autocomplete li[role="option"]:last-child':{borderBottomLeftRadius:"var(--borderRadius-medium)",borderBottomRightRadius:"var(--borderRadius-medium)"},".cm-tooltip.cm-tooltip-autocomplete ul li[aria-selected], .cm-tooltip.cm-tooltip-autocomplete ul li[aria-selected] .cm-completionDetail":{color:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",background:"var(--bgColor-accent-emphasis, var(--color-accent-emphasis))"},".cm-completionDetail":{paddingLeft:"8px",color:"var(--fgColor-muted, var(--color-fg-muted))",fontSize:"var(--fontSize-small)",fontStyle:"normal"}})},48031:(e,t,n)=>{n.d(t,{G:()=>i});var a=n(24774);function i(e=null,t="bottom"){return[a.S7.of(()=>({dom:e,top:"top"===t}))]}},42378:(e,t,n)=>{n.d(t,{BE:()=>o,Cw:()=>N,I6:()=>b,Lo:()=>d,Md:()=>g,TB:()=>j,TC:()=>_,TU:()=>m,YH:()=>f,Z3:()=>p,eO:()=>x,e_:()=>v,f9:()=>l,fV:()=>h,tJ:()=>y,td:()=>u,w0:()=>c,ye:()=>C});var a=n(15874),i=n(54528),r=n(6585),s=n(24774);let o=e=>e.state.selection.main,l=(e,t)=>{e.dispatch({selection:{anchor:t}})},c=e=>e.state.selection.ranges.some(e=>!e.empty),d=e=>e.sliceDoc(e.selection.main.from,e.selection.main.to),u=(e,t,n)=>{e.dispatch({selection:{anchor:t,head:n}})};function m(e,t){return e.state.doc.line(t.line+1).from+t.ch}function p(e,t){let n=e.state.doc.lineAt(t);return{line:n.number-1,ch:t-n.from}}let h=(e,t)=>e.state.doc.line(t),g=(e,t,n)=>{let a=h(e,t);v(e,a.from,a.from,n)},f=(e,t,n)=>{let a=h(e,t);v(e,a.from,a.from+n.length,"")},y=(e,t)=>{e.dispatch(e.state.replaceSelection(t))},x=(e,t,n)=>e.sliceDoc(t,n),v=(e,t,n,a)=>{e.dispatch({changes:{from:t,to:n,insert:a}})},_=(e,t)=>{let n=o(e);v(e,n.from,n.to,t)},b=(e,t)=>new i.ZX(e.state.doc,t).next(),j=(e,t,n)=>{let a=new i.ZX(e.state.doc,t).next();e.dispatch({changes:{from:a.value.from,to:a.value.to,insert:n}})},C=(e,t,n,a,i)=>{if(void 0!==n)try{let o=h(e,t),l=h(e,n);if(o&&l){e.focus();let t=i?l.from+i:l.to;u(e,o.from+(a??0),t),e.dispatch({effects:[s.Lz.scrollIntoView(r.OF.range(o.from,l.to),{y:"center"})]})}}catch{}else try{let n=h(e,t);n&&(e.focus(),l(e,n.from+(a??0)),e.dispatch({effects:[s.Lz.scrollIntoView(n.from,{y:"center"})]}))}catch{}};function N(e){return e.state.facet(a.Xt)}},40650:(e,t,n)=>{n.d(t,{p:()=>u});var a=n(13080),i=n(46988),r=n(96540),s=n(72659),o=n(82610),l=n(65615),c=n(7426),d=n(93326);function u({excludeFeedback:e,inputRef:t,isLatestMessage:n,isSharedMessage:u,isLoading:m,isStreaming:p,removeOutdatedContentPreviewItems:h}){let{message:g}=(0,s.V)(),f=(0,l.Pk)(),y=(0,c.b)(),x=(0,o.Th)(g,f.currentUserLogin),v="Copilot"===x.name,_="user"===x.type,b=v||(0,o.yh)(x),j=v&&!!g.agentErrors?.length,C=!j&&!!v&&!!g.error&&g.error.isError,N=f.isWaitingOnCopilot||m||p,w=v&&!e&&(!n||!N)&&!C,I=(0,r.useRef)([]),S=(0,r.useRef)(null),k=(0,r.useRef)(!1),T=g.interrupted,A=g.clientConfirmations&&g.clientConfirmations.length>0,E=C&&g.error?.retryable,[R,P]=(0,r.useState)([]),[D,L]=(0,r.useState)(void 0),M=(E||T)&&n,O={openLinksInCurrentTab:"assistive"===f.mode,isStreaming:n&&N},B=!C&&(w||b&&!!g.content&&!p)&&(!_||!g.confirmations)||_&&!n||C&&n,F=(0,r.useRef)(0);(0,r.useEffect)(()=>{let e=(g.skillExecutions??[]).find(e=>!R.some(t=>t.slug===e.slug&&t.statusMessage===e.statusMessage));if(e){let t=setTimeout(()=>{F.current=Date.now(),P([...R,e]),L(e)},Math.max(0,2e3-(Date.now()-F.current)));return()=>clearTimeout(t)}},[g.skillExecutions,R]),(0,r.useEffect)(()=>{n&&p&&(0,a.i)("Copilot is responding")},[n,p]),(0,r.useEffect)(()=>{n&&!p&&S.current&&(0,a.C)(S.current)},[n,p]);let $=(0,r.useCallback)(()=>{I.current=I.current.filter(e=>!e.classList.contains("feedback-action")),k.current=!0},[]),U=(0,r.useCallback)(async(e,t,n)=>{n?n("accepted"===e.state):await y.sendChatMessage({thread:y.getSelectedThread(f),content:`@${x.name} ${(0,d.Z)(e.state)} Confirmation: ${t}`,references:g.references??[],topic:f.currentTopic,context:f.context,confirmations:e,customInstructions:f.customInstructions,model:f.model})},[y,f,x.name,g.references]),z=(0,r.useCallback)(()=>{window.setTimeout(()=>t?.current?.focus(),1)},[t]),V=(0,r.useCallback)(async()=>{let e=y.getSelectedThread(f);e&&(h?.(),z(),(0,i.BI)("dotcom_chat.activate",{target:"RESPONSE_ACTION_RETRY",mode:f.mode}),await y.retryLastUnsuccessfulChatMessage(e))},[y,f,h,z]),W=(0,r.useCallback)(async e=>{let t=y.getSelectedThread(f);t&&(h?.(),z(),(0,i.BI)("dotcom_chat.activate",{target:"RESPONSE_ACTION_RETRY_FOR_NEW_SUBTHREAD",mode:f.mode}),await y.retryUserChatMessage(t,g,e))},[y,f,g,h,z]),H=(0,r.useCallback)(async e=>{let t=y.getSelectedThread(f);t&&(h?.(),await y.editUserChatMessage(t,g,e))},[y,f,g,h]);return{author:x,removeOutdatedContentPreviewItems:h,feedbackSubmitted:k,focusableElements:I,handleConfirmationAction:U,handleRetryErrorMessage:V,handleRetryCopilotResponse:W,handleEditUserMessage:H,hasClientConfirmations:A,isCopilot:v,isUser:_,isAI:b,isAgentError:j,isError:C,isInterrupted:T,isLoading:N,isSharedMessage:u,myRef:S,onFeedbackSubmitted:$,rendererConfig:O,renderFeedback:w,shouldShowMessageActions:B,shownSkillExecutionsForRespondingText:R,skillExecutionToUseForRespondingText:D,showRetryButton:M}}},2120:(e,t,n)=>{n.d(t,{Y:()=>c});var a=n(96540),i=n(82610),r=n(2622),s=n(37937),o=n(65615),l=n(7426);function c(e){let t=(0,o.Pk)(),n=(0,l.b)(),{currentTopic:c,messages:d,selectedThreadID:u}=t,m=n.getSelectedThread(t),p=(0,a.useRef)(null),h=e||p;return(0,a.useEffect)(()=>{m&&d.length>0&&n.showTopicPicker(!1)},[m,d.length,n]),(0,a.useEffect)(()=>{let e=c?(0,i.P)(c)?c.name:String(c.id):null;u&&e&&s.J.setSelectedTopic(u,e)},[u,c]),(0,a.useEffect)(()=>{let e=window.setTimeout(()=>{h.current?.focus()},1);return()=>{window.clearTimeout(e)}},[h]),(0,a.useEffect)(()=>((()=>{let e=t.context?.[0]??(r.W.topicsAsReferences?t.currentRepository:t.currentTopic);e&&n.generateSuggestions(e)})(),()=>{n.clearSuggestions()}),[n,t.context,t.currentTopic,t.currentRepository,t.selectedThreadID]),{textAreaRef:h}}},39363:(e,t,n)=>{n.d(t,{a:()=>o});var a=n(96540),i=n(56056),r=n(93589),s=n(77342);function o(e){let{streamingMessage:t,isWaitingOnCopilot:n,messages:o,selectedThreadID:l}=e,c=(0,a.useMemo)(()=>{let e={id:s.Wp,role:"assistant",content:"",createdAt:"",threadID:l||"",references:[],clientSide:!0,messageIndex:-1},a=(0,r.B)(o);return n?[...a,t??e]:a},[o,t,n,l]);return{messages:c,groupedMessages:(0,i.A)(c)}}},69425:(e,t,n)=>{n.d(t,{g:()=>i});var a=n(96540);function i(e){let[t,n]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=e.current,a=t?.lastElementChild;if(!a)return;let i=new IntersectionObserver(([e])=>n(e?.isIntersecting??!0),{root:t,threshold:1});return i.observe(a),()=>i.disconnect()}),t}},22678:(e,t,n)=>{n.d(t,{d:()=>s});var a=n(65615),i=n(7426),r=n(68956);function s(){let e=(0,i.b)(),t=(0,a.Pk)();return(0,r.iI)()||(0,r.Xw)(e.getSelectedThread(t))}},21057:(e,t,n)=>{n.d(t,{JE:()=>p,Z3:()=>u,bn:()=>d,kw:()=>h,qj:()=>m});var a=n(97286),i=n(80758),r=n(96540),s=n(22678),o=n(82610),l=n(65615),c=n(7426);let d="https://github.com/marketplace?type=apps&copilot_app=true",u="@",m=RegExp("^@(?<slug>\\S+)$");function p(e=!0){let t=(0,l.Pk)(),n=(0,c.b)(),i=!!(0,s.d)(),{model:d,messages:u,agentsPath:m}=t,h=d?.hasLimitedCapabilities,g=(0,r.useCallback)(e=>{if(h||i)return{agents:[],showLimit:!1};let t=(0,o.Q7)(u)[0];return t?{agents:e.filter(e=>e.slug===t.name),showLimit:e.length>1}:{agents:e,showLimit:!1}},[i,u,h]),{isLoading:f,data:y,refetch:x,isStale:v,isFetched:_}=(0,a.I)({queryKey:["copilot-chat","agents",m],queryFn:()=>m?n.fetchAgents(m):[],select:g,enabled:e&&!h&&!i}),b=async()=>!_||v?(await x()).data:y;return{loading:f,disabled:h,availableAgents:y?.agents,showLimit:y?.showLimit??!1,imperativelyFetch:b}}function h({inputOnChange:e,inputRef:t}){let n=(0,i.H)({inputRef:t,fallbackEventHandler:e});return(0,r.useCallback)((e="")=>{t.current?.value&&n(" ",[0,0]);let a=`${u}${e}`;n(a,[0,0],a.length)},[n,t])}},10967:(e,t,n)=>{n.d(t,{Ld:()=>g,M8:()=>f,Tz:()=>v,W5:()=>u,cx:()=>h,r_:()=>x,vn:()=>y,xG:()=>m});var a=n(55156),i=n(97665),r=n(40458),s=n(94747),o=n(97286),l=n(57572),c=n(96540),d=n(37937);n(65615),n(7426);let u={Unindexed:"not_indexed",Indexed:"indexed",Indexing:"indexing",PartiallyIndexed:"partially_indexed",Unknown:"unknown"},m={Requested:"requested",NotFound:"not_found",Unauthorized:"unauthorized",ServiceUnavailable:"service_unavailable",QuotaExhausted:"quota_exhausted",Forbidden:"forbidden",CanIndex:"ok",IndexingError:"indexing_error",RequestFailed:"request_failed",Unknown:"unknown"},p=[m.NotFound,m.Unauthorized,m.ServiceUnavailable,m.QuotaExhausted,m.Forbidden,m.RequestFailed],h=256,g=400;function f(e){var t,n;let a=(0,i.jE)(),o=(0,c.useCallback)(()=>Promise.all(e.map(e=>a.invalidateQueries({queryKey:["copilot-chat","repos-indexing-state",e]}))),[a,e]),l=(0,r.E)({queries:e.map(e=>({queryKey:["copilot-chat","repos-indexing-state",e],queryFn:()=>_(e),placeholderData:{requestStatus:m.Unknown,code:u.Unknown,docs:u.Unknown},staleTime:1/0}))}),{mutate:d}=(0,s.n)({mutationKey:["repos-indexing-state"],mutationFn:()=>b(e),onSuccess:o}),h={requestStatus:0===(n=(t=l.map(e=>e.data)).map(e=>e.requestStatus)).length?m.Unknown:n.some(e=>p.includes(e))?m.IndexingError:n.every(e=>e===m.CanIndex)?m.CanIndex:(n.every(e=>e===m.Unknown),m.Unknown),code:C(t.map(e=>e.code)),docs:C(t.map(e=>e.docs)),remainingRepoIndexTokens:t[0]?.remainingRepoIndexTokens};return N(()=>void o(),h.code===u.Indexing&&h.requestStatus!==m.IndexingError?1e4:0),[h,()=>d()]}function y(e){let t=(0,i.jE)(),n=(0,c.useCallback)(()=>Promise.resolve(t.invalidateQueries({queryKey:["repo-indexing-state",e]})),[t,e]),a=(0,o.I)({queryKey:["copilot-chat","repo-indexing-state",e],queryFn:()=>_(e),placeholderData:{requestStatus:m.Unknown,code:u.Unknown,docs:u.Unknown},staleTime:1/0}),{mutate:r}=(0,s.n)({mutationKey:["repo-indexing-state"],mutationFn:()=>b([e]),onSuccess:n}),l=a.data;return N(()=>void n(),l.code===u.Indexing&&l.requestStatus!==m.IndexingError?1e4:0),[l,()=>r()]}function x(e){let t=(0,o.I)({queryKey:["copilot-chat","repos-indexing-state",e],queryFn:()=>j(e),staleTime:1/0});return!t.isError&&!!t.data?.canChat}function v(){let e=d.J.getPanelHeight(),t=d.J.getPanelWidth(),n=(0,c.useRef)(null),a=(0,c.useRef)(e),i=(0,c.useRef)(e),r=(0,c.useRef)(null),s=(0,c.useRef)(t),o=(0,c.useRef)(t),[l,u]=(0,c.useState)(e),[m,p]=(0,c.useState)(t),f=(0,c.useRef)(0);(0,c.useEffect)(()=>{f.current=parseFloat(getComputedStyle(document.documentElement).fontSize)},[]);let y=e=>Math.min(Math.max(e,h),window.innerHeight-f.current),x=e=>Math.min(Math.max(e,g),window.innerWidth-2*f.current),v=(0,c.useCallback)(e=>{if(null!==n.current){let t=n.current-e.clientY,r=y(a.current+t);u(r),i.current=r}if(null!==r.current){let t=r.current-e.clientX,n=x(s.current+t);p(n),o.current=n}},[]),_=(0,c.useCallback)(()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",_),null!==n.current&&(d.J.setPanelHeight(i.current),n.current=null),null!==r.current&&(d.J.setPanelWidth(o.current),r.current=null)},[v]),b=(0,c.useCallback)((e,t,i)=>{0===e.button&&(e.preventDefault(),i&&(n.current=e.clientY,a.current=l),t&&(r.current=e.clientX,s.current=m),window.addEventListener("mousemove",v),window.addEventListener("mouseup",_))},[l,m,v,_]),j=(0,c.useCallback)(e=>{if("ArrowUp"===e.key){let t=y(l+4);u(t),d.J.setPanelHeight(t),e.preventDefault()}else if("ArrowDown"===e.key){let t=y(l-4);u(t),d.J.setPanelHeight(t),e.preventDefault()}else if("ArrowRight"===e.key){let t=x(m-4);p(t),d.J.setPanelWidth(t),e.preventDefault()}else if("ArrowLeft"===e.key){let t=x(m+4);p(t),d.J.setPanelWidth(t),e.preventDefault()}},[l,m]);return{panelWidth:m,panelHeight:l,startResize:b,onResizerKeyDown:j}}async function _(e){let t=await fetch(`/search/check_indexing_status?nwo=${encodeURIComponent(e)}`,{headers:{Accept:"application/json",...(0,a.kt)()}});if(!t.ok)return{requestStatus:m.RequestFailed,code:u.Unknown,docs:u.Unknown};let n=await t.json();return{requestStatus:n.can_index,code:n.code_status,docs:n.docs_status}}async function b(e){let t=1===e.length?`nwo=${encodeURIComponent(e[0])}`:`nwos=${encodeURIComponent(JSON.stringify(e))}`;return(0,l.DI)(`/search/index_embeddings?${t}&index_code=true`,{method:"POST"})}async function j(e){let t=await fetch(`/github-copilot/docs/docsets/kb_indexed_repos?ids=${encodeURIComponent(JSON.stringify(e))}`,{headers:{Accept:"application/json",...(0,a.kt)()}});return t.ok?await t.json():{canChat:!1}}function C(e){return e.every(e=>e===u.Indexed)?u.Indexed:e.every(e=>e===u.Unindexed)?u.Unindexed:e.some(e=>e===u.Indexing)?u.Indexing:e.some(e=>e===u.Unindexed)?u.PartiallyIndexed:u.Unknown}function N(e,t){let n=(0,c.useRef)(void 0),a=(0,c.useRef)(e);return(0,c.useEffect)(()=>{a.current=e},[e]),(0,c.useEffect)(()=>{if(t>0)return n.current=window.setInterval(()=>a.current(),t),()=>window.clearInterval(n.current)},[t]),n}},39046:(e,t,n)=>{n.d(t,{s:()=>CopilotImageAttacher});var a=n(46988),i=n(2622),r=n(5271),s=n(31747);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let l=["image/gif","image/jpeg","image/png","image/webp"];let CopilotImageAttacher=class CopilotImageAttacher{static getAllowedImageFileExtensions(e){return this.getFileExtensions(e).join(",")}static isTypeAllowed(e,t){return e=e.toLowerCase(),this.getMimeTypes(t).includes(e)}static getAllowedFiles(e,t){let[n,a]=e.reduce(([e,n],a)=>this.isTypeAllowed(a.type,t)?[[...e,a],n]:[e,[...n,a]],[[],[]]);return[n,a]}static getAttachmentLimit(){return i.W.attachMultipleImages?4:1}static getAttachmentSizeLimit(){return i.W.dotcomChatFileUpload?384e4:512e3}static makeImageReference(e,t){let n;let a=crypto.randomUUID();return i.W.dotcomChatFileUpload&&(n=new s.N(a,e,t)),n||(n=new s.J(a,e)),{id:a,attachment:n,type:"image",name:e.name||"Image"}}static getFileExtensions(e){let t=this.getMimeTypes(e).map(e=>`.${e.split("/")[1]}`);return t.includes(".jpeg")&&t.push(".jpg"),t}static getMimeTypes(e){return e.capabilities.limits.vision?e.capabilities.limits.vision.supported_media_types.filter(e=>l.includes(e)):[]}async addImageAttachments(e,t="unknown",n){if(0===e.length)return[];let s=this.state.selectedThreadID;if(!s&&i.W.dotcomChatFileUpload)try{s=(await this.manager.createThread(n)).id}catch(t){let e="An error occurred creating the thread. Sending a single message should create a new thread.";throw t instanceof Error&&(e||(e=t.message)),this.manager.addAmbientError(e),Error(e)}let o=this.state.currentReferences.filter(e=>"image"===e.type).length,l=CopilotImageAttacher.getAttachmentLimit();if(o+e.length>l){let e=i.W.attachMultipleImages?`You can add up to ${l} image files per message.`:"Only one image can be uploaded at a time";this.manager.addAmbientError(e),(0,r.d)("file_limit_reached");return}let c=i.W.dotcomChatFileUpload,d=`Only images below ${c?"3.75MB":"500KB"} are supported${c?"":" during this preview period"}`,u=[];for(let n of e){if(!CopilotImageAttacher.isTypeAllowed(n.type,this.state.model)){(0,r.d)("included_unsupported_file",{fileTypes:n.type,uploadType:t});return}if(n.size>CopilotImageAttacher.getAttachmentSizeLimit()){this.manager.addAmbientError(d),(0,r.d)("size_limit_exceeded",{size:n.size});return}if(null==s)throw this.manager.addAmbientError("Please manually create a thread before uploading an image"),Error("ThreadID resolution for image attachment is not functioning properly");let e=CopilotImageAttacher.makeImageReference(n,s);this.manager.addReference(e,"image-attacher"),u.push(e)}return await Promise.all(u.map(async e=>{try{await e.attachment.prefetch(),this.manager.setImageAttachmentUploaded(e.id,e.attachment),(0,a.BI)("dotcom_chat.vision.image_added",{uploadType:t})}catch(n){this.manager.removeReference(e);let t="An unexpected error occurred while reading the file";if("string"==typeof n)throw this.manager.addAmbientError(`An error occurred uploading the attachment ${e.name}`),(0,r.d)("ErrorString",{message:n}),Error(n);if(n instanceof Error){if((0,r.d)(n.name,{message:n.message}),"FileSizeError"===n.name)this.manager.addAmbientError(d);else if("GenericServerError"===n.name&&n.message.includes("Error creating policy"))this.manager.addAmbientError(t);else throw this.manager.addAmbientError(t),n}else throw this.manager.addAmbientError(t),n}})),u}constructor(e,t){o(this,"state",void 0),o(this,"manager",void 0),this.state=e,this.manager=t}}},48186:(e,t,n)=>{n.d(t,{E:()=>CopilotTextAttacher,x:()=>s});var a=n(46988),i=n(54006);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let s="application/x.clipboard",o=/^\s*`?([\w-_]{3,40}\.\w{1,10})`?\s*$/;let CopilotTextAttacher=class CopilotTextAttacher{static async isAttachable(e){if(e.size>CopilotTextAttacher.getAttachmentSizeLimit())return!1;let t=await e.text();return CopilotTextAttacher.isPlainText(t)}static getTextFileExtensions(){return CopilotTextAttacher.fileExtensionsCache??(CopilotTextAttacher.fileExtensionsCache=Object.values(i.r4).flatMap(e=>e.extensions??[]).filter(e=>"stl"!==e).join(","))}static getAttachmentSizeLimit(){return 512e3}static isPlainText(e){let t=Math.min(e.length,1e3),n=0,a=0;for(let i=0;i<t;i++){let t=e.charCodeAt(i);0===t?n++:(t<32||t>126)&&a++}let i=n/t,r=a/t;return i<=.1&&r<=.2}makePlaceholderReference(e){return{type:"loading",title:e.name,id:crypto.randomUUID(),isClientOnly:!0}}async makeReference(e){let t=await e.text(),n=e.name||await this.generateFileName(t,e.type),i=n.split(".").pop();return(0,a.BI)("copilot.attach_pasted_file",{extension:i,characters:t.length}),{type:"thread-scoped-file",name:n,text:t,language:""}}async addAttachment(e){let t;if(e.size>CopilotTextAttacher.getAttachmentSizeLimit()){this.manager.addAmbientError("Attached text files must be smaller than 500KB");return}let n=await e.text();if(!CopilotTextAttacher.isPlainText(n)){this.manager.addAmbientError(`"${e.name}" has an unsupported file type. Please try again with a plain text file`);return}let a=this.makePlaceholderReference(e);this.manager.addReference(a,"text-attacher"),this.manager.dispatch({type:"WAITING_ON_ATTACHMENT",loading:!0});try{t=await this.makeReference(e),this.manager.replaceReference(a,t)}catch{this.manager.addAmbientError("Failed to process file. Please try again."),this.manager.removeReference(a)}finally{this.manager.dispatch({type:"WAITING_ON_ATTACHMENT",loading:!1})}return t}async generateFileName(e,t){let n=this.existingFileNames.size>0?`

Follow the naming formats used by these existing files: ${Array.from(this.existingFileNames).slice(0,5).join(", ")}`:"",i=await this.manager.service.getSimpleCompletion(`Return a suitable filename for the following file contents.
      Follow the file naming conventions of the language and do not include any special characters except for period, underscore or hyphens.
      Try to limit the name to 20 characters or less.
      You MUST include the file extension.${n}

File contents:
\`\`\`
${e}
\`\`\`
`),r=i.ok?o.exec(i.payload)?.[1]:null;return r?(0,a.BI)("copilot.generate_pasted_file_name.success"):(0,a.BI)("copilot.generate_pasted_file_name.failure"),this.uniqueFileName(r??this.defaultFileName(t))}uniqueFileName(e){if(!this.existingFileNames.has(e))return e;let t=e.lastIndexOf("."),n=t>0&&t<e.length-1,a=n?e.substring(0,t):e,i=n?e.substring(t):"",r=2;for(;this.existingFileNames.has(`${a}${r}${i}`);)r++;return`${a}${r}${i}`}defaultFileName(e){return e===s?"pasted.txt":"untitled.txt"}constructor(e,t=new Set){r(this,"manager",void 0),r(this,"existingFileNames",void 0),this.manager=e,this.existingFileNames=t}};r(CopilotTextAttacher,"fileExtensionsCache",void 0)},93326:(e,t,n)=>{n.d(t,{Z:()=>a});function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}},54533:(e,t,n)=>{n.d(t,{LU:()=>s,SI:()=>d,by:()=>c,g:()=>u,oR:()=>m,oy:()=>r,wt:()=>l});var a=n(82610),i=n(77342);function r(e){return e.split("#")[0]}function s(e,t){let n=r(e),a=t.get(n)??[],i=a.indexOf(e);return a.length>1&&-1!==i?i+1:null}function o(e,t){return`file:${e.name}#${t}`}function l(e,t,n){switch(e.type){case"thread-scoped-file":return s(o(e,t),n)??void 0;case"draft-issue":return s(m({ref:e,messageIndex:t}).id,n)??void 0}}function c(e,t,n){return{type:"file",id:`file:${(0,a.Vb)(e)}#0`,reference:e,messageId:t??i.Wp,name:e.path,language:e.languageName??"",value:"",isStreaming:!0,isUserEdited:!1,timestamp:n?new Date(n):new Date}}function d(e,t){return{type:"issue",id:`issue:${e.number}`,messageId:t??i.Wp,name:e.title??"",number:e.number,owner:e.repository.owner,repo:e.repository.name,href:e.url}}function u(e){switch(e.type){case"file":return{type:"thread-scoped-file",name:e.name,language:e.language,text:e.value};case"new-issue":return{type:"draft-issue",tag:e.tag,parentTag:e.parentTag,title:e.name,description:e.body,repository:e.repository,template:e.template,assignees:e.assignees,labels:e.labels,issueType:e.issueType,projects:e.projects,milestone:e.milestone};default:return null}}function m({ref:e,messageIndex:t,messageId:n,timestamp:a}){switch(e.type){case"thread-scoped-file":return function(e,t,n=i.Wp,a){return{type:"file",id:o(e,t),reference:e,messageId:n,name:e.name,language:e.language,value:e.text,timestamp:a?new Date(a):new Date,isStreaming:!1,isUserEdited:n===i.Wp}}(e,t,n,a);case"draft-issue":return function({ref:e,messageId:t=i.Wp,messageIndex:n}){return{type:"new-issue",id:`new-issue:${e.tag}#${n}`,tag:e.tag,parentTag:e.parentTag,repository:e.repository,name:e.title,body:e.description,assignees:e.assignees??[],labels:e.labels??[],issueType:e.issueType,projects:e.projects??[],milestone:e.milestone,isUserEdited:t===i.Wp,messageId:t,isStreaming:!1,template:e.template}}({ref:e,messageIndex:t,messageId:n});default:return null}}},66667:(e,t,n)=>{var a,i,r,s=n(21253),o=n(56413),l=n(66144),c=n(74848);function d(e){return(0,c.jsx)(c.Fragment,{children:e.children})}try{d.displayName||(d.displayName="App")}catch{}var u=n(44848),m=n(82610),p=n(2622),h=n(65615),g=n(40186),f=n(38359),y=n(79760),x=n(61663),v=n(21728),_=n(2497),b=n(47584),j=n(38621);let C="spark",N=`${m.Jz}/spark`;function w(e){let t,n;let a=(0,v.c)(4),{onLinkClick:i}=e;a[0]!==i?(t=(e,t)=>{i?.(e,t)},a[0]=i,a[1]=t):t=a[1];let r=t;return a[2]!==r?(n=(0,c.jsx)(_.Vx,{"aria-current":b.fV.pathname===N?"page":void 0,displayName:"Spark",href:N,icon:j.SparkleFillIcon,id:C,onLinkClick:r}),a[2]=r,a[3]=n):n=a[3],n}try{w.displayName||(w.displayName="SparkNavigation")}catch{}var I=n(26443),S=n(38568),k=n(46928),T=n(60658),A=n(57572),E=n(70775),R=n(46429),P=n(84217),D=n(19647),L=n(13922),M=n(87330),O=n(46309),B=n(37827),F=n(96540),$=n(13253);let U={stack:"SparkView-module__stack--uJy9d",icon:"SparkView-module__icon--a_7ZO",description:"SparkView-module__description--P3jqh",formContainer:"SparkView-module__formContainer--UuPM6",promptInputContainer:"SparkView-module__promptInputContainer--V8jwO",formContainerActions:"SparkView-module__formContainerActions--LBFu1",attachmentToolbar:"SparkView-module__attachmentToolbar--HQkPh",alertBanner:"SparkView-module__alertBanner--jxf09"};function z(){let{spark:e}=(0,f.X)(),[t,n]=(0,F.useState)(""),{promptImage:a,attachImage:i,imageUploadError:r,setImageUploadError:s,clearImageAttachment:o}=(0,E.SW)(),l=(0,k.Z)(),[d,u]=(0,F.useState)([]),[m,p]=(0,F.useState)(!1),[h,g]=(0,F.useState)(!1),y=(0,F.useRef)(null),x=(0,F.useRef)(null),v=(0,F.useRef)(null),_=(0,F.useRef)(null),b=(0,F.useRef)(null),[,C]=(0,T.M)("workbench-pending-submission",void 0);(0,F.useEffect)(()=>{var t;if(Array.isArray(t=e.icebreakers)&&t.every(e=>"type"in e&&"data"in e)){let t=e.icebreakers.find(e=>"functional"===e.type);t&&t.data.length>0&&u(t.data.sort(()=>.5-Math.random()).slice(0,3))}},[e.icebreakers]),(0,S.N)(()=>{let e=0;!function t(){if(!y.current||!_.current)return;let n=_.current.scrollTop;e++,0===y.current.scrollHeight&&e<10&&setTimeout(t,1),y.current.style.height="0";let a=y.current.scrollHeight,i=Math.min(Math.max(a,120),300);y.current.style.height=`${a}px`,_.current.style.height=`${i}px`,_.current.scrollTop=n}()},[t,y]),(0,F.useEffect)(()=>{r&&b.current?.focus()},[r]);let N=async e=>{"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.altKey||e.nativeEvent.isComposing||(e.preventDefault(),await w())},w=async e=>{if(h)return;let i=e??t;if(""===i.trim())return;n(i),g(!0);let r=await (0,A.lS)("/copilot/spark",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(r.ok){let{id:e}=await r.json();C({promptText:i,promptImage:a}),l(`/copilot/spark/${e}`)}};return(0,c.jsx)(I.A.Container,{children:(0,c.jsxs)(O.B,{direction:"vertical",align:"center",padding:"normal",className:U.stack,children:[(0,c.jsx)(j.SparkleFillIcon,{size:40,className:U.icon}),(0,c.jsx)(P.A,{as:"h1",className:"text-center",children:"Build it. Publish it. Share it."}),(0,c.jsx)("p",{className:U.description,children:"Tell Spark what you want to build. It creates your website or app, helps you customize the look, commits directly to a repository, and publishes online. Easy to theme, easier to share."}),r&&(0,c.jsx)(B.l,{className:U.alertBanner,ref:b,variant:"critical",title:"Error attaching image",description:r,hideTitle:!0,onDismiss:()=>{v.current?.focus(),s(void 0)}}),(0,c.jsxs)("div",{ref:_,className:U.formContainer,children:[(0,c.jsx)(D.Ay,{autoFocus:!0,className:U.promptInputContainer,placeholder:"What do you want to create?",ref:y,value:t,onChange:e=>{let t=e.target.value;n(t),p(t.trim().length>0)},onKeyDown:N,resize:"none"}),(0,c.jsxs)("div",{className:U.formContainerActions,children:[(0,c.jsx)("div",{role:"toolbar","aria-label":"Attachments",className:U.attachmentToolbar,children:a&&(0,c.jsx)(L.A,{text:a.name,leadingVisual:j.ImageIcon,onRemove:()=>{o(),v.current?.focus()},size:"large"})}),(0,c.jsx)(M.K,{"aria-label":"Attach image",icon:j.PaperclipIcon,variant:"invisible",ref:v,onClick:()=>x.current?.click()}),(0,c.jsx)("input",{id:"image-uploader",hidden:!0,ref:x,type:"file",accept:R._.join(","),onChange:i}),(0,c.jsx)(M.K,{onClick:()=>w(),icon:j.PaperAirplaneIcon,"aria-label":"Submit prompt","data-testid":"submit-prompt",tooltipDirection:"n",variant:"invisible",loading:h,loadingAnnouncement:"Generating spark",disabled:!m})]})]}),(0,c.jsx)(O.B,{direction:"horizontal",wrap:"wrap",gap:"condensed",align:"center",children:d&&d.map(e=>(0,c.jsx)($.Z,{titleHtml:e.titleHtml,icon:e.icon,color:e.color,onClick:()=>w(e.message)},e.id))})]})})}try{z.displayName||(z.displayName="SparkView")}catch{}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let W=/\/copilot\/spark/;let SparkPlugin=class SparkPlugin{matchView(e){return this.routes.some(t=>t.test(e.pathname))}constructor(){V(this,"id",C),V(this,"displayName","Spark"),V(this,"routes",[W]),V(this,"ViewComponent",z),V(this,"NavigationComponent",w)}};var H=n(18312),q=n(88104),G=n(8932),K=n(46988),Q=n(10871);let J={container:"ImmersiveDisabled-module__container--EDOnQ",content:"ImmersiveDisabled-module__content--dpYC9",footer:"ImmersiveDisabled-module__footer--xPpOC",bannerContainer:"ImmersiveDisabled-module__bannerContainer--Y_iqm"};function Z(){return(0,c.jsxs)("div",{className:J.container,children:[(0,c.jsx)("div",{className:J.content,children:(0,c.jsx)(G.A,{})}),(0,c.jsx)("div",{className:J.footer,children:(0,c.jsx)("div",{className:J.bannerContainer,children:(0,c.jsx)(B.l,{variant:"upsell",title:"Copilot is disabled",hideTitle:!0,description:"Copilot on GitHub is currently disabled by your organization.",primaryAction:(0,c.jsx)(Q.z,{as:"a",href:"https://github.com/settings/copilot",onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"NO_ACCESS_SETTING_DISABLED",mode:"immersive"}),children:"Settings"})})})})]})}try{Z.displayName||(Z.displayName="ImmersiveDisabled")}catch{}var X=n(2914),Y=n(37937),ee=n(68956),et=n(72100),en=n(34164),ea=n(47767),ei=n(69425),er=n(12152),es=n(42252),eo=n(69676),el=n(82678),ec=n(89323),ed=n(15385),eu=n(71941),em=n(34614),ep=n(93116);let eh={errorFallbackContainer:"ErrorFallback-module__errorFallbackContainer--woWrK"};function eg({regionName:e}){return(0,c.jsx)("div",{className:eh.errorFallbackContainer,children:(0,c.jsxs)(ep.E,{children:[(0,c.jsx)(ep.E.Visual,{children:(0,c.jsx)(j.AlertIcon,{size:"medium"})}),(0,c.jsx)(ep.E.Heading,{children:"Something went wrong"}),(0,c.jsxs)(ep.E.Description,{children:[e," is temporarily unavailable due to an unknown error. Try reloading the page or, if the error persists,"," ",(0,c.jsx)(em.A,{href:"https://support.github.com/",inline:!0,children:"contact support"}),"."]})]})})}try{eg.displayName||(eg.displayName="ErrorFallback")}catch{}let ef={container:"ContentPreview-module__container--bV98v",toolbar:"ContentPreview-module__toolbar--b58FL",actions:"ContentPreview-module__actions--AGnBu",tabsContainer:"ContentPreview-module__tabsContainer--bNywg",tabs:"ContentPreview-module__tabs--Si9sh",rightDivider:"ContentPreview-module__rightDivider--Ta3Js",leftDivider:"ContentPreview-module__leftDivider--X7WDV",content:"ContentPreview-module__content--o15no"};var ey=n(22418),ex=n(41686),ev=n(64704),e_=n(69930),eb=n(53949),ej=n(12649),eC=n(54533);let eN={anchor:"VersionSelector-module__anchor--HA1Ko"};function ew({item:e,onVersionSelect:t}){let{versionedItems:n,openItem:a}=(0,q.xx)(),i=(0,eC.oy)(e.id),r=n.get(i)??[],s=r.indexOf(e.id);return((0,F.useEffect)(()=>{t&&r.length>1&&t(`Version${s+1}`)},[s,t,r.length]),r.length<=1)?null:(0,c.jsxs)(ec.W,{children:[(0,c.jsx)(ec.W.Button,{variant:"invisible",className:eN.anchor,children:(0,c.jsx)(ej.g,{version:s+1,"data-testid":"version-selector"})}),(0,c.jsx)(ec.W.Overlay,{children:(0,c.jsx)(ed.l,{selectionVariant:"single",children:r.map((n,i)=>(0,c.jsxs)(ed.l.Item,{onSelect:()=>{a(n),t&&t(`Version${i+1}`)},selected:n===e.id,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(ej.g,{version:i+1})}),"Version ",i+1]},n))})})]})}try{ew.displayName||(ew.displayName="VersionSelector")}catch{}var eI=n(4576),eS=n(11499),ek=n(27331);function eT({issueTemplate:e}){let[t,n]=F.useState(!1),a=F.useRef(null),{repository:i}=(0,eI.u)(),r=!e&&!i?.isBlankIssuesEnabled;return(0,c.jsx)(c.Fragment,{children:r?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(eS.cQ,{commandId:"github:submit-form",variant:"primary","data-testid":"create-issue-dialog-button",ref:a,showKeybindingHint:!0,onClick:e=>{e.preventDefault(),n(!0)},children:"Create"}),t&&(0,c.jsx)(ek.l,{title:"Select a template",onClose:()=>n(!1),footerButtons:[{buttonType:"primary",content:"OK",onClick:()=>n(!1)}],returnFocusRef:a,children:"This repository requires all issues to have a template. To create this issue, first select the appropriate template from the template dropdown."})]}):(0,c.jsx)(ey.l,{hideCreateMore:!0,className:"width-auto"})})}try{eT.displayName||(eT.displayName="CreateIssueButton")}catch{}var eA=n(1301),eE=n(73218),eR=n(57814),eP=n(28339),eD=n(98830),eL=n(97286),eM=n(69487),eO=n(26677),eB=n(46996);function eF(e){let{messages:t}=(0,h.Pk)();return`new-issue:${e}#${t.length}`}function e$(e){let{openItem:t,updateItem:n}=(0,q.xx)(),{selectedThreadID:a}=(0,h.Pk)(),i=eF(e.tag),r=`edited-${a}-${i}`,[s,o]=(0,eO.Fo)(r,void 0);return(0,F.useCallback)((a,r=!1)=>{let s,l=!1;for(s in a)if(!(0,eB.A)(a[s],e[s])){l=!0;break}if(!l)return;let c={...e,...a};!r&&(c.id=i,c.isUserEdited=!0,p.W.copilotPersistEditedDraftIssues&&o(c)),n(c),t(c.id)},[e,i,t,n,o])}var eU=n(21878),ez=n(71783),eV=n(55724),eW=n(9935);function eH(e,t){return e?.toLowerCase()===t?.toLowerCase()}function eq({draftIssue:e,onCreate:t,onChange:n,onClose:a,onBeforeCreate:i}){let{name:r,body:s=""}=e,o=(0,F.useRef)(null),{repository:l,clearSessionData:d}=(0,eI.u)(),[u,m]=(0,F.useState)(r),[p,h]=(0,F.useState)(s),g=(0,F.useCallback)(()=>{d(),o.current?.clearSessionStorage()},[d]),f=(0,F.useCallback)(()=>{g(),a?.()},[g,a]);return((0,F.useEffect)(()=>{m(r),h(s)},[s,r]),!function(e){let{repository:t,assignees:n,setAssignees:a}=(0,eI.u)(),[i,r]=(0,F.useState)(n),{isLoading:s,data:o}=function({owner:e,repo:t,assignees:n}){let a=(0,H.useRelayEnvironment)(),i=(0,eD.M)({includeAuthorableBots:!1,includeAssignableBots:!0});return(0,eL.I)({queryKey:["copilot-immersive-assignees",JSON.stringify(a),i,e,t,n],queryFn:async()=>{if(!e||!t||!n)return[];let r=await (0,y.SD)({environment:a,query:eP.OE,variables:{owner:e,name:t,loginNames:n.join(",")??[],first:n.length??0,capabilities:i}}).toPromise();return(r?.repository?.suggestedActors?.nodes??[]).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eP.G1,e))}})}({owner:t?.owner.login,repo:t?.name,assignees:e.assignees}),l=e$({...e,assignees:o?.map(e=>eR.vM(e.login)?eR.A9:e.login)??[]});(0,F.useEffect)(()=>{!s&&o&&(t?.viewerIssueCreationPermissions?.assignable?a(o):null!=t&&a([]))},[s,o,a,t?.viewerIssueCreationPermissions?.assignable,t]),(0,F.useEffect)(()=>{s||i===n||(l({assignees:n.map(e=>(0,eR.vM)(e.login)?eR.A9:e.login)}),r(n))},[s,i,n,l])}(e),!function(e){let{repository:t,labels:n,setLabels:a}=(0,eI.u)(),[i,r]=(0,F.useState)(n),{isLoading:s,data:o}=function({owner:e,repo:t,labels:n}){let a=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-labels",JSON.stringify(a),e,t,n],queryFn:async()=>{if(!e||!t||!n)return[];let i=await (0,y.SD)({environment:a,query:eU.uS,variables:{owner:e,repo:t,shouldQueryByNames:!0,labelNames:n.join(","),count:n.length}}).toPromise();return(i?.repository?.labelsByNames?.nodes??[]).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eU.l_,e))}})}({owner:t?.owner.login,repo:t?.name,labels:e.labels}),l=e$({...e,labels:o?.map(e=>e.name)??[]});(0,F.useEffect)(()=>{!s&&o&&(t?.viewerIssueCreationPermissions?.labelable?a(o):null!=t&&a([]))},[s,o,a,t?.viewerIssueCreationPermissions?.labelable,t]),(0,F.useEffect)(()=>{s||i===n||(l({labels:n.map(e=>e.name)}),r(n))},[s,i,n,l])}(e),!function(e){let{repository:t,issueType:n,setIssueType:a}=(0,eI.u)(),[i,r]=(0,F.useState)(n),{isLoading:s,data:o}=function({owner:e,repo:t}){let n=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-issue-types",JSON.stringify(n),e,t],queryFn:async()=>{if(!e||!t)return[];let a=await (0,y.SD)({environment:n,query:eW.xS,variables:{owner:e,repo:t,issueTypesPageSize:25}}).toPromise();if(!a?.repository)return[];let i=(0,eM.readInlineData)(eW.Jc,a.repository);return(i?.issueTypes?.edges?.flatMap(e=>e?.node)??[]).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eW.sH,e))}})}({owner:t?.owner.login,repo:t?.name}),l=(0,F.useMemo)(()=>!e.issueType||s?null:o?.find(t=>eH(t.name,e.issueType)),[e.issueType,s,o]),c=e$({...e,issueType:l?.name});(0,F.useEffect)(()=>{s||(t?.viewerIssueCreationPermissions?.typeable?a(l??null):null!=t&&a(null))},[s,l,a,t?.viewerIssueCreationPermissions?.typeable,t]),(0,F.useEffect)(()=>{s||eH(i?.name,n?.name)||(c({issueType:n?.name}),r(n))},[s,i,n,c])}(e),!function(e){let{repository:t,milestone:n,setMilestone:a}=(0,eI.u)(),[i,r]=(0,F.useState)(n),{isLoading:s,data:o}=function({owner:e,repo:t,milestone:n}){let a=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-milestones",JSON.stringify(a),e,t,n],queryFn:async()=>{if(!e||!t||!n)return null;let i=await (0,eM.fetchQuery)(a,ez.KK,{owner:e,repo:t,query:n,count:1}).toPromise();return(i?.repository?.milestones?.nodes||[]).filter(e=>!!e).map(e=>(0,eM.readInlineData)(ez.xm,e))[0]??null}})}({owner:t?.owner.login,repo:t?.name,milestone:e.milestone}),l=e$({...e,milestone:o?.title});(0,F.useEffect)(()=>{s||(t?.viewerIssueCreationPermissions?.milestoneable?a(o??null):null!=t&&a(null))},[s,o,a,t?.viewerIssueCreationPermissions?.milestoneable,t]),(0,F.useEffect)(()=>{var e,t;s||(e=i?.title,t=n?.title,e?.toLowerCase()===t?.toLowerCase())||(l({milestone:n?.title}),r(n))},[s,i,n,l])}(e),!function(e){let{repository:t,projects:n,setProjects:a}=(0,eI.u)(),[i,r]=(0,F.useState)(n),{isLoading:s,data:o}=function({owner:e,repo:t,projects:n}){let a=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-projects",JSON.stringify(a),e,t,n],queryFn:async()=>{if(!e||!t||!n||!n.length)return[];let i=await (0,eM.fetchQuery)(a,eV.BT,{owner:e,repo:t,query:n.join(",")}).toPromise(),r=(i?.repository?.projectsV2?.nodes??[]).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eV.dW,e)),s=[...[...r,...(i?.repository?.recentProjects?.edges??[]).map(e=>e?.node).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eV.dW,e)),...(i?.repository?.owner?.projectsV2?.edges??[]).map(e=>e?.node).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eV.dW,e)),...(i?.repository?.owner?.recentProjects?.edges??[]).map(e=>e?.node).filter(e=>!!e).map(e=>(0,eM.readInlineData)(eV.dW,e))].reduce((e,t)=>(e.set(t.id,t),e),new Map).values()],o=new Set(n.map(e=>e.toLowerCase()));return s.filter(e=>!1===e.closed).filter(e=>!1===e.hasReachedItemsLimit).filter(e=>o.has(e.title.toLowerCase()))}})}({owner:t?.owner.login,repo:t?.name,projects:e.projects}),l=e$({...e,projects:o?.map(e=>e.title)??[]});(0,F.useEffect)(()=>{!s&&o&&(t?.viewerIssueCreationPermissions?.triageable?a(o):null!=t&&a([]))},[s,o,a,t?.viewerIssueCreationPermissions?.triageable,t]),(0,F.useEffect)(()=>{s||i===n||(l({projects:n.map(e=>e.title)}),r(n))},[s,i,n,l])}(e),null==l)?(0,c.jsx)(e_.Q,{optionConfig:{useViewportQueries:!1}}):(0,c.jsx)(eA.e,{repository:l,title:u,body:p,setTitle:e=>{m(e),n?.({name:e})},setBody:e=>{h(e),n?.({body:e})},clearOnCreate:f,issueFormRef:o,onCreateSuccess:({issue:e})=>t?.(e),onCreateError:eE.l,onCancel:f,onBeforeCreate:i})}try{eq.displayName||(eq.displayName="CreateIssueForm")}catch{}let eG={container:"CreateIssuePreview-module__container--UdBdV",toolbar:"CreateIssuePreview-module__toolbar--KnRki FilePreview-module__toolbar--toYCM",toolbarLeft:"CreateIssuePreview-module__toolbarLeft--WCzxL FilePreview-module__toolbarLeft--FG_Fy",toolbarActions:"CreateIssuePreview-module__toolbarActions--euLmx FilePreview-module__toolbarActions--GZPSm",createIssueFooter:"CreateIssuePreview-module__createIssueFooter--csy2W",form:"CreateIssuePreview-module__form--t92hw"};var eK=n(31941),eQ=n(21320),eJ=n(45396),eZ=n(83850),eX=n(79237),eY=n(33902),e0=n(55847);function e1({issue:e}){let{openItem:t,versionedItems:n}=(0,q.xx)(),a=(function(){let{items:e,versionedItems:t}=(0,q.xx)();return(0,F.useMemo)(()=>{let n=[...t.entries()].filter(([e])=>e.startsWith("new-issue:")).map(([t,n])=>{let a=n.at(-1);return a?e.get(a):void 0}).filter(e=>!!e),a=n.reduce((e,t)=>(e.set(t.tag,{item:t,parent:null,children:[]}),e),new Map);for(let e of n){if(!e.parentTag)continue;let t=a.get(e.parentTag),n=a.get(e.tag);t&&n&&(n.parent=t,t.children.push(n))}return a},[e,t])})().get(e.tag);return p.W.draftIssueTree?(0,c.jsxs)(c.Fragment,{children:[(()=>{let e=a?.parent?.item;if(!e)return null;let i=(0,eC.LU)(e.id,n);return(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsx)(eK.A,{children:"Parent"}),(0,c.jsxs)("div",{className:"border rounded-2 p-2",children:[(0,c.jsx)(j.IssueDraftIcon,{className:"mr-2"}),(0,c.jsx)(e0.Q,{variant:"link",className:"fgColor-default",onClick:()=>t(e.id,!0),children:e.name}),null!=i&&(0,c.jsx)(ej.g,{version:i})]})]})})(),(()=>{let e=a?a.children:[];if(0===e.length)return null;let i=e=>{let a=(0,eC.LU)(e.item.id,n);return(0,c.jsx)(eJ.r,{title:(0,c.jsx)(eY.T,{value:e.item.name,onClick:()=>{t(e.item.id,!0)},trailingBadges:null!=a?[(0,c.jsx)(ej.g,{version:a},`${e.item.tag}#${a}`)]:void 0}),subItems:e.children?.length?e.children.map(i):void 0,defaultExpanded:!0,children:(0,c.jsx)(eZ.Q,{children:(0,c.jsx)(eX.D,{children:(0,c.jsx)(j.IssueDraftIcon,{})})})},e.item.tag)};return(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsx)(eK.A,{children:"Sub-issues"}),(0,c.jsx)("div",{className:"border rounded-2 p-2",children:(0,c.jsx)(eQ.v,{title:"Sub-issues",children:e.map(i)})})]})})()]}):null}try{e1.displayName||(e1.displayName="Relationships")}catch{}var e2=n(10833),e5=n(37824);let e3={container:"RepositoryPicker-module__container--LguWf",label:"RepositoryPicker-module__label--UrLpA",ssoBanner:"RepositoryPicker-module__ssoBanner--iob3k"};function e4({draftIssue:e,resolvedDraftIssueRepo:t,loadingDraftIssueRepo:n,topReposQuery:a}){let[i,r]=(0,F.useState)(void 0),{repository:s,setRepository:o}=(0,eI.u)(),l=(0,H.useFragment)(e2.Sy,a?.viewer),d=(0,F.useMemo)(()=>{if(null!=l)return(l?.topRepositories.edges||[]).flatMap(e=>e?.node?[(0,H.readInlineData)(e2.R6,e.node)]:[])},[l]),u=(0,F.useCallback)(e=>{null!=e&&o(e)},[o]);!function(e,t,n,a){let{repository:i,setRepository:r}=(0,eI.u)(),[s,o]=(0,F.useState)(i),l=e$(e),c=(0,F.useMemo)(()=>!n&&t?.nameWithOwner==null||t?.nameWithOwner===i?.nameWithOwner,[n,t?.nameWithOwner,i?.nameWithOwner]);(0,F.useEffect)(()=>{e.isStreaming||n||(null!=t?r(t):null!=a&&a.length>0?r(a[0]):r(void 0))},[e.isStreaming,n,t,r,a]),(0,F.useEffect)(()=>{s!==i&&(l({repository:i?.nameWithOwner},c),o(i))},[l,i,c,s])}(e,t,n,d),(0,F.useEffect)(()=>{n||null==s||null==d||d.find(e=>e.id===s.id)||r(s.id)},[s,n,d]);let{ssoOrganizations:m}=(0,h.Pk)(),p=(0,F.useMemo)(()=>m?.map(e=>e.login)??[],[m]);if(!n&&null==s&&(null==d||0===d.length))return null;let g=s??d?.[0],f=e.isStreaming||n||null==t;return(0,c.jsxs)("div",{className:e3.container,children:[(0,c.jsx)(eK.A,{className:(0,en.$)(e3.label,"sr-only"),required:!0,children:"Repository"}),(0,c.jsx)(e2.ow,{initialRepository:g,onSelect:u,options:{hasIssuesEnabled:!0,readonly:f},topRepositoriesData:a?a.viewer:null,enforceAtleastOneSelected:!0,subtitle:(0,c.jsx)(e5.x,{className:e3.ssoBanner,forceWrap:!0,protectedOrgs:p,maxVisibleOrgNames:0,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${location.href}`})},i)]})}try{e4.displayName||(e4.displayName="RepositoryPicker")}catch{}let e6=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"owner"},{defaultValue:null,kind:"LocalArgument",name:"repo"}],t=[{kind:"Variable",name:"name",variableName:"repo"},{kind:"Variable",name:"owner",variableName:"owner"}],n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"filename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[n,a,i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],s=[n,a,i,{alias:null,args:null,kind:"ScalarField",name:"about",storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"TemplatePickerQuery",selections:[{alias:null,args:t,concreteType:"Repository",kind:"LinkedField",name:"repository",plural:!1,selections:[{alias:null,args:null,concreteType:"IssueForm",kind:"LinkedField",name:"issueForms",plural:!0,selections:[n,{kind:"InlineDataFragmentSpread",name:"TemplatePickerForm",selections:r,args:null,argumentDefinitions:[]}],storageKey:null},{alias:null,args:null,concreteType:"IssueTemplate",kind:"LinkedField",name:"issueTemplates",plural:!0,selections:[n,{kind:"InlineDataFragmentSpread",name:"TemplatePickerTemplate",selections:s,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"TemplatePickerQuery",selections:[{alias:null,args:t,concreteType:"Repository",kind:"LinkedField",name:"repository",plural:!1,selections:[{alias:null,args:null,concreteType:"IssueForm",kind:"LinkedField",name:"issueForms",plural:!0,selections:r,storageKey:null},{alias:null,args:null,concreteType:"IssueTemplate",kind:"LinkedField",name:"issueTemplates",plural:!0,selections:s,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"453f03781d915408c3c338e5d346e0be",metadata:{},name:"TemplatePickerQuery",operationKind:"query",text:null}}}();e6.hash="582a468668cd62a5a95ad0f91f7ea5e5";let e7={kind:"InlineDataFragment",name:"TemplatePickerForm"};e7.hash="277026edd019ed6ef2c9d27b3d3d6c4a";let e8={kind:"InlineDataFragment",name:"TemplatePickerTemplate"};e8.hash="fa6038bb9389af7bff23ba3491dd0507";var e9=n(7426),te=n(22678),tt=n(75632),tn=n(3893);function ta({draftIssue:e}){let t=(0,te.d)();return(0,tt.G7)("copilot_immersive_draft_issue_template_picker")&&null==t?(0,c.jsx)(ti,{draftIssue:e}):null}function ti({draftIssue:e}){let{repository:t}=(0,eI.u)(),{data:n}=function({owner:e,repo:t}){let n=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-templates",JSON.stringify(n),e,t],queryFn:async()=>{if(!e||!t)return[];let a=await (0,eM.fetchQuery)(n,e6,{owner:e,repo:t}).toPromise();return[...(a?.repository?.issueTemplates||[]).map(e=>(0,eM.readInlineData)(e8,e)),...(a?.repository?.issueForms||[]).map(e=>(0,eM.readInlineData)(e7,e))].sort((e,t)=>e.filename.localeCompare(t.filename))}})}({owner:t?.owner.login,repo:t?.name});return null==n||0===n.length?null:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:"/"}),(0,c.jsxs)("div",{className:e3.container,children:[(0,c.jsx)(eK.A,{className:(0,en.$)(e3.label,"sr-only"),children:"Template"}),(0,c.jsx)(tr,{templates:n,draftIssue:e,isBlankIssuesEnabled:t?.isBlankIssuesEnabled})]})]})}function tr({templates:e,draftIssue:t,isBlankIssuesEnabled:n}){let[a,i]=(0,F.useState)(""),r=(0,F.useMemo)(()=>a?e?.filter(e=>e.name?.toLowerCase().includes(a.toLowerCase())):e,[e,a]),[s,o]=(0,F.useState)(void 0);(0,F.useEffect)(()=>{if(!t.template){o(void 0);return}let n=t.template.split("/").pop();o(e?.find(e=>e.filename===n))},[e,t.template]);let l=function(){let e=(0,e9.b)(),t=(0,h.Pk)(),{updateItem:n}=(0,q.xx)();return(0,F.useCallback)(async(a,i)=>{let r={type:"text",name:`timeline-event: {"type": "switch-issue-template", "markdownContent": "${i?`Changing template to '${i.name}'\u{2026}`:"Removing template\u2026"}"}`,text:i?`Update the selected draft issue with the \`${i.filename}\` template. Regenerate the title and description following the new template. Maintain all conversation context. Update the metadata to follow the new template. DO NOT change the \`tag\` field.`:"Update the selected draft issue to remove the template formatting. Regenerate the title and description to follow a generic format. Maintain all conversation context. DO NOT change the `tag` field."},s={...a,template:i?.filename,isUserEdited:!1};n(s);let o=(0,eC.g)(s);await e.sendChatMessage({thread:e.getSelectedThread(t),content:i?`Use the '${i.name}' template`:"Remove the template",references:[r,o],topic:t.currentTopic,context:t.context,customInstructions:t.customInstructions,model:t.model})},[e,t,n])}(),d=(0,F.useRef)(null),u=p.W.draftIssueTemplateRequiredIfBlankIssuesDisabled&&null!=n&&!n;return(0,c.jsx)(tn.O,{items:r??[],initialSelectedItems:s?[s]:[],placeholderText:"Select template",selectionVariant:"single",filterItems:i,renderAnchor:e=>(0,c.jsxs)(e0.Q,{trailingVisual:j.TriangleDownIcon,...e,ref:d,children:[s?(0,c.jsx)("span",{children:s.name}):"Select template",u&&(0,c.jsx)("span",{style:{color:"red",marginLeft:4},children:"*"})]}),getItemKey:e=>e.filename,convertToItemProps:e=>({id:e.filename,text:e.name,description:("IssueTemplate"===e.__typename?e.about:e.description)||void 0,descriptionVariant:"block",source:e}),onSelectionChange:async([e])=>{o(e),await l(t,e)},selectPanelRef:d,height:"large",width:"medium"})}try{ta.displayName||(ta.displayName="TemplatePicker")}catch{}try{ti.displayName||(ti.displayName="TemplatePickerWrapper")}catch{}try{tr.displayName||(tr.displayName="TemplatePickerInternal")}catch{}var ts=n(77342),to=n(93589),tl=n(42742);let tc=e=>{let{messages:t}=(0,h.Pk)(),n=(0,to.B)(t);return(0,F.useMemo)(()=>{if(null!=e)return async t=>{let a=t.match(/(!\[.*\]\(https:\/\/(?:.+\.)?github\.com\/github-copilot\/chat\/attachments\/[0-9a-fA-F-]+\))/g),i=new Set;for(let e of a||[]){let t=e.match(/https:\/\/(?:.+\.)?github\.com\/github-copilot\/chat\/attachments\/[0-9a-fA-F-]+/)?.[0];t&&i.add(t)}if(i.size>0){let a=Array.from(i).map(async e=>{let t=await fetch(e),n=await t.blob(),a=n.type.split("/")[1],i=`copilot-image.${a}`,r=await createImageBitmap(n),s=r.width;return r.close(),{file:new File([n],i,{type:n.type}),url:e,width:s}}),r=await Promise.all(a);for(let n of(await Promise.all(r.map(async t=>{if(t)return{uploadedFile:await (0,tl.QM)(t.file,e.databaseId?.toString()),originalUrl:t.url,width:t.width}}))))if(n){let{uploadedFile:e,originalUrl:a,width:i}=n,r=e.url;if(r){let e=RegExp(`!\\[(.*?)\\]\\(${a}\\)`,"g");t=t.replace(e,`<img alt="$1" width="${i}" src="${r}" />`)}}(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_ISSUE_CREATED_IMAGES",mode:"immersive",imageCount:i.size,threadId:n[0]?.threadID})}return t}},[n,e])};function td({isPreviewOpening:e,issue:t,onClose:n}){t=function(e){let{messages:t}=(0,h.Pk)(),n=(0,to.B)(t),a=(0,F.useMemo)(()=>n.flatMap(e=>e.mediaContent||[]),[n]),i=(0,F.useMemo)(()=>(function(e,t){if(!e)return"";let n=e.match(/(!\[.*?\]\(image\d+\))/g);if(null==n)return e;for(let a of n){let n=/\(image(\d+)\)/,i=parseInt(a.match(n)[1],10),r=t.length-i,s=t[r]?.chatAttachmentUrl||t[r]?.url;if(s){let t=a.replace(n,`(${s})`);e=e.replace(a,t)}}return e})(e.body,a),[e.body,a]);return i===e.body?e:{...e,body:i}}(t);let[a,i]=(0,F.useState)(e);(0,F.useEffect)(()=>{if(a){let e=setTimeout(()=>i(!1),500);return()=>clearTimeout(e)}},[a]);let{selectedThreadID:r}=(0,h.Pk)(),{isLoading:s,data:o}=function(){let e=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-top-repos",JSON.stringify(e)],queryFn:async()=>await (0,e2.Xl)(e,10,!0).toPromise()})}(),[l,d]=t.repository?.split("/")??[],{isLoading:u,data:m}=function({owner:e,repo:t}){let n=(0,H.useRelayEnvironment)();return(0,eL.I)({queryKey:["copilot-immersive-current-repo",JSON.stringify(n),e,t],queryFn:async()=>{if(!e||!t)return null;let a=await (0,e2.DW)(n,e,t).toPromise();if(a?.repository!=null)return(0,H.readInlineData)(e2.R6,a.repository)}})}({owner:l,repo:d}),g=tc(m),f=function({tag:e}){let t=(0,h.Pk)(),n=(0,e9.b)(),{items:a,updateItem:i,openItem:r,closeItem:s,openPreviewPane:o}=(0,q.xx)(),l=eF(e);return(0,F.useCallback)(async e=>{(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_ISSUE_CREATED",mode:"immersive",threadId:n.getSelectedThread(t)?.id,repositoryId:e.repository.databaseId,issueNumber:e.number,chatReferrer:document.referrer});let c=e.number,d=e.repository.owner.login,u=e.repository.name,m=e.title,p=`issue:${d}/${u}/${c}`;i({id:p,messageId:ts.Wp,name:m,owner:d,repo:u,number:c,href:e.url,type:"issue"}),s(l),r(p),o();let h=[{type:"text",name:`timeline-event: {"type": "issue-created", "markdownContent": "Issue saved to [${d}/${u}#${c}](${e.url})"}`,text:`Fetch the issue details and return them in a code block with YAML following this example format:
\`\`\`list type="issue"
data:
- url: ${e.url}
  state: "open"
  draft: false
  title: "${m}"
  number: ${c}
  author: ${t.currentUserLogin}
  created_at: "2025-03-27T12:00:00Z"
  closed_at: "2025-03-27T12:00:00Z"
  labels:
  - name: "bug"
  - name: "good first issue"
\`\`\``}],g=a.get(l);g?.type==="new-issue"&&h.push((0,eC.g)(g)),await n.sendChatMessage({thread:n.getSelectedThread(t),content:`Saved the issue to [${d}/${u}#${c}](${e.url})`,references:h,topic:t.currentTopic,context:t.context,customInstructions:t.customInstructions,model:t.model})},[l,n,t,a,o,r,i,s])}(t),y=e$(t),x=(0,F.useRef)(null),v=(0,F.useSyncExternalStore)(e=>{let t=new ResizeObserver(e);return t.observe(document.documentElement),()=>{t.unobserve(document.documentElement),t.disconnect()}},()=>!p.W.draftIssueMetadataLocation||!x.current||x.current.clientWidth<1024);return a||s?(0,c.jsx)(e_.Q,{optionConfig:{useViewportQueries:!1}}):null!=o||u||null!=m?(0,c.jsx)(ev.S,{optionConfig:(0,ex.S)({storageKeyPrefix:`${t.id}@${r}`,insidePortal:v}),preselectedData:{repository:m??void 0},...(0,eb.G)("create-issue-preview"),children:(0,c.jsxs)("div",{className:eG.container,ref:x,children:[(0,c.jsxs)("div",{className:eG.toolbar,children:[(0,c.jsx)("div",{className:eG.toolbarLeft,children:(0,c.jsx)(ew,{item:t})}),(0,c.jsxs)("div",{className:eG.toolbarActions,children:[(0,c.jsx)(em.A,{href:"https://gh.io/copilot-create-issues-feedback",className:"mr-2",children:"Give feedback"}),p.W.draftIssueTemplateRequiredIfBlankIssuesDisabled?(0,c.jsx)(eT,{issueTemplate:t.template}):(0,c.jsx)(ey.l,{hideCreateMore:!0,className:eG.createIssueFooter})]})]}),(0,c.jsxs)("div",{className:eG.form,children:[(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"condensed",className:"py-2",children:[(0,c.jsx)(e4,{draftIssue:t,resolvedDraftIssueRepo:m,loadingDraftIssueRepo:u,topReposQuery:o}),(0,c.jsx)(ta,{draftIssue:t})]}),(0,c.jsx)(eq,{draftIssue:t,onCreate:f,onChange:y,onClose:n,onBeforeCreate:g}),(0,c.jsx)(e1,{issue:t})]})]})}):(0,c.jsx)("span",{children:"No repositories found."})}try{td.displayName||(td.displayName="CreateIssuePreview")}catch{}var tu=n(34225),tm=n(26514),tp=n(44492),th=n(16945),tg=n(23125),tf=n(54006);let ty=e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=e.name||"file",n.click(),URL.revokeObjectURL(t)},tx={container:"FilePreview-module__container--_pENP",previewContainer:"FilePreview-module__previewContainer--vjKjn",codeMirrorContainer:"FilePreview-module__codeMirrorContainer--bIVZV",toolbar:"FilePreview-module__toolbar--toYCM",toolbarLeft:"FilePreview-module__toolbarLeft--FG_Fy",toolbarLoC:"FilePreview-module__toolbarLoC--cjBe0",toolbarActions:"FilePreview-module__toolbarActions--GZPSm",footer:"FilePreview-module__footer--pwLuO"};var tv=n(72334);let t_={ERROR:"ERROR",LOADING:"LOADING",LOADED:"LOADED",READY:"READY"};function tb(e,t){e&&e.postMessage&&e.postMessage(JSON.stringify(t),"*")}let tj={container:"SandboxView-module__container--_qS7F",iframe:"SandboxView-module__iframe--bgP8I"},tC={error:"ErrorMessage-module__error--EPInF",errorIcon:"ErrorMessage-module__errorIcon--qRxBg",errorHeader:"ErrorMessage-module__errorHeader--ePU6Q"};function tN(e){let t;let n=(0,v.c)(4),{error:a}=e;if(n[0]!==a){let e,i;let r=a?.split("\n")??[];n[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,c.jsx)("span",{className:tC.errorIcon,children:(0,c.jsx)(j.StopIcon,{size:24})}),i=(0,c.jsx)("h2",{className:tC.errorHeader,children:"HTML rendering failed"}),n[2]=e,n[3]=i):(e=n[2],i=n[3]),t=(0,c.jsxs)("div",{className:tC.error,children:[e,i,r.length>0?(0,c.jsx)("p",{children:r.map(tw)}):(0,c.jsx)("p",{children:"Refresh the page or check the HTML"})]}),n[0]=a,n[1]=t}else t=n[1];return t}function tw(e){return(0,c.jsxs)(c.Fragment,{children:[e,(0,c.jsx)("br",{})]},`error-line-${e}}`)}try{tN.displayName||(tN.displayName="ErrorMessage")}catch{}function tI(e){let t,n,a,i;let r=(0,v.c)(11),{content:s,scripts:o,styles:l,viewscreenUrl:d}=e,u=(0,tt.G7)("viewscreen_sandbox");r[0]!==d?(n=new URL("view/sandbox?url=client://sandbox",d).toString(),t=new URL(n,b.fV.origin),r[0]=d,r[1]=t,r[2]=n):(t=r[1],n=r[2]);let m=t.origin,p=(0,F.useRef)(null),h=(0,F.useRef)(null);r[3]!==s||r[4]!==o||r[5]!==l?(a={content:s,scripts:o,styles:l},r[3]=s,r[4]=o,r[5]=l,r[6]=a):a=r[6];let{renderState:g,errorMessage:f}=function(e,t,n,a){let i,r,s,o,l,c;let d=(0,v.c)(16),[u,m]=(0,F.useState)(t_.LOADING),[p,h]=(0,F.useState)();d[0]!==t||d[1]!==e||d[2]!==a?(i=n=>(function(e,t,n,a,i,r){let s=function(e){var t;let n=e.data;if(!n)return null;if("string"==typeof n)try{n=JSON.parse(n)}catch{return null}return"object"==typeof(t=n)&&t&&"render"===t.type&&"string"==typeof t.body&&"object"==typeof t.payload?n:null}(e);if(!s)return;let o=s.body,l=n.current?.contentWindow;switch(o){case"hello":tb(l,{type:"render:cmd",body:{cmd:"ack",ack:!0}}),tb(l,{type:"render:cmd",body:{cmd:"branding",branding:!1}});break;case"error":case"error:fatal":case"error:invalid":r(t_.ERROR),s.payload?.error&&i(s.payload.error);break;case"loading":r(t_.LOADING);break;case"loaded":r(t_.LOADED);break;case"ready":if(!n.current||!a.current)return;r(t_.READY)}})(n,0,e,t,h,m),d[0]=t,d[1]=e,d[2]=a,d[3]=i):i=d[3];let g=i;return d[4]!==g?(r=()=>(window.addEventListener("message",g),()=>window.removeEventListener("message",g)),s=[g],d[4]=g,d[5]=r,d[6]=s):(r=d[5],s=d[6]),(0,F.useEffect)(r,s),d[7]!==t||d[8]!==e||d[9]!==n||d[10]!==u?(o=()=>{u===t_.READY&&e.current&&t.current&&function(e,t,n){let a={type:"render:cmd",body:{cmd:"sandbox:data:ready","sandbox:data:ready":{...n}}};tb(e.contentWindow,a)}(e.current,t.current,n)},l=[t,e,n,u],d[7]=t,d[8]=e,d[9]=n,d[10]=u,d[11]=o,d[12]=l):(o=d[11],l=d[12]),(0,F.useEffect)(o,l),d[13]!==p||d[14]!==u?(c={renderState:u,errorMessage:p},d[13]=p,d[14]=u,d[15]=c):c=d[15],c}(p,h,a,m);return u?(r[7]!==f||r[8]!==g||r[9]!==n?(i=(0,c.jsx)("div",{ref:h,className:tj.container,children:g===t_.ERROR?(0,c.jsx)(tN,{error:f}):(0,c.jsx)("iframe",{ref:p,className:tj.iframe,sandbox:"allow-scripts",title:"Preview page for the user provided code",src:n})}),r[7]=f,r[8]=g,r[9]=n,r[10]=i):i=r[10],i):null}try{tI.displayName||(tI.displayName="SandboxView")}catch{}let tS={loadingContainer:"HtmlPreview-module__loadingContainer--b987j",loadingHead:"HtmlPreview-module__loadingHead--abHb3",loadingText:"HtmlPreview-module__loadingText--WYXW5"};function tk(e,t,n){let a=`file:${e}`;if(!n.has(a))return null;let i=n.get(a)??[],r=i[i.length-1];if(!r)return null;let s=t.get(r);return s&&"file"===s.type?s:null}function tT({file:e}){let{previewUrl:t}=(0,f.X)(),{items:n,versionedItems:a}=(0,q.xx)(),{scripts:i,styles:r,files:s}=function(e,t,n){let a=Array.from(e.matchAll(/<script.*?src="(.*?)"/g)).map(e=>e[1]).filter(e=>void 0!==e).map(e=>tk(e,t,n)),i=(function(e){let t=Array.from(e.matchAll(/<link([^>]+)>/g)).map(e=>e[1]).filter(e=>void 0!==e),n=[];for(let e of t){if("stylesheet"!==/rel\s*=\s*"([^"]+)"/.exec(e)?.[1])continue;let t=/href\s*=\s*"([^"]+)"/.exec(e)?.[1];t&&n.push(t)}return n})(e).map(e=>tk(e,t,n)),r=Array.from(e.matchAll(RegExp("<script(?![^>]*\\bsrc=).*?>(.*?)<\\/script>","gms"))).map(e=>e[1]).filter(e=>void 0!==e);return{scripts:[...a.map(e=>e?.value??""),...r,'document.dispatchEvent(new Event("DOMContentLoaded"))'].join("\n"),styles:i.map(e=>e?.value??"").join("\n"),files:a.concat(i)}}(e.value,n,a),[o,l]=(0,F.useState)(!1),d=(e.isStreaming||s.some(e=>!e||e.isStreaming))&&!o;return((0,F.useEffect)(()=>{if(d){let e=setTimeout(()=>{l(!0)},3e3);return()=>clearTimeout(e)}}),d)?(0,c.jsxs)("div",{className:tS.loadingContainer,children:[(0,c.jsx)("div",{className:tS.loadingHead,children:(0,c.jsx)(tv.N,{animationType:"thinking",loopAnimation:!0})}),(0,c.jsx)("p",{className:tS.loadingText,children:"Preparing your preview\u2026"})]}):(0,c.jsx)(tI,{scripts:i,styles:r,content:e.value,viewscreenUrl:t},e.id)}try{tT.displayName||(tT.displayName="HtmlPreview")}catch{}var tA=n(24880),tE=n(44968),tR=n(63867),tP=n(74022);let tD={markdownPreview:"MarkdownPreview-module__markdownPreview--TTDgv",spinner:"MarkdownPreview-module__spinner--hV_1B",error:"MarkdownPreview-module__error--MpG_1",errorIcon:"MarkdownPreview-module__errorIcon--ZskC4",errorHeader:"MarkdownPreview-module__errorHeader--WHC6c"};function tL({file:e}){let t=function(e,t){let[n,a]=(0,F.useState)(e),i=(0,F.useMemo)(()=>(0,tP.A)(a,2e3),[2e3]);return(0,F.useEffect)(()=>i(e),[i,e]),n}(e.value,2e3),{status:n,data:a}=(0,eL.I)({queryKey:["copilot-immersive","MarkdownPreview",t,e.name],queryFn:async()=>{let n=await (0,A.lS)("/copilot/immersive/markdown",{method:"POST",body:{content:t,filename:e.name}});if(!n.ok)throw Error(`Failed to load rendered markdown (${n.status} on ${n.url})`);return await n.json()},placeholderData:tA.rX,staleTime:1/0});return(0,c.jsx)("div",{className:(0,en.$)("readme html-blob blob",tD.markdownPreview),children:"pending"===n?(0,c.jsx)("div",{className:tD.spinner,children:(0,c.jsx)(tR.A,{srText:"Loading Markdown preview\u2026"})}):"error"===n?(0,c.jsxs)("div",{className:tD.error,children:[(0,c.jsx)("span",{className:tD.errorIcon,children:(0,c.jsx)(j.StopIcon,{size:24})}),(0,c.jsx)("h2",{className:tD.errorHeader,children:"Markdown rendering failed"}),(0,c.jsx)("p",{children:"Refresh the page or check the markdown code"})]}):(0,c.jsx)(tE.mo,{className:"markdown-body",html:a.html})})}try{tL.displayName||(tL.displayName="MarkdownPreview")}catch{}function tM({isPreviewOpening:e,file:t,onClose:n}){let{updateItem:a}=(0,q.xx)(),i=(0,h.Pk)(),r=t.isStreaming?i.messages[i.messages.length-1]:i.messages.find(e=>e.id===t.messageId),{linesOfCode:s,isPreviewable:o,size:l}=(0,F.useMemo)(()=>{let e=new Blob([t.value]).size,n=new Set(["markdown","html"]);return{linesOfCode:t.value.split("\n").length,isPreviewable:n.has(t.language),size:function(e){if(0===e)return"0 bytes";if(1===e)return"1 byte";let t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["bytes","KB","MB","GB","TB"][t]}`}(e)}},[t.language,t.value]);!function(e,t){let{reference:n}=e,a=(0,e9.b)(),{isLoading:i,isError:r,data:s}=(0,eL.I)({queryKey:["copilot-reference-preview","copilot","references",n?.type,n?(0,m.Vb)(n):void 0],queryFn:async()=>{if(!n||"file"!==n.type||e.value)return null;let i=await a.service.hydrateReference(n);return i.ok?(t({...e,value:i.payload.contents,isStreaming:!1}),i.payload):null},staleTime:Number.POSITIVE_INFINITY});(0,F.useEffect)(()=>{s?.contents&&e.value!==s.contents&&t({...e,value:s.contents,isStreaming:!1})},[s?.contents,e,t])}(t,a);let[d,u]=(0,F.useState)("code"),[p,g]=(0,F.useState)(void 0),f=(0,F.useCallback)(e=>{g(e)},[]);return(0,F.useEffect)(()=>{(r?.error?.type==="publicCode"||r?.error?.type==="filtered")&&n()},[r?.error,n]),(0,c.jsxs)("div",{className:tx.container,children:[(0,c.jsxs)("div",{className:tx.toolbar,children:[(0,c.jsxs)("div",{className:tx.toolbarLeft,children:[o&&(0,c.jsxs)(th.I,{"aria-label":"File view",onChange:e=>{let t=0===e?"preview":"code";u(t),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_FILE_VIEW_OPTION",option:t})},children:[(0,c.jsx)(th.I.Button,{selected:"preview"===d,children:"Preview"}),(0,c.jsx)(th.I.Button,{selected:"code"===d,children:"Code"})]}),(0,c.jsx)(ew,{item:t,onVersionSelect:f}),(0,c.jsxs)("p",{className:tx.toolbarLoC,children:[s," ",1===s?"line":"lines"," \xb7 ",l]})]}),(0,c.jsxs)("div",{className:tx.toolbarActions,children:[(0,c.jsx)(tm.T,{textToCopy:t.value,ariaLabel:"Copy code",onCopy:()=>(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_FILE_COPY",mode:"immersive"})}),(0,c.jsx)(M.K,{"aria-label":"Download code",icon:j.DownloadIcon,variant:"invisible",onClick:()=>{let e=(()=>{let e=t.name.lastIndexOf(".");if(e>0){let n=t.name.substring(0,e),a=t.name.substring(e);return void 0!==p?`${n}_${p}${a}`:t.name}return void 0!==p?`${t.name}_${p}`:t.name})();ty(new File([t.value],e)),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_FILE_DOWNLOAD",mode:"immersive"})}})]})]}),o&&"preview"===d?(0,c.jsx)(tF,{file:t}):(0,c.jsx)(tB,{file:t,isPreviewOpening:e})]})}let tO=(0,tg.A)((e,t,n)=>{n({...e,value:t})},500,{leading:!1,trailing:!0});function tB({file:e,isPreviewOpening:t}){let{openItem:n,updateItem:a,versionedItems:i}=(0,q.xx)(),r=(0,F.useRef)(!1),s=function(e,t){let n=e.get((0,eC.oy)(t.id))??[];return n[n.length-1]===t.id}(i,e),o=!e.reference||"thread-scoped-file"===e.reference.type,l=o&&!e.isStreaming&&s,d=(0,F.useId)(),u=function(e){let t=(0,F.useMemo)(()=>(function({language:e,value:t}){let n=/^\t/m.test(t)?"tab":"space";return{indentUnit:function(e,t){if("space"!==t)return 8;{var n;let t=e.match(/^( +)[^*]/im);return void 0!==(n=t?.[1]?.length)&&n>=1&&n<=12?n:2}}(t,n),indentWithTabs:"tab"===n,lineWrapping:function(e){let t=(0,tf.vL)(e);return t?.wrap??!1}(e)}})(e),[e]);return(0,F.useMemo)(()=>({indentUnit:t.indentUnit,indentWithTabs:t.indentWithTabs,lineWrapping:t.lineWrapping}),[t.indentUnit,t.indentWithTabs,t.lineWrapping])}(e),[m,p]=(0,F.useState)(),g=m?.id===e.id?m.value:e.value,{messages:f}=(0,h.Pk)();(0,F.useEffect)(()=>{t&&(r.current=!0)},[t]);let y=t$((0,F.useCallback)(t=>{if(l&&t!==e.value){if(e.isUserEdited)p({value:t,id:e.id}),tO(e,t,a);else{let i={...e,messageId:ts.Wp,id:`file:${e.name}#${f.length}`,timestamp:new Date,isUserEdited:!0,value:t};a(i),n(i.id),p({value:t,id:i.id})}}},[e,l,f.length,n,a]));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("span",{id:d,className:"sr-only",children:[e.name," file contents"]}),(0,c.jsx)(tu.default,{ariaLabelledBy:d,containerClassName:tx.codeMirrorContainer,fileName:e.name,height:"100%",isReadOnly:!l,spacing:u,value:g,onChange:y,focusNextRenderRef:r,placeholder:"Loading...",hideHelp:!0}),o&&!s&&(0,c.jsx)("div",{className:tx.footer,children:"Switch to the latest version to edit this file."})]})}function tF({file:e}){return"markdown"===e.language?(0,c.jsx)("div",{className:tx.previewContainer,children:(0,c.jsx)(tL,{file:e})}):"html"===e.language?(0,c.jsx)("div",{className:tx.previewContainer,children:(0,c.jsx)(tT,{file:e})}):null}let t$=e=>{let t=(0,tp.M)(e);return(0,F.useCallback)((...e)=>t.current?.(...e),[t])};try{tM.displayName||(tM.displayName="FilePreview")}catch{}try{tB.displayName||(tB.displayName="CodeMirrorView")}catch{}try{tF.displayName||(tF.displayName="PreviewComponent")}catch{}let tU={container:"ImagePreview-module__container--AUrb4",imageElement:"ImagePreview-module__imageElement--DNVl1"};function tz({image:e}){return(0,c.jsx)("div",{className:tU.container,children:(0,c.jsx)("img",{className:tU.imageElement,src:e.url,alt:e.altText})})}try{tz.displayName||(tz.displayName="ImagePreview")}catch{}var tV=n(55947),tW=n(3172);let tH={container:"IssuePreview-module__container--XUu9S"},tq=(0,F.memo)(function({isPreviewOpening:e,issue:t,onClose:n}){let[a,i]=(0,F.useState)(e);(0,F.useEffect)(()=>{if(a){let e=setTimeout(()=>i(!1),500);return()=>clearTimeout(e)}},[a]);let r=(0,F.useMemo)(()=>(0,c.jsx)(M.K,{icon:j.LinkExternalIcon,variant:"invisible","aria-label":"Open issue in new tab",onClick:()=>{window.open(t.href,"_blank")}}),[t.href]),s=(0,F.useMemo)(()=>({navigate:eE.l,insideSidePanel:!0,shouldSkipSetDocumentTitle:!0,titleAs:"h2",useViewportQueries:!1,withLiveUpdates:!0,onIssueDelete:n,additionalHeaderActions:r,showRepositoryPill:!0}),[n,r]),o=(0,F.useMemo)(()=>({owner:t.owner,repo:t.repo,number:t.number,type:"Issue"}),[t.number,t.owner,t.repo]);return a?(0,c.jsx)(e_.Q,{optionConfig:s}):(0,c.jsx)("div",{className:tH.container,children:(0,c.jsx)(tW.e,{children:(0,c.jsx)(tV.cI,{itemIdentifier:o,optionConfig:s})})})});try{tq.displayName||(tq.displayName="IssuePreview")}catch{}function tG({isOpening:e,onClose:t,previewItem:n}){let a=null;switch(n.type){case"file":a=(0,c.jsx)(tM,{isPreviewOpening:e,file:n,onClose:t});break;case"issue":a=(0,c.jsx)(tq,{isPreviewOpening:e,issue:n,onClose:t});break;case"new-issue":a=(0,c.jsx)(td,{isPreviewOpening:e,issue:n,onClose:t});break;case"image":a=(0,c.jsx)(tz,{image:n})}return a?(0,c.jsx)(er.t,{fallback:(0,c.jsx)(eg,{regionName:"This workbench item"}),children:a}):null}try{tG.displayName||(tG.displayName="ContentPreviewItem")}catch{}let tK={tabContainer:"ContentPreviewTab-module__tabContainer--TyGLZ",tabContent:"ContentPreviewTab-module__tabContent--zNIXv",isActive:"ContentPreviewTab-module__isActive--xbw0T",mainButton:"ContentPreviewTab-module__mainButton--Y_fZZ",icon:"ContentPreviewTab-module__icon--Ff5yz",title:"ContentPreviewTab-module__title--WZajJ",closeButton:"ContentPreviewTab-module__closeButton--DACs7"};function tQ({file:e}){return e.isStreaming?(0,c.jsx)(tR.A,{size:"small"}):"markdown"===e.language?(0,c.jsx)(j.MarkdownIcon,{}):(0,c.jsx)(j.CodeIcon,{})}function tJ({item:e}){switch(e.type){case"file":return(0,c.jsx)(tQ,{file:e});case"image":return(0,c.jsx)(j.ImageIcon,{});case"issue":return(0,c.jsx)(j.IssueOpenedIcon,{});case"new-issue":return(0,c.jsx)(j.IssueDraftIcon,{});default:return null}}let tZ=(0,F.forwardRef)(function({onClick:e,onClose:t,isActive:n,item:a,controlHintId:i,tabPanelId:r,...s},o){let l=()=>{t&&t(),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_TAB_CLOSE",mode:"immersive"})},d=(0,F.useRef)(null),u=a.name;return(0,c.jsx)("div",{className:tK.tabContainer,children:(0,c.jsxs)("div",{className:(0,en.$)(tK.tabContent,{[tK.isActive]:n}),children:[(0,c.jsxs)("button",{className:tK.mainButton,type:"button",role:"tab","aria-selected":n?"true":void 0,"aria-describedby":i,"aria-controls":r,onClick:t=>{e&&e(t),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_TAB_SELECT",mode:"immersive"})},onKeyDown:e=>{switch(e.key.toLowerCase()){case"delete":case"backspace":l();break;case"tab":if(e.shiftKey)break;e.preventDefault(),d.current?.focus()}},onAuxClick:e=>{1===e.button&&l()},ref:o,...s,children:[(0,c.jsx)("span",{className:tK.icon,children:(0,c.jsx)(tJ,{item:a})}),(0,c.jsx)("span",{className:tK.title,"data-title":u,"data-testid":`content-preview-tab-${a.id}`,children:u})]}),(0,c.jsx)("div",{className:tK.closeButton,children:(0,c.jsx)(M.K,{icon:j.XIcon,size:"small",variant:"invisible","aria-label":`Close ${u}`,"aria-hidden":!0,tabIndex:-1,unsafeDisableTooltip:!0,onClick:l,ref:d})})]})})});try{tQ.displayName||(tQ.displayName="CodeTabIcon")}catch{}try{tJ.displayName||(tJ.displayName="TabIcon")}catch{}try{tZ.displayName||(tZ.displayName="ContentPreviewTab")}catch{}function tX(){return(0,c.jsx)("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",children:(0,c.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M13 .5H3A2.5 2.5 0 0 0 .5 3v10A2.5 2.5 0 0 0 3 15.5h10a2.5 2.5 0 0 0 2.5-2.5V3A2.5 2.5 0 0 0 13 .5M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm6 6.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5M12.25 5a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0M5 12.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})})}try{tX.displayName||(tX.displayName="DiceIcon")}catch{}let tY={container:"EmptyState-module__container--iHvWJ",icon:"EmptyState-module__icon--e1df9",heading:"EmptyState-module__heading--p3oK5",subtitle:"EmptyState-module__subtitle--oksOj"};function t0({isOpening:e}){let t=(0,e9.b)(),n=(0,h.Pk)(),a=(0,ea.zy)(),i=(0,F.useRef)(null),r=t.getSelectedThread(n),s=(0,f.X)(),[o,l]=(0,F.useState)([]);return(0,F.useEffect)(()=>{var e;if(Array.isArray(e=s.icebreakers)&&e.every(e=>"type"in e&&"data"in e)){let e=s.icebreakers.find(e=>"interactional"===e.type);e&&e.data.length>0&&l(e.data)}},[s.icebreakers,a]),(0,F.useEffect)(()=>{e&&i.current&&window.requestAnimationFrame(()=>{i.current?.focus()})},[e]),(0,c.jsxs)("div",{className:tY.container,children:[(0,c.jsx)(j.BrowserIcon,{size:24,className:tY.icon}),(0,c.jsx)("h1",{className:"sr-only",children:"Content preview panel"}),(0,c.jsx)("h2",{className:tY.heading,children:"View files directly within Copilot"}),(0,c.jsx)("p",{className:tY.subtitle,children:"Ask to generate a file or app, or use the button below to try it yourself."}),(0,c.jsx)(e0.Q,{ref:i,leadingVisual:tX,onClick:()=>{if(0===o.length)return;let e=function(e){let t=Math.floor(Math.random()*e.length),n=e[t];if(!n)throw Error("No icebreaker found");return n}(o),a=0===n.messages.length?r:t.getSelectedThread(n),i=n.currentUserLogin,s=e.message;t.sendChatMessage({thread:a,content:s.replaceAll("$$USERNAME$$",i),references:n.currentReferences,topic:n.currentTopic,context:n.context,customInstructions:n.customInstructions,model:n.model}),(0,K.BI)("dotcom_chat.activate",{target:"CONTENT_PREVIEW_EMPTY_STATE_ICEBREAKER_BUTTON",topic:n.currentTopic?.name,mode:"immersive",suggestionId:e.id})},disabled:n.isWaitingOnCopilot,children:"I\u2019m feeling lucky"})]})}try{t0.displayName||(t0.displayName="EmptyState")}catch{}let t1={container:"LoadingState-module__container--a0Cz6"};function t2(){return(0,c.jsx)("div",{className:t1.container,children:(0,c.jsx)(tR.A,{size:"large"})})}try{t2.displayName||(t2.displayName="LoadingState")}catch{}function t5(e,t,n={}){(0,K.BI)(e,{contentPreviewType:t.type,mode:"immersive",path:t.id,...n})}function t3({returnFocusRef:e}){let{items:t,openItems:n,selectedItem:a,openItem:i,closeItem:r,closeAllItems:s,closePreviewPane:o,showLoadingState:l,previewPaneOpen:d}=(0,q.xx)(),u=(0,es.S)(d),m=d&&!u,p=u&&!d,h=n.map(e=>t.get(e)).filter(e=>e?.type==="file"),g=(0,F.useId)(),f=(0,F.useId)(),y=(0,F.useId)(),x=n.map(e=>t.get(e)).filter(e=>!!e);(0,F.useEffect)(()=>{p&&e.current?.focus()},[p,e]);let v=async()=>{let e=h.map(e=>new File([e.value],e.name));ty(new File([await (0,eu._6)(e).blob()],"files.zip"))},_=x.find(e=>e.id===a)??x[0],b=(0,F.useCallback)((e=!1)=>{if(_){let t=e&&1===x.length;r(_.id),t&&(o(),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_CLOSE",mode:"immersive"}))}},[r,o,x.length,_]),C=(0,F.useRef)([]),N=(0,F.useRef)(null);(0,el.G)({containerRef:N,focusableElementFilter:e=>"tab"===e.role,bindKeys:eo.z0.ArrowHorizontal|eo.z0.HomeAndEnd,focusInStrategy:"first",focusOutBehavior:"wrap"},[x]);let w=!(0,ei.g)(N),I=e=>{let t=x[e];if(!t)return;let n=C.current[e+1]??C.current[e-1]??N.current;n?.focus();let a=1===x.length;r(t.id),a&&o(),t5("filePreviewTab.close",t)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:ef.toolbar,children:[(0,c.jsx)("div",{className:(0,en.$)(ef.actions,ef.rightDivider),children:(0,c.jsx)(t4,{})}),(0,c.jsx)("div",{className:ef.tabsContainer,children:(0,c.jsxs)("div",{className:ef.tabs,role:"tablist","aria-label":"Workbench items",ref:N,tabIndex:-1,onWheel:e=>{e.deltaY&&(e.preventDefault(),e.currentTarget.scrollLeft+=e.deltaY)},children:[x.map((e,t)=>(0,c.jsx)(tZ,{id:e.id===a?g:void 0,tabPanelId:e.id===a?f:void 0,controlHintId:y,isActive:e.id===a,onClick:()=>{i(e.id),t5("filePreviewTab.click",e)},onClose:()=>I(t),item:e,ref:e=>{C.current[t]=e}},e.id)),(0,c.jsx)("span",{id:y,"aria-hidden":"true",className:"sr-only",children:"Press Delete to close."}),(0,c.jsx)("span",{})]})}),n.length>0&&(0,c.jsx)("div",{className:(0,en.$)(ef.actions,w&&ef.leftDivider),children:(0,c.jsxs)(ec.W,{children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{icon:j.KebabHorizontalIcon,"aria-label":"More options",variant:"invisible"})}),(0,c.jsx)(ec.W.Overlay,{children:(0,c.jsxs)(ed.l,{children:[h.length>0&&(0,c.jsxs)(ed.l.Item,{onSelect:v,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.FileZipIcon,{})}),"Download all files"]}),(0,c.jsxs)(ed.l.Item,{onSelect:()=>{s(),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_CLOSE_ALL_TABS",mode:"immersive"})},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.XIcon,{})}),"Close all tabs"]})]})})]})})," "]}),(0,c.jsx)("div",{className:ef.content,role:"tabpanel",id:f,"aria-labelledby":g,children:l?(0,c.jsx)(t2,{}):_?(0,c.jsx)(tG,{isOpening:m,previewItem:_,onClose:b}):(0,c.jsx)(t0,{isOpening:m})})]})}function t4(){let{closePreviewPane:e}=(0,q.xx)();return(0,c.jsx)(M.K,{variant:"invisible",icon:j.SidebarCollapseIcon,"aria-label":"Close workbench",onClick:()=>{e(),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_CLOSE",mode:"immersive"})}})}function t6(){return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:ef.toolbar,children:(0,c.jsx)("div",{className:(0,en.$)(ef.actions,ef.rightDivider),children:(0,c.jsx)(t4,{})})}),(0,c.jsx)("div",{className:(0,en.$)(ef.content),children:(0,c.jsx)(eg,{regionName:"The workbench"})})]})}function t7(e){let t=(0,F.useId)();return(0,c.jsxs)("aside",{"aria-labelledby":t,className:ef.container,tabIndex:-1,"data-testid":"content-preview",role:"dialog",children:[(0,c.jsx)("h2",{id:t,className:"sr-only",children:"Workbench"}),(0,c.jsx)(er.t,{fallback:(0,c.jsx)(t6,{}),children:(0,c.jsx)(t3,{...e})})]})}try{t3.displayName||(t3.displayName="ContentPreviewInner")}catch{}try{t4.displayName||(t4.displayName="CloseContentPreviewButton")}catch{}try{t6.displayName||(t6.displayName="ContentPreviewFallback")}catch{}try{t7.displayName||(t7.displayName="ContentPreview")}catch{}function t8(){let e=b.fV.pathname;return(0,F.useMemo)(()=>e.includes("/share/"),[e])}let t9=/\/copilot\/c\/([^/]+)/,ne=/\/copilot\/share\/([^/]+)/;function nt(){let e=b.fV.pathname;return(0,F.useMemo)(()=>{let t=e.match(t9)||e.match(ne);if(!t)return null;let[,n]=t;return n??null},[e])}function nn(e,t){let n=(0,h.Pk)(),{currentReferences:a,context:i}=n,r=(0,e9.b)(),{reloadQuota:s}=(0,X.xR)(),o=r.getSelectedThread(n),{updateItem:l}=(0,q.xx)(),c=t8(),d=nt(),u=(0,te.d)();return(0,F.useCallback)(async m=>{if(s(),""===m.trim())return;for(let e of a){let n=(0,eC.oR)({ref:e,messageIndex:t});null!=n&&l({...n,isUserEdited:!1})}let p={thread:o,content:m,references:a,topic:e.current,context:i,customInstructions:n.customInstructions,model:n.model,customCopilotId:u,skillOptions:n.skillOptions};if(c){let e=await r.continueSharedThread(d);if(e){let{thread:t,messages:n}=e,a=n.at(-1)?.id;await r.sendChatMessage({...p,thread:t,parentMessageId:a})}}else await r.sendChatMessage(p)},[s,o,a,i,n.customInstructions,n.model,n.skillOptions,u,c,r,d,t,l,e])}var na=n(42157),ni=n(4460);function nr(){let e=(0,e9.b)();return(0,F.useCallback)(async t=>{window.location.pathname!==m.Jz&&((0,ni.kd)(m.Jz),e.dispatch({type:"SELECT_PLUGIN",plugin:null}),await e.selectThread(null,t))},[e])}function ns({messageId:e,messageIndex:t,messageTimestamp:n}){let{openPreviewPane:a,openItem:i,updateItem:r}=(0,q.xx)();return(0,F.useCallback)((s,o)=>{let l;switch(o.type){case"file":l=(0,eC.by)(o,e,n);break;case"thread-scoped-file":l=(0,eC.oR)({ref:o,messageIndex:t,messageId:e,timestamp:n});break;case"draft-issue":l=(0,eC.oR)({ref:o,messageIndex:t,messageId:e});break;case"issue":l=(0,eC.SI)(o,e);break;default:return}s.preventDefault(),r(l),i(l.id),a()},[e,t,n,a,i,r])}var no=n(47173);let nl={banner:"ChatInputBanners-module__banner--QlUDL"},nc=p.W.premiumRequestQuotasEnabled?m.mF:10;function nd({onDismiss:e,className:t}){let{isLicensedLimited:n,canUpgradePlan:a,canPurchaseAdditionalQuota:i,premiumInteractionsQuotaExceeded:r,resetDate:s}=(0,X.xR)(),o=n?`You have used ${100-nc}% of your free requests this month.`:r?`You have used all premium requests available this month. You will be charged per additional premium request until the limit resets on ${s}.`:`You have used ${100-nc}% of your premium responses this month. ${a?"Upgrade to increase your limit.":"Enable additional requests to get more usage after the limit is reached."}`,l=a&&!r?(0,c.jsx)(Q.z,{as:"a",href:m.Zs,onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"immersive"})},children:"Upgrade"}):i&&!r?(0,c.jsx)(Q.z,{as:"a",href:m.pF,onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_OVERAGES",mode:"immersive"})},children:"Enable additional requests"}):(0,c.jsx)(Q.z,{as:"a",href:m.MB,onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_MANAGE_BILLING",mode:"immersive"})},children:"Manage billing"}),d=a&&i&&!r?(0,c.jsx)(em.A,{as:"a",href:m.Zs,onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"immersive"})},children:"Enable additional requests"}):null;return(0,c.jsx)("div",{className:t,children:(0,c.jsx)(B.l,{variant:"info",title:"Limit reached soon",description:o,hideTitle:!0,primaryAction:l,secondaryAction:d,onDismiss:()=>{e(),(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_DISMISS",mode:"immersive"})}})})}try{nd.displayName||(nd.displayName="QuotaMeterBanner")}catch{}function nu(){let{ambientError:e}=(0,h.Pk)(),t=function(){let{isLicensedLimited:e,chatQuotaRemaining:t,premiumChatQuotaRemaining:n,premiumInteractionsQuotaExceeded:a,overagesEnabled:i}=(0,X.xR)(),[r,s]=(0,F.useState)(()=>Y.J.getMeterBannerFlag()??!1);return(0,F.useEffect)(()=>{if((e||p.W.premiumRequestQuotasEnabled)&&void 0!==t){let r=Y.J.getMeterBannerFlag();t>0&&t<=nc||!e&&n>0&&n<=nc||!e&&a&&i?null===r?(Y.J.setMeterBannerFlag(!0),s(!0)):s(r):(Y.J.removeMeterBannerFlag(),s(!1))}},[e,t,n,i,a]),{visible:r&&void 0!==t&&(e||p.W.premiumRequestQuotasEnabled),onDismiss:()=>{Y.J.setMeterBannerFlag(!1),s(!1)}}}();return(0,c.jsxs)(c.Fragment,{children:[e&&(0,c.jsx)(no.P,{ambientError:e,useLargerBorderRadius:!0}),t.visible&&(0,c.jsx)(nd,{className:nl.banner,onDismiss:t.onDismiss})]})}try{nu.displayName||(nu.displayName="ChatInputBanners")}catch{}let nm={container:"Layout-module__container--ON_wj",left:"Layout-module__left--LHTG3",main:"Layout-module__main--JKQM5",content:"Layout-module__content--s7QoY",footer:"Layout-module__footer--raJHn",chatInputContainer:"Layout-module__chatInputContainer--DXrKy",previewPane:"Layout-module__previewPane--vF1ZO",active:"Layout-module__active--nDCtU",viewer:"Layout-module__viewer--M_UyD",fullscreenPreviewPane:"Layout-module__fullscreenPreviewPane--i4oKD",fullscreenPluginPane:"Layout-module__fullscreenPluginPane--nfB0s"},np={container:"QuotaExceededBanner-module__container--BbiER"};function nh(){let{isLicensedLimited:e,canUpgradePlan:t,canPurchaseAdditionalQuota:n,resetDate:a}=(0,X.xR)(),i=e?`You have reached your free plan limit. Limit resets on ${a}.`:`You have reached your monthly limit for premium requests. ${t?`Select an upgrade option or switch to the default model. Limit resets on ${a}.`:`Enable additional requests or switch to the default model. Limit resets on ${a}.`}`,r=t?(0,c.jsx)(Q.z,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"immersive"})},children:"Upgrade"}):n?(0,c.jsx)(Q.z,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"immersive"})},children:"Enable additional requests"}):null,s=t&&n?(0,c.jsx)(em.A,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"immersive"})},children:"Enable additional requests"}):null;return(0,c.jsx)("div",{className:np.container,children:(0,c.jsx)(B.l,{variant:"upsell",title:"Limit reached",description:i,hideTitle:!0,primaryAction:r,secondaryAction:s})})}try{nh.displayName||(nh.displayName="QuotaExceededBanner")}catch{}function ng({textAreaRef:e,handleUserSubmit:t,nextMessageIndex:n}){let a=(0,h.Pk)(),{chatQuotaExceeded:i,premiumInteractionsQuotaExceeded:r,overagesEnabled:s}=(0,X.xR)(),o=nr(),l=function(){let{figmaAuthUrl:e}=(0,f.X)();if(!e)return;let t=new URL(e,location.origin);return t.searchParams.set("return_url",location.pathname+location.search),t.toString()}(),d=ns({messageIndex:n}),{versionedItems:u,items:m}=(0,q.xx)(),g=(0,F.useMemo)(()=>{let e=new Set;for(let[,t]of m)"file"===t.type&&e.add(t.name);return e},[m]),y=!!a.model?.billing?.is_premium,x=!i&&(!p.W.premiumRequestQuotasEnabled||s||!r||!y);return(0,c.jsx)("div",{className:nm.chatInputContainer,children:x?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(nu,{}),(0,c.jsx)(na.V,{showModelPicker:!0,onNewThreadSelected:o,textAreaRef:e,onSubmit:t,isStreaming:!!a.streamingMessage,size:"large",onClickReference:d,getReferenceVersion:e=>(0,eC.wt)(e,n,u),existingFileNames:g,figmaAuthUrl:l})]}):(0,c.jsx)(nh,{})})}try{ng.displayName||(ng.displayName="ChatInputContainer")}catch{}var nf=n(39046),ny=n(5271),nx=n(48186);let nv=(0,F.createContext)(void 0);function n_({children:e,model:t,state:n,manager:a}){let[i,r]=(0,F.useState)(!1),s=(0,F.useCallback)(async(e,i)=>{if(!e)return;let[r,s]=nf.s.getAllowedFiles([...e],t);if(r.length>0&&new nf.s(n,a).addImageAttachments(r,i),p.W.pasteTextFiles&&s.length>0){let e=[],t=new nx.E(a);await Promise.allSettled(s.map(async n=>{await nx.E.isAttachable(n)?await t.addAttachment(n):e.push(n.type)})),e.length>0&&(0,ny.d)("included_unsupported_file",{fileTypes:e.join(","),uploadType:i})}},[t,n,a]);(0,F.useEffect)(()=>{if(t.capabilities.supports.vision){let e=e=>{e.preventDefault(),r(!1),s(e.dataTransfer?.files||null,"drag")},t=e=>{e.preventDefault()},n=()=>r(!0),a=()=>r(!1);return window.addEventListener("dragover",t),window.addEventListener("drop",e),window.addEventListener("dragenter",n),window.addEventListener("dragleave",a),()=>{window.removeEventListener("dragover",t),window.removeEventListener("drop",e),window.removeEventListener("dragenter",n),window.removeEventListener("dragleave",a)}}},[s,t.capabilities.supports.vision]);let o=(0,F.useMemo)(()=>({isDragging:i}),[i]);return(0,c.jsx)(nv.Provider,{value:o,children:e})}try{nv.displayName||(nv.displayName="DragDropContext")}catch{}try{n_.displayName||(n_.displayName="DragDropProvider")}catch{}var nb=n(14987),nj=n(25408),nC=n(57393),nN=n(2640),nw=n(57516),nI=n(47139),nS=n(40961),nk=n(32837),nT=n(53526),nA=n(73451),nE=n(9591);let nR={hideOnDesktop:"ConversationActions-module__hideOnDesktop--zHNNV"};var nP=n(37404),nD=n(76797),nL=n(52464);let nM={container:"ConversationSharingDialog-module__container--AYIbb",innerContainer:"ConversationSharingDialog-module__innerContainer--aF_PO",sharedLinkContainer:"ConversationSharingDialog-module__sharedLinkContainer--ccuni",textInputContainer:"ConversationSharingDialog-module__textInputContainer--IoJB6",textInput:"ConversationSharingDialog-module__textInput--hqfoz",success:"ConversationSharingDialog-module__success--IlwFA",spinner:"ConversationSharingDialog-module__spinner--yV4lB",successIcon:"ConversationSharingDialog-module__successIcon--tw4y6",mutedText:"ConversationSharingDialog-module__mutedText--VVQZ_",warningText:"ConversationSharingDialog-module__warningText--Pp3s_",snapshotText:"ConversationSharingDialog-module__snapshotText--Rrl0m",buttonStack:"ConversationSharingDialog-module__buttonStack--uAtQJ",lockIcon:"ConversationSharingDialog-module__lockIcon--zZ_aM",cancelButton:"ConversationSharingDialog-module__cancelButton--TjQ9X",quickFadeUp:"ConversationSharingDialog-module__quickFadeUp--FrM1T"},nO=({closeDialog:e,threadId:t})=>{let n=(0,h.Pk)(),a=(0,e9.b)(),[i,r]=(0,F.useState)(!1),[s,o]=(0,F.useState)(!1),[l,d]=(0,F.useState)(!1),[u,m]=(0,F.useState)(!1),{selectedThreadID:g,ssoOrganizations:f,apiUrl:y,threads:x}=n,v=x.get(t||g),[_,C]=(0,F.useState)(()=>v?.sharedID||""),[N,w]=(0,F.useState)(()=>v?.sharedMessageID?v.sharedMessageID:""),I=b.fV.origin,S=`${I}/copilot/share/${_}`;(0,F.useEffect)(()=>{if(i){let e=setTimeout(()=>r(!1),1500);return()=>clearTimeout(e)}},[i]),(0,F.useEffect)(()=>{if(l){let e=setTimeout(()=>d(!1),1500);return()=>clearTimeout(e)}},[l]);let k=(0,F.useCallback)(async()=>{try{await (0,nD.D)(S),r(!0),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_COPY_SHARED_CONVERSATION_LINK",mode:"immersive"})}catch{}},[S]);(0,F.useEffect)(()=>{(t||g)&&C(v?.sharedID||"")},[v?.sharedID,g,t]);let T=(0,F.useCallback)(async()=>{o(!0);let e=t||g,n=new nP.k(y,f),i=await n.shareThread(e,p.W.copilotShareActiveSubthread&&e===g?a.FindLastMessageID():"");if(i.ok){o(!1);let{sharedAt:t,sharedID:n,sharedMessageID:r}=i.payload;C(n),d(!0),w(r),a.dispatch({type:"SHARED_THREAD_UPDATED",thread:{id:e,sharedID:n,sharedAt:t,sharedMessageID:r}}),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_CREATE_SHARED_CONVERSATION",mode:"immersive",originalThreadId:e,sharedThreadId:n})}else o(!1)},[y,a,g,f,t]),A=(0,F.useCallback)(async()=>{if(!u){m(!0);return}m(!1),o(!0);let e=t||g,n=new nP.k(y,f),i=await n.unshareThread(e);if(i.ok){o(!1),w("");let{sharedID:t,sharedAt:n,sharedMessageID:r}=i.payload;a.dispatch({type:"SHARED_THREAD_UPDATED",thread:{id:e,sharedID:t,sharedAt:n,sharedMessageID:r}}),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_UNSHARE_CONVERSATION",mode:"immersive",originalThreadId:e,sharedThreadId:_})}else o(!1)},[y,a,g,u,f,t,_]);return(0,c.jsx)(ek.l,{title:_?"Conversation shared":"Share conversation",onClose:e,width:"large",children:(0,c.jsxs)("div",{className:nM.container,children:[(0,c.jsxs)(O.B,{direction:"vertical",gap:"condensed",children:[(0,c.jsx)(O.B,{direction:"horizontal",padding:"none",align:"center",justify:"start",gap:"condensed",children:N?(0,c.jsxs)("span",{children:[(0,c.jsx)("span",{className:nM.snapshotText,children:"This shared conversation is a snapshot"}),", accessible to anyone with the link. It will not update with new messages."]}):_?(0,c.jsx)("span",{children:"This conversation and future messages are visible to anyone with the link. If private repository content is included, repository access is required to view."}):(0,c.jsx)("span",{children:"When shared, this conversation and future messages will be visible to anyone with the link. If private repository content is included, repository access is required to view."})}),(0,c.jsx)("div",{className:nM.innerContainer,children:(0,c.jsx)("div",{className:nM.sharedLinkContainer,children:(0,c.jsx)("div",{className:nM.textInputContainer,children:(0,c.jsx)(nE.A,{"aria-label":"Shared link",size:"large",readOnly:!0,value:_&&S,placeholder:_?void 0:"https://github.com/copilot/share/\u2026",className:nM.textInput,trailingAction:_?(0,c.jsx)(nE.A.Action,{onClick:()=>void k(),icon:j.CopyIcon,"aria-label":"Copy link"}):void 0})})})})]}),(0,c.jsxs)(O.B,{direction:"horizontal",gap:"condensed",align:"center",justify:"space-between",className:nM.buttonStack,children:[s?(0,c.jsxs)("div",{className:nM.quickFadeUp,children:[(0,c.jsx)(tR.A,{size:"small",className:nM.spinner}),_?"Unsharing conversation...":"Sharing conversation..."]}):u?(0,c.jsxs)("div",{className:nM.quickFadeUp,children:[(0,c.jsx)(nL.A,{size:"medium",className:nM.warningText,children:"Confirm unsharing this conversation?"}),(0,c.jsx)(e0.Q,{variant:"default",onClick:()=>m(!1),className:nM.cancelButton,children:"Cancel"})]}):i?(0,c.jsxs)("div",{className:nM.quickFadeUp,children:[(0,c.jsx)(j.CheckIcon,{className:nM.successIcon}),(0,c.jsx)(nL.A,{size:"medium",className:nM.success,children:"Copied to clipboard"})]}):l?(0,c.jsxs)("div",{className:nM.quickFadeUp,children:[(0,c.jsx)(j.CheckIcon,{className:nM.successIcon}),(0,c.jsx)(nL.A,{size:"medium",className:nM.success,children:"Conversation shared"})]}):_?(0,c.jsxs)("div",{children:[(0,c.jsx)(j.UnlockIcon,{className:nM.lockIcon}),(0,c.jsx)(nL.A,{size:"medium",className:nM.mutedText,children:"Visible to anyone with the link"})]}):(0,c.jsx)("div",{}),(()=>{if(!_)return(0,c.jsx)(e0.Q,{variant:"primary",disabled:s,onClick:T,children:"Share"})})(),(()=>{if(_)return(0,c.jsx)(e0.Q,{variant:"danger",disabled:s,onClick:A,children:"Unshare"})})()]})]})})};try{nO.displayName||(nO.displayName="ConversationSharingDialog")}catch{}function nB({onOpenDialog:e,showShare:t=!0,hideShareOnDesktop:n=!1,isShared:a=!1}){let{canShareThread:i}=(0,f.X)(),{isWaitingOnCopilot:r,messages:s}=(0,h.Pk)(),o=(0,m.Q7)(s).length>0||r;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ed.l.Item,{onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_CONTEXT_MENU_RENAME",mode:"immersive"}),e("rename")},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PencilIcon,{})}),"Rename"]}),t&&i&&(0,c.jsxs)(ed.l.Item,{className:n?nR.hideOnDesktop:void 0,disabled:o,onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_CONTEXT_MENU_SHARE",mode:"immersive"}),e("share")},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:a?(0,c.jsx)(j.UnlockIcon,{}):(0,c.jsx)(j.LockIcon,{})}),"Share"]}),(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_CONTEXT_MENU_DELETE",mode:"immersive"}),e("delete")},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.TrashIcon,{})}),"Delete"]})]})}function nF({visibleDialog:e,onClose:t,threadName:n,threadId:a,selectedThreadId:i,onStartLoading:r,onFinishLoading:s}){let{threads:o}=(0,h.Pk)(),l=(0,e9.b)(),d=nr(),u=(0,F.useCallback)(async()=>{t(),(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_LIST_ACTION_DELETE",mode:"immersive"}),r();let e=o.get(a);e&&(a===i&&await d({clearTopic:!0,includeThreads:!1}),await l.deleteThread(e)),s()},[o,a,i,d,l,s,r,t]),m=(0,F.useCallback)(async e=>{t(),(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_LIST_ACTION_RENAME",mode:"immersive"}),r();let n=o.get(a);n&&await l.renameThread(n,e),s()},[o,a,l,r,s,t]);return(0,c.jsx)(c.Fragment,{children:"delete"===e?(0,c.jsx)(n$,{onCancel:t,onConfirm:u}):"rename"===e?(0,c.jsx)(nU,{currentName:n,onCancel:t,onSubmit:m}):"share"===e?(0,c.jsx)(nO,{closeDialog:()=>{t(),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SHARE_DIALOG_CLOSE",mode:"immersive"})},threadId:a}):null})}let n$=({onConfirm:e,onCancel:t})=>(0,c.jsx)(nT.K,{title:"Delete conversation",onClose:n=>{"confirm"===n?((0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_DIALOG_DELETE_CONFIRM",mode:"immersive"}),e()):((0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_DIALOG_DELETE_CANCEL",mode:"immersive"}),t())},confirmButtonContent:"Delete",confirmButtonType:"danger",children:"Are you sure you want to delete this conversation? This action cannot be undone."}),nU=({currentName:e,onCancel:t,onSubmit:n})=>{let[a,i]=(0,F.useState)(void 0),r=(0,F.useRef)(null),s=(0,F.useId)(),o=(0,F.useId)(),l=()=>{(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_DIALOG_RENAME_CANCEL",mode:"immersive"}),t()};return(0,c.jsx)(ek.l,{title:(0,c.jsx)("span",{id:o,children:"Rename conversation"}),onClose:l,width:"small",footerButtons:[{content:"Cancel",onClick:l},{content:"Update",buttonType:"primary",type:"submit",form:s,onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_DIALOG_RENAME_CONFIRM",mode:"immersive"})}],initialFocusRef:r,children:(0,c.jsx)("form",{id:s,onSubmit:e=>{e.preventDefault();let t=r.current?.value?.trim()??"";t?t.length>100?i("max_length"):n(t):i("required")},children:(0,c.jsxs)(nA.A,{required:!0,children:[(0,c.jsx)(nA.A.Label,{visuallyHidden:!0,children:"Rename conversation"}),(0,c.jsx)(nE.A,{"aria-labelledby":o,ref:r,defaultValue:e,maxLength:100,block:!0}),"required"===a&&(0,c.jsx)(nA.A.Validation,{variant:"error",children:"Enter a name"}),"max_length"===a&&(0,c.jsx)(nA.A.Validation,{variant:"error",children:"Name cannot exceed 100 characters"})]})})})};try{nB.displayName||(nB.displayName="ConversationActions")}catch{}try{nF.displayName||(nF.displayName="ConversationActionDialogs")}catch{}try{n$.displayName||(n$.displayName="DeleteDialog")}catch{}try{nU.displayName||(nU.displayName="RenameDialog")}catch{}var nz=n(91321),nV=n(42522);let nW={shareButton:"ManageSharedConversationButton-module__shareButton--A4cNu",menuButton:"ManageSharedConversationButton-module__menuButton--BAXN7",successState:"ManageSharedConversationButton-module__successState--o6D7d",hideOnMobile:"ManageSharedConversationButton-module__hideOnMobile--HzeSN"},nH={container:"UnshareConversationDialog-module__container--vV3vj",buttonStack:"UnshareConversationDialog-module__buttonStack--IQJqH",threadInfoStack:"UnshareConversationDialog-module__threadInfoStack--iNgZ2",threadTitle:"UnshareConversationDialog-module__threadTitle--aYFcp",threadDescription:"UnshareConversationDialog-module__threadDescription--Cpoli"},nq=({closeDialog:e,threadId:t})=>{let n=(0,h.Pk)(),a=(0,e9.b)(),{selectedThreadID:i,ssoOrganizations:r,apiUrl:s,threads:o}=n,[l,d]=(0,F.useState)(n.messages),[u,m]=(0,F.useState)(()=>{let e=o.get(t);return e?.sharedID||""}),p=(0,F.useRef)(""!==u);(0,F.useEffect)(()=>{let e=async()=>{if(0===l.filter(e=>e.threadID===t).length){let e=new nP.k(n.apiUrl,n.ssoOrganizations),t=await e.listSharedThreadMessages(u);t.ok&&d(t.payload.messages)}};u&&e()},[u,t]);let g=o.get(t||i),f=l[l.length-1],y=f?.content||"";(0,F.useEffect)(()=>{let e=t||i;if(e){let t=o.get(e);m(t?.sharedID||"")}},[a,m,i,o,t]);let x=(0,F.useCallback)(async()=>{let n=t||i,o=new nP.k(s,r),l=await o.unshareThread(n);if(l.ok){let{sharedID:t,sharedAt:i,sharedMessageID:r}=l.payload;a.dispatch({type:"SHARED_THREAD_UPDATED",thread:{id:n,sharedID:t,sharedAt:i,sharedMessageID:r}}),p.current=!1,e(),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_UNSHARE_CONVERSATION",mode:"immersive",originalThreadId:n,sharedThreadId:u})}},[s,e,a,i,r,u,t]),v=(0,F.useCallback)(()=>{e()},[e]);return(0,c.jsx)(ek.l,{title:"Unshare conversation",onClose:v,width:"large",children:(0,c.jsxs)("div",{className:nH.container,children:[(0,c.jsx)("span",{children:"You're about to unshare the link for the following conversation:"}),(0,c.jsxs)(O.B,{direction:"vertical",className:nH.threadInfoStack,"aria-label":"Thread information",children:[(0,c.jsx)("span",{className:nH.threadTitle,children:g?.name||""}),(0,c.jsx)("span",{className:nH.threadDescription,children:y})]}),(0,c.jsx)("span",{children:"Once unshared, the link will no longer be accessible."}),(0,c.jsxs)(O.B,{direction:"horizontal",gap:"condensed",align:"end",justify:"end",className:nH.buttonStack,children:[(0,c.jsx)(e0.Q,{onClick:e,children:"Cancel"}),(()=>{if(u)return(0,c.jsx)(e0.Q,{onClick:x,variant:"danger",children:"Unshare"})})()]})]})})};try{nq.displayName||(nq.displayName="UnshareConversationDialog")}catch{}let nG=({openDialog:e})=>{let{selectedThreadID:t,threads:n}=(0,h.Pk)(),[a,i]=(0,F.useState)(!1),[r,s]=(0,F.useState)(!1),[o,l]=(0,F.useState)(!1),[d,u]=(0,F.useState)("Copy link"),p=n.get(t)?.sharedID,g=`${b.fV.origin}/copilot/share/${p||"\u2026"}`,{messages:f}=(0,h.Pk)(),y=(0,m.Q7)(f).length>0,x=(0,F.useCallback)(async e=>{"preventDefault"in e&&(e.preventDefault(),e.stopPropagation());try{await (0,nD.D)(g),s(!0),u("Copied!"),setTimeout(()=>{s(!1),u("Copy link")},2e3),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_COPY_SHARED_CONVERSATION_LINK",mode:"immersive",originalThreadId:t,sharedThreadId:p})}catch{}},[g,t,p]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(nz.A,{"data-testid":"manage-shared-conversations",className:`${nW.shareButton} ${nW.hideOnMobile}`,children:[(0,c.jsx)(nV.m,{text:y?"Disabled for Copilot extensions":"Anyone with the link can view this conversation",direction:"n",type:"label",children:(0,c.jsx)(e0.Q,{leadingVisual:j.UnlockIcon,onClick:()=>{y||e()},inactive:y,children:"Share"})}),(0,c.jsxs)(ec.W,{open:o,onOpenChange:l,children:[(0,c.jsx)(ec.W.Button,{"aria-label":"Additional share options",icon:j.TriangleDownIcon,className:nW.menuButton}),(0,c.jsx)(ec.W.Overlay,{width:"small",children:(0,c.jsx)(ed.l,{children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ed.l.Item,{onSelect:x,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:r?(0,c.jsx)(j.CheckIcon,{className:nW.successState}):(0,c.jsx)(j.CopyIcon,{})}),(0,c.jsx)("span",{className:r?nW.successState:void 0,children:d})]},"copy-link"),(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:()=>{i(!0),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_UNSHARE_DIALOG_OPEN",mode:"immersive"})},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.UnlinkIcon,{})}),"Unshare"]},"Unshare-link")]})})})]})]}),a&&(0,c.jsx)(nq,{threadId:t,closeDialog:()=>{i(!1),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_UNSHARE_DIALOG_CLOSE",mode:"immersive"})}})]})};try{nG.displayName||(nG.displayName="ManageSharedConversationButton")}catch{}let nK={shareButton:"ShareConversationButton-module__shareButton--_CML9",hideOnMobile:"ShareConversationButton-module__hideOnMobile--AYVjz"},nQ=({openDialog:e})=>{let{messages:t}=(0,h.Pk)(),n=(0,m.Q7)(t).length>0;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(nV.m,{text:n?"Disabled for Copilot extensions":"This conversation has not yet been shared",direction:"n",type:"label",children:(0,c.jsx)(e0.Q,{leadingVisual:j.LockIcon,inactive:n,onClick:()=>{n||e()},className:`${nK.shareButton} ${nK.hideOnMobile}`,children:"Share"})})})};try{nQ.displayName||(nQ.displayName="ShareConversationButton")}catch{}let nJ=()=>{let{selectedThreadID:e,threads:t}=(0,h.Pk)(),n=!!(e&&t.get(e)?.sharedID),[a,i]=(0,F.useState)(!1),r=()=>{i(!0),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SHARE_DIALOG_OPEN",mode:"immersive"})};return(0,c.jsxs)(c.Fragment,{children:[n?(0,c.jsx)(nG,{openDialog:r}):(0,c.jsx)(nQ,{openDialog:r}),a&&(0,c.jsx)(nO,{closeDialog:()=>{i(!1),(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SHARE_DIALOG_CLOSE",mode:"immersive"})}})]})};try{nJ.displayName||(nJ.displayName="ConversationSharingButton")}catch{}let nZ={header:"Header-module__header--ufLgW",rightControls:"Header-module__rightControls--Ce65x",editedPromptIndicator:"Header-module__editedPromptIndicator--k1vcE",leadingVisual:"Header-module__leadingVisual--O6MuP"};var nX=n(8386),nY=n(56221);let n0={dialog:"ManageSharedConversationsDialog-module__dialog--kEiyu",actionButtons:"ManageSharedConversationsDialog-module__actionButtons--JL7Md",alertIcon:"ManageSharedConversationsDialog-module__alertIcon--vcDiF",footer:"ManageSharedConversationsDialog-module__footer--qEM5d",mutedText:"ManageSharedConversationsDialog-module__mutedText--ZU5NV",footerContent:"ManageSharedConversationsDialog-module__footerContent--x0AC3",footerLeft:"ManageSharedConversationsDialog-module__footerLeft--hfY2Z",footerRight:"ManageSharedConversationsDialog-module__footerRight--bhyxU",confirmationText:"ManageSharedConversationsDialog-module__confirmationText--h4QXT",quickFadeUp:"ManageSharedConversationsDialog-module__quickFadeUp--L_rid",conversationLink:"ManageSharedConversationsDialog-module__conversationLink--kiSX1"},n1=e=>{let t=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}).format(t)},n2=({closeDialog:e})=>{let t=(0,e9.b)(),n=(0,h.Pk)(),[a,i]=(0,F.useState)(0),[r,s]=(0,F.useState)([]),[o,l]=(0,F.useState)(!0),[d,u]=(0,F.useState)(!1),[m,p]=(0,F.useState)(null),[g,f]=(0,F.useState)(!1),[y,x]=(0,F.useState)(5>r.length),v=5*a,_=r.slice(v,v+5);(0,F.useEffect)(()=>{(async()=>{let e=await t.fetchSharedThreads();e&&s(e.map(e=>({id:e.id,conversation:e.name||"New conversation",lastUpdated:n1(e.updatedAt),sharedUrl:`${b.fV.origin}/copilot/share/${e.sharedID}`,threadUrl:`${b.fV.origin}/copilot/c/${e.id}`}))),l(!1)})()},[t]),(0,F.useEffect)(()=>{y&&a>0&&r.length<=5*a&&i(0),x(5<r.length)},[r,a,5]);let C=(0,F.useCallback)(()=>{e()},[e]),N=(0,F.useCallback)(async()=>{if(!g){f(!0);return}f(!1),l(!0);try{(await t.unshareAllThreads()).ok&&(s([]),await t.fetchThreads())}finally{l(!1)}},[g,t]),w=e=>{p(e),u(!0)},I=async()=>{u(!1),p(null),l(!0);let e=await t.fetchSharedThreads();e&&s(e.map(e=>({id:e.id,conversation:e.name||"New conversation",lastUpdated:n1(e.updatedAt),sharedUrl:`${b.fV.origin}/copilot/share/${e.sharedID}`,threadUrl:`${b.fV.origin}/copilot/c/${e.id}`}))),l(!1)},S=o||"error"===n.sharedThreadsLoading.state||0===r.length,k=(0,F.useMemo)(()=>{if(!r.length)return[];let e={buttonType:"danger",content:"Unshare all",onClick:()=>{g?N():f(!0)}};return g?[{buttonType:"default",content:"Cancel",onClick:()=>f(!1)},e]:[e]},[r.length,g,N]),T=e=>1===e?"Are you sure you want to unshare this conversation?":`Are you sure you want to unshare all ${e} conversations?`,A=(0,F.useMemo)(()=>o?{result:"loading",heading:"Loading shared conversations",description:"Your shared conversations will appear here.",isSpinner:!0}:"error"===n.sharedThreadsLoading.state?{result:"error",heading:"We couldn't load the shared conversations",description:"Try again or, if the problem persists, contact support."}:{result:"empty",heading:"No shared conversations",description:"Your shared conversations will appear here."},[o,n.sharedThreadsLoading.state]);return(0,c.jsxs)(ek.l,{title:"Manage shared conversations",width:"xlarge",className:n0.dialog,position:{narrow:"fullscreen",regular:"center"},onClose:C,renderFooter:()=>k?.length?(0,c.jsx)(ek.l.Footer,{className:n0.footer,children:(0,c.jsxs)("div",{className:n0.footerContent,children:[(0,c.jsx)("div",{className:n0.footerLeft,children:g&&(0,c.jsx)("div",{className:`${n0.confirmationText} ${n0.quickFadeUp}`,children:T(r.length)})}),(0,c.jsx)("div",{className:n0.footerRight,children:(0,c.jsx)(ek.l.Buttons,{buttons:k})})]})}):null,children:[S?(0,c.jsxs)(ep.E,{children:[(0,c.jsx)(ep.E.Visual,{children:A.isSpinner?(0,c.jsx)(O.B,{direction:"horizontal",align:"center",children:(0,c.jsx)(tR.A,{size:"medium",srText:"Loading shared conversations\u2026"})}):(0,c.jsx)("div",{className:n0.mutedText,children:"error"===A.result?(0,c.jsx)(j.AlertIcon,{size:"medium",className:n0.alertIcon,"aria-label":"Error loading shared conversations"}):(0,c.jsx)(j.LinkIcon,{size:"medium","aria-label":"No shared conversations"})})}),(0,c.jsx)(ep.E.Heading,{children:A.heading}),(0,c.jsx)(ep.E.Description,{children:A.description})]}):(0,c.jsxs)(nX.X.Container,{children:[(0,c.jsx)(nY.b,{"aria-labelledby":"manage-shared-conversations",cellPadding:"normal",columns:[{header:"Conversation",field:"conversation",width:"growCollapse",minWidth:"60%",rowHeader:!0,renderCell:e=>(0,c.jsx)(em.A,{href:e.threadUrl,className:n0.conversationLink,children:e.conversation})},{header:"Last updated",field:"lastUpdated",width:"growCollapse",renderCell:e=>(0,c.jsx)("span",{className:n0.mutedText,children:e.lastUpdated})},{id:"actions",width:"growCollapse",align:"end",header:()=>(0,c.jsx)("div",{className:"sr-only",children:"Actions"}),renderCell:e=>(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:n0.actionButtons,children:[(0,c.jsx)(tm.T,{textToCopy:e.sharedUrl,onCopy:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_COPY_SHARED_CONVERSATION_LINK",mode:"immersive"})},ariaLabel:"Copy share link"}),(0,c.jsx)(M.K,{"aria-label":"Unshare conversation",title:"Unshare conversation",icon:j.UnlinkIcon,variant:"invisible",onClick:()=>w(e)})]})})}],data:_}),r.length>5&&(0,c.jsx)(nX.X.Pagination,{"aria-label":"Shared conversations pagination",pageSize:5,defaultPageIndex:a,totalCount:r.length,onChange:e=>{i(e.pageIndex)},showPages:!1})]}),d&&m&&(0,c.jsx)(nq,{threadId:m.id,closeDialog:I})]})};try{n2.displayName||(n2.displayName="ManageSharedConversationsDialog")}catch{}var n5=n(67416);let n3=()=>{let e=(0,h.Pk)(),t=(0,te.d)(),n=(0,ee.JB)(e.customCopilots,t),a=(0,ee.hH)()||n,i=!(0,ee.k1)()&&n;return{updateGlobalNavigationBreadcrumbs:()=>{let e=[{label:"Copilot",href:"/copilot"}];a&&e.push({label:"Spaces",href:m.VR}),i&&n&&e.push({label:n.name,href:(0,ee.Cb)(n)}),(0,n5.FC)(e)}}},n4={dialog:"SystemPromptDialog-module__dialog--DZtq2",content:"SystemPromptDialog-module__content--OeMCM",description:"SystemPromptDialog-module__description--eb7_P",textareaContainer:"SystemPromptDialog-module__textareaContainer--MN8c4",textarea:"SystemPromptDialog-module__textarea--MK1JE"},n6=(0,F.forwardRef)(function(e,t){let n=(0,e9.b)(),[a,i]=(0,F.useState)(!1),[r,s]=(0,F.useState)(void 0);return(0,F.useImperativeHandle)(t,()=>({openDialog:()=>i(!0)})),(0,F.useEffect)(()=>{(async()=>{s(await n.getSystemPrompt())})()},[n]),(0,c.jsx)(c.Fragment,{children:a&&(0,c.jsx)(ek.l,{onClose:()=>{i(!1),(0,K.BI)("dotcom_chat.activate",{target:"SYSTEM_PROMPT_DIALOG_CLOSE",mode:"immersive"})},title:"System prompt",renderBody:()=>(0,c.jsxs)("div",{className:n4.content,children:[(0,c.jsxs)("p",{className:n4.description,children:["The system prompt for"," ",(0,c.jsx)(em.A,{muted:!0,inline:!0,href:"https://github.com/copilot",children:"GitHub Copilot"})," ","is a set of instructions that guides the LLM to provide enhanced functionality and output quality based on user input."]}),(0,c.jsx)("div",{className:n4.textareaContainer,children:(0,c.jsx)("textarea",{className:n4.textarea,readOnly:!0,children:r})})]}),className:n4.dialog})})});try{n6.displayName||(n6.displayName="SystemPromptDialog")}catch{}function n7({showPreviewPaneButton:e=!0,conversationSpecificItems:t,customButtons:n}){let a=(0,e9.b)(),i=(0,h.Pk)(),{currentTopic:r,repoCustomInstructionsEnabled:s,selectedThreadID:o,threads:l,messagesLoading:d,currentReferences:u}=i,g=(0,h.pn)(e=>(0,m.CB)(a.getSelectedThread(e))),y=t8(),x=(0,te.d)(),v=(0,ee.JB)(i.customCopilots,x);v?(0,nN.D)(`${g} \xb7 GitHub Copilot Spaces \xb7 ${v.name}`):y?(0,nN.D)(`Shared conversation \xb7 GitHub Copilot`):(0,nN.D)(`${g} \xb7 GitHub Copilot`);let{updateGlobalNavigationBreadcrumbs:_}=n3();(0,F.useEffect)(()=>{_()},[_,x]);let b=(0,F.useRef)(null),C=(0,F.useRef)(null),N=(0,F.useMemo)(()=>(0,nw.X)(),[]),w=(0,tt.G7)("copilot_staff_prompt_dialog")&&N,[I,S]=(0,F.useState)(!1),[k,T]=(0,F.useState)(!1),A=(0,F.useRef)(null),E=!!Y.J.settings?.instructionPrompt,{isLicensedLimited:R}=(0,X.xR)(),P=p.W.repoCustomInstructions||p.W.repoCustomInstructionsPreview,{previewPaneOpen:D,openPreviewPane:L}=(0,q.xx)(),O=(0,F.useRef)(null),[B,$]=(0,F.useState)(null),U=r?.customInstructions||[];p.W.topicsAsReferences&&(U=(0,m.NJ)(u));let z=P&&U.length>0,[V,W,H]=(0,nk.B)(!1),{canShareThread:G}=(0,f.X)(),Q="loaded"===d.state,[J,Z]=(0,F.useState)(!1),et=G&&!y&&o&&!x&&Q;return(0,c.jsxs)("div",{className:nZ.header,children:[(0,c.jsxs)("div",{className:nZ.rightControls,children:[et&&(0,c.jsx)(nJ,{}),n,(0,c.jsxs)(ec.W,{anchorRef:O,children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{icon:j.KebabHorizontalIcon,"aria-label":"Menu",onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU",mode:"immersive"}),className:(0,en.$)(E&&nZ.editedPromptIndicator),loading:V})}),(0,c.jsx)(ec.W.Overlay,{width:"small",children:(0,c.jsxs)(ed.l,{children:[t,o&&!y&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ed.l.Group,{children:[(0,c.jsx)(ed.l.GroupHeading,{children:"Conversation"}),(0,c.jsx)(nB,{onOpenDialog:$,isShared:!!l.get(o)?.sharedID,showShare:!x,hideShareOnDesktop:!0})]}),(0,c.jsx)(ed.l.Divider,{})]}),(0,c.jsxs)(ed.l.Group,{children:[(0,c.jsx)(ed.l.GroupHeading,{children:"Prompt"}),z&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>{a.toggleRepoCustomInstructions(!s)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.RepoIcon,{})}),s?"Disable custom instructions":"Enable custom instructions"]}),(0,c.jsxs)(ed.l.Item,{onSelect:()=>{T(!0),(0,K.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_PERSONAL_INSTRUCTIONS",mode:"immersive"})},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.NoteIcon,{})}),"Personal instructions"]}),(0,c.jsxs)(ed.l.Item,{onSelect:()=>{C.current?.openDialog(),(0,K.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_SYSTEM_PROMPT",mode:"immersive"})},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.CpuIcon,{})}),"System prompt"]}),w&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>S(!0),children:[(0,c.jsx)(ed.l.LeadingVisual,{children:E?(0,c.jsx)("span",{className:(0,en.$)(nZ.editedPromptIndicator,nZ.leadingVisual),children:(0,c.jsx)(j.BeakerIcon,{})}):(0,c.jsx)(j.BeakerIcon,{})}),"Edit prompt",(0,c.jsx)(ed.l.TrailingVisual,{children:(0,c.jsx)(nI.A,{variant:"attention",children:"Staff"})})]})]}),(0,c.jsx)(ed.l.Divider,{}),(0,c.jsxs)(ed.l.Group,{children:[(0,c.jsxs)(ed.l.Item,{onSelect:()=>{Z(!0)},children:["Manage shared conversations",(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.ListUnorderedIcon,{})})]}),(0,c.jsxs)(ed.l.Item,{onSelect:()=>{b.current?.openDialog(),(0,K.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_GIVE_FEEDBACK",mode:"immersive"})},children:["Give feedback",(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.CommentIcon,{})})]}),R&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(ed.l.LinkItem,{href:"/github-copilot/signup/copilot_individual",onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_UPGRADE_PRO",mode:"immersive"}),children:["Upgrade to Pro",(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.CopilotIcon,{})})]})}),(0,c.jsxs)(ed.l.LinkItem,{href:"/settings/copilot",onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_SETTINGS",mode:"immersive"}),children:["Settings",(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.GearIcon,{})})]})]})]})})]}),e&&!D&&(0,c.jsx)(M.K,{icon:j.SidebarExpandIcon,"aria-label":"Open workbench",onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_OPEN_BUTTON",mode:"immersive"}),L()}}),(0,c.jsx)(n6,{ref:C}),(0,c.jsx)(nb.l,{ref:b,mode:"immersive",returnFocusRef:O}),o&&(0,c.jsx)(nF,{visibleDialog:B,onClose:()=>{(0,nS.flushSync)(()=>$(null)),O.current?.focus()},threadName:g,threadId:o,selectedThreadId:o,onStartLoading:W,onFinishLoading:H})]}),I&&(0,c.jsx)(nC.X,{promptDialogRef:A,onDismiss:()=>S(!1)}),k&&(0,c.jsx)(nj.Y,{onDismiss:()=>T(!1),returnFocusRef:O}),J&&(0,c.jsx)(n2,{closeDialog:()=>{Z(!1)}})]})}try{n7.displayName||(n7.displayName="Header")}catch{}var n8=n(56056),n9=n(26871),ae=n(89401),at=n(2120),an=n(39363),aa=n(72659),ai=n(66349),ar=n(72160),as=n(67264),ao=n(61982),al=n(47920),ac=n(32132);let ad=({functionCall:e,manager:t,panelWidth:n,messageInterrupted:a})=>{let{functionMetadata:i,functionRenderer:r,parsedArgs:s}=(0,ac.BO)(e),o=(0,F.useMemo)(()=>a&&"started"===e.status?{...e,status:"error"}:e,[e,a]);return(0,c.jsx)(c.Fragment,{children:i&&r&&s&&r(o,i,t,n,s,!1)})};try{ad.displayName||(ad.displayName="FunctionCallBadge")}catch{}var au=n(79887),am=n(82005),ap=n(73786),ah=n(4181),ag=n(50260),af=n(40650),ay=n(53914),ax=n(34407),av=n(1088);let a_={imageAttachment:"ChatImageAttachment-module__imageAttachment--YlPWs"},ab=({messageId:e,src:t,alt:n,name:a,mode:i,squareView:r})=>{let{openPreviewPane:s,openItem:o,updateItem:l}=(0,q.xx)(),d=`image:${t}`,u=(0,F.useCallback)(e=>{e.metaKey||e.ctrlKey||((0,K.BI)("dotcom_chat.activate",{target:"BROWSER_IMAGE_OPENED",mode:"immersive"}),o(d),s(),e.preventDefault())},[d,s,o]);return(0,F.useEffect)(()=>{l({altText:n,id:d,messageId:e,name:a,type:"image",url:t})},[d,n,e,a,t,l]),(0,c.jsx)("div",{className:a_.imageAttachment,children:(0,c.jsx)(av.o,{src:t,alt:n,onClick:u,mode:i,useOverlay:!0,squareView:r})})},aj=(0,F.memo)(ab);try{ab.displayName||(ab.displayName="ChatImageAttachmentUnmemoized")}catch{}try{aj.displayName||(aj.displayName="ChatImageAttachment")}catch{}let aC={chatMessage:"ChatMessage-module__chatMessage--rtt38",user:"ChatMessage-module__user--UoWHh",editing:"ChatMessage-module__editing--BMp49",content:"ChatMessage-module__content--MYneF",imageGrid:"ChatMessage-module__imageGrid--juCGt",imageRow:"ChatMessage-module__imageRow--HFSCK",references:"ChatMessage-module__references--Kunt2",messageArea:"ChatMessage-module__messageArea--CoOmf",userMessage:"ChatMessage-module__userMessage--xvIFp",messageSubthreadIndicator:"ChatMessage-module__messageSubthreadIndicator--DJyyk",actions:"ChatMessage-module__actions--Jllb6",ai:"ChatMessage-module__ai--WrCO3",latest:"ChatMessage-module__latest--IZwZP",actionsPlaceholder:"ChatMessage-module__actionsPlaceholder--MCwTL",avatar:"ChatMessage-module__avatar--KYI8V",sharedThreadActions:"ChatMessage-module__sharedThreadActions--Z9ffu ChatMessage-module__actions--Jllb6",skillExecutionText:"ChatMessage-module__skillExecutionText--pIBPI",errorFallback:"ChatMessage-module__errorFallback--d0bNW",blinkingCursor:"ChatMessage-module__blinkingCursor--M3kDA"};function aN({className:e,messageId:t,messageIndex:n,messageTimestamp:a,references:i,size:r}){let s=ns({messageId:t,messageIndex:n,messageTimestamp:a}),{updateItem:o,versionedItems:l}=(0,q.xx)();return(0,F.useEffect)(()=>{for(let e of i){let i=(0,eC.oR)({ref:e,messageIndex:n,messageId:t,timestamp:a});null!=i&&o(i)}},[t,n,a,i,o]),(0,c.jsx)(ai.t,{references:i,onClickReference:s,size:r,className:e,getReferenceVersion:e=>(0,eC.wt)(e,n,l)})}try{aN.displayName||(aN.displayName="ChatMessageReferences")}catch{}let aw={container:"ChatPagingComponent-module__container--nH9hp",disabledButton:"ChatPagingComponent-module__disabledButton--hCGPC",pageIndicator:"ChatPagingComponent-module__pageIndicator--HoVKG"};function aI({currentPage:e,totalPages:t,onPrev:n,onNext:a,isUserMessage:i,disabled:r=!1}){if(e<1)throw Error("currentPage must be greater than or equal to 1");if(t<1)throw Error("totalPages must be greater than or equal to 1");if(e>t)throw Error("currentPage must be less than or equal to totalPages");let s=1===e||r,o=e===t||r,l=s?aw.disabledButton:"",d=o?aw.disabledButton:"";return(0,c.jsxs)("div",{className:aw.container,"data-testid":"chat-paging-component",children:[(0,c.jsx)(M.K,{variant:"invisible","aria-label":"Previous response",onClick:()=>{s||((0,K.BI)("dotcom_chat.activate",{target:i?"USER_MESSAGE_ACTION_PREVIOUS_RESPONSE":"RESPONSE_ACTION_PREVIOUS_RESPONSE",mode:"immersive"}),n(e-1))},icon:j.ChevronLeftIcon,className:l}),(0,c.jsxs)("span",{className:aw.pageIndicator,children:[e,"/",t]}),(0,c.jsx)(M.K,{variant:"invisible","aria-label":"Next response",onClick:()=>{o||((0,K.BI)("dotcom_chat.activate",{target:i?"USER_MESSAGE_ACTION_NEXT_RESPONSE":"RESPONSE_ACTION_NEXT_RESPONSE",mode:"immersive"}),a(e+1))},icon:j.ChevronRightIcon,className:d})]})}try{aI.displayName||(aI.displayName="ChatPagingComponent")}catch{}var aS=n(58011);let ak=(0,F.createContext)(null),aT=()=>{let e=(0,F.useContext)(ak);if(!e)throw Error("Missing required ContentPreviewBlockContext provider.");return e};try{ak.displayName||(ak.displayName="ContentPreviewBlockContext")}catch{}var aA=n(19919),aE=n(47970),aR=n(66211),aP=n(53110);function aD({className:e}){return(0,c.jsxs)("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"presentation",className:e,children:[(0,c.jsx)("g",{clipPath:"url(#clip0_6911_7629)",fill:"currentColor",children:(0,c.jsx)("path",{d:"M14.722 6.047a.75.75 0 11-1.5 0V3.615L10.2 6.638a.75.75 0 01-1.06-1.06l3.023-3.024H9.729a.75.75 0 010-1.499h4.243a.75.75 0 01.75.75v4.242zM1.278 9.953a.75.75 0 111.5 0v2.432L5.8 9.362a.75.75 0 011.06 1.06l-3.023 3.024h2.433a.75.75 0 010 1.499H2.028a.75.75 0 01-.75-.75V9.953z"})}),(0,c.jsx)("defs",{children:(0,c.jsx)("clipPath",{id:"clip0_6911_7629",children:(0,c.jsx)("path",{fill:"#fff",d:"M0 0H16V16H0z"})})})]})}try{aD.displayName||(aD.displayName="ExpandIcon")}catch{}let aL={container:"FileBlock-module__container--zWu5c",header:"FileBlock-module__header--X7DLN",language:"FileBlock-module__language--fbEB2",name:"FileBlock-module__name--rkkGx",previewCode:"FileBlock-module__previewCode--EieE9",isClipped:"FileBlock-module__isClipped--Z6AMg",expandIconContainer:"FileBlock-module__expandIconContainer--JwHHA",insightsButtonContainer:"FileBlock-module__insightsButtonContainer--BRMgP"};function aM({language:e,name:t,code:n,line:a,children:i,isClipped:r,isStreaming:s,index:o,startOffset:l,endOffset:d}){let{message:u}=(0,aa.V)(),{updateItem:m,openItem:p,openPreviewPane:h,versionedItems:g,openItems:f}=(0,q.xx)(),{messageIndex:y,messageId:x,messageTimestamp:v,autoOpenPreviewPane:_,markdown:b,hasAutoOpenedPreviewPaneRef:C}=aT(),{name:N}=(0,tf.vL)(e),w=`file:${t}`,I=`${w}#${y}.${a}`,S=!!n,k=g.get(w)??[],T=k.indexOf(I),A=k.length>1&&-1!==T?T+1:null,E=(0,F.useCallback)((e,t=!0)=>{(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_FILE_OPENED",mode:"immersive"}),p(I,t||f.length<1||0===o),e&&h()},[p,I,f.length,o,h]);(0,F.useEffect)(()=>{let a=n?.trimEnd();S&&x!==ts.Wp&&-1!==b.indexOf(a)&&m({messageId:x,id:I,language:e,name:t,value:n,type:"file",timestamp:new Date(v),isStreaming:s,isUserEdited:!1})},[n,e,x,t,m,I,S,v,s,b]),(0,F.useEffect)(()=>{s&&S&&x!==ts.Wp&&(E(_&&!C.current,!1),C.current=!0)},[s,S,E,_,x,C]);let[R,P]=(0,F.useState)(!1),{publicCodeReferences:D,codeVulnerabilities:L}=(0,aR.R)(u.copilotAnnotations,l,d);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"position-relative",children:[(0,c.jsxs)("button",{className:aL.container,onClick:()=>E(!0),"aria-label":`View file: ${t}`,"data-testid":`chat-message-view-file-${t}`,children:[(0,c.jsxs)("div",{className:aL.header,children:[(0,c.jsxs)("div",{className:aL.language,children:[s?(0,c.jsx)(tR.A,{size:"small",className:aS.sX}):tf.Yr.has(N)?(0,c.jsx)(j.MarkdownIcon,{className:aS.sX}):(0,c.jsx)(j.CodeIcon,{className:aS.sX}),(0,c.jsx)("span",{className:aL.name,children:t}),null!==A&&(0,c.jsx)(ej.g,{version:A})]}),(0,c.jsx)("div",{className:aL.expandIconContainer,children:(0,c.jsx)(aD,{})})]}),(0,c.jsx)("pre",{className:(0,en.$)(aL.previewCode,r&&aL.isClipped),"aria-hidden":!0,children:(0,c.jsx)("code",{children:i})})]}),(D.length>0||L.length>0)&&(0,c.jsx)("div",{className:aL.insightsButtonContainer,children:(0,c.jsx)(M.K,{variant:"invisible",size:"small",icon:j.ShieldIcon,"aria-label":"Code insights",onClick:()=>P(!0)})})]}),R&&(0,c.jsx)(aP.t,{publicCodeReferences:D,codeVulnerabilities:L,onClose:()=>P(!1)})]})}try{aM.displayName||(aM.displayName="FileBlock")}catch{}let aO="data-fileblock-props",aB=(0,aA.F)(aO),aF=RegExp("^name=(?<name>[^\\s]+)"),a$=RegExp("^name=(?<name>[^\\s]+)\\n?"),aU={code:(e,t)=>{let n=(0,aA.k)(e,aO);return n?(0,c.jsx)(aM,{...n,children:e.children}):t}},az=(RegExp("^(?<lang>[^\\s]+)\\s+type=(?<type>[^\\s]+)"),RegExp("^(?:`{3,}|~{3,})+(?<lang>[^\\s]+)\\ntype=(?<type>[^\\s]+)"),RegExp("^type=(?<type>[^\\s]+)\\n?")),aV=e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e;var aW=n(57210);let aH={container:"DraftIssueBlock-module__container--xuyX4",icon:"DraftIssueBlock-module__icon--unPEF",previewText:"DraftIssueBlock-module__previewText--G_AS3"},aq="data-draft-issue-block",aG={fromUnknown:e=>{if("object"!=typeof e||null==e)return null;let t={};return"title"in e&&"string"==typeof e.title&&(t.title=e.title),"tag"in e&&"string"==typeof e.tag&&(t.tag=e.tag),"description"in e&&"string"==typeof e.description&&(t.body=e.description),"labels"in e&&Array.isArray(e.labels)&&(t.labels=e.labels.filter(e=>"string"==typeof e)),"assignees"in e&&Array.isArray(e.assignees)&&(t.assignees=e.assignees.filter(e=>"string"==typeof e)),"repository"in e&&"string"==typeof e.repository&&(t.repository=e.repository),"template"in e&&"string"==typeof e.template&&(t.template=e.template),"type"in e&&"string"==typeof e.type&&(t.issueType=e.type),"projects"in e&&Array.isArray(e.projects)&&(t.projects=e.projects.filter(e=>"string"==typeof e)),"milestone"in e&&"string"==typeof e.milestone&&(t.milestone=e.milestone),"parentTag"in e&&"string"==typeof e.parentTag&&(t.parentTag=e.parentTag),t}},aK=e=>{try{let t=(0,aW.load)(e);return aG.fromUnknown(t)}catch{return null}};function aQ({yaml:e,isStreaming:t}){let[n,a]=(0,F.useState)(t);(0,F.useEffect)(()=>{t&&a(!0)},[t]);let{updateItem:i,openItem:r,openPreviewPane:s,versionedItems:o,items:l}=(0,q.xx)(),{messageId:d,messageIndex:u,autoOpenPreviewPane:m,hasAutoOpenedPreviewPaneRef:p}=aT(),h=(0,F.useRef)({}),g=(0,F.useMemo)(()=>{let t=aK(e);return null!=t?(h.current=t,t):h.current},[e]);(0,F.useEffect)(()=>(0,K.BI)("dotcom_chat.activate",{target:"ISSUE_DRAFT_BLOCK_RENDERED",mode:"immersive"}),[]);let f=null!=g.tag?`new-issue:${g.tag}#${u}`:void 0,y=null!=f?(0,eC.LU)(f,o):null,x=null!=f?l.get(f):void 0,v=g.repository||x?.type!=="new-issue"?g.repository:x.repository||"",_=(0,F.useCallback)(({userInitiated:e})=>{null!=f&&(r(f,e),(e||m&&!p.current)&&(s(),p.current=!0),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_DRAFT_ISSUE_OPENED",mode:"immersive"}))},[f,r,s,m,p]);(0,F.useEffect)(()=>{null!=f&&i({messageId:d,name:g.title??"",body:g.body,repository:v,id:f,type:"new-issue",tag:g.tag??"",isStreaming:t,template:g.template,issueType:g.issueType,milestone:g.milestone,assignees:g.assignees?.sort()??[],labels:g.labels?.sort()??[],projects:g.projects?.sort()??[],isUserEdited:!1})},[f,t,v,g.assignees,g.body,g.tag,g.title,g.labels,g.template,g.issueType,g.projects,g.milestone,d,i]),(0,F.useEffect)(()=>{null!=f&&n&&_({userInitiated:!1})},[f,_,n]);let b=(0,F.useCallback)(()=>_({userInitiated:!0}),[_]);return(0,c.jsxs)("div",{className:aH.container,role:"button",onClick:b,onKeyDown:e=>{("Enter"===e.code||"Space"===e.code)&&b()},tabIndex:0,children:[t?(0,c.jsx)(tR.A,{size:"small",className:aS.sX}):(0,c.jsx)(j.IssueDraftIcon,{className:aH.icon}),(0,c.jsx)("span",{className:aH.previewText,children:g.title}),null!=y&&(0,c.jsx)(ej.g,{version:y})]})}try{aQ.displayName||(aQ.displayName="DraftIssueBlock")}catch{}let aJ=(0,aA.F)(aq),aZ={div:(e,t)=>{let n=(0,aA.k)(e,aq);return n?(0,c.jsx)(aQ,{...n}):t}},aX={container:"DraftIssueTreeBlock-module__container--Qc8JY"};function aY({data:e,isStreaming:t}){let n=(0,F.useRef)([]),a=(0,F.useMemo)(()=>{let t=function(e){try{let t=(0,aW.loadAll)(e);if(Array.isArray(t))return t.map(aG.fromUnknown).filter(e=>!!e).filter(e=>!!e.tag);return null}catch{return null}}(e);return t&&(n.current=t),n.current},[e]),[i,r]=(0,F.useState)(t);(0,F.useEffect)(()=>{t&&r(!0)},[t]);let{updateItem:s,openItem:o,openPreviewPane:l,versionedItems:d}=(0,q.xx)(),{messageId:u,messageIndex:m,autoOpenPreviewPane:p,hasAutoOpenedPreviewPaneRef:h}=aT(),g=(0,F.useCallback)(e=>e.tag?`new-issue:${e.tag}#${m}`:void 0,[m]);(0,F.useEffect)(()=>{for(let e of a){let n=g(e);n&&s({messageId:u,type:"new-issue",id:n,tag:e.tag??"",parentTag:e.parentTag,name:e.title??"",body:e.body,repository:e.repository,template:e.template,issueType:e.issueType,milestone:e.milestone,assignees:e.assignees?.sort()??[],labels:e.labels?.sort()??[],projects:e.projects?.sort()??[],isUserEdited:!1,isStreaming:t})}},[g,t,a,u,m,s]);let f=(0,F.useCallback)((e,t)=>{let n=g(e);n&&(o(n,t),(t||p&&!h.current)&&(l(),h.current=!0))},[g,o,l,p,h]),y=(0,F.useMemo)(()=>{let e=a.reduce((e,t)=>(e.set(t.tag,{item:t,children:[]}),e),new Map);for(let t of a){if(!t.parentTag)continue;let n=e.get(t.parentTag),a=e.get(t.tag);n&&a&&n.children.push(a)}return Array.from(e.values()).filter(e=>!e.item.parentTag)},[a]);(0,F.useEffect)(()=>{if(i)for(let e of y)f(e.item,!1)},[i,y,f]);let x=e=>{let n=g(e.item),a=n?(0,eC.LU)(n,d):null;return(0,c.jsx)(eJ.r,{title:(0,c.jsx)(eY.T,{value:e.item.title??"",onClick:()=>f(e.item,!0),trailingBadges:null!=a?[(0,c.jsx)(ej.g,{version:a},`${e.item.tag}#${a}`)]:void 0}),subItems:e.children?.length?e.children.map(x):void 0,defaultExpanded:!0,children:(0,c.jsx)(eZ.Q,{children:(0,c.jsx)(eX.D,{children:t?(0,c.jsx)(tR.A,{size:"small",className:aS.sX}):(0,c.jsx)(j.IssueDraftIcon,{})})})},e.item.tag)};return(0,c.jsx)("div",{className:aX.container,children:y.length>0&&(0,c.jsx)(eQ.v,{title:"Draft issue hierarchy",children:y.map(x)})})}try{aY.displayName||(aY.displayName="DraftIssueTreeBlock")}catch{}let a0="data-draft-tree-issue-block",a1=(0,aA.F)(a0);var a2=n(72534);function a5({owner:e,repo:t,issueNumber:n,href:a,children:i}){let{updateItem:r,openItem:s,openPreviewPane:o,items:l}=(0,q.xx)(),{messageId:d}=aT(),u=(0,h.A3)("messages"),m=Number(n),p=`issue:${e}/${t}/${m}`,g=l.get(p),f=function(e,t,n,a,i){if(!n||!a||!i||isNaN(i))return;let r=e.find(e=>e.id===t),s=r?.references,o=s?.find(e=>"issue"===e.type&&e.number===i&&e.repository.name===a&&e.repository.owner===n),l=o?.title;if(l)return l;let c=s?.find(e=>"api-response"===e.type&&"Issue"===e.resourceType&&e.repo===`${n}/${a}`&&e.data.number===i),d=c?.data;return d?.title}(u,d,e,t,m)??g?.name??`Issue #${m}`;return(0,F.useEffect)(()=>{e&&t&&r({messageId:d,name:f,number:m,owner:e,repo:t,id:p,href:a,type:"issue"})},[p,d,a,m,e,t,f,r]),(0,c.jsx)(em.A,{href:a,onClick:e=>{e.metaKey||e.ctrlKey||(s(p),o(),(0,K.BI)("dotcom_chat.activate",{target:"BROWSER_ISSUE_OPENED",mode:"immersive"}),e.preventDefault())},target:"_blank",rel:"noreferrer",children:i})}try{a5.displayName||(a5.displayName="IssueLinkBlock")}catch{}let a3="data-issuelink-props",a4=(0,aA.F)(a3),a6=RegExp("\\/(?<owner>[^/]+)\\/(?<repo>[^/]+)\\/issues\\/(?<number>\\d+)"),a7={span:(e,t)=>{let n=(0,aA.k)(e,a3);return n?(0,c.jsx)(a5,{...n}):t}};var a8=n(62456),a9=n(89169),ie=n(46008);let it={list:"IssueListBlock-module__list--GM7vt",streaming:"IssueListBlock-module__streaming--HSaKx",item:"IssueListBlock-module__item--Z3Nv7",link:"IssueListBlock-module__link--xHV6N",content:"IssueListBlock-module__content--kXyl1",metadata:"IssueListBlock-module__metadata--fIv1v",header:"IssueListBlock-module__header--tb2Am",title:"IssueListBlock-module__title--KvqP1",unknownTitle:"IssueListBlock-module__unknownTitle--tj7iM",number:"IssueListBlock-module__number--FIbRR",labels:"IssueListBlock-module__labels--ergn3",labelIcon:"IssueListBlock-module__labelIcon--AdciQ",description:"IssueListBlock-module__description--FVdIE",icon:"IssueListBlock-module__icon--KVpem",open:"IssueListBlock-module__open--yTQ0j",draft:"IssueListBlock-module__draft--FrF8w",done:"IssueListBlock-module__done--SRM4P",closed:"IssueListBlock-module__closed--jfPZH",unassignedAvatar:"IssueListBlock-module__unassignedAvatar--SawNd"},ia={fromUnknown:e=>{if("object"!=typeof e||null===e)return{};let t={};return"url"in e&&"string"==typeof e.url&&(t.url=e.url),"state"in e&&"string"==typeof e.state&&(t.state=e.state),"draft"in e&&"boolean"==typeof e.draft&&(t.draft=e.draft),"created_at"in e&&"string"==typeof e.created_at&&(t.created_at=e.created_at),"closed_at"in e&&"string"==typeof e.closed_at&&(t.closed_at=e.closed_at),"merged_at"in e&&"string"==typeof e.merged_at&&(t.merged_at=e.merged_at),"title"in e&&"string"==typeof e.title&&(t.title=e.title),"number"in e&&"number"==typeof e.number&&(t.number=e.number),"labels"in e&&Array.isArray(e.labels)&&(t.labels=e.labels.filter(e=>"string"==typeof e)),"author"in e&&"string"==typeof e.author&&(t.author=e.author),"comments"in e&&"number"==typeof e.comments&&(t.comments=e.comments),"assignees_avatar_urls"in e&&Array.isArray(e.assignees_avatar_urls)&&(t.assignees_avatar_urls=e.assignees_avatar_urls.filter(e=>"string"==typeof e)),t}};function ii({item:e,isStreaming:t}){let n,a;let i=e.author;e.merged_at?(n=e.merged_at,a="Merged"):e.closed_at?(n=e.closed_at,a="Closed"):e.created_at&&(n=e.created_at,a="Opened");let r=n?new Date(n):null;return r&&isNaN(r.getTime())&&(r=null),i&&r||!t?(0,c.jsxs)("span",{className:it.description,children:[i," ",i?a?.toLowerCase():a," ",r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a9.A,{date:r,format:"micro"})," ago"]})]}):null}let ir=e=>{try{let t=(0,aW.load)(e);if("object"==typeof t&&null!==t&&"data"in t&&Array.isArray(t.data))return t.data.map(ia.fromUnknown);return null}catch{return null}};function is({data:e,type:t,isStreaming:n}){let[a,i]=(0,F.useState)(()=>ir(e)??[]),{updateItem:r,openItem:s,openPreviewPane:o}=(0,q.xx)(),{messageId:l}=aT();return(0,F.useEffect)(()=>i(t=>ir(e)??t),[e]),(0,F.useEffect)(()=>{"issue"===t?(0,K.BI)("dotcom_chat.activate",{target:"ISSUE_LIST_BLOCK_RENDERED",mode:"immersive"}):(0,K.BI)("dotcom_chat.activate",{target:"PR_LIST_BLOCK_RENDERED",mode:"immersive"})},[t]),(0,c.jsx)("ul",{className:(0,en.$)(it.list,n&&it.streaming),children:a.map((e,i)=>{let d={...e,type:t},u=n&&i===a.length-1,{icon:m,colorClass:p}=function(e){let t,n=null;if("issue"===e.type)"open"!==e.state||e.draft?"closed"!==e.state||e.draft?"open"===e.state&&e.draft?(n=(0,c.jsx)(j.IssueDraftIcon,{"aria-label":"Draft issue"}),t=it.draft):"closed"===e.state&&e.draft&&(n=(0,c.jsx)(j.SkipIcon,{"aria-label":"Closed draft issue"}),t=it.draft):(n=(0,c.jsx)(j.IssueClosedIcon,{"aria-label":"Closed issue"}),t=it.done):(n=(0,c.jsx)(j.IssueOpenedIcon,{"aria-label":"Open issue"}),t=it.open);else if("pr"===e.type){let a="string"==typeof e.merged_at&&e.merged_at.length>0;"open"===e.state&&!a&&e.draft?(n=(0,c.jsx)(j.GitPullRequestDraftIcon,{"aria-label":"Draft pull request"}),t=it.draft):"open"!==e.state||a||e.draft?"closed"!==e.state||a?"closed"===e.state&&a&&(n=(0,c.jsx)(j.GitMergeIcon,{"aria-label":"Merged pull request"}),t=it.done):(n=(0,c.jsx)(j.GitPullRequestClosedIcon,{"aria-label":"Closed pull request"}),t=it.closed):(n=(0,c.jsx)(j.GitPullRequestIcon,{"aria-label":"Pull request"}),t=it.open)}return{icon:n,colorClass:t}}(d);return(0,c.jsx)("li",{className:it.item,children:(0,c.jsxs)("div",{className:it.content,children:[(0,c.jsx)("div",{className:(0,en.$)(p,it.icon),children:m}),(0,c.jsxs)("div",{className:it.header,children:[u&&!d.title?null:(0,c.jsx)("a",{...(0,eb.G)("issue-list-item-link"),href:d.url??"#",className:it.link,onClick:e=>{if(!e.metaKey&&!e.ctrlKey&&(e.preventDefault(),d.url)){if("issue"===d.type){(0,K.BI)("dotcom_chat.activate",{target:"ISSUE_LIST_BLOCK_ITEM_OPEN",mode:"immersive"});let{owner:e,repo:t,number:n}=function(e){let t=/^https?:\/\/[^/]+\/([^/]+)\/([^/]+)\/issues\/(\d+)(\/.*)?$/.exec(e);if(!t)return{};let n=parseInt(t[3]??"0",10);return{owner:t[1],repo:t[2],number:n}}(d.url);if(e&&t&&n){let a=`issue:${e}/${t}/${n}`;r({messageId:l,name:d.title??`Issue #${n}`,number:n,owner:e,repo:t,id:a,href:d.url,type:"issue"}),s(a),o()}}else(0,K.BI)("dotcom_chat.activate",{target:"PR_LIST_BLOCK_ITEM_OPEN",mode:"immersive"}),window.open(d.url,"_self")}},target:"_blank",rel:"noreferrer",children:d.title||void 0===d.number?(0,c.jsxs)(c.Fragment,{children:[d.title?(0,c.jsx)("span",{className:it.title,children:d.title}):(0,c.jsx)("span",{className:(0,en.$)(it.title,it.unknownTitle),children:"Unknown issue"}),void 0!==d.number&&(0,c.jsxs)("span",{className:it.number,children:["#",d.number]})]}):(0,c.jsxs)("span",{className:it.title,children:["#",d.number]})}),(0,c.jsxs)("div",{className:it.labels,children:[d.labels?.length?d.labels.map(e=>(0,c.jsx)(nI.A,{size:"small",variant:"secondary",children:e},e)):null,0!==d.comments&&void 0!==d.comments&&(0,c.jsxs)(nI.A,{size:"small",variant:"secondary",children:[(0,c.jsx)(j.CommentIcon,{className:it.labelIcon,size:12}),d.comments]})]})]}),(0,c.jsx)(ii,{item:d,isStreaming:u}),(0,c.jsx)("div",{className:it.metadata,children:void 0===d.assignees_avatar_urls?null:0===d.assignees_avatar_urls.length?(0,c.jsx)("div",{className:it.unassignedAvatar,role:"img","aria-label":"Unassigned",children:(0,c.jsx)(j.PersonIcon,{size:12})}):(0,c.jsx)("div",{role:"img","aria-label":`${d.assignees_avatar_urls.length} ${1===d.assignees_avatar_urls.length?"assignee":"assignees"}`,children:(0,c.jsx)(ie.A,{disableExpand:!0,children:d.assignees_avatar_urls.map(e=>(0,c.jsx)(a8.r,{src:e,alt:"Assignee avatar"},e))})})})]})},i)})})}try{ii.displayName||(ii.displayName="Description")}catch{}try{is.displayName||(is.displayName="ListBlock")}catch{}let io="data-issues-list-block",il=(0,aA.F)(io),ic={div:(e,t)=>{let n=(0,aA.k)(e,io);return n?(0,c.jsx)(is,{...n}):t}},id=({messageId:e,messageIndex:t,messageTimestamp:n,autoOpenPreviewPane:a,markdown:i,...r})=>{let s=(0,F.useRef)(!1),o=(0,F.useMemo)(()=>{let e=[...r.extensions??[],function(e){return{transformMarkdown:t=>(0,aE.YR)(t,"code",t=>{let n=t.lang??"",{name:a,code:i}=function(e,t){let n=e&&aF.exec(e);if(n)return{name:n.groups?.name,code:t};let a=a$.exec(t);return a?{name:a.groups?.name,code:t.replace(a$,"")}:{code:t}}(t.meta??void 0,t.value);if(!a)return;e.includes(a)||e.push(a);let r=i.split("\n",6),s=6===r.length,o=s?r.join("\n"):`${r.join("\n")}
`,l=t.position?.start.line??0;t.value=o,t.data={...t.data,hName:"code",hProperties:{[aB]:JSON.stringify({language:n,name:a,code:i,line:l,isStreaming:t.isStreaming??!1,isClipped:s,index:e.indexOf(a),startOffset:t.position?.start.offset??-1,endOffset:t.position?.end.offset??-1})}}}),transformHtml:e=>(0,aE.YR)(e,"element",(e,t,n)=>{let a=e.children?.[0];n&&void 0!==t&&"pre"===e.tagName&&e.children?.length===1&&a?.type==="element"&&"code"===a.tagName&&aB in a.properties&&n.children.splice(t,1,a)}),reactComponents:aU}}([])];return p.W.immersiveIssuePreview&&(e=[...e,{transformMarkdown:e=>(0,aE.YR)(e,"link",e=>{try{if(new URL(e.url,window.location.origin).origin!==window.location.origin)return}catch{return}let t=a6.exec(e.url);if(!t?.groups)return;let{owner:n="",repo:a="",number:i=""}=t.groups;e.data={hName:"span",hProperties:{[a4]:JSON.stringify({owner:n,repo:a,issueNumber:i,href:e.url,children:(0,a2.d)(e)})}}}),reactComponents:a7},{transformMarkdown:e=>(0,aE.YR)(e,"code",e=>{if("list"!==e.lang)return;let t=aV(az.exec(e.meta??"")?.groups?.type??"");("issue"===t||"pr"===t)&&(e.data={hName:"div",hProperties:{[il]:JSON.stringify({data:e.value,type:t,isStreaming:e.isStreaming??!1})},hChildren:[]})}),transformHtml:e=>(0,aE.YR)(e,"element",(e,t,n)=>{let a=e.children?.[0];n&&void 0!==t&&"pre"===e.tagName&&e.children?.length===1&&a?.type==="element"&&il in a.properties&&n.children.splice(t,1,a)}),reactComponents:ic}]),p.W.draftIssueUI&&(e=[...e,{transformMarkdown:e=>(0,aE.YR)(e,"code",e=>{"yaml"===e.lang&&"draft-issue"===aV(az.exec(e.meta??"")?.groups?.type??"")&&(e.data={hName:"div",hProperties:{[aJ]:JSON.stringify({yaml:e.value,isStreaming:e.isStreaming??!1})},hChildren:[]})}),transformHtml:e=>(0,aE.YR)(e,"element",(e,t,n)=>{let a=e.children?.[0];n&&null!=t&&"pre"===e.tagName&&e.children?.length===1&&a?.type==="element"&&aJ in a.properties&&n.children.splice(t,1,a)}),reactComponents:aZ}]),p.W.draftIssueTree&&(e=[...e,{transformMarkdown:e=>(0,aE.YR)(e,"code",e=>{"yaml"===e.lang&&"draft-issue-tree"===aV(az.exec(e.meta??"")?.groups?.type??"")&&(e.data={hName:"div",hProperties:{[a1]:JSON.stringify({data:e.value,isStreaming:e.isStreaming??!1})},hChildren:[]})}),transformHtml:e=>(0,aE.YR)(e,"element",(e,t,n)=>{let a=e.children?.[0];n&&null!=t&&"pre"===e.tagName&&e.children?.length===1&&a?.type==="element"&&a1 in a.properties&&n.children.splice(t,1,a)}),reactComponents:{div:(e,t)=>{let n=(0,aA.k)(e,a0);return n?(0,c.jsx)(aY,{...n}):t}}}]),e},[r.extensions]);return(0,c.jsx)(ak.Provider,{value:(0,F.useMemo)(()=>({messageId:e,messageIndex:t,messageTimestamp:n,autoOpenPreviewPane:a,markdown:i,hasAutoOpenedPreviewPaneRef:s}),[e,t,n,a,i,s]),children:(0,c.jsx)(aS.To,{...r,markdown:i,extensions:o,chatMode:"immersive"})})};try{id.displayName||(id.displayName="MarkdownViewer")}catch{}let iu={timelineEvent:"TimelineEvents-module__timelineEvent--Piv5d",icon:"TimelineEvents-module__icon--IYNGr",situationalTimelineEvent:"TimelineEvents-module__situationalTimelineEvent--vlwlp TimelineEvents-module__timelineEvent--Piv5d",references:"TimelineEvents-module__references--r1iWF ChatMessage-module__references--Kunt2"};function im(e){return"text"===e.type&&null!=e.name&&e.name.startsWith("timeline-event:")}function ip(e){return e.references?.some(im)??!1}function ih({message:e,messageIndex:t,isViewingSharedThread:n,isSharedMessage:a,isLatestMessage:i}){return(0,c.jsxs)(c.Fragment,{children:[ip(e)&&(0,c.jsx)(ig,{message:e,messageIndex:t}),(0,c.jsx)(iy,{isViewingSharedThread:n,isSharedMessage:a,isLatestMessage:i})]})}function ig({message:e,messageIndex:t}){let{updateItem:n}=(0,q.xx)();(0,F.useEffect)(()=>{if(e.references)for(let a of e.references){let i=(0,eC.oR)({ref:a,messageIndex:t,messageId:e.id,timestamp:e.createdAt});null!=i&&n(i)}},[e.references,e.id,t,e.createdAt,n]);let a=e.references?.filter(e=>im(e));if(!a)return;let i=[];for(let e of a){let t=JSON.parse(e.name.replace("timeline-event: ",""));i.push(t)}return(0,c.jsxs)(c.Fragment,{children:[e.references&&e.references.length>0&&(0,c.jsx)(aN,{className:iu.references,messageId:e.id,messageTimestamp:e.createdAt,messageIndex:t,references:e.references,size:"medium"}),i.map(n=>(0,c.jsxs)("div",{className:iu.timelineEvent,children:[(0,c.jsx)(j.CheckIcon,{className:iu.icon}),(0,c.jsx)(id,{autoOpenPreviewPane:!1,markdown:n.markdownContent,messageId:e.id,messageIndex:t,messageTimestamp:e.createdAt,accessibleHeader:(0,m.hV)("Timeline",e.content??"")})]},n.type))]})}function iy({isSharedMessage:e,isViewingSharedThread:t,isLatestMessage:n}){return(0,c.jsxs)(c.Fragment,{children:[e&&!t&&(0,c.jsxs)("div",{className:iu.situationalTimelineEvent,children:[(0,c.jsx)(j.LinkIcon,{className:iu.icon})," Messages up to this point are included in shared link"]}),n&&p.W.copilotDuplicateThread&&t&&(0,c.jsxs)("div",{className:iu.situationalTimelineEvent,children:[(0,c.jsx)(j.RepoForkedIcon,{className:iu.icon})," Messages beyond this point will start a new private conversation"]})]})}try{ih.displayName||(ih.displayName="TimelineEvents")}catch{}try{ig.displayName||(ig.displayName="UserMessageTimelineEvent")}catch{}try{iy.displayName||(iy.displayName="SituationalTimelineEvents")}catch{}let ix={container:"UserMessageEdit-module__container--rqkMG",input:"UserMessageEdit-module__input--LbiZ1",inputContainer:"UserMessageEdit-module__inputContainer--tewB2",actions:"UserMessageEdit-module__actions--_YMp2"},iv=({messageContent:e,onSubmit:t,onCancel:n,disableSubmit:a=!1})=>{let[i,r]=(0,F.useState)(e),s=(0,F.useRef)(null);return(0,F.useEffect)(()=>{s.current&&(s.current.style.height="auto",s.current.style.height=`${s.current.scrollHeight}px`)},[i]),(0,c.jsxs)(eS.tL,{commands:{"copilot-chat:send-message":a?void 0:()=>{(0,K.BI)("dotcom_chat.activate",{target:"USER_MESSAGE_EDITING_SUBMIT",mode:"immersive"}),t(i)},"github:cancel":()=>{n(),r(e),(0,K.BI)("dotcom_chat.activate",{target:"USER_MESSAGE_EDITING_CANCEL",mode:"immersive"})}},className:ix.container,...(0,eb.G)("user-message-edit-box"),children:[(0,c.jsx)("div",{className:ix.inputContainer,children:(0,c.jsx)("textarea",{ref:s,autoComplete:"off",autoCorrect:"off",spellCheck:"false","aria-multiline":"true",rows:1,placeholder:"Ask Copilot",value:i,onChange:e=>r(e.target.value),className:ix.input,autoFocus:!0,onInput:()=>{s.current&&(s.current.style.height="auto",s.current.style.height=`${s.current.scrollHeight}px`)},onFocus:e=>e.target.setSelectionRange(0,e.target.value.length)})}),(0,c.jsxs)("div",{className:ix.actions,children:[(0,c.jsx)(eS.cQ,{commandId:"github:cancel",children:"Cancel"}),(0,c.jsx)(eS.cQ,{commandId:"copilot-chat:send-message",showKeybindingHint:!0,variant:"primary",...(0,eb.G)("user-message-edit-submit"),disabled:a,children:"Send"})]})]})};try{iv.displayName||(iv.displayName="UserMessageEdit")}catch{}let i_=({excludeFeedback:e,inputRef:t,isLatestMessage:n,isFirstReply:a,isLoading:i,isStreaming:r,panelWidth:s,messageIndex:o,autoOpenPreviewPane:l})=>{let{message:d}=(0,aa.V)(),u=(0,e9.b)(),g=(0,h.Pk)(),{items:f,versionedItems:y,openItem:x,removeItems:v,updateItem:_,openItems:b,openItemsBeforeSubthreadChange:C,setOpenItemsBeforeSubthreadChange:N,enableLoadingState:w,disableLoadingState:I,previewPaneOpen:S}=(0,q.xx)();(0,F.useEffect)(()=>{let e=g.currentReferences.find(e=>"figma"===e.type);if(p.W.immersiveFigmaIntegration&&e){let t={altText:e.title,type:"image",url:e.fullImageUrl,id:`image:${e.fullImageUrl}`,messageId:d.id,name:e.title};f.has(`image:${e.fullImageUrl}`)||_(t)}},[f,d.id,d.references,S,g.currentReferences,_]);let k=(0,F.useCallback)(()=>{let e=[],t=d;for(;null!=t;)e.push(t.id),t=void 0!==t.selectedChildIndex?g.messages[t.selectedChildIndex]:void 0;let n=new Map;for(let[e,t]of f){let a=n.get(t.messageId)||[];a.push(e),n.set(t.messageId,a)}let a=[];for(let t of e){let e=n.get(t);if(e)for(let t of e)a.push(t)}for(let[e,t]of f)t.messageId===ts.Wp&&a.push(e);N([...b]),a.some(e=>b.includes(e))&&w(),v(a)},[f,w,d,b,v,N,g.messages]),{handleConfirmationAction:T,handleRetryErrorMessage:A,handleRetryCopilotResponse:E,handleEditUserMessage:R,hasClientConfirmations:P,isAgentError:D,isAI:L,isCopilot:O,isError:B,isInterrupted:$,isLoading:U,isUser:z,myRef:V,onFeedbackSubmitted:W,rendererConfig:H,renderFeedback:G,shouldShowMessageActions:Q,skillExecutionToUseForRespondingText:J,showRetryButton:Z}=(0,af.p)({excludeFeedback:e,inputRef:t,isLatestMessage:n,isLoading:i,isStreaming:r,removeOutdatedContentPreviewItems:k}),X=t8(),Y=g.editingMessage===d.id,et=r&&!B&&!d.confirmations&&!Q&&n&&(!e||L),ea=(0,to.CX)(g.messages,d),ei=(ea?.childMessageIndexes?.findIndex(e=>e===o)||0)+1||1,er=ea?.childMessageIndexes?.length||1,es=er>=ay.L9,eo=u.maxMessagesReached(),el=er>1,ec=(0,F.useMemo)(()=>d.mediaContent?.filter(e=>e.mediaType.startsWith("image/")),[d.mediaContent]),ed=(0,F.useMemo)(()=>p.W.attachImagesImmersive&&void 0!==ec&&ec.length>0||!1,[ec]),eu=Q&&X&&(O||el),em=(0,F.useRef)(null),ep=(0,tp.M)(e=>{let t=y.get(eC.oy(e))?.at(-1);t&&x(t,!1)});(0,F.useEffect)(()=>{if(em.current!==d.id&&n&&C.length>0){let e=setTimeout(()=>{for(let e of C)ep.current(e);I(),N([])});return()=>clearTimeout(e)}em.current=d.id},[I,d.id,C,n,N,ep]);let eh=(0,F.useCallback)(()=>{let e=ei-1;u.setSelectedMessage(g.messages[ea.childMessageIndexes[e-1]]),k()},[ei,u,ea,k,g.messages]),eg=(0,F.useCallback)(()=>{let e=ei-1;u.setSelectedMessage(g.messages[ea.childMessageIndexes[e+1]]),k()},[ei,u,ea,k,g.messages]),ef=nr(),{model:ey,availableModels:ex}=(0,h.bP)("model","availableModels"),ev=ey;d.model&&(ev=(ex??[ev]).find(e=>e.id===d.model)||ev);let e_=z&&g.messages.findLast(e=>"user"===e.role)?.id===d.id,ej=()=>u.startEditingMessage(d.id),eN=(0,te.d)(),ew=!!(0,ee.JB)(g.customCopilots,eN),eI=es||eo||!!eN&&!ew,ek=O&&U&&n&&!d.content,eT=(0,F.useCallback)(e=>{u.setWrapCodeLines(e)},[u]);return(0,c.jsxs)("div",{className:(0,en.$)("message-container",aC.chatMessage,z&&aC.user,L&&aC.ai,Y?aC.editing:"",n&&aC.latest),ref:V,...(0,eb.G)(`message-${B?"error":r?"streaming":d.id}`),children:[L?(0,c.jsx)(as.W,{isLoading:U&&n,isLoadingSkills:(d.skillExecutions??[]).length>0&&U&&""===d.content&&n,isError:B&&d.error?.type!=="agentUnauthorized",className:aC.avatar,mode:g.mode,isFirstMessage:a,message:d.content||"",createdAt:d.createdAt}):null,z&&ed&&(0,c.jsx)("div",{className:ec?.length===4?aC.imageGrid:aC.imageRow,children:ec?.map(e=>c.jsx(aj,{name:e?.name||"Uploaded image",messageId:d.id,src:e?.url||"",alt:`Uploaded image${e?.name?`: ${e.name}`:""}`,mode:g.mode,squareView:ec?.length>=2},e?.url||""))}),z&&d.references&&d.references.length>0&&(0,c.jsx)(aN,{className:aC.references,messageId:d.id,messageTimestamp:d.createdAt,messageIndex:o,references:d.references,size:"medium"}),!Y&&(0,c.jsx)("div",{className:aC.content,children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:(0,en.$)("js-snippet-clipboard-copy-unpositioned",aC.messageArea),children:[z?(0,c.jsx)(ah.R,{accessibleHeader:(0,m.hV)("You",d.content??""),className:aC.userMessage,children:d.content??""}):(0,c.jsxs)(c.Fragment,{children:[!p.W.newImmersiveReferencesUI&&O&&d.skillExecutions?.map((e,t)=>c.jsx(ad,{functionCall:e,manager:u,panelWidth:s,messageInterrupted:d.interrupted},t)),ek&&(p.W.newImmersiveReferencesUI?(0,c.jsx)(ag.b,{className:(0,en.$)(aC.skillExecutionText,"mb-2"),children:`${(0,ac.WA)(J)}...`}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:aC.blinkingCursor,children:"\u258B"}),(0,c.jsx)("span",{className:"sr-only",children:"Waiting for reply\u2026"})]})),p.W.newImmersiveReferencesUI&&d.references&&d.references.length>0&&d.content&&(0,c.jsx)(ai.s,{className:"mb-2",references:d.references,isImmersive:!0}),O&&i?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ax.O,{variant:"rounded",height:"12px",width:"random"}),(0,c.jsx)(ax.O,{variant:"rounded",height:"12px",width:"random"}),(0,c.jsx)(ax.O,{variant:"rounded",height:"12px",width:"random"})]}):!P&&d.content&&(0,c.jsx)(ib,{children:(0,c.jsx)(id,{autoOpenPreviewPane:l,markdown:d.content,messageId:d.id,messageIndex:o,messageTimestamp:d.createdAt,accessibleHeader:(0,m.hV)("Copilot",d.content??""),copilotAnnotations:d.copilotAnnotations,wrapCodeLines:g.wrapCodeLines,onWrapCodeLinesChange:eT,...H})}),B?(0,c.jsx)(ao.K,{manager:u}):null,D&&d.agentErrors&&(0,c.jsx)(ao.h,{errors:d.agentErrors}),$?(0,c.jsx)(au.h,{messageHasContent:!!d.content||!!d.skillExecutions?.length}):null,L&&!ek&&(0,m.Ye)(d.confirmations).map((e,t)=>"indexrepo"===e.confirmation.name?null:(0,c.jsx)(ar.m,{confirmation:e,handleConfirmation:T,isLatestMessage:n},t))]}),el&&!n&&(0,c.jsxs)("div",{className:aC.messageSubthreadIndicator,"data-testid":"chat-paging-indicator",children:[ei,"/",er]})]}),et&&(0,c.jsx)("div",{className:aC.actionsPlaceholder}),!Q&&Z&&(0,c.jsx)(am.$,{handleRetryMessage:A,disabled:eI}),Q&&!X&&(0,c.jsxs)(ap.M,{"aria-label":"Message tools",className:aC.actions,"data-testid":"nonshared-toolbar",children:[z&&(e_?(0,c.jsx)(eS.N5,{commandId:"copilot-chat:edit-last-message",variant:"invisible","aria-label":"Edit message",onClick:ej,icon:j.PencilIcon,disabled:eI,...(0,eb.G)("edit-message-button")}):(0,c.jsx)(M.K,{variant:"invisible","aria-label":"Edit message",onClick:ej,icon:j.PencilIcon,disabled:eI,...(0,eb.G)("edit-message-button")})),O&&(0,c.jsxs)(c.Fragment,{children:[G&&(0,c.jsx)(al.G,{iconSize:"medium",onFeedbackSubmitted:W}),!!d.content&&!r&&(0,c.jsx)(tm.T,{textToCopy:d.content??"",ariaLabel:"Copy to clipboard",size:"medium",className:"d-flex flex-items-center",onCopy:()=>(0,K.BI)("dotcom_chat.activate",{target:"RESPONSE_ACTION_COPY",mode:"immersive"})})]}),Z&&B?(0,c.jsx)(am.$,{handleRetryMessage:A,disabled:eI}):L&&!B&&!d.clientSide&&(0,c.jsx)(am.$,{handleRetryMessage:E,disabled:eI,showModelPicker:!!ex&&ex.length>1,model:ev,navigateToNewThread:ef}),el&&(0,c.jsx)(aI,{currentPage:ei,totalPages:er,onPrev:eh,onNext:eg,isUserMessage:z,disabled:g.isWaitingOnCopilot})]}),eu&&(0,c.jsxs)(ap.M,{"aria-label":"Message tools",className:aC.sharedThreadActions,"data-testid":"shared-toolbar",children:[O&&(0,c.jsx)(c.Fragment,{children:!!d.content&&!r&&(0,c.jsx)(tm.T,{textToCopy:d.content??"",ariaLabel:"Copy to clipboard",size:"medium",className:"d-flex flex-items-center actions",onCopy:()=>(0,K.BI)("dotcom_chat.activate",{target:"RESPONSE_ACTION_COPY",mode:"immersive"})})}),el&&(0,c.jsx)(aI,{currentPage:ei,totalPages:er,onPrev:eh,onNext:eg,isUserMessage:z,disabled:g.isWaitingOnCopilot})]})]})}),Y&&(0,c.jsx)(iv,{messageContent:d.content||"",onSubmit:R,onCancel:()=>u.cancelEditingMessage(),disableSubmit:g.isWaitingOnCopilot})]})},ib=({children:e})=>(0,c.jsx)(er.t,{fallback:(0,c.jsx)(B.l,{className:aC.errorFallback,variant:"warning",title:"Message cannot be displayed",description:"An unknown error occurred while attempting to display this message."}),children:e}),ij=({message:e,messageIndex:t,isSharedMessage:n,isLatestMessage:a,...i})=>{let r=t8();return(0,c.jsxs)(aa.$,{message:e,children:[!ip(e)&&(0,c.jsx)(i_,{...i,messageIndex:t,isSharedMessage:n,isLatestMessage:a,isViewingSharedThread:r}),(0,c.jsx)(ih,{message:e,messageIndex:t,isViewingSharedThread:r,isSharedMessage:n,isLatestMessage:a})]})},iC=(0,F.memo)(function(e){return(0,c.jsx)(ib,{children:(0,c.jsx)(ij,{...e})})});try{i_.displayName||(i_.displayName="InnerChatMessage")}catch{}try{ib.displayName||(ib.displayName="MessageErrorBoundary")}catch{}try{ij.displayName||(ij.displayName="ChatMessageUnmemoized")}catch{}try{iC.displayName||(iC.displayName="ChatMessage")}catch{}let iN={ConversationLoader:"ConversationLoader-module__ConversationLoader--iaHbr",ConversationLoader__assistantGroup:"ConversationLoader-module__ConversationLoader__assistantGroup--PYCmE",ConversationLoader__userGroup:"ConversationLoader-module__ConversationLoader__userGroup--rnmbz",ConversationLoader__assistantAvatar:"ConversationLoader-module__ConversationLoader__assistantAvatar--jPmNg"};function iw(){return(0,c.jsxs)("div",{className:iN.ConversationLoader,"data-testid":"conversation-loader",children:[(0,c.jsx)("div",{className:iN.ConversationLoader__userGroup,children:(0,c.jsx)(ax.O,{variant:"rounded",height:"20px",width:"random"})}),(0,c.jsxs)("div",{className:iN.ConversationLoader__assistantGroup,children:[(0,c.jsx)(ax.O,{className:iN.ConversationLoader__assistantAvatar,variant:"elliptical",sx:{position:"absolute",height:24}}),Array.from({length:Math.floor(4*Math.random())+2}).map((e,t)=>(0,c.jsx)(ax.O,{variant:"rounded",height:"20px",width:"random"},t))]})]})}try{iw.displayName||(iw.displayName="ConversationLoader")}catch{}let iI={container:"ErrorState-module__container--DKNLc",icon:"ErrorState-module__icon--Grz_W",description:"ErrorState-module__description--uIC8b",sso:"ErrorState-module__sso--b2klG"};function iS({title:e,description:t,ssoOrgs:n}){let a=n&&n.length>0;return(0,c.jsxs)("div",{className:iI.container,children:[(0,c.jsx)("h1",{className:"sr-only",children:"Copilot Chat"}),(0,c.jsxs)(ep.E,{border:!1,children:[(0,c.jsx)(ep.E.Visual,{children:(0,c.jsx)(j.AlertIcon,{size:"medium",className:iI.icon})}),(0,c.jsx)(ep.E.Heading,{as:"h2",children:e}),(void 0!==t||a)&&(0,c.jsxs)("div",{className:iI.description,children:[(0,c.jsx)(ep.E.Description,{children:(0,c.jsx)("span",{children:t})}),(0,c.jsx)("div",{className:iI.sso,children:a&&(0,c.jsx)(e5.x,{protectedOrgs:n})})]})]})]})}function ik(){let{helpUrl:e}=(0,f.X)();return(0,c.jsxs)("div",{className:iI.container,children:[(0,c.jsx)("h1",{className:"sr-only",children:"Copilot Chat"}),(0,c.jsxs)(ep.E,{border:!1,children:[(0,c.jsx)(ep.E.Visual,{children:(0,c.jsx)(j.LockIcon,{size:"medium",className:iI.icon})}),(0,c.jsx)(ep.E.Heading,{as:"h2",children:"You don't have access to this shared conversation"}),(0,c.jsxs)("div",{className:iI.description,children:[(0,c.jsx)(ep.E.Description,{children:(0,c.jsx)("span",{children:"To view this shared link, you must have permissions to all resources referenced in the conversation."})}),(0,c.jsx)(em.A,{inline:!0,href:`${e}/copilot/using-github-copilot/copilot-chat/asking-github-copilot-questions-in-github#sharing-copilot-chat-conversations`,children:"Learn more"})]})]})]})}try{iS.displayName||(iS.displayName="ErrorState")}catch{}try{ik.displayName||(ik.displayName="SharedThreadForbidden")}catch{}let iT={container:"ImmersiveChat-module__container--Q4j2R",emptyContent:"ImmersiveChat-module__emptyContent--IQfnX",messageContent:"ImmersiveChat-module__messageContent--fpzTL",scrollToBottomButton:"ImmersiveChat-module__scrollToBottomButton--MQEF2",hidden:"ImmersiveChat-module__hidden--K3ci9"},iA=({inputRef:e,panelWidth:t,isMobile:n})=>{let{scrollToBottom:a}=(0,n9.b)(),i=(0,h.Pk)(),{streamingMessage:r,messages:s}=i,o=(0,e9.b)().getSelectedThread(i),l=(0,m.CB)(o),d=o?.sharedMessageID,{messages:u,groupedMessages:p}=(0,an.a)(i),g=u.find(e=>"assistant"===e.role)?.id;return(0,S.N)(()=>a("instant"),[a]),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"sr-only",children:[(0,c.jsx)("h1",{children:"Copilot Chat"}),(0,c.jsx)("h2",{children:l})]}),p.map((a,i)=>(0,c.jsx)(n8.i,{isLastGroup:i===p.length-1,children:a.map((o,l)=>{let u=-1===o.messageIndex?s.length:o.messageIndex;return(0,c.jsx)(iC,{isLatestMessage:i===p.length-1&&l===a.length-1,isSharedMessage:o.id===d,isFirstReply:o.id===g,message:o,messageIndex:u,inputRef:e,panelWidth:t,isStreaming:o.id===r?.id,autoOpenPreviewPane:!n},l)})},i))]})},iE=()=>(0,c.jsx)(iS,{title:"Conversation failed to load",description:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(em.A,{href:"",onClick:e=>{e.preventDefault(),window.location.reload()},inline:!0,children:"Reload the page"})," ","to try again."]})}),iR=()=>(0,c.jsx)(iS,{title:"Access denied",description:"You do not have permission to view this."}),iP=()=>{let{messagesLoading:e,ssoOrganizations:t}=(0,h.Pk)(),n=e.missingOrgIds?.map(e=>String(e)).map(e=>t?.find(t=>t.id===e)?.login).filter(e=>!!e),a=n&&n.length>0?"This URL may be incorrect, you're signed out of your organization or the conversation may have been deleted.":"This URL may be incorrect or the conversation may have been deleted.";return(0,c.jsx)(iS,{title:"Conversation not found",description:a,ssoOrgs:n})},iD=()=>(0,c.jsx)(iS,{title:"Shared conversation not found",description:"This URL may be incorrect or the conversation may have been deleted."}),iL=({inputRef:e,panelWidth:t,isMobile:n})=>{let a=(0,h.Pk)(),i=(0,e9.b)(),{messagesLoading:r,threadsLoading:s,messages:o,showTopicPicker:l}=a,d=i.getSelectedThread(a),{textAreaRef:u}=(0,at.Y)(e),m=t8(),g=null,f=null;return(0,to.B)(o).length&&"loaded"===r.state?g=(0,c.jsx)(iA,{inputRef:u,panelWidth:t,isMobile:n}):("loading"===r.state||"pending"===r.state)&&a.selectedThreadID&&!l?g=(0,c.jsx)(iw,{}):"error"===r.state&&a.selectedThreadID&&(null===d||r.notFound)?p.W.copilotSharedForbiddenError?p.W.copilotSharedForbiddenError&&(f=m&&a.fetchSharedThreads?.ok===!1?403===a.fetchSharedThreads.status?(0,c.jsx)(ik,{}):(0,c.jsx)(iD,{}):(0,c.jsx)(iP,{})):f=m?(0,c.jsx)(iD,{}):(0,c.jsx)(iP,{}):("error"===r.state||"error"===s.state)&&(f=403===s.status?(0,c.jsx)(iR,{}):(0,c.jsx)(iE,{})),(0,c.jsxs)(n9.$,{className:iT.container,children:[f&&(0,c.jsx)("div",{className:iT.emptyContent,children:f}),g&&(0,c.jsxs)("div",{className:iT.messageContent,children:[g,(0,c.jsx)(iM,{}),(0,c.jsx)(ae.Cb,{})]}),(0,c.jsx)(ae.zc,{})]})},iM=()=>{let{isScrolledUp:e,scrollToBottom:t}=(0,n9.b)();return(0,c.jsx)(M.K,{"aria-label":"Scroll to bottom",className:(0,en.$)(iT.scrollToBottomButton,!e&&iT.hidden),onClick:()=>t("smooth"),icon:j.ArrowDownIcon,tooltipDirection:"n",tabIndex:-1,"aria-hidden":!0})};try{iA.displayName||(iA.displayName="Messages")}catch{}try{iE.displayName||(iE.displayName="FailedToLoadThreadError")}catch{}try{iR.displayName||(iR.displayName="AccessDeniedError")}catch{}try{iP.displayName||(iP.displayName="NotFoundError")}catch{}try{iD.displayName||(iD.displayName="SharedThreadNotFound")}catch{}try{iL.displayName||(iL.displayName="ImmersiveChat")}catch{}try{iM.displayName||(iM.displayName="ScrollToBottomButton")}catch{}var iO=n(97891),iB=n(46584);let iF=JSON.parse('{"Files":{"id":"files-group","name":"Files","color":"var(--display-gray-fgColor)","icon":"file","entries":[{"id":"create-profile-readme","message":"First, create an outstanding README for my GitHub profile using only Markdown. Then ask for key details (such as profession, top skills, favorite projects, or social links) to further refine and personalize it.","titleHtml":"Profile README"},{"id":"generate-html-calculator","message":"Generate a simple calculator using HTML, CSS, and JavaScript.","titleHtml":"Simple calculator"},{"id":"make-pong","message":"Create a simple Pong game using HTML, CSS, and JavaScript. The player should control the left paddle with their mouse and arrow keys up/down, the right paddle is the computer. Make sure the game includes a bouncing ball, a scoreboard and collision detection for paddles and walls.","titleHtml":"Pong game"},{"id":"mermaid-architecture","message":"Create a Markdown file with a Mermaid diagram showing an architecture overview.","titleHtml":"Mermaid architecture overview"}]},"Pull requests":{"id":"pull-requests-group","name":"Pull requests","color":"var(--display-green-fgColor)","icon":"git-pull-request","entries":[{"id":"list-open-prs","message":"List my latest open pull requests.","titleHtml":"My open pull requests"},{"id":"summarize-pr","message":"Search for my latest merged PR and summarize it. What was the purpose and the key changes made?","titleHtml":"Summarize my latest PR"}]},"Issues":{"id":"issues-group","name":"Issues","color":"var(--display-green-fgColor)","icon":"issue-opened","entries":[{"id":"list-open-issues","message":"List the latest open issues assigned to me.","titleHtml":"Issues assigned to me"},{"id":"create-issue","message":"First, create a new draft issue. Then ask for additional information to fill out the issue.","titleHtml":"Create a new issue"},{"id":"summarize-issue","message":"Summarize the latest issue that I\'ve opened including all comments.","titleHtml":"Summarize my latest issue"}]},"Git":{"id":"git-group","name":"Git","color":"var(--display-gray-fgColor)","icon":"git-branch","entries":[{"id":"basic-git-commands","message":"Explain what basic Git commands are and how to use them. Include commands like `git status`, `git init`, `git clone`, `git add`, `git commit`, `git push`, and `git pull`. Provide examples for each command.","titleHtml":"Basic Git commands"},{"id":"git-branching","message":"Explain how to create and manage branches in Git. Include commands like `git branch`, `git checkout`, `git merge`, and `git rebase`. Provide examples for each command.","titleHtml":"Git branching"},{"id":"advanced-git-commands","message":"Explain advanced Git commands and their usage. Include commands like `git stash`, `git cherry-pick`, `git revert`, and `git reset`. Provide examples for each command.","titleHtml":"Advanced Git commands"}]}}');var i$=n(65556);function iU({className:e}){let[t,n]=(0,F.useState)(tv.L.Static),[a,i]=(0,F.useState)(!0),{safeSetTimeout:r}=(0,i$.A)();return(0,F.useEffect)(()=>{let e=r(()=>{Y.J.getProPlusAnimationFlag()?(n(tv.L.Activate),i(!1)):(n(tv.L.Idle),i(!0))},1e3);return()=>clearTimeout(e)},[r]),(0,c.jsx)("div",{className:e,children:(0,c.jsx)(tv.N,{animationType:t,onAnimationEnd:()=>{t===tv.L.Activate&&(n(tv.L.Idle),i(!0),Y.J.removeProPlusAnimationFlag())},loopAnimation:a,size:48})})}try{iU.displayName||(iU.displayName="CopilotEmptyStateAnimation")}catch{}let iz={scrollContainer:"NewConversation-module__scrollContainer--Xfaaj",container:"NewConversation-module__container--Qt89h",banner:"NewConversation-module__banner--nBNmy",main:"NewConversation-module__main--GVJMw",content:"NewConversation-module__content--j88E1",alignTop:"NewConversation-module__alignTop--gdI7p",innerContainer:"NewConversation-module__innerContainer--gDENn",footer:"NewConversation-module__footer--uQNk1",suggestions:"NewConversation-module__suggestions--vWWmG",starters:"NewConversation-module__starters--leV1b",item:"NewConversation-module__item--PJdL6",suggestionButton:"NewConversation-module__suggestionButton--avNLF"},iV={container:"StarterPill-module__container--BCDeZ",icon:"StarterPill-module__icon--ca2DE",title:"StarterPill-module__title--ODdkN",dropdown:"StarterPill-module__dropdown--wcx2F"},iW=e=>e in j,iH=F.forwardRef(({name:e,icon:t,color:n,onClick:a,dropdown:i},r)=>{let s=function(e){let t=`${e.replaceAll(/(?:^|-)(\w)/g,(e,t)=>t.toUpperCase())}Icon`;return iW(t)?j[t]:void 0}(t);return(0,c.jsxs)("button",{ref:r,className:iV.container,onClick:a,children:[s&&(0,c.jsx)("div",{className:iV.icon,style:{color:n},children:(0,c.jsx)(s,{})}),(0,c.jsxs)("div",{className:iV.title,children:[e,i&&(0,c.jsx)("div",{className:iV.dropdown,children:(0,c.jsx)(j.TriangleDownIcon,{})})]})]})});iH.displayName="StarterPill";try{(a=Icon).displayName||(a.displayName="Icon")}catch{}function iq(){let e=(0,e9.b)(),t=(0,h.Pk)(),n=(n,a)=>{let i=e.getSelectedThread(t),r=0===t.messages.length?i:e.getSelectedThread(t);e.sendChatMessage({thread:r,content:n,references:t.currentReferences,topic:t.currentTopic,context:t.context,customInstructions:t.customInstructions,model:t.model}),(0,K.BI)("dotcom_chat.activate",{target:a,mode:"immersive"})};return(0,c.jsx)(c.Fragment,{children:[{name:"Create issue",icon:"issue-draft",color:"var(--fgColor-muted)",message:"First, create a new draft issue. Then ask for additional information to fill out the issue",analyticsTarget:"STARTER_CUSTOM_CREATE_ISSUE"}].map(e=>(0,c.jsx)("li",{className:iz.item,children:(0,c.jsx)(iH,{name:e.name,icon:e.icon,color:e.color,onClick:()=>n(e.message,e.analyticsTarget)})},e.name))})}try{iq.displayName||(iq.displayName="CustomStarters")}catch{}var iG=n(18427),iK=n(64633),iQ=n(87913);let iJ={container:"EditorUpsellBanner-module__container--CVVb2",banner:"EditorUpsellBanner-module__banner--nLwUI",title:"EditorUpsellBanner-module__title--UkB0l",description:"EditorUpsellBanner-module__description--wNgDi",actions:"EditorUpsellBanner-module__actions--tJUAU",editorButton:"EditorUpsellBanner-module__editorButton--gkwOw",closeButton:"EditorUpsellBanner-module__closeButton--qXUPm"};function iZ(){let e=(0,h.A3)("isEditorUpsellBannerDismissed"),t=(0,e9.b)(),{isLicensedLimited:n}=(0,X.xR)(),a=(0,F.useId)(),i="editor_upsell_banner",r=(e,t)=>{p.W.freeToPaidTelemetry?(0,iK.F)(e,i,"immersive",t):(0,K.BI)("dotcom_chat.activate",{target:`EDITOR_UPSELL_BANNER_${e.toUpperCase()}`,mode:"immersive"})};return e||!n?null:(0,c.jsx)("div",{className:iJ.container,children:(0,c.jsxs)("section",{className:iJ.banner,"aria-labelledby":a,children:[(0,c.jsx)("h2",{className:iJ.title,id:a,children:"Install Copilot in your favorite code editor"}),(0,c.jsx)("p",{className:iJ.description,children:"Copilot is available for a multitude of editors to fit your needs"}),p.W.freeToPaidSettingsUpgrade?(0,c.jsx)(iG.B,{menuLocation:i,mode:"immersive"}):(0,c.jsxs)(nz.A,{className:iJ.actions,children:[(0,c.jsx)(Q.z,{className:iJ.editorButton,href:iQ.A.vscode.url,leadingVisual:(0,c.jsx)("img",{src:iQ.A.vscode.icon,alt:"",height:"20",width:"20"}),onClick:()=>{r("vscode","ide_menu_primary_button_click")},children:iQ.A.vscode.name}),(0,c.jsxs)(ec.W,{children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{"aria-label":"More editors",icon:j.TriangleDownIcon,unsafeDisableTooltip:!0,onClick:()=>{r("menu","ide_menu_open")}})}),(0,c.jsx)(ec.W.Overlay,{align:"end",children:(0,c.jsx)(ed.l,{children:(0,c.jsx)(iK.t,{menuLocation:i,mode:"immersive"})})})]})]}),(0,c.jsx)(M.K,{variant:"invisible",className:iJ.closeButton,icon:j.XIcon,"aria-label":"Dismiss banner",onClick:()=>{t.dismissEditorUpsellBanner(),(0,K.BI)("dotcom_chat.activate",{target:"EDITOR_UPSELL_BANNER_DISMISS",mode:"immersive"})}})]})})}try{iZ.displayName||(iZ.displayName="EditorUpsellBanner")}catch{}function iX({onDismiss:e,className:t}){return(0,c.jsx)("div",{className:t,children:(0,c.jsx)(B.l,{variant:"success",title:"Copilot Pro+ activated",description:"Your Copilot Pro+ subscription is now active.",hideTitle:!0,onDismiss:()=>{e(),(0,K.BI)("dotcom_chat.activate",{target:"PRO_PLUS_SUCCESS_BANNER_DISMISS",mode:"immersive"})}})})}try{iX.displayName||(iX.displayName="ProPlusSuccessBanner")}catch{}function iY({onDismiss:e,className:t}){return(0,c.jsx)("div",{className:t,children:(0,c.jsx)(B.l,{variant:"success",title:"Copilot Pro trial activated",description:"Your 30-day Copilot Pro trial is now active.",hideTitle:!0,onDismiss:()=>{e(),(0,K.BI)("dotcom_chat.activate",{target:"TRIAL_SUCCESS_BANNER_DISMISS",mode:"immersive"})}})})}try{iY.displayName||(iY.displayName="TrialSuccessBanner")}catch{}function i0(){let e=(0,X.xR)().licenseType,t=function(){let[e,t]=(0,F.useState)(()=>(Y.J.getTrialSuccessBannerFlag()&&!Y.J.getProPlusSuccessBannerFlag())??!1);return{visible:e,onDismiss:()=>{Y.J.removeTrialSuccessBannerFlag(),t(!1)}}}(),n=function(){let[e,t]=(0,F.useState)(()=>Y.J.getProPlusSuccessBannerFlag()??!1);return{visible:e,onDismiss:()=>{Y.J.removeProPlusSuccessBannerFlag(),Y.J.removeTrialSuccessBannerFlag(),t(!1)}}}(),a=n.visible,i=!a&&t.visible&&e===ts.mF.LicensedFull;return(0,c.jsxs)(c.Fragment,{children:[!a&&!i&&(0,c.jsx)(iZ,{}),i&&(0,c.jsx)(iY,{className:nl.banner,onDismiss:t.onDismiss}),a&&(0,c.jsx)(iX,{className:nl.banner,onDismiss:n.onDismiss})]})}try{i0.displayName||(i0.displayName="NewConversationBanners")}catch{}let i1={suggestionButton:"SuggestionCard-module__suggestionButton--U6qWz",icon:"SuggestionCard-module__icon--XvDGU"},i2=e=>e in j;function i5({titleHtml:e,icon:t,color:n,onClick:a}){let i=function(e){let t=`${e.replaceAll(/(?:^|-)(\w)/g,(e,t)=>t.toUpperCase())}Icon`;return i2(t)?j[t]:void 0}(t);return(0,c.jsxs)("button",{className:i1.suggestionButton,onClick:a,children:[i&&(0,c.jsx)("div",{className:i1.icon,style:{color:n},children:(0,c.jsx)(i,{})}),(0,c.jsx)(tE.mo,{html:e})]})}try{i5.displayName||(i5.displayName="SuggestionCard")}catch{}try{(i=Icon).displayName||(i.displayName="Icon")}catch{}function i3({group:e,onEntrySelect:t}){let[n,a]=(0,F.useState)(!1),i=(0,F.useRef)(null);return(0,c.jsx)("li",{className:iz.item,children:(0,c.jsxs)(ec.W,{open:n,onOpenChange:a,children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(iH,{ref:i,name:e.name,icon:e.icon,color:e.color,onClick:()=>{a(!n)},dropdown:!0})}),(0,c.jsx)(ec.W.Overlay,{style:{width:"260px"},children:(0,c.jsx)(ed.l,{children:e.entries.map(e=>(0,c.jsx)(ed.l.Item,{onSelect:()=>t(e),children:(0,c.jsx)(tE.mo,{html:e.titleHtml})},e.id))})})]})})}function i4({textAreaRef:e,handleUserSubmit:t,nextMessageIndex:n}){let a=(0,e9.b)(),i=(0,h.Pk)(),r=(0,f.X)(),s=a.getSelectedThread(i),o=(0,F.useMemo)(()=>{var e;if(Array.isArray(e=r.icebreakers)&&e.every(e=>"type"in e&&"data"in e)){let e=(0,tt.G7)("copilot_showcase_icebreakers")?{data:r.icebreakers.filter(e=>["functional","instructional"].includes(e.type)).flatMap(e=>e.data)}:r.icebreakers.find(e=>"functional"===e.type);if(e&&e.data.length>0)return[...e.data].sort(()=>.5-Math.random()).slice(0,6)}return[]},[r.icebreakers]),l=e=>{let t=0===i.messages.length?s:a.getSelectedThread(i),n=i.currentUserLogin||"",r=e.message.replaceAll("$$USERNAME$$",n);a.sendChatMessage({thread:t,content:r,references:i.currentReferences,topic:i.currentTopic,context:i.context,customInstructions:i.customInstructions,model:i.model}),(0,K.BI)("dotcom_chat.activate",{target:"NEW_CONVERSATION_STARTER_MENU_ITEM",topic:i.currentTopic?.name,mode:"immersive",starterId:e.id})},d=(0,F.useMemo)(()=>p.W.newConversationStarters?Object.values(iF):[],[]);return(0,c.jsx)("div",{className:iz.scrollContainer,children:(0,c.jsxs)("div",{className:iz.container,children:[(0,c.jsx)("div",{className:iz.banner,children:(0,c.jsx)(i0,{})}),(0,c.jsx)("div",{className:iz.main,children:(0,c.jsx)("div",{className:iz.content,children:(0,c.jsxs)("div",{className:iz.alignTop,children:[(0,iB.u)("copilot_pro_plus_animation")?(0,c.jsx)(iU,{}):(0,c.jsx)(G.A,{hidden:!0}),(0,c.jsxs)("div",{className:iz.innerContainer,children:[(0,c.jsx)("h1",{className:"sr-only",children:"Copilot Chat"}),(0,c.jsx)(ng,{textAreaRef:e,handleUserSubmit:t,nextMessageIndex:n}),(0,c.jsx)("h2",{className:"sr-only",children:"Sample prompts to try"}),(0,c.jsx)("ul",{className:`${p.W.newConversationStarters?iz.starters:iz.suggestions}`,children:p.W.newConversationStarters?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(iq,{}),d.map(e=>(0,c.jsx)(i3,{group:e,onEntrySelect:l},e.id))]}):o.map(e=>(0,c.jsx)("li",{className:iz.suggestionButton,children:(0,c.jsx)(i5,{titleHtml:e.titleHtml,icon:e.icon,color:e.color,onClick:()=>{let t=0===i.messages.length?s:a.getSelectedThread(i),n=i.currentUserLogin,r=e.message;a.sendChatMessage({thread:t,content:r.replaceAll("$$USERNAME$$",n),references:i.currentReferences,topic:i.currentTopic,context:i.context,customInstructions:i.customInstructions,model:i.model}),(0,K.BI)("dotcom_chat.activate",{target:"EMPTY_STATE_SUGGESTION_CARD",topic:i.currentTopic?.name,mode:"immersive",suggestionId:e.id})}})},e.id))})]})]})})}),(0,c.jsx)("div",{className:iz.footer,children:(0,c.jsx)(iO.h,{})})]})})}try{i3.displayName||(i3.displayName="StarterGroupWithMenu")}catch{}try{i4.displayName||(i4.displayName="NewConversation")}catch{}let i6={container:"QuotaExceededEmptyState-module__container--IH35J",main:"QuotaExceededEmptyState-module__main--UOew3",hero:"QuotaExceededEmptyState-module__hero--GYoHc",copy:"QuotaExceededEmptyState-module__copy--FI8o_",heading:"QuotaExceededEmptyState-module__heading--RHZjC",description:"QuotaExceededEmptyState-module__description--m4Qvb",footer:"QuotaExceededEmptyState-module__footer--xLpJU"};function i7(){let{resetDate:e}=(0,X.xR)();return(0,c.jsxs)("div",{className:i6.container,children:[(0,c.jsxs)("div",{className:i6.main,children:[(0,c.jsx)("img",{className:i6.hero,src:"/images/modules/copilot-immersive-v1/hero.png",alt:"Hero"}),(0,c.jsxs)("div",{className:i6.copy,children:[(0,c.jsx)("h2",{className:i6.heading,children:"You\u2019ve reached your free plan limit"}),(0,c.jsxs)("p",{className:i6.description,children:["Your limits will reset on ",e,"."]}),(0,c.jsx)(Q.z,{as:"a",variant:"primary",size:"large",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"QUOTA_EXCEEDED_EMPTY_STATE_LINK_UPGRADE",mode:"immersive"})},children:"Upgrade to Pro"})]})]}),(0,c.jsxs)("div",{className:i6.footer,children:[(0,c.jsx)("strong",{children:"Part of an organization?"}),(0,c.jsxs)("span",{children:["Upgrade to"," ",(0,c.jsx)(em.A,{href:"https://github.com/github-copilot/business_signup/choose_business_type?cft=copilot_li.features_copilot.cfb",inline:!0,children:"Copilot Business"})," ","to enable across teams."]})]})]})}try{i7.displayName||(i7.displayName="QuotaExceededEmptyState")}catch{}var i8=n(55649);function i9(){return(0,c.jsx)(B.l,{title:"Chat is disabled",variant:"warning",description:"Conversation unavailable. The linked space may have been deleted, or you might be signed out of your organization.",hideTitle:!0})}function re({customCopilot:e}){let t=(0,ea.Zp)();return e&&(0,c.jsx)(B.l,{title:"Chat is disabled",variant:"critical",description:"You've exceeded the size limit for this space. Remove some references to continue chatting.",hideTitle:!0,primaryAction:(0,c.jsx)(Q.z,{as:"a",href:(0,ee.Cb)(e),onClick:n=>{n.preventDefault(),t((0,ee.Cb)(e))},children:"Edit"})})}function rt(){return(0,c.jsx)(B.l,{title:"Reference size exceeded",variant:"critical",description:"You've exceeded the size limit for this space. Remove some references to continue.",hideTitle:!0,className:"mb-3"})}function rn(){return(0,c.jsx)(B.l,{title:"Reference not found",variant:"critical",description:"We couldn't access that repository. Make sure it exists and that you have permission to use it.",hideTitle:!0,className:"mb-3"})}try{i9.displayName||(i9.displayName="SpaceDeletedBanner")}catch{}try{re.displayName||(re.displayName="SpaceSizeExceededBanner")}catch{}try{rt.displayName||(rt.displayName="ReferenceSizeExceededBanner")}catch{}try{rn.displayName||(rn.displayName="AssociatedRepositoryReferenceNotFoundBanner")}catch{}let ra={spaceHomepage:"spaceHomepage",customCopilotDisabled:"customCopilotDisabled",customCopilotSizeExceeded:"customCopilotSizeExceeded"};function ri({variant:e,customCopilot:t}){switch(e){case ra.customCopilotDisabled:return(0,c.jsx)(i9,{});case ra.customCopilotSizeExceeded:return(0,c.jsx)(re,{customCopilot:t});case ra.spaceHomepage:return(0,c.jsx)(c.Fragment,{});default:return null}}try{ri.displayName||(ri.displayName="SpaceConversationBanner")}catch{}function rr({isMobile:e,textAreaRef:t,isSidebarOpen:n}){let a=(0,h.Pk)(),{messages:i,messagesLoading:r,threadsLoading:s}=a,o=(0,e9.b)(),{model:l}=(0,h.bP)("model"),d=p.W.attachImagesImmersive&&p.W.wholeAreaDragDrop,{chatQuotaExceeded:u}=(0,X.xR)(),m=(0,te.d)(),{variant:g,customCopilot:f}=function(e,t){let{isPending:n,data:a,error:i}=(0,et.TB)(e),r=i instanceof et.Be;if(i&&!r)throw i;let s=!n&&!r&&a&&(0,i8.ix)(a)?a:void 0;return{variant:function(e,t,n,a){if(e&&!a)return ra.spaceHomepage;if(n)return null;let i=!!t;return e&&!i?ra.customCopilotDisabled:(0,ee.Hh)(t)?ra.customCopilotSizeExceeded:null}(e,s,n,t),customCopilot:s,isLoading:n}}(m,a.selectedThreadID),y=(0,F.useRef)(a.currentTopic),x=t8(),v=(0,F.useMemo)(()=>!a.selectedThreadID&&Y.J.getEntrypointMessage(),[a.selectedThreadID]),_=(0,F.useMemo)(()=>!a.selectedThreadID&&!v&&!m&&!u&&"error"!==r.state&&"error"!==s.state,[a.selectedThreadID,v,m,u,r.state,s.state]),b=i.length,j=nn(y,b);(0,F.useEffect)(()=>{y.current=a.currentTopic},[a.currentTopic]),(0,F.useEffect)(()=>{let e=Y.J.getEntrypointMessage();e&&!u&&(Y.J.setEntrypointMessage(null),setTimeout(()=>{j(e)},100))},[j,u]);let C=(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n7,{isSidebarOpen:n}),!a.selectedThreadID&&u?(0,c.jsx)(i7,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:nm.content,children:_?(0,c.jsx)(i4,{textAreaRef:t,handleUserSubmit:j,nextMessageIndex:b}):(0,c.jsx)(iL,{inputRef:t,isMobile:e,onSubmit:j})}),(!x||p.W.copilotDuplicateThread)&&!_&&(0,c.jsxs)("div",{className:nm.footer,children:[g&&(0,c.jsx)(ri,{variant:g,customCopilot:f}),(0,c.jsx)(ng,{textAreaRef:t,handleUserSubmit:j,nextMessageIndex:b})]})]})]});return d?(0,c.jsx)(n_,{model:l,state:a,manager:o,children:C}):C}function rs(e){return(0,c.jsx)(er.t,{fallback:(0,c.jsx)(eg,{regionName:"This conversation"}),children:(0,c.jsx)(rr,{...e})})}try{rr.displayName||(rr.displayName="ConversationViewInner")}catch{}try{rs.displayName||(rs.displayName="ConversationView")}catch{}var ro=n(84976),rl=n(35642);let rc=(0,n(80688).A)("sessionStorage",{throwQuotaErrorsOnSet:!1,ttl:864e5}),rd="THREAD_TIME_PATCH";function ru(){let e=rc.getItem(rd);return e?JSON.parse(e):null}function rm(){rc.removeItem(rd)}let rp={ConversationList__container:"ConversationList-module__ConversationList__container--rX8fM",ConversationList__empty:"ConversationList-module__ConversationList__empty--sTf7Y",ConversationList:"ConversationList-module__ConversationList--LAVA0",ConversationList__section:"ConversationList-module__ConversationList__section--ihwdi",ConversationList__title:"ConversationList-module__ConversationList__title--IHb4U",ConversationList__item:"ConversationList-module__ConversationList__item--dD6z4",ConversationList__link:"ConversationList-module__ConversationList__link--Byc2c",ConversationList__text:"ConversationList-module__ConversationList__text--YbHpv",ConversationList__context:"ConversationList-module__ConversationList__context--SK6Jb"};function rh({selectedItemID:e,loadingState:t,onConversationSelect:n}){let a=(0,e9.b)(),{threads:i}=(0,h.Pk)(),r=(0,F.useMemo)(()=>((function(e){let t=ru();if(t){let n=e.get(t.threadID);n&&(Date.parse(n.updatedAt)<=t.updatedAt?n.updatedAt=new Date(t.updatedAt).toJSON():rm())}})(i),a.sortThreads(i).map(e=>({id:e.id,text:(0,m.CB)(e),href:`${m.Jz}/c/${e.id}`,date:new Date(e.updatedAt)}))),[i,a]),s=function(e){let t=new Date,n=new Date(t);n.setDate(t.getDate()-1);let a=new Date(t);a.setDate(t.getDate()-7);let i=new Date(t);i.setDate(t.getDate()-30);let r=[],s=[],o=[],l=[];for(let c of e)c.date.toDateString()===t.toDateString()?r.push(c):c.date.toDateString()===n.toDateString()?s.push(c):c.date>a?o.push(c):c.date>i&&l.push(c);return{Today:r,Yesterday:s,"Last 7 days":o,"Last 30 days":l}}(r),o=0===r.length,l=(0,F.useId)();return(0,c.jsx)("nav",{"aria-labelledby":`${l}-conversations`,id:`${l}-conversation-list`,tabIndex:-1,className:rp.ConversationList__container,children:o&&("loading"===t||"pending"===t)?(0,c.jsx)(rl.r,{lines:5}):o?(0,c.jsx)(rf,{}):(0,c.jsxs)("div",{className:rp.ConversationList__section,children:[(0,c.jsx)("h3",{id:`${l}-conversations`,className:"sr-only",children:"Conversations"}),Object.entries(s).map(([t,a])=>a.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{id:`${l}_${t}`,className:rp.ConversationList__title,children:t}),(0,c.jsx)("ul",{className:rp.ConversationList,children:a.map(t=>(0,c.jsx)(rg,{item:t,selectedItemId:e??void 0,onSelect:n,threads:i},t.id))})]},t))]})})}function rg({item:e,selectedItemId:t,onSelect:n,threads:a}){let i=e.id===t,[r,s]=(0,F.useState)(null),[o,l,d]=(0,nk.B)(!1),u=a.get(t),m=!!u?.customCopilotID,p=(0,F.useRef)(null),h=(0,F.useCallback)(()=>{(0,nS.flushSync)(()=>s(null)),p.current?.focus()},[p]);return e.href&&(0,c.jsxs)("li",{className:rp.ConversationList__item,children:[(0,c.jsx)(ro.N_,{className:rp.ConversationList__link,to:e.href,"aria-current":i?"page":void 0,onClick:()=>{n(),(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_SELECT",threadId:e.id,mode:"immersive"})},children:(0,c.jsx)("span",{className:rp.ConversationList__text,children:e.text})}),(0,c.jsx)("span",{className:rp.ConversationList__context,children:(0,c.jsxs)(ec.W,{anchorRef:p,children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{loading:o,icon:j.KebabHorizontalIcon,"aria-label":"Manage conversation",variant:"invisible",onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"CONVERSATION_CONTEXT_MENU",mode:"immersive"})})}),(0,c.jsx)(ec.W.Overlay,{children:(0,c.jsx)(ed.l,{children:(0,c.jsx)(nB,{onOpenDialog:s,isShared:!!a.get(e.id)?.sharedID,showShare:!m})})})]})}),(0,c.jsx)(nF,{visibleDialog:r,onClose:h,threadName:e.text,threadId:e.id,selectedThreadId:t,onStartLoading:l,onFinishLoading:d})]},e.id)}function rf(){return(0,c.jsxs)("div",{className:rp.ConversationList__empty,children:[(0,c.jsx)(P.A,{as:"h3",sx:{fontSize:1,mb:2},children:"No conversations yet"}),(0,c.jsx)(nL.A,{sx:{color:"fg.muted"},children:"Ask Copilot anything on the right to start your first conversation."})]})}try{rh.displayName||(rh.displayName="ConversationList")}catch{}try{rg.displayName||(rg.displayName="ConversationListEntry")}catch{}try{rf.displayName||(rf.displayName="EmptyState")}catch{}function ry(){return(0,c.jsx)("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",children:(0,c.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.515.456a1.555 1.555 0 00-2.2 0L6.58 6.19a1.556 1.556 0 00-.396.673l-.825 2.89a.667.667 0 00.824.824l2.89-.826c.254-.072.485-.209.672-.396l5.735-5.734a1.556 1.556 0 000-2.2l-.965-.965zm-1.257.942a.222.222 0 01.314 0l.965.966a.222.222 0 010 .314L13.415 3.8l-1.28-1.28 1.123-1.122zm-2.065 2.066l1.279 1.279-3.67 3.67a.221.221 0 01-.096.056l-1.736.496.496-1.736c.01-.036.03-.07.057-.096l3.67-3.67zM1.639 4.778a2.25 2.25 0 012.25-2.25h3.154a.75.75 0 000-1.5H3.889a3.75 3.75 0 00-3.75 3.75v7.333a3.75 3.75 0 003.75 3.75h7.333a3.75 3.75 0 003.75-3.75V8.445a.75.75 0 00-1.5 0v3.666a2.25 2.25 0 01-2.25 2.25H3.889a2.25 2.25 0 01-2.25-2.25V4.778z",clipRule:"evenodd"})})}try{ry.displayName||(ry.displayName="ComposeIcon")}catch{}function rx({className:e,size:t=16}){return(0,c.jsx)("svg",{className:e,width:t,height:t,"aria-hidden":"true",fill:"none",viewBox:"0 0 16 16",children:(0,c.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.9853 4.76795c.2467 1.23107.1819 2.55631-.3218 3.71134 1.0897-1.00527 1.7464-2.46826 1.7464-3.86921 0-.41421.3357-.75.75-.75.4142 0 .75.33579.75.75 0 2.80515-2.0553 5.92172-5.26314 6.53282.12999.0339.26315.0635.39904.0885 1.3486.2485 2.7916.0174 3.7282-.5446.3552-.2131.8159-.0979 1.029.2573.2131.3552.0979.8159-.2573 1.029-1.3033.782-3.1303 1.0359-4.77168.7335-1.47895-.2726-2.95185-1.0297-3.73462-2.4328.03609.3407.0998.6912.19117 1.0445.39625 1.5319 1.23152 2.7976 2.12066 3.2689.36598.194.5054.6479.31141 1.0139-.19399.366-.64793.5054-1.01391.3114-1.41889-.7521-2.42362-2.4914-2.87037-4.2186-.37219-1.439-.41354-3.09054.18406-4.40236-.18676.13263-.36743.27694-.54001.43237-1.03593.93306-1.73142 2.22122-1.73142 3.69879 0 .4142-.33579.75-.75.75-.41422 0-.75-.3358-.75-.75 0-1.97509.934-3.64826 2.22755-4.81334.88055-.7931 1.9505-1.37217 3.05387-1.65822-.11043-.0376-.22261-.07252-.33631-.10464-1.50098-.42402-2.98649-.28172-3.84609.36302-.33136.24853-.80147.18139-1.05-.14998-.24854-.33136-.1814-.80146.14997-1.05 1.38041-1.03537 3.4149-1.0978 5.1539-.60654 1.67421.47295 3.33259 1.53108 4.06402 3.11319l.0038.00674c.035-.47081.0022-.96424-.0972-1.46029-.2603-1.29954-.95701-2.50156-1.90466-3.21238-.33135-.24854-.39848-.71865-.14994-1.050006.24855-.331356.71865-.398487 1.05001-.14994C10.8023 1.6197 11.6657 3.17263 11.9853 4.76795ZM7.99998 6.0001c-1.10457 0-2 .89543-2 2s.89543 2 2 2 2-.89543 2-2-.89543-2-2-2Z",fill:"currentColor"})})}try{rx.displayName||(rx.displayName="SpacesIcon")}catch{}let rv={list:"ServiceList-module__list--YDLyn",icon:"ServiceList-module__icon--iUANO"};function r_({toggleFloatingSidebar:e}){let t=(0,h.Pk)(),{activePlugin:n,selectedThreadID:a}=t,i=(0,u.qw)(),r=(0,e9.b)(),s=nr(),o=(0,ee.hH)(),l=async t=>{t.metaKey||t.ctrlKey||(t.preventDefault(),e(),await s({clearTopic:!0,includeThreads:!1}),(0,K.BI)("dotcom_chat.activate",{target:"SIDEBAR_CONVERSATION_NEW",mode:"immersive"}))},d=(t,n)=>{t.metaKey||t.ctrlKey||(e(),r.selectPlugin(n))};return(0,c.jsxs)("ul",{className:rv.list,children:[(0,c.jsx)(_.Vx,{"aria-current":a||n||o?void 0:"page",displayName:"Dashboard",href:m.Jz,icon:j.HomeIcon,id:"home",onLinkClick:l}),(0,et.BV)()&&(0,c.jsx)(_.Vx,{"aria-current":o?"page":void 0,displayName:"Spaces",expandOnClick:!1,hasItems:!1,href:m.VR,iconOverride:(0,c.jsx)(rx,{className:rv.icon,size:16}),id:"spaces",onLinkClick:()=>{e(),r.selectPlugin(null)}}),i.map(e=>void 0!==e.NavigationComponent?(0,c.jsx)(e.NavigationComponent,{chatState:t,onLinkClick:d},e.id):null)]})}try{r_.displayName||(r_.displayName="ServiceList")}catch{}let rb={container:"Sidebar-module__container--s585U",header:"Sidebar-module__header--uOLk8",sidebar:"Sidebar-module__sidebar--sn0TN",conversations:"Sidebar-module__conversations--NEO0w",quicklinks:"Sidebar-module__quicklinks--wbmcD",blankslateContainer:"Sidebar-module__blankslateContainer--Gvuc8",pinned:"Sidebar-module__pinned--e3Nsi",visible:"Sidebar-module__visible--d8dRm"};function rj({isVisible:e,isPinned:t,isFloating:n,onNewThread:a,onToggle:i}){let r=(0,h.Pk)(),{threads:s,selectedThreadID:o}=r,l=n?e:t,d=(0,e9.b)(),u=(0,F.useRef)(!1),g=nr(),f=t8(),{closePreviewPane:y}=(0,q.xx)(),x=(0,et.BV)(),v=p.W.immersiveServiceNavigation||x;(0,F.useEffect)(()=>{0!==s.size||u.current||(u.current=!0,d.fetchThreads())},[s,d,r]);let _=()=>{n&&e&&i()},b=()=>{_(),y()},C=(0,F.useRef)(null);(0,F.useEffect)(()=>{if(e&&n){let e=e=>{C.current&&!C.current.contains(e.target)&&i()};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}},[e,n,i]);let N=(0,F.useId)();return(0,c.jsxs)("aside",{"aria-labelledby":`${N}-copilot-navigation`,ref:C,className:(0,en.$)(rb.container,e&&rb.visible,t&&rb.pinned),children:[(0,c.jsxs)("div",{className:rb.header,children:[(0,c.jsx)("h2",{id:`${N}-copilot-navigation`,className:"sr-only",children:"Copilot navigation"}),(0,c.jsx)(M.K,{icon:l?j.SidebarExpandIcon:j.SidebarCollapseIcon,"aria-label":l?"Close conversations":"Open conversations",onClick:()=>{i(),l?(0,K.BI)("dotcom_chat.activate",{target:"SIDEBAR_EXPAND",mode:"immersive"}):(0,K.BI)("dotcom_chat.activate",{target:"SIDEBAR_COLLAPSE",mode:"immersive"})},variant:"default"}),(0,c.jsx)(M.K,{as:ro.N_,to:m.Jz,icon:ry,"aria-label":"New conversation",onClick:async e=>{e.metaKey||e.ctrlKey||(e.preventDefault(),_(),await g({clearTopic:!0,includeThreads:!1}),a(),(0,K.BI)("dotcom_chat.activate",{target:"SIDEBAR_CONVERSATION_NEW",mode:"immersive"}))},variant:"default"})]}),(0,c.jsx)("div",{className:rb.sidebar,children:(0,c.jsx)(er.t,{fallback:(0,c.jsx)(rC,{}),children:(0,c.jsxs)("div",{className:rb.conversations,children:[(0,c.jsxs)("nav",{"aria-labelledby":`${N}-quick-links`,className:rb.quicklinks,children:[(0,c.jsx)("h3",{id:`${N}-quick-links`,className:"sr-only",children:"Quick links"}),v&&(0,c.jsx)(r_,{toggleFloatingSidebar:b})]}),(0,c.jsx)(rh,{selectedItemID:f?null:o,loadingState:r.threadsLoading.state,onConversationSelect:b})]})})})]})}function rC(){return(0,c.jsx)("div",{className:rb.blankslateContainer,children:(0,c.jsx)(eg,{regionName:"The conversations menu"})})}try{rj.displayName||(rj.displayName="Sidebar")}catch{}try{rC.displayName||(rC.displayName="SidebarContentsFallback")}catch{}var rN=n(30631);let rw={container:"SpaceNotFoundComponent-module__container--hltG9",description:"SpaceNotFoundComponent-module__description--b8Rdv",banner:"SpaceNotFoundComponent-module__banner--ntKjI",icon:"SpaceNotFoundComponent-module__icon--hM9CP"},rI=({protectedOrganizations:e})=>(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:rw.container,children:[(0,c.jsx)(j.AlertIcon,{className:rw.icon}),(0,c.jsx)("h3",{children:"Space not found"}),(0,c.jsx)("p",{className:rw.description,children:"This URL may be incorrect, you're signed out of your organization, or the Space may have been deleted."}),(0,c.jsx)("div",{className:rw.banner,children:e&&(0,c.jsx)(e5.x,{protectedOrgs:e,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${encodeURIComponent(window.location.href)}`})})]})});try{rI.displayName||(rI.displayName="SpaceNotFoundComponent")}catch{}var rS=n(97665),rk=n(94747);function rT(e){switch(e.type){case"github_file":return{repository_id:e.repositoryId,file_path:e.filePath};case"free_text":return{text:e.text,name:e.name};case"github_issue":case"github_pull_request":return{repository_id:e.repositoryId,number:e.number};default:throw Error("Unsupported resource")}}let rA=e=>{let t=(0,e9.b)(),n=(0,rS.jE)(),{mutateAsync:a,...i}=(0,rk.n)({onSuccess:async()=>(e&&await n.invalidateQueries({queryKey:(0,i8.TP)(e)}),n.invalidateQueries({queryKey:i8.rt})),mutationFn:async n=>{let a=e?(0,ee.fn)(e):"/custom_copilots",i={custom_copilot:{owner_id:n.ownerId,owner_type:n.ownerType,name:n.name,icon_type:n.iconType,icon_color:n.iconColor,description:n.description,general_instructions:n.generalInstructions,resources_attributes:n.resources?.map(e=>({id:e.databaseId,resource_type:e.type,_destroy:e.markedForDestroy,metadata:rT(e)})),visibility:n.visibility}},r=await (0,A.lS)(a,{method:e?"PUT":"POST",body:i}),s=await r.json();if(!r.ok)throw s.errorMessages;return t.dispatch({type:"SET_CUSTOM_COPILOT",customCopilot:s}),s}});return{upsertCopilotSpace:a,...i}};function rE({onClose:e,copilotSpace:t}){let[n,a]=(0,F.useState)(t.generalInstructions??""),[i,r]=(0,F.useState)(void 0),{upsertCopilotSpace:s,isPending:o}=rA(t),l=async t=>{if(t?.preventDefault(),!(n.length>4e3)&&!o)try{await s({generalInstructions:n}),e()}catch(t){let e="An error occurred while saving the instructions.";t&&"object"==typeof t&&"general_instructions"in t&&(e=t.general_instructions),r(e)}};return(0,c.jsx)(ek.l,{width:"large",title:"Edit instructions",subtitle:"Describe the main responsibilities, limitations, and expertise areas of the Copilot. Include what tasks it should handle and which ones to avoid.",onClose:e,footerButtons:[{buttonType:"default",content:"Cancel",onClick:e},{buttonType:"primary",content:"Save",onClick:()=>void l(),loading:o,loadingAnnouncement:"Saving instructions"}],children:(0,c.jsx)(eS.tL,{commands:{"github:submit-form":void 0},children:(0,c.jsx)("form",{onSubmit:l,children:(0,c.jsxs)(nA.A,{children:[(0,c.jsx)(nA.A.Label,{visuallyHidden:!0,children:"General Instructions"}),(0,c.jsx)(D.Ay,{block:!0,resize:"vertical",rows:7,name:"generalInstructions",value:n,placeholder:"General instructions",validationStatus:i||n.length>4e3?"error":void 0,...(0,eb.G)("instructions-input"),onChange:e=>{a(e.target.value),r(void 0)}}),i?(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsx)("span",{...(0,eb.G)("error-message"),children:i})}):(0,c.jsx)(rR,{text:n,promptCharLimit:4e3})]})})})})}function rR({text:e,promptCharLimit:t}){let n=e.length>t,a=(0,c.jsxs)(c.Fragment,{children:[e.length.toLocaleString()," / ",t.toLocaleString()," characters"]});return n?(0,c.jsx)(nA.A.Validation,{variant:"error",children:a}):(0,c.jsx)(nA.A.Caption,{children:a})}try{rE.displayName||(rE.displayName="EditInstructionsDialog")}catch{}try{rR.displayName||(rR.displayName="CharacterCount")}catch{}var rP=n(8601),rD=n(79786);let rL=p.W.customCopilot128kWindow?288e3:144e3;function rM({onClose:e,copilotSpace:t,resource:n}){let[a,i]=(0,F.useState)(n?.name??""),[r,s]=(0,F.useState)(n?.text??""),[o,l]=(0,F.useState)(!1),d=n?.text??"",u=(0,F.useRef)(t.sizePercentage).current,[m,p]=(0,F.useState)({}),h=m.base&&m.base.startsWith("The size of the space exceeds the current limit"),{upsertCopilotSpace:g,isPending:f}=rA(t),y=async t=>{if(t?.preventDefault(),!f)try{await g({resources:[{id:Date.now().toString(),type:"free_text",name:a,text:r,markedForDestroy:!1,...n&&{id:n.id,databaseId:n.databaseId}}]}),e()}catch(e){p(e)}},x=!!n;return(0,c.jsx)(ek.l,{width:"large",title:x?"Edit a text file":"Add a text file",onClose:e,renderFooter:()=>(0,c.jsxs)(ek.l.Footer,{children:[(0,c.jsx)("div",{className:"d-flex flex-items-center",children:h?(0,c.jsx)(nA.A.Validation,{variant:"error",children:"The size of the space exceeds the current limit"}):null}),(0,c.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[(0,c.jsx)(e0.Q,{onClick:e,children:"Cancel"}),(0,c.jsx)(e0.Q,{variant:"primary",inactive:o,onClick:o?void 0:()=>void y(),loading:f,loadingAnnouncement:"Saving resource",children:x?"Save":"Add"})]})]}),children:(0,c.jsx)(eS.tL,{commands:{"github:submit-form":void 0},children:(0,c.jsx)("form",{onSubmit:y,children:(0,c.jsxs)(O.B,{children:[(0,c.jsxs)(nA.A,{required:!0,children:[(0,c.jsx)(nA.A.Label,{children:"Name"}),(0,c.jsx)(nE.A,{block:!0,placeholder:"Give the file a title",value:a,onChange:e=>{i(e.target.value),p(e=>({...e,"resources.name":""}))},maxLength:1e3,validationStatus:m["resources.name"]?"error":void 0}),m["resources.name"]&&(0,c.jsx)(nA.A.Validation,{variant:"error",children:m["resources.name"]})]}),(0,c.jsxs)(nA.A,{required:!0,children:[(0,c.jsx)(nA.A.Label,{children:"Content"}),(0,c.jsx)(D.Ay,{block:!0,rows:7,name:"content",value:r,placeholder:"Enter content here",onChange:e=>{s(e.target.value),p(e=>({...e,"resources.text":""}))}}),m["resources.text"]?(0,c.jsx)(nA.A.Validation,{variant:"error",children:m["resources.text"]}):(0,c.jsx)(rO,{text:r,percentage:u,resourceContent:d,setOverSpaceLimit:l})]})]})})})})}function rO({text:e,percentage:t,resourceContent:n,setOverSpaceLimit:a}){let i=t/100*rL+(e.length>n.length?Math.abs(e.length-n.length):-Math.abs(e.length-n.length)),r=Math.round(i/rL*100);return i>rL?(a(!0),(0,c.jsx)(nA.A.Validation,{variant:"error",children:`Total percent used: ${r}%`})):(a(!1),(0,c.jsx)(nA.A.Caption,{children:`Total percent used: ${r}%`}))}try{rM.displayName||(rM.displayName="TextFileDialog")}catch{}try{rO.displayName||(rO.displayName="CharacterCount")}catch{}let rB=({children:e,copilotSpace:t,findFileWorkerPath:n})=>{let[a,i]=(0,F.useState)(!1),[r,s]=(0,F.useState)(!1),{upsertCopilotSpace:o}=rA(t),l=async e=>{await o({resources:e.map(e=>({...e,fileExists:!0,markedForDestroy:!1}))}),s(!1)},d=(0,F.useRef)(null);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ec.W,{anchorRef:d,children:[(0,c.jsx)(ec.W.Anchor,{children:e}),(0,c.jsx)(ec.W.Overlay,{width:"small",children:(0,c.jsxs)(ed.l,{children:[(0,c.jsxs)(ed.l.Item,{onSelect:()=>{s(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.FileCodeIcon,{})}),"Add files, folders..."]}),(0,c.jsxs)(ed.l.Item,{onSelect:()=>{i(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PlusIcon,{})}),"Add a text file"]})]})})]}),a&&(0,c.jsx)(rM,{copilotSpace:t,onClose:()=>i(!1)}),r&&(0,c.jsx)(rD.Q,{formData:[],onCancel:()=>{s(!1)},onSave:l,findFileWorkerPath:n,attachmentButtonRef:d,openRepoPanel:!0,owner:t.ownerIsOrg?t.owner:void 0})]})};try{rB.displayName||(rB.displayName="AddReferenceMenu")}catch{}var rF=n(5796),r$=n(6020);let rU={warningIcon:"ReferencesTable-module__warningIcon--aAwMb",referenceTitle:"ReferencesTable-module__referenceTitle--RAQOR"};function rz(e,t){return Object.values(e.reduce((e,n)=>{let a=t(n);return{...e,[a]:n}},{}))}function rV({copilotSpace:e}){let{upsertCopilotSpace:t}=rA(e),n=!p.W.customCopilotOrgOwned||e.editable;async function a(e){await t({resources:[{...e,markedForDestroy:!0}]})}let i=(0,F.useMemo)(()=>rz(e.resources,rH),[e.resources]);return(0,c.jsx)(nX.X.Container,{children:(0,c.jsx)(nY.b,{"aria-labelledby":"references-title",cellPadding:"normal",data:i,columns:[{id:"id",header:"Name",rowHeader:!0,renderCell:e=>{switch(e.type){case"github_file":{let t=e.filePath.split("/"),n=t.pop(),a=[e.nwo,...t].join("/"),i=e.nwo.split("/"),r=e.fileExists&&e.commitish?(0,rF.IO9)({repo:{ownerLogin:i[0],name:i[1]},commitish:e.commitish,action:"blob",path:e.filePath}):void 0;return(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"normal",children:[(0,c.jsx)("span",{className:"fgColor-muted",children:(0,c.jsx)(j.FileIcon,{size:16})}),(0,c.jsxs)(O.B,{gap:"none",children:[(0,c.jsx)("div",{children:e.fileExists?(0,c.jsx)(rN.A,{title:n,className:(0,en.$)(rU.referenceTitle,"f5 text-normal"),children:(0,c.jsx)(em.A,{rel:"noopener",target:"_blank",href:r,children:n})}):(0,c.jsx)(rN.A,{title:n,className:(0,en.$)(rU.referenceTitle,"f5 text-normal"),children:n})}),(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:a,className:(0,en.$)(rU.referenceTitle,"fgColor-muted"),children:a})})]})]})}case"free_text":return(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"normal",children:[(0,c.jsx)("span",{className:"fgColor-muted",children:(0,c.jsx)(j.FileIcon,{size:16})}),(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:e.name,maxWidth:300,className:(0,en.$)(rU.referenceTitle,"f5 text-normal"),children:e.name})})]});case"github_pull_request":case"github_issue":return(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"normal",children:[(0,c.jsx)("span",{className:"fgColor-muted",children:(0,c.jsx)(j.IssueOpenedIcon,{size:16})}),(0,c.jsxs)(O.B,{gap:"none",children:[(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:e.title||"",maxWidth:300,className:(0,en.$)(rU.referenceTitle,"f5 text-normal"),children:(0,c.jsx)(em.A,{rel:"noopener",target:"_blank",href:e.url,children:e.title})})}),(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:e.nwo||"",className:(0,en.$)(rU.referenceTitle,"fgColor-muted"),children:e.nwo})})]})]});default:return null}}},{id:"size",header:"Size",align:"end",maxWidth:"auto",width:"growCollapse",renderCell:e=>(0,c.jsx)("span",{className:"fgColor-muted",children:e.sizePercentage&&e.sizePercentage<1?"<1%":`${Math.round(e.sizePercentage||0)}%`})},{id:"actions",header:()=>(0,c.jsx)(r$.s,{children:"Actions"}),maxWidth:"auto",align:"end",renderCell:t=>{let i="github_file"===t.type&&!t.fileExists;return(0,c.jsxs)(c.Fragment,{children:[i&&(0,c.jsx)(M.K,{className:rU.warningIcon,icon:j.AlertIcon,variant:"invisible",size:"small","aria-label":"This file no longer exists"}),n&&(0,c.jsx)(rW,{copilotSpace:e,row:t,onEdit:()=>{},onDelete:a})]})}}]})})}let rW=({copilotSpace:e,row:t,onDelete:n})=>{let[a,i]=(0,F.useState)(null);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ec.W,{children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{"aria-label":"Resource actions",title:"Resource actions",icon:j.KebabHorizontalIcon,variant:"invisible"})}),(0,c.jsx)(ec.W.Overlay,{children:(0,c.jsxs)(ed.l,{children:["free_text"===t.type&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(ed.l.Item,{onSelect:()=>i(t),children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PencilIcon,{})}),"Edit"]})}),(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:()=>{n(t)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.TrashIcon,{})}),"Delete"]})]})})]}),a&&(0,c.jsx)(rM,{copilotSpace:e,resource:a,onClose:()=>{i(null)}})]})},rH=e=>"github_file"===e.type?`${e.repositoryId}@${e.filePath}`:e.id;try{rV.displayName||(rV.displayName="ReferencesTable")}catch{}try{rW.displayName||(rW.displayName="RowActions")}catch{}let rq={details:"SpaceHomePageDetails-module__details--HzLa5",left:"SpaceHomePageDetails-module__left--rKaKZ",right:"SpaceHomePageDetails-module__right--JjPv5",emptyText:"SpaceHomePageDetails-module__emptyText--M2tmQ",instructions:"SpaceHomePageDetails-module__instructions--hChUu",references:"SpaceHomePageDetails-module__references--YHEv1",instructionsLockup:"SpaceHomePageDetails-module__instructionsLockup--wnzoa",referencesLockup:"SpaceHomePageDetails-module__referencesLockup--cXs2l",conversationsLockup:"SpaceHomePageDetails-module__conversationsLockup--_Kl0j",instructionsTitle:"SpaceHomePageDetails-module__instructionsTitle--cK6Qu",referencesTitle:"SpaceHomePageDetails-module__referencesTitle--d2cWi",conversationsTitle:"SpaceHomePageDetails-module__conversationsTitle--vbBGh",instructionsText:"SpaceHomePageDetails-module__instructionsText--Q2xUD",conversationsText:"SpaceHomePageDetails-module__conversationsText--bSR7l",referencesText:"SpaceHomePageDetails-module__referencesText--LDg6x",referencesSizeProgressBar:"SpaceHomePageDetails-module__referencesSizeProgressBar--LN0LZ",referencesSizeText:"SpaceHomePageDetails-module__referencesSizeText--jYyml",conversations:"SpaceHomePageDetails-module__conversations--xVIB6"},rG=({currentSpace:e,state:t,manager:n,customCopilotId:a,setShowEditInstructionsDialog:i,referenceSizeExceeded:r})=>{let{threads:s,findFileWorkerPath:o}=t,l=(0,k.Z)(),d=!p.W.customCopilotOrgOwned||e.editable,u=(0,F.useMemo)(()=>{!function(e){let t=ru();if(t){let n=e.get(t.threadID);n&&(Date.parse(n.updatedAt)<=t.updatedAt?n.updatedAt=new Date(t.updatedAt).toJSON():rm())}}(s);let t=new Map(Array.from(s.entries()).filter(([,t])=>t.customCopilotOwner?t.customCopilotOwner===a.owner&&t.customCopilotID===a.id:t.customCopilotID===e.oldId));return n.sortThreads(t).map(e=>({id:e.id,text:(0,m.CB)(e),href:`${m.Jz}/c/${e.id}`,date:new Date(e.updatedAt)}))},[s,a,n,e.oldId]);return(0,c.jsxs)("div",{className:rq.details,children:[(0,c.jsxs)("div",{className:rq.left,children:[(0,c.jsxs)("div",{className:rq.instructions,children:[(0,c.jsxs)("div",{className:rq.instructionsLockup,children:[(0,c.jsx)("h2",{className:rq.instructionsTitle,children:"Instructions"}),d&&(0,c.jsx)(e0.Q,{size:"medium",onClick:()=>i(!0),children:"Edit"})]}),e.generalInstructions?(0,c.jsx)("p",{className:rq.instructionsText,children:e.generalInstructions}):(0,c.jsx)("p",{className:rq.emptyText,children:"No instructions added"})]}),(0,c.jsxs)("div",{className:rq.references,children:[(0,c.jsx)("div",{id:"references-title",children:(0,c.jsxs)("div",{className:rq.referencesLockup,children:[(0,c.jsx)("h2",{className:rq.referencesTitle,children:"References"}),e.sizePercentage>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(rP.z,{inline:!0,barSize:"small",progress:e.sizePercentage,className:rq.referencesSizeProgressBar}),(0,c.jsxs)("span",{className:rq.referencesSizeText,children:[e.sizePercentage<1?"<1":Math.round(e.sizePercentage),"%"]})]}),d&&(0,c.jsx)(rB,{copilotSpace:e,findFileWorkerPath:o,children:(0,c.jsx)(e0.Q,{size:"medium",children:"Add"})})]})}),r&&(0,c.jsx)(rt,{}),e.resources?.length>0?(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(rV,{copilotSpace:e})}):(0,c.jsx)("p",{className:rq.referencesText,children:"No references added"})]})]}),(0,c.jsx)("div",{className:rq.right,children:(0,c.jsx)("div",{className:rq.conversations,children:(0,c.jsxs)("div",{className:rq.conversationsLockup,children:[(0,c.jsx)("h2",{className:rq.conversationsTitle,children:"Conversations"}),u.length>0?(0,c.jsx)(ed.l,{variant:"full",children:u.map(e=>(0,c.jsxs)(ed.l.LinkItem,{href:e.href,onClick:t=>{t.preventDefault(),l(e.href)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.CommentIcon,{})}),e.text]},e.id))}):(0,c.jsx)("p",{className:rq.conversationsText,children:"No conversations yet"})]})})})]})};try{rG.displayName||(rG.displayName="SpaceHomePageDetails")}catch{}let rK={container:"SpaceHomePageState-module__container--U1I3l",title:"SpaceHomePageState-module__title--j3DVO",description:"SpaceHomePageState-module__description--DU0xQ"},rQ="DependabotIcon",rJ="blue",rZ={BeakerIcon:j.BeakerIcon,BookIcon:j.BookIcon,BroadcastIcon:j.BroadcastIcon,CloudIcon:j.CloudIcon,CodeIcon:j.CodeIcon,DatabaseIcon:j.DatabaseIcon,DependabotIcon:j.DependabotIcon,HubotIcon:j.HubotIcon,OrganizationIcon:j.OrganizationIcon,PlusIcon:j.PlusIcon,ProjectRoadmapIcon:j.ProjectRoadmapIcon,TelescopeIcon:j.TelescopeIcon,TerminalIcon:j.TerminalIcon},rX=Object.keys(rZ),rY=["auburn","blue","brown","coral","cyan","gray","green","indigo","lemon","lime","olive","orange","pine","pink","plum","purple","red","teal","yellow"],r0=e=>rY.find(t=>t===e)??rJ,r1={container:"SpacesAvatar-module__container--zJJUl",auburn:"SpacesAvatar-module__auburn--CIKFA",blue:"SpacesAvatar-module__blue--csQQ0",brown:"SpacesAvatar-module__brown--n04yP",coral:"SpacesAvatar-module__coral--_ML4p",cyan:"SpacesAvatar-module__cyan--o0MwN",gray:"SpacesAvatar-module__gray--vvb1W",green:"SpacesAvatar-module__green--Ro4IV",indigo:"SpacesAvatar-module__indigo--_0T4q",lemon:"SpacesAvatar-module__lemon--gsHE8",lime:"SpacesAvatar-module__lime--vRdDX",olive:"SpacesAvatar-module__olive--G1neu",orange:"SpacesAvatar-module__orange--FmpCu",pine:"SpacesAvatar-module__pine--jFhFP",pink:"SpacesAvatar-module__pink--vHHwu",plum:"SpacesAvatar-module__plum--M6SF6",purple:"SpacesAvatar-module__purple--_4Sak",red:"SpacesAvatar-module__red--IUpfe",teal:"SpacesAvatar-module__teal--q0AMo",yellow:"SpacesAvatar-module__yellow--DdvtA"},r2={auburn:r1.auburn,blue:r1.blue,brown:r1.brown,coral:r1.coral,cyan:r1.cyan,gray:r1.gray,green:r1.green,indigo:r1.indigo,lemon:r1.lemon,lime:r1.lime,olive:r1.olive,orange:r1.orange,pine:r1.pine,pink:r1.pink,plum:r1.plum,purple:r1.purple,red:r1.red,teal:r1.teal,yellow:r1.yellow};function r5({icon:e,color:t,size:n=16}){let{SpaceIcon:a,spaceColor:i}=(0,F.useMemo)(()=>({SpaceIcon:e&&e in rZ!=!1?rZ[e]:rZ[rQ],spaceColor:r0(t)}),[e,t]);return(0,c.jsx)("div",{style:{"--custom-size":`var(--base-size-${2*n})`},className:(0,en.$)(r1.container,r2[i]),children:(0,c.jsx)(a,{size:n})})}try{r5.displayName||(r5.displayName="SpacesAvatar")}catch{}function r3(e){return void 0!==e.id}let r4=e=>{let{selectedThreadID:t,textAreaRef:n,onSubmit:a,customCopilotId:i}=e,r=(0,e9.b)(),s=(0,h.Pk)(),o=nr(),{isPending:l,data:d,error:u}=(0,et.TB)(i);(0,F.useEffect)(()=>{d&&r3(d)&&r.dispatch({type:"SET_CUSTOM_COPILOT",customCopilot:d}),r.clearCurrentReferences(["image"])},[d,r]);let[m,p]=(0,F.useState)(!1);if(u instanceof et.Be)return(0,c.jsx)(rI,{});if(l||!d)return(0,c.jsx)(iw,{});let g=!!r3(d)&&(0,ee.Hh)(d);return(0,c.jsx)(c.Fragment,{children:r3(d)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:rK.container,children:[(0,c.jsx)(r5,{icon:d.iconType,color:d.iconColor}),(0,c.jsx)("h1",{className:rK.title,children:(0,c.jsx)(rN.A,{title:d.name,maxWidth:"100%",children:d.name})}),d.description&&(0,c.jsx)("p",{className:rK.description,children:d.description}),(0,c.jsx)("div",{className:"width-full",children:(0,c.jsx)(na.V,{customCopilotId:i,textAreaRef:n,onSubmit:a,isStreaming:!!s.streamingMessage,size:"small",hideAttachmentButton:!0,disabled:g,showModelPicker:!0,onNewThreadSelected:o},t)}),(0,c.jsx)(rG,{currentSpace:d,state:s,manager:r,customCopilotId:i,setShowEditInstructionsDialog:p,referenceSizeExceeded:g})]}),m&&(0,c.jsx)(rE,{copilotSpace:d,onClose:()=>p(!1)})]}):(0,c.jsx)(rI,{protectedOrganizations:d.protectedOrganizations})})};try{r4.displayName||(r4.displayName="SpaceHomePageState")}catch{}var r6=n(6869);function r7(e){let{closeDialog:t}=e,[n,a]=(0,F.useState)({});return(0,c.jsxs)(ek.l,{renderFooter:()=>(0,c.jsx)(st,{...e}),title:"Share space",onClose:t,width:"large",children:[n.base||n.visibility?(0,c.jsx)(B.l,{hideTitle:!0,title:"Unable to update space visibility",description:n.visibility||n.base,"aria-label":"Critical",variant:"critical"}):null,(0,c.jsxs)(O.B,{"data-testid":"custom-copilot-visibility",gap:"condensed",children:[(0,c.jsx)(O.B,{direction:"horizontal",gap:"condensed",align:"start",children:"This space may contain private content. Viewers must have have access to all referenced content."}),(0,c.jsxs)(O.B,{direction:"vertical",gap:"condensed",align:"start",children:[(0,c.jsx)("p",{className:"text-bold mt-2 mb-0",children:"Change the base role"}),(0,c.jsx)(r8,{onError:a,...e})]})]})]})}function r8({customCopilotId:e,onError:t}){let{customCopilots:n}=(0,h.Pk)(),a=n?.find(t=>ee.UG(t,e));return a?(0,c.jsx)("div",{className:"border rounded-2 width-full",children:(0,c.jsx)(ed.l,{role:"list",showDividers:!0,className:"py-1",children:(0,c.jsxs)(ed.l.Item,{role:"listitem",children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(a8.r,{src:a.ownerAvatar})}),(0,c.jsxs)("div",{className:"d-flex",children:[(0,c.jsxs)("div",{className:"flex-auto",children:[(0,c.jsx)("b",{className:"mr-2",children:a.ownerDisplayName}),(0,c.jsx)("span",{className:"text-light text-small",children:"Owner"})]}),(0,c.jsx)(se,{onError:t,copilotSpace:a,visibility:a.visibility})]})]})})}):null}let r9=[{text:"Only you can access",value:"private"},{text:"The entire organization can access",value:"org_public"}];function se({copilotSpace:e,visibility:t,onError:n}){let a=(0,e9.b)(),[i,r]=(0,F.useState)(!1),[s,o]=(0,F.useState)(!1),l=(0,F.useRef)(null),d=r9.find(e=>e.value===t);async function u(t){if(!s){o(!0);try{let i=(0,ee.fn)(e),r=await (0,A.lS)(i,{method:"PUT",body:{custom_copilot:{visibility:t}}});if(r.ok){let e=await r.json();a.dispatch({type:"SET_CUSTOM_COPILOT",customCopilot:e})}else{let e=await r.json();e.errorMessages?n(e.errorMessages):n({base:e.error})}}catch{n({base:"An error occurred while creating your space"})}finally{o(!1),r(!1)}}}return e.editable?(0,c.jsxs)(ec.W,{onOpenChange:r,anchorRef:l,open:i,children:[(0,c.jsxs)(em.A,{muted:!0,className:"text-small text-light",ref:l,onClick:()=>r(!0),children:[(0,c.jsx)(rN.A,{title:d?.text||"",inline:!0,className:"mr-1",children:d?.text}),(0,c.jsx)(j.TriangleDownIcon,{size:15})]}),(0,c.jsx)(ec.W.Overlay,{width:"medium",children:(0,c.jsx)(ed.l,{selectionVariant:"single",children:r9.map(e=>(0,c.jsx)(ed.l.Item,{selected:e.value===d?.value,onSelect:()=>u(e.value),children:(0,c.jsx)("span",{className:"text-small",children:e.text})},e.value))})})]}):(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:d?.text||"",className:"text-small text-light",children:d?.text})})}function st({customCopilotId:e}){let[t,n]=(0,F.useState)(!1),a=(0,F.useRef)(null),i=b.fV.origin,{id:r,owner:s}=e,o=(0,F.useMemo)(()=>s?`${i}${m.VR}/${s}/${r}`:`${i}${m.VR}/${r}`,[i,s,r]);return(0,c.jsx)(ek.l.Footer,{children:(0,c.jsx)(O.B,{direction:"horizontal",gap:"condensed",align:"start",justify:"end",children:t?(0,c.jsx)(e0.Q,{leadingVisual:j.CheckIcon,variant:"primary",children:"Copied!"}):(0,c.jsx)(e0.Q,{leadingVisual:j.LinkIcon,variant:"primary",onClick:()=>{(0,nD.D)(o),n(!0),a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{n(!1),a.current=null},2e3)},children:"Copy link"})})})}try{r7.displayName||(r7.displayName="CopilotSpaceVisibilityDialog")}catch{}try{r8.displayName||(r8.displayName="VisibilitySettings")}catch{}try{se.displayName||(se.displayName="VisibilitySelect")}catch{}try{st.displayName||(st.displayName="CopilotSpaceVisibilityDialogFooter")}catch{}let sn={avatarContainer:"SpacesFormDialog-module__avatarContainer--mWqaR",avatarContainerButton:"SpacesFormDialog-module__avatarContainerButton--SKRWC",footerContainer:"SpacesFormDialog-module__footerContainer--Ir0LP"};function sa({onSelect:e}){let[t,n]=(0,F.useState)([]),[a,i]=(0,F.useState)(!1),[r,s]=(0,F.useState)(void 0),o=t=>{s(t),e(t)};(0,F.useEffect)(()=>{(async()=>{try{let e=await (0,A.lS)("/github-copilot/chat/custom_copilots_owners"),t=await e.json(),a=t?.owners;if(!e.ok||!a){l();return}n(a),a[0]&&o(a[0])}catch{l()}})()},[]);let l=()=>{n([]),i(!0)};return(0,c.jsxs)(nA.A,{required:!0,children:[(0,c.jsx)(nA.A.Label,{children:"Owner"}),(0,c.jsxs)(ec.W,{children:[(()=>{let e=r?.name||"Choose an owner",t=r?(0,c.jsx)(a8.r,{src:r.avatarUrl},r.avatarUrl):void 0;return(0,c.jsx)(ec.W.Button,{"data-testid":"owner-dropdown-anchor",block:!0,alignContent:"start","aria-label":e,leadingVisual:t,children:e})})(),(0,c.jsx)(ec.W.Overlay,{responsiveVariant:"fullscreen",width:"large",maxHeight:"large",sx:{overflow:"auto"},children:(0,c.jsx)(ed.l,{showDividers:!0,children:(0,c.jsx)(ed.l.Group,{sx:{maxHeight:350,overflow:"auto"},children:(0,c.jsxs)(ed.l,{selectionVariant:"single",children:[t&&t.map(e=>{let{name:t,avatarUrl:n,displayName:a}=e;return(0,c.jsxs)(ed.l.Item,{selected:t===r?.name,onSelect:()=>o(e),children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(a8.r,{src:n})}),t,(0,c.jsx)(ed.l.Description,{children:a})]},t)}),!t.length&&!a&&(0,c.jsx)(ed.l.Item,{disabled:!0,children:"Fetching owners\u2026"},"fetching-owners"),a&&(0,c.jsx)(ed.l.Item,{disabled:!0,sx:{color:"danger.fg"},children:"An error occurred while loading owners. Please reopen the dialog to try again."},"error-fetching-owners")]})})})})]})]})}try{sa.displayName||(sa.displayName="SpacesOwnerDropdown")}catch{}function si(){return{icon:rX[Math.floor(Math.random()*rX.length)],color:rY[Math.floor(Math.random()*rY.length)]}}function sr({onClose:e,copilotSpaceId:t}){let n=(0,ea.Zp)(),{isLoading:a,data:i}=(0,et.CF)(!0),r=(0,ee.JB)(i,t),s=p.W.customCopilotOrgOwned,[o,l]=(0,F.useState)(r?.name??""),[d,u]=(0,F.useState)(r?.description??""),[m,h]=(0,F.useState)({}),[g,f]=(0,F.useState)(null),[y,x]=(0,F.useState)(()=>r?{icon:r.iconType??rQ,color:r.iconColor??rJ}:si()),{upsertCopilotSpace:v,isPending:_}=rA(r),b=async()=>{if(_)return;let t={name:o,description:d,iconType:y.icon,iconColor:y.color};s&&g&&!r&&(t.ownerId=g.id,t.ownerType=g.type);try{let a=await v(t);if(h({}),!r&&a){let e=(0,ee.Cb)(a);return n(e)}e()}catch(e){h(e??{})}},C=e=>{e?.preventDefault(),b()},N=!!r;return a||!i?null:(0,c.jsx)(ek.l,{title:N?"Edit space":"Create new space",onClose:e,width:"large",renderFooter:()=>(0,c.jsxs)("div",{className:sn.footerContainer,children:[(0,c.jsx)(e0.Q,{variant:"default",onClick:e,children:"Cancel"}),(0,c.jsx)(e0.Q,{loading:_,loadingAnnouncement:N?"Saving space":"Creating space",variant:"primary",onClick:()=>b(),children:N?"Save":"Create"})]}),children:(0,c.jsx)(eS.tL,{commands:{"github:submit-form":()=>C()},children:(0,c.jsx)("form",{onSubmit:C,children:(0,c.jsxs)(O.B,{children:[Object.keys(m).length>0&&(0,c.jsx)(B.l,{title:"Failed to save this Copilot Space",description:m.base,variant:"critical",className:"mb-2"}),(0,c.jsxs)(O.B,{direction:"horizontal",align:"end",children:[(0,c.jsxs)(nA.A,{className:"flex-auto",children:[(0,c.jsx)(nA.A.Label,{required:!0,children:"Name"}),(0,c.jsx)(nE.A,{block:!0,name:"space name",value:o,placeholder:"Enter name",onChange:e=>{if(l(e.target.value),m.name||m.slug){let e={...m};delete e.name,delete e.slug,h(e)}}}),m.slug&&(m.name?(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsxs)("span",{children:["Name ",m.name]})}):(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsx)("span",{children:ee.j0})}))]}),(0,c.jsxs)("div",{className:sn.avatarContainer,children:[(0,c.jsx)(r5,{...y}),(0,c.jsx)(M.K,{icon:j.ArrowSwitchIcon,size:"medium",variant:"default",onClick:()=>x(si()),"aria-labelledby":"Change avatar",className:sn.avatarContainerButton})]})]}),!r&&(0,c.jsx)(sa,{onSelect:f}),(0,c.jsxs)(nA.A,{children:[(0,c.jsx)(nA.A.Label,{children:"Description"}),(0,c.jsx)(ss,{text:d,promptCharLimit:1e3}),(0,c.jsx)(D.Ay,{block:!0,resize:"vertical",rows:3,name:"description","aria-label":"Description",value:d,placeholder:"Describe the purpose of this space.",onChange:e=>{if(u(e.target.value),m.description){let e={...m};delete e.description,h(e)}}}),m.description&&(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsxs)("span",{children:["Description ",m.description]})})]})]})})})})}function ss({text:e,promptCharLimit:t}){let n=e.length>t,a=(0,c.jsxs)(c.Fragment,{children:[e.length.toLocaleString()," / ",t.toLocaleString()," characters"]});return(0,c.jsx)(c.Fragment,{children:n?(0,c.jsx)(nA.A.Validation,{variant:"error",children:a}):(0,c.jsx)(nA.A.Caption,{children:a})})}try{sr.displayName||(sr.displayName="SpacesFormDialog")}catch{}try{ss.displayName||(ss.displayName="CharacterCount")}catch{}let so={spaceVisibilityDialog:"SpaceVisibilityDialog-module__spaceVisibilityDialog--LUdcG",copyLinkSection:"SpaceVisibilityDialog-module__copyLinkSection--HCOb8",copyLinkButtonContainer:"SpaceVisibilityDialog-module__copyLinkButtonContainer--k5Tbn",copyLinkButton:"SpaceVisibilityDialog-module__copyLinkButton--C9iVh",copiedLinkButton:"SpaceVisibilityDialog-module__copiedLinkButton--p3bFD",dialogFooterText:"SpaceVisibilityDialog-module__dialogFooterText--Y6T6a",errorBanner:"SpaceVisibilityDialog-module__errorBanner--ci3oJ"};function sl(e){let{closeDialog:t}=e,[n,a]=(0,F.useState)({}),[i,r]=(0,F.useState)(!1),s=(0,F.useRef)(null);(0,F.useEffect)(()=>()=>{s.current&&(clearTimeout(s.current),s.current=null)},[]);let o=(0,F.useMemo)(()=>`${b.fV.origin}${(0,ee.Cb)(e.customCopilotId)}`,[e.customCopilotId]);return(0,c.jsxs)(ek.l,{title:"Share this space",renderFooter:()=>(0,c.jsx)(sm,{}),onClose:t,className:so.spaceVisibilityDialog,width:"large",children:[n.base||n.visibility?(0,c.jsx)(B.l,{hideTitle:!0,title:"Unable to update space visibility",description:n.visibility||n.base,"aria-label":"Critical",variant:"critical",className:so.errorBanner}):null,(0,c.jsxs)(O.B,{"data-testid":"custom-copilot-visibility",gap:"condensed",children:[(0,c.jsxs)(O.B,{direction:"vertical",gap:"condensed",align:"start",children:[(0,c.jsx)("span",{className:"text-small text-bold color-fg-muted mb-1",children:"Link"}),(0,c.jsxs)("div",{className:so.copyLinkSection,children:[(0,c.jsx)(nE.A,{block:!0,value:o,readOnly:!0,className:"color-fg-muted"}),(0,c.jsxs)("div",{style:{position:"relative"},className:so.copyLinkButtonContainer,children:[(0,c.jsx)(e0.Q,{className:so.copyLinkButton,leadingVisual:j.LinkIcon,variant:"default",onClick:()=>{(0,nD.D)(o),r(!0),s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{r(!1),s.current=null},2e3)},style:{visibility:i?"hidden":"visible"},tabIndex:i?-1:1,"aria-hidden":i?"true":"false",children:"Copy link"}),i&&(0,c.jsx)(e0.Q,{variant:"default",className:so.copiedLinkButton,tabIndex:-1,"aria-hidden":"false",children:"Link copied"})]})]})]}),(0,c.jsxs)(O.B,{direction:"vertical",gap:"condensed",align:"start",children:[(0,c.jsx)("span",{className:"text-small text-bold color-fg-muted mt-2",children:"Base role"}),(0,c.jsx)(sc,{onError:a,...e})]})]})]})}function sc({customCopilotId:e,onError:t}){let{data:n,isLoading:a}=(0,et.CF)(!0),i=n?.find(t=>ee.UG(t,e)),{data:r,isLoading:s,error:o}=(0,et.Tx)(e.owner||"",e.id);if((0,F.useEffect)(()=>{a||s||i&&r||t({visibility:"Could not load your space's visibility settings"})},[a,s,i,r,t]),a)return(0,c.jsx)("div",{className:"color-fg-muted p-2",children:"Loading space information..."});if(!i)return(0,c.jsx)("div",{className:"color-fg-muted p-2",children:"Could not load data for your space."});let l=e.owner,d=r?.memberCount;return(0,c.jsxs)("div",{className:"width-full d-flex flex-items-center flex-justify-between",children:[(0,c.jsxs)("div",{className:"d-flex flex-items-center mt-1",children:[(0,c.jsx)(a8.r,{src:i.ownerAvatar,className:"mr-2",square:!0,size:32}),(0,c.jsxs)("div",{className:"d-flex flex-column",children:[(0,c.jsxs)("span",{className:"ml-1",children:[(0,c.jsx)(rN.A,{maxWidth:"230px",title:i.ownerDisplayName,inline:!0,children:(0,c.jsx)("b",{children:i.ownerDisplayName})}),(0,c.jsx)("span",{className:"color-fg-muted ml-1",children:"(owner)"})]}),l&&(0,c.jsxs)(c.Fragment,{children:[!s&&null!==d&&(0,c.jsxs)("span",{className:"text-small color-fg-muted ml-1",children:[d," ",1===d?"person":"people"]}),(s||o||null===d)&&(0,c.jsx)("span",{className:"text-small color-fg-muted ml-1",children:"Organization"})]})]})]}),(0,c.jsx)(su,{onError:t,copilotSpace:i,visibility:i.visibility})]})}let sd=[{text:"No access",value:"private"},{text:"Read",value:"org_public"}];function su({copilotSpace:e,visibility:t,onError:n}){let[a,i]=(0,F.useState)(!1),r=(0,F.useRef)(null),s=sd.find(e=>e.value===t),{upsertCopilotSpace:o,isPending:l}=rA(e);async function d(e){if(!l)try{await o({visibility:e})}catch{n({base:"An error occurred while updating your space's visibility."})}finally{i(!1)}}return e.editable?(0,c.jsxs)(ec.W,{onOpenChange:i,anchorRef:r,open:a,children:[(0,c.jsx)(ec.W.Button,{loading:l,variant:"invisible",className:"text-small",ref:r,onClick:()=>i(!0),children:(0,c.jsx)(rN.A,{title:s?.text||"",inline:!0,className:"mr-1",children:s?.text})}),(0,c.jsx)(ec.W.Overlay,{side:"outside-bottom",align:"end",children:(0,c.jsx)(ed.l,{selectionVariant:"single",children:sd.map(e=>(0,c.jsx)(ed.l.Item,{selected:e.value===s?.value,onSelect:()=>d(e.value),children:(0,c.jsx)("span",{className:"text-small",children:e.text})},e.value))})})]}):(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:s?.text||"",className:"text-small text-light",children:s?.text})})}function sm(){return(0,c.jsx)(ek.l.Footer,{style:{backgroundColor:"var(--bgColor-muted)",borderBottomLeftRadius:"var(--borderRadius-large, 0.75rem)",borderBottomRightRadius:"var(--borderRadius-large, 0.75rem)"},className:"color-fg-muted flex-justify-center text-small p-2",children:(0,c.jsx)("span",{className:so.dialogFooterText,children:"This space may include private content. Viewers need content access."})})}try{sl.displayName||(sl.displayName="SpaceVisibilityDialog")}catch{}try{sc.displayName||(sc.displayName="VisibilitySettings")}catch{}try{su.displayName||(su.displayName="VisibilitySelect")}catch{}try{sm.displayName||(sm.displayName="CopilotSpaceVisibilityDialogFooter")}catch{}function sp({onDelete:e,copilot:t}){let[n,a]=(0,F.useState)(null),[i,r]=(0,F.useState)(!1),s=(0,F.useRef)(null),o=(0,ea.Zp)(),[l,d]=(0,F.useState)(!1),u=p.W.customCopilotVisibility&&t.ownerIsOrg,m=!p.W.customCopilotOrgOwned||t.editable,h=()=>{(0,nS.flushSync)(()=>a(null)),s.current?.focus()},g=()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_SHARE_DIALOG_CLOSE",mode:"immersive"}),h()},f=async e=>{h(),r(!0),await e(),r(!1)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ec.W,{anchorRef:s,children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{loading:i,icon:j.KebabHorizontalIcon,"aria-label":"Manage space",variant:"invisible",onClick:()=>(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU",mode:"immersive"})})}),(0,c.jsx)(ec.W.Overlay,{side:"outside-bottom",align:"end",children:(0,c.jsxs)(ed.l,{children:[m&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU_EDIT",mode:"immersive"}),p.W.customCopilotsRedesign?o((0,ee.GL)(t)):d(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PencilIcon,{})}),"Edit"]}),u&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU_SHARE",mode:"immersive"}),a("share")},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.ShareIcon,{})}),"Share"]}),m&&(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU_DELETE",mode:"immersive"}),a("delete")},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.TrashIcon,{})}),"Delete"]})]})})]}),"delete"===n?(0,c.jsx)(sh,{onCancel:h,onConfirm:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_LIST_ACTION_DELETE",mode:"immersive"}),f(e)}}):null,"share"===n?p.W.customCopilotsRedesign?(0,c.jsx)(sl,{closeDialog:g,customCopilotId:t}):(0,c.jsx)(r7,{closeDialog:g,customCopilotId:t}):null,l&&(0,c.jsx)(sr,{copilotSpaceId:t,onClose:()=>{d(!1)}})]})}let sh=({onConfirm:e,onCancel:t})=>(0,c.jsx)(nT.K,{title:"Delete space",onClose:n=>{"confirm"===n?((0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_DIALOG_DELETE_CONFIRM",mode:"immersive"}),e()):((0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_DIALOG_DELETE_CANCEL",mode:"immersive"}),t())},confirmButtonContent:"Delete",confirmButtonType:"danger",children:"Are you sure you want to delete this space? This action cannot be undone."});try{sp.displayName||(sp.displayName="CopilotSpacesMenu")}catch{}try{sh.displayName||(sh.displayName="DeleteDialog")}catch{}function sg({isSidebarOpen:e,onCreateSpace:t}){let n=(0,h.Pk)(),a=(0,te.d)(),{updateGlobalNavigationBreadcrumbs:i}=n3(),r=(0,k.Z)(),[s,o]=(0,F.useState)(!1),[l,d]=(0,F.useState)(!1),[u,g]=(0,F.useState)(!1),[f,y]=(0,F.useState)(null),x=(0,F.useRef)(null),v=a&&b.fV?.pathname!==m.VR,{mutateAsync:_}=(0,et.kt)(),C=(0,F.useMemo)(()=>a?(0,ee.JB)(n.customCopilots,a):null,[n.customCopilots,a]),N=p.W.customCopilotVisibility&&C?.ownerIsOrg;(0,F.useEffect)(()=>{i()},[i]);let w=()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_SHARE_DIALOG_CLOSE",mode:"immersive"}),d(!1)},I=()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_DELETE_DIALOG_CLOSE",mode:"immersive"}),o(!1)},S=async()=>{if(a)try{await _(a),r(m.VR)}catch(e){y(e instanceof Error?e:Error(String(e))),I()}},T=C?.editable||!p.W.customCopilotOrgOwned,A=v&&!n.selectedThreadID?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ed.l.Group,{children:[(0,c.jsx)(ed.l.GroupHeading,{children:"Space"}),T&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU_EDIT",mode:"immersive"}),p.W.customCopilotsRedesign?r((0,ee.GL)(C)):g(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PencilIcon,{})}),"Edit"]}),T&&(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU_DELETE",mode:"immersive"}),o(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.TrashIcon,{})}),"Delete"]})]}),(0,c.jsx)(ed.l.Divider,{})]}):null,E=(0,c.jsx)(e0.Q,{variant:"primary",onClick:t,children:"New space"}),R=(0,c.jsx)(e0.Q,{onClick:()=>{(0,K.BI)("dotcom_chat.activate",{target:"COPILOT_SPACE_CONTEXT_MENU_SHARE",mode:"immersive"}),d(!0)},leadingVisual:j.ShareIcon,children:"Share"}),P=(0,c.jsxs)(c.Fragment,{children:[p.W.customCopilotOrgOwned&&!a&&E,N&&R]});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n7,{showModelPicker:!!a,showPreviewPaneButton:!1,conversationSpecificItems:A,isSidebarOpen:e,customButtons:P}),f&&(0,c.jsxs)(r6.A,{variant:"danger",children:[(0,c.jsx)(j.AlertIcon,{}),"There was a problem deleting your space."]}),s&&a?(0,c.jsx)(sh,{onCancel:I,onConfirm:S}):null,l&&a?p.W.customCopilotsRedesign?(0,c.jsx)(sl,{closeDialog:w,customCopilotId:a}):(0,c.jsx)(r7,{closeDialog:w,customCopilotId:a}):null,u&&a?(0,c.jsx)(sr,{copilotSpaceId:a,onClose:()=>{g(!1),x.current?.focus()}}):null]})}try{sg.displayName||(sg.displayName="SpacesHeader")}catch{}var sf=n(12528);let sy=e=>{let t=(0,e9.b)(),{customCopilots:n}=(0,h.Pk)(),a=(0,rS.jE)(),{mutateAsync:i,...r}=(0,rk.n)({onSuccess:async()=>{e&&await a.invalidateQueries({queryKey:(0,i8.TP)(e)})},mutationFn:async a=>{let i=(0,ee.JB)(n,e);if(!i)return;let r=`${(0,ee.Cb)(e)}/stars`,s=a.starred?"POST":"DELETE";if((await (0,A.lS)(r,{method:s})).ok)return i.starred=a.starred,t.dispatch({type:"SET_CUSTOM_COPILOT",customCopilot:i}),i}});return{starCopilotSpace:i,...r}},sx={dialogTitle:"AllAttachmentsDialog-module__dialogTitle--kVeBP",attachmentText:"AllAttachmentsDialog-module__attachmentText--Thq94"};function sv({attachment:e,className:t}){switch(e.type){case"github_file":return(0,c.jsx)(j.FileIcon,{className:t});case"free_text":return(0,c.jsx)(j.PasteIcon,{className:t});case"github_issue":return(0,c.jsx)(j.IssueOpenedIcon,{className:t});case"github_pull_request":return(0,c.jsx)(j.GitPullRequestIcon,{className:t});default:return null}}try{sv.displayName||(sv.displayName="AttachmentIcon")}catch{}let s_={attachmentList:"AttachmentsList-module__attachmentList--IN3KR",attachmentItem:"AttachmentsList-module__attachmentItem--tHUdD",attachmentItemButton:"AttachmentsList-module__attachmentItemButton--r1pVl",attachmentItemLink:"AttachmentsList-module__attachmentItemLink--Hjtzq",attachmentText:"AttachmentsList-module__attachmentText--GQrPc",attachmentName:"AttachmentsList-module__attachmentName--laQlh",attachmentContent:"AttachmentsList-module__attachmentContent--j1qOG",attachmentIcon:"AttachmentsList-module__attachmentIcon--scKcJ",lineClamp:"AttachmentsList-module__lineClamp--Dk8at"};function sb({attachments:e,onTextFileClick:t}){return(0,c.jsx)("ul",{className:s_.attachmentList,children:e.map(e=>(0,c.jsx)(sj,{attachment:e,onTextFileClick:t},e.id))})}function sj({attachment:e,onTextFileClick:t}){switch(e.type){case"github_file":{let{filePath:t,fileName:n,fileUrl:a}=(0,ee.q5)(e);return(0,c.jsx)("li",{className:s_.attachmentItem,children:(0,c.jsxs)("a",{className:s_.attachmentItemLink,href:a,rel:"noopener noreferrer",target:"_blank",children:[(0,c.jsx)("div",{className:s_.attachmentIcon,children:(0,c.jsx)(sv,{attachment:e})}),(0,c.jsxs)("div",{className:s_.attachmentText,children:[(0,c.jsx)("div",{className:s_.attachmentName,children:n}),(0,c.jsx)("p",{className:s_.attachmentContent,children:t})]})]})},e.id)}case"free_text":return(0,c.jsx)("li",{className:s_.attachmentItem,children:(0,c.jsx)("button",{type:"button",onClick:()=>t(e),className:s_.attachmentItemButton,children:(0,c.jsxs)("span",{className:s_.attachmentItemLink,children:[(0,c.jsx)("div",{className:s_.attachmentIcon,children:(0,c.jsx)(sv,{attachment:e})}),(0,c.jsxs)("div",{className:s_.attachmentText,children:[(0,c.jsx)("div",{className:(0,en.$)(s_.attachmentName,s_.lineClamp),children:e.name}),(0,c.jsx)("p",{className:(0,en.$)(s_.attachmentContent,s_.lineClamp),children:e.text})]})]})})},e.id);case"github_issue":case"github_pull_request":return(0,c.jsx)("li",{className:s_.attachmentItem,children:(0,c.jsxs)("a",{className:s_.attachmentItemLink,href:e.url,rel:"noopener noreferrer",target:"_blank",children:[(0,c.jsx)("div",{className:s_.attachmentIcon,children:(0,c.jsx)(sv,{attachment:e,className:"fgColor-success"})}),(0,c.jsxs)("div",{className:s_.attachmentText,children:[(0,c.jsxs)("div",{className:(0,en.$)(s_.attachmentName,s_.lineClamp),children:[e.title,"\xa0",(0,c.jsx)("span",{className:"fgColor-muted text-light",children:`#${e.number}`})]}),(0,c.jsx)("div",{className:(0,en.$)(s_.attachmentContent,s_.lineClamp),children:e.nwo})]})]})},e.id);default:return null}}try{sb.displayName||(sb.displayName="AttachmentsList")}catch{}try{sj.displayName||(sj.displayName="AttachmentItem")}catch{}function sC({copilotSpace:e,onClose:t,returnFocusRef:n,initialAttachment:a}){let i=(0,ea.Zp)(),[r,s]=(0,F.useState)(a??null);return(0,c.jsx)(ek.l,{onClose:t,position:{narrow:"fullscreen"},returnFocusRef:n,footerButtons:!0===e.editable&&null===r?[{content:"Edit",leadingVisual:j.PencilIcon,onClick:()=>i(`${(0,ee.GL)(e)}#attachments`)}]:void 0,renderHeader:()=>(0,c.jsx)(ek.l.Header,{children:(0,c.jsxs)("div",{className:"d-flex flex-items-center",children:[r?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(M.K,{icon:j.ArrowLeftIcon,variant:"invisible",onClick:()=>s(null),"aria-label":"Back",className:"mr-1"}),(0,c.jsx)(ek.l.Title,{className:sx.dialogTitle,children:r?.name??"Attachments"})]}):(0,c.jsx)(ek.l.Title,{className:(0,en.$)(sx.dialogTitle,"pl-2"),children:"Attachments"}),(0,c.jsx)(ek.l.CloseButton,{onClose:t})]})}),children:r?(0,c.jsx)("p",{className:sx.attachmentText,children:r.text}):(0,c.jsx)(sb,{attachments:e.resources,onTextFileClick:s})})}try{sC.displayName||(sC.displayName="AllAttachmentsDialog")}catch{}let sN={instructionsText:"FullInstructionsDialog-module__instructionsText--o9TCB"},sw=e=>(0,c.jsx)(j.CheckIcon,{...e,className:"fgColor-success"});function sI({copilotSpace:e,onClose:t,returnFocusRef:n}){let[a,i]=(0,F.useState)(!1),r=(0,ea.Zp)();return(0,c.jsx)(ek.l,{title:"Instructions",onClose:t,returnFocusRef:n,position:{narrow:"fullscreen"},footerButtons:[{content:a?"Copied":"Copy",leadingVisual:a?sw:j.CopyIcon,onClick:function(){(0,nD.D)(e.generalInstructions||""),i(!0),setTimeout(()=>i(!1),2e3)}},...!0===e.editable?[{content:"Edit",leadingVisual:j.PencilIcon,onClick:()=>r(`${(0,ee.GL)(e)}#instructions`)}]:[]],renderBody:()=>(0,c.jsx)("div",{className:"p-3",children:(0,c.jsx)("p",{className:sN.instructionsText,children:e.generalInstructions})})})}try{sw.displayName||(sw.displayName="SuccessCheckIcon")}catch{}try{sI.displayName||(sI.displayName="FullInstructionsDialog")}catch{}let sS={container:"SpacesAvatar-module__container--l4sp7",auburn:"SpacesAvatar-module__auburn--U8kGs",blue:"SpacesAvatar-module__blue--d1mxM",brown:"SpacesAvatar-module__brown--_ruGo",coral:"SpacesAvatar-module__coral--hB7XS",cyan:"SpacesAvatar-module__cyan--WUswA",gray:"SpacesAvatar-module__gray--foelF",green:"SpacesAvatar-module__green--r5__R",indigo:"SpacesAvatar-module__indigo--KsU8T",lemon:"SpacesAvatar-module__lemon--aCebI",lime:"SpacesAvatar-module__lime--Up9rD",olive:"SpacesAvatar-module__olive--D8h2F",orange:"SpacesAvatar-module__orange--sgv01",pine:"SpacesAvatar-module__pine--G_Si8",pink:"SpacesAvatar-module__pink--UH3QW",plum:"SpacesAvatar-module__plum--sp5UB",purple:"SpacesAvatar-module__purple--VMWjs",red:"SpacesAvatar-module__red--Yo2zb",teal:"SpacesAvatar-module__teal--kGNrV",yellow:"SpacesAvatar-module__yellow--CFqwn"},sk={auburn:sS.auburn,blue:sS.blue,brown:sS.brown,coral:sS.coral,cyan:sS.cyan,gray:sS.gray,green:sS.green,indigo:sS.indigo,lemon:sS.lemon,lime:sS.lime,olive:sS.olive,orange:sS.orange,pine:sS.pine,pink:sS.pink,plum:sS.plum,purple:sS.purple,red:sS.red,teal:sS.teal,yellow:sS.yellow};function sT({color:e,size:t=16}){let{spaceColor:n}=(0,F.useMemo)(()=>({icon:rx,spaceColor:r0(e)}),[e]);return(0,c.jsx)("div",{style:{"--custom-size":`var(--base-size-${2*t})`},className:(0,en.$)(sS.container,sk[n]),children:(0,c.jsx)(rx,{size:t})})}try{sT.displayName||(sT.displayName="SpacesAvatar")}catch{}let sA={container:"Tip-module__container--rpJ1l",prefix:"Tip-module__prefix--eQ9yO"};function sE({children:e}){return(0,c.jsxs)("div",{className:sA.container,children:[(0,c.jsxs)("div",{className:sA.prefix,children:[(0,c.jsx)(j.LightBulbIcon,{}),"Tip"]}),e]})}try{sE.displayName||(sE.displayName="Tip")}catch{}let sR={page:"SpaceDetails-module__page--UBmtp",mainSection:"SpaceDetails-module__mainSection--P35zI",side:"SpaceDetails-module__side--mMAqk",sideSection:"SpaceDetails-module__sideSection--XhyPI",sideSectionTitle:"SpaceDetails-module__sideSectionTitle--vrKrG",sideSectionHeader:"SpaceDetails-module__sideSectionHeader--IxmeX",desktopOnly:"SpaceDetails-module__desktopOnly--oiJQY",mobileOnly:"SpaceDetails-module__mobileOnly--dti0U",conversationTitle:"SpaceDetails-module__conversationTitle--p6cM1",conversationsListTitle:"SpaceDetails-module__conversationsListTitle--LkHDP",sideTitle:"SpaceDetails-module__sideTitle--D1UY2",conversations:"SpaceDetails-module__conversations--VXj6Z",startConversation:"SpaceDetails-module__startConversation--li41R",noConversations:"SpaceDetails-module__noConversations--ewz03",conversationsPlaceholder:"SpaceDetails-module__conversationsPlaceholder--CCFjv",conversationsPlaceholderText:"SpaceDetails-module__conversationsPlaceholderText--W5ibg",conversationsHeader:"SpaceDetails-module__conversationsHeader--QgdxX",conversationsList:"SpaceDetails-module__conversationsList--lt9L9",conversationsItems:"SpaceDetails-module__conversationsItems--MkPm7",conversationItem:"SpaceDetails-module__conversationItem--yq1AN",conversationItemMenuOpen:"SpaceDetails-module__conversationItemMenuOpen--AkhsV",conversationItemLeftColumn:"SpaceDetails-module__conversationItemLeftColumn--ozFFv",conversationName:"SpaceDetails-module__conversationName--OV6x1",conversationKickoffMessage:"SpaceDetails-module__conversationKickoffMessage--c2Ta4",conversationTimestamp:"SpaceDetails-module__conversationTimestamp--A90s3",instructionsText:"SpaceDetails-module__instructionsText--t0_h4",info:"SpaceDetails-module__info--PdrIT",infoDescription:"SpaceDetails-module__infoDescription--w1JGf",visibilityLabel:"SpaceDetails-module__visibilityLabel--oXD34",descriptionExpander:"SpaceDetails-module__descriptionExpander--ieTKL",starFillIcon:"SpaceDetails-module__starFillIcon--Iwfp3",instructionsLink:"SpaceDetails-module__instructionsLink--Plgg1",attachmentsLink:"SpaceDetails-module__attachmentsLink--S84Mn",actionListOffset:"SpaceDetails-module__actionListOffset--v2BWE",lineClamp:"SpaceDetails-module__lineClamp--TE1ZX"};function sP(e){return void 0!==e.id}function sD({customCopilotId:e,onChatSubmit:t,selectedThreadID:n,textAreaRef:a}){let{threads:i,streamingMessage:r}=(0,h.Pk)(),s=(0,e9.b)(),o=nr(),[l,d]=(0,F.useState)(null),{isPending:u,data:m,error:p}=(0,et.TB)(e),[g,f]=(0,F.useState)(!1),[y,x]=(0,F.useState)(!1),v=(0,F.useMemo)(()=>{if(!m||!sP(m))return[];!function(e){let t=ru();if(t){let n=e.get(t.threadID);n&&(Date.parse(n.updatedAt)<=t.updatedAt?n.updatedAt=new Date(t.updatedAt).toJSON():rm())}}(i);let t=new Map(Array.from(i.entries()).filter(([,t])=>t.customCopilotOwner?t.customCopilotOwner===e.owner&&t.customCopilotID===e.id:t.customCopilotID===m.oldId));return s.sortThreads(t).slice(0,10)},[i,e,s,m]);if((0,F.useEffect)(()=>{m&&sP(m)&&s.dispatch({type:"SET_CUSTOM_COPILOT",customCopilot:m}),s.clearCurrentReferences(["image"])},[m,s]),p instanceof et.Be)return(0,c.jsx)(rI,{});if(u||!m)return(0,c.jsx)(iw,{});if(!sP(m))return(0,c.jsx)(rI,{protectedOrganizations:m.protectedOrganizations});let _=!!sP(m)&&(0,ee.Hh)(m);return(0,c.jsx)("div",{className:sR.page,children:(0,c.jsxs)("div",{className:sR.mainSection,children:[(0,c.jsxs)("div",{className:sR.conversations,children:[_&&(0,c.jsx)(rt,{}),(0,c.jsxs)("div",{className:sR.startConversation,children:[(0,c.jsx)("h2",{className:sR.conversationTitle,children:"Start a new conversation"}),(0,c.jsx)(na.V,{textAreaRef:a,onSubmit:t,customCopilotId:m,isStreaming:!!r,size:"large",placeholder:"Ask anything",disabled:_,showModelPicker:!0,onNewThreadSelected:o},n)]}),v.length>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:sR.conversationsList,children:[(0,c.jsx)("div",{className:sR.conversationsHeader,children:(0,c.jsx)("h2",{className:sR.conversationsListTitle,children:"Your last conversations"})}),(0,c.jsx)("ul",{role:"menu",className:sR.conversationsItems,children:v.map(e=>(0,c.jsx)(sL,{conversation:e,activeMenuConversationId:l,setActiveMenuConversationId:d},e.id))})]}),(0,c.jsx)(sE,{children:"When sharing a space your conversations don't get shared."})]}):(0,c.jsx)("div",{className:sR.noConversations,children:(0,c.jsx)(sM,{})})]}),(0,c.jsxs)("aside",{className:sR.side,children:[(0,c.jsx)(sO,{copilotSpace:m}),(0,c.jsx)(sB,{copilotSpace:m,setInstructionsDialogOpen:f,setAttachmentsDialogOpen:x}),m.generalInstructions&&(0,c.jsx)(sF,{copilotSpace:m,isDialogOpen:g,setDialogOpen:f}),m.starredUsers.length>0&&(0,c.jsx)(sU,{copilotSpace:m}),m.resources.length>0&&(0,c.jsx)(s$,{copilotSpace:m,isDialogOpen:y,setDialogOpen:x})]})]})})}function sL({conversation:e,activeMenuConversationId:t,setActiveMenuConversationId:n}){let a=(0,k.Z)(),i=(0,e9.b)(),r=(0,m.CB)(e),s=`${m.Jz}/c/${e.id}`;return(0,c.jsxs)("li",{role:"menuitem",onClick:()=>{a(s)},onKeyDown:e=>{"Enter"===e.key&&a(s)},className:(0,en.$)(sR.conversationItem,null!==t&&sR.conversationItemMenuOpen),children:[(0,c.jsxs)("div",{className:sR.conversationItemLeftColumn,children:[(0,c.jsx)("div",{className:sR.conversationName,children:r}),(0,c.jsx)("div",{className:sR.conversationKickoffMessage,children:""}),(0,c.jsxs)("div",{className:sR.conversationTimestamp,children:[(0,c.jsx)(j.ClockIcon,{})," ",(0,c.jsx)(a9.A,{format:"relative",prefix:"",date:new Date(e.updatedAt)})]})]}),(0,c.jsxs)(ec.W,{open:t===e.id,onOpenChange:t=>{n(t?e.id:null)},children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{variant:"invisible","aria-label":"Conversation options",icon:j.KebabHorizontalIcon,onClick:e=>{e.stopPropagation()}})}),(0,c.jsx)(ec.W.Overlay,{onClick:e=>e.stopPropagation(),align:"end",children:(0,c.jsx)(ed.l,{children:(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:function(){i.deleteThread(e)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.TrashIcon,{})}),"Delete"]})})})]})]})}function sM(){return(0,c.jsx)("section",{className:sR.noConversations,children:(0,c.jsxs)("div",{className:sR.conversationsPlaceholder,children:[(0,c.jsx)(j.CommentDiscussionIcon,{size:24}),(0,c.jsx)("div",{className:sR.conversationsPlaceholderText,children:"Start your first conversation using the field above"})]})})}function sO({copilotSpace:e}){let t=(0,k.Z)(),[n,a]=(0,F.useState)(!1),i=(e.description?.length??0)>140&&!n,{starCopilotSpace:r}=sy(e);return(0,c.jsxs)("section",{className:sR.info,children:[(0,c.jsx)(sT,{size:20,color:e.iconColor}),(0,c.jsxs)("h3",{className:sR.sideTitle,children:[e.name,(0,c.jsx)(nI.A,{className:sR.visibilityLabel,size:"small",variant:"secondary",children:"Private"})]}),e.description&&(0,c.jsxs)("p",{className:sR.infoDescription,children:[(i?e.description.slice(0,140):e.description).replaceAll("\n\n","\n"),i&&(0,c.jsx)("button",{type:"button","aria-label":"Expand description",className:sR.descriptionExpander,onClick:()=>a(!0),children:(0,c.jsx)(j.EllipsisIcon,{size:16})})]}),(0,c.jsxs)(O.B,{gap:"condensed",direction:{narrow:"vertical",regular:"horizontal"},children:[e.editable&&(0,c.jsx)(e0.Q,{block:!0,onClick:function(){t((0,ee.GL)(e))},leadingVisual:j.PencilIcon,variant:"default",children:"Edit"}),(0,c.jsx)(e0.Q,{block:!0,onClick:()=>void r({starred:!e.starred}),leadingVisual:e.starred?(0,c.jsx)(j.StarFillIcon,{className:sR.starFillIcon}):(0,c.jsx)(j.StarIcon,{}),variant:"default",children:e.starred?"Starred":"Star"})]})]})}function sB({copilotSpace:e,setInstructionsDialogOpen:t,setAttachmentsDialogOpen:n}){return(0,c.jsxs)(ed.l,{variant:"full",className:sR.actionListOffset,children:[(0,c.jsxs)(ed.l.LinkItem,{href:`/${e.owner}`,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(a8.r,{size:16,square:e.ownerIsOrg,src:e.ownerAvatar})}),(0,c.jsxs)("span",{className:"fgColor-muted",children:["Owned by ",(0,c.jsx)("strong",{className:"text-semibold",children:e.owner})]})]}),e.generalInstructions&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>t(!0),className:sR.mobileOnly,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.NoteIcon,{})}),(0,c.jsx)("span",{className:"fgColor-muted",children:"View instructions"})]}),e.resources.length>0&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>n(!0),className:sR.mobileOnly,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PaperclipIcon,{})}),(0,c.jsxs)("span",{className:"fgColor-muted",children:[e.resources.length," attachment",e.resources.length>1?"s":""]})]})]})}function sF({copilotSpace:e,isDialogOpen:t,setDialogOpen:n}){let a=(0,F.useRef)(null);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(sz,{title:"Instructions",children:[(0,c.jsx)("p",{className:sR.instructionsText,children:(e.generalInstructions||"").replaceAll("\n\n","\n")}),(0,c.jsx)(em.A,{className:sR.instructionsLink,as:"button",ref:a,onClick:()=>n(!0),"aria-haspopup":"dialog","aria-expanded":t,children:"View full instructions"})]}),t&&(0,c.jsx)(sI,{copilotSpace:e,onClose:()=>n(!1),returnFocusRef:a})]})}function s$({copilotSpace:e,isDialogOpen:t,setDialogOpen:n}){let[a,i]=(0,F.useState)(null),r=(0,F.useRef)(null),s=e.resources.slice(0,5);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(sz,{title:"Attachments",count:e.resources.length,children:[(0,c.jsx)(ed.l,{variant:"full",className:sR.actionListOffset,children:s.map(e=>{if("free_text"===e.type)return(0,c.jsxs)(ed.l.Item,{onSelect:()=>{"free_text"===e.type&&(i(e),n(!0))},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(sv,{attachment:e})}),(0,c.jsx)("span",{className:sR.lineClamp,children:e.name})]},e.id);let t=(0,ee.$s)(e)?"fgColor-success":"",{fileName:a,fileUrl:r}="github_file"===e.type?(0,ee.q5)(e):{fileName:e.title,fileUrl:e.url};return(0,c.jsxs)(ed.l.LinkItem,{href:r,children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(sv,{attachment:e,className:t})}),(0,c.jsx)("span",{className:sR.lineClamp,children:a})]},e.id)})}),(0,c.jsx)(em.A,{className:sR.attachmentsLink,as:"button",ref:r,onClick:()=>n(!0),"aria-haspopup":"dialog","aria-expanded":t,children:"View all attachments"})]}),t&&(0,c.jsx)(sC,{copilotSpace:e,initialAttachment:a,onClose:()=>{i(null),n(!1)},returnFocusRef:r})]})}function sU({copilotSpace:e}){return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(sz,{title:"Starred by",count:e.starredUsers.length,children:(0,c.jsx)("div",{children:e.starredUsers.map(e=>(0,c.jsx)(a8.r,{className:"mr-2",size:32,src:e.avatarUrl,alt:e.login},e.login))})})})}function sz({title:e,count:t,children:n}){return(0,c.jsxs)("div",{className:(0,en.$)(sR.sideSection,sR.desktopOnly),children:[(0,c.jsx)("div",{className:sR.sideSectionHeader,children:(0,c.jsxs)("h4",{className:sR.sideSectionTitle,children:[e," ",!!t&&(0,c.jsx)(sf.A,{children:t})]})}),n]})}try{sD.displayName||(sD.displayName="SpaceDetails")}catch{}try{sL.displayName||(sL.displayName="ConversationItem")}catch{}try{sM.displayName||(sM.displayName="NoConversationsPlaceholder")}catch{}try{sO.displayName||(sO.displayName="InfoSection")}catch{}try{sB.displayName||(sB.displayName="MetadataSection")}catch{}try{sF.displayName||(sF.displayName="InstructionsSection")}catch{}try{s$.displayName||(s$.displayName="AttachmentsSection")}catch{}try{sU.displayName||(sU.displayName="StarredSection")}catch{}try{sz.displayName||(sz.displayName="SideSection")}catch{}function sV({customCopilotId:e,selectedThreadID:t,textAreaRef:n}){let a=(0,h.Pk)(),{messages:i}=a,r=nn((0,F.useRef)(a.currentTopic),i.length);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sg,{}),(0,c.jsx)(er.t,{fallback:(0,c.jsx)(eg,{regionName:"This space"}),children:p.W.customCopilotsRedesign?(0,c.jsx)(sD,{customCopilotId:e,onChatSubmit:r,selectedThreadID:t,textAreaRef:n}):(0,c.jsx)(r4,{selectedThreadID:t,textAreaRef:n,onSubmit:r,customCopilotId:e})})]})}try{sV.displayName||(sV.displayName="SpacesConversation")}catch{}var sW=n(72819);let sH={metadata:"SpacesCard-module__metadata--sQAQe",metadataItem:"SpacesCard-module__metadataItem--wvRpg"};function sq({onClick:e}){return(0,c.jsxs)(sW.Z,{onClick:e,children:[(0,c.jsx)(sW.Z.Icon,{icon:j.PlusIcon}),(0,c.jsx)(sW.Z.Heading,{children:"Create a new space"}),(0,c.jsx)(sW.Z.Description,{children:"Add attachments, repositories, and more."})]})}function sG({copilotSpace:e,spaceVisibilityEnabled:t,onDelete:n,onClick:a}){let i=e.ownerIsOrg?j.OrganizationIcon:j.PersonIcon,r="org_public"===e.visibility?j.PeopleIcon:j.LockIcon,s="org_public"===e.visibility?"Shared":"Private";return(0,c.jsxs)(sW.Z,{href:(0,ee.Cb)(e),onClick:a,children:[(0,c.jsx)(sW.Z.Icon,{icon:rx,color:e.iconColor}),(0,c.jsx)(sW.Z.Heading,{children:e.name}),(0,c.jsx)(sW.Z.Description,{children:e.description}),(0,c.jsx)(sW.Z.Menu,{children:(0,c.jsx)(sp,{copilot:e,onDelete:n})}),(0,c.jsx)(sW.Z.Metadata,{children:t?(0,c.jsxs)("div",{className:sH.metadata,children:[(0,c.jsxs)("div",{className:sH.metadataItem,children:[(0,c.jsx)(i,{}),e.owner]}),(0,c.jsxs)("div",{className:sH.metadataItem,children:[(0,c.jsx)(r,{}),s]})]}):(0,c.jsx)("div",{className:sH.metadata,children:(0,c.jsxs)("div",{className:sH.metadataItem,children:[(0,c.jsx)(j.ClockIcon,{}),(0,c.jsx)(a9.A,{format:"micro",prefix:"",date:new Date(e.updatedAt)})]})})})]},e.owner?`${e.owner}/${e.id}`:e.id)}try{sq.displayName||(sq.displayName="NewSpacesCard")}catch{}try{sG.displayName||(sG.displayName="SpacesCard")}catch{}let sK={banner:"SpacesView-module__banner--A6t_P"};function sQ({copilotSpaces:e}){let t=p.W.customCopilotVisibility,{ssoOrganizations:n}=(0,h.Pk)(),a=n.map(e=>e.login),[i,r]=(0,F.useState)(!1),[s,o]=(0,F.useState)(null),l=void 0===e,d=()=>{r(!0)},{mutateAsync:u}=(0,et.kt)(),m=e=>async()=>{try{await u(e),o(null)}catch(e){o(e instanceof Error?e:Error(String(e)))}},g=()=>{(0,K.BI)("dotcom_chat.activate",{target:"SIDEBAR_CUSTOM_COPILOT_SELECTED",mode:"immersive"})},f=e&&e.length>0;return(0,c.jsxs)(er.t,{fallback:(0,c.jsx)(eg,{regionName:"Spaces"}),children:[(0,c.jsx)(sg,{}),s&&(0,c.jsxs)(r6.A,{variant:"danger",children:[(0,c.jsx)(j.AlertIcon,{}),"There was a problem deleting your space."]}),(0,c.jsxs)(I.A.Container,{children:[(0,c.jsx)(I.A.Banner,{children:n.length>0&&(0,c.jsx)("div",{className:sK.banner,children:(0,c.jsx)(e5.x,{protectedOrgs:a,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${encodeURIComponent(window.location.href)}`})})}),(0,c.jsxs)(I.A.Header,{children:[(0,c.jsx)(I.A.Icon,{icon:(0,c.jsx)(rx,{size:32})}),(0,c.jsx)(I.A.Title,{children:f||l?"Spaces":"Set context once. Chat again and again."}),(0,c.jsx)(I.A.Description,{children:"Create a unique version of Copilot based on a bundle of GitHub files and more."}),!f&&!l&&(0,c.jsx)(e0.Q,{variant:"primary",onClick:d,children:"New Space"})]}),(f||l)&&(0,c.jsxs)(I.A.Section,{children:[(0,c.jsx)(I.A.Section.Title,{children:"Your spaces"}),(0,c.jsxs)(I.A.Section.Grid,{loading:l,children:[(0,c.jsx)(sq,{onClick:d}),e?.map?.(e=>c.jsx(sG,{copilotSpace:e,spaceVisibilityEnabled:t,onDelete:m(e),onClick:g},e.owner?`${e.owner}/${e.id}`:e.id))]})]}),i&&(0,c.jsx)(sr,{onClose:()=>r(!1)})]})]})}try{sQ.displayName||(sQ.displayName="SpacesView")}catch{}var sJ=n(17774),sZ=n(5420);let sX={banner:"SpacesViewNext-module__banner--LY0l8",underlineNav:"SpacesViewNext-module__underlineNav--xyd7p",listContainer:"SpacesViewNext-module__listContainer--sBDT9"},sY=["personal","org","starred"];function s0({copilotSpaces:e}){let t;let n=p.W.customCopilotVisibility,a=p.W.customCopilotsRedesign,i=(0,h.Pk)(),r=(0,ea.Zp)(),{ssoOrganizations:s}=i,[o]=(0,k.o)(),l=o.get("tab");t=sY.includes(l)?l:"personal";let d=s.map(e=>e.login),[u,g]=(0,F.useState)(!1),[f,y]=(0,F.useState)(null),x=void 0===e,v=e?.filter(e=>!e.ownerIsOrg).length??0,_=e?.filter(e=>e.ownerIsOrg).length??0,b=e?.filter(e=>e.starred).length??0,C=()=>{a?r(m.QT):g(!0)},{mutateAsync:N}=(0,et.kt)(),w=e=>async()=>{try{await N(e),y(null)}catch(e){y(e instanceof Error?e:Error(String(e)))}},S=()=>{(0,K.BI)("dotcom_chat.activate",{target:"SIDEBAR_CUSTOM_COPILOT_SELECTED",mode:"immersive"})},T=e?.filter(e=>"personal"===t?!e.ownerIsOrg:"org"===t?e.ownerIsOrg:"starred"!==t||e.starred),A=e?.length===0&&!x,E=e&&e.length>0&&T?.length===0&&!x,R=()=>"personal"===t?"personal":"org"===t?"organization":"starred"===t?"starred":"";return(0,c.jsxs)(er.t,{fallback:(0,c.jsx)(eg,{regionName:"Spaces"}),children:[(0,c.jsx)(sg,{onCreateSpace:C}),f&&(0,c.jsxs)(r6.A,{variant:"danger",children:[(0,c.jsx)(j.AlertIcon,{}),"There was a problem deleting your space."]}),(0,c.jsxs)(I.A.Container,{children:[(0,c.jsx)(I.A.Banner,{children:s.length>0&&(0,c.jsx)("div",{className:sX.banner,children:(0,c.jsx)(e5.x,{protectedOrgs:d,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${encodeURIComponent(window.location.href)}`,useFullWidthStyle:!0})})}),(0,c.jsxs)(I.A.Header,{children:[(0,c.jsx)(I.A.Icon,{icon:(0,c.jsx)(rx,{size:32})}),(0,c.jsx)(I.A.Title,{children:"Set context once. Chat again and again"}),(0,c.jsx)(I.A.Description,{children:"Spaces lets you create shared research environments where you and your team can collaborate, explore topics, and exchange insights\u2014all powered by AI-driven search and summarization."})]}),(0,c.jsxs)("div",{className:sX.listContainer,children:[(0,c.jsx)("div",{className:sX.underlineNav,children:(0,c.jsxs)(sZ.O,{"aria-label":"Spaces",children:[(0,c.jsx)(sZ.O.Item,{as:sJ.N,to:{search:"?tab=personal"},"aria-current":"personal"===t?"page":void 0,icon:j.SmileyIcon,counter:v,children:"Yours"}),(0,c.jsx)(sZ.O.Item,{as:sJ.N,to:{search:"?tab=org"},"aria-current":"org"===t?"page":void 0,icon:j.OrganizationIcon,counter:_,children:"Organizations"}),(0,c.jsx)(sZ.O.Item,{as:sJ.N,to:{search:"?tab=starred"},"aria-current":"starred"===t?"page":void 0,icon:j.StarIcon,counter:b,children:"Starred"})]})}),(0,c.jsx)(I.A.Section,{children:(0,c.jsx)(I.A.Section.Grid,{loading:x,children:A?(0,c.jsxs)(I.A.Section.Grid.Empty,{children:[(0,c.jsx)("p",{children:"Spaces you create will appear here."}),(0,c.jsx)(e0.Q,{onClick:C,children:"New space"})]}):E?(0,c.jsxs)(I.A.Section.Grid.Empty,{children:["starred"===R()?(0,c.jsx)(j.StarIcon,{size:24}):(0,c.jsx)(j.SearchIcon,{size:24}),(0,c.jsxs)("p",{children:["No ",R()," spaces found."]})]}):T?.map?.(e=>c.jsx(sG,{copilotSpace:e,spaceVisibilityEnabled:n,onDelete:w(e),onClick:S},e.owner?`${e.owner}/${e.id}`:e.id))})})]}),u&&(0,c.jsx)(sr,{onClose:()=>g(!1)})]})]})}try{s0.displayName||(s0.displayName="SpacesViewNext")}catch{}let s1=()=>{let{mutateAsync:e,...t}=(0,rk.n)({mutationFn:async e=>{let t={resources:e.resources?.map(e=>({id:e.id,resource_type:e.type,metadata:rT(e)}))},n=await (0,A.lS)("/copilot/spaces/resource_sizes",{method:"POST",body:t}),a=await n.json();if(!n.ok)throw a.errorMessages;return a}});return{getCopilotSpaceResourceSizes:e,...t}};var s2=n(55516);function s5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let UrlDetails=class UrlDetails{constructor(e,t="",n="",a="",i=0,r="unknown"){s5(this,"url",void 0),s5(this,"owner",void 0),s5(this,"repo",void 0),s5(this,"number",void 0),s5(this,"type",void 0),s5(this,"id",void 0),s5(this,"errorMessage",void 0),this.id=e,this.url=t,this.owner=n,this.repo=a,this.number=i,this.type=r}};let s3=()=>{let{mutateAsync:e,...t}=(0,rk.n)({mutationFn:async({input:e,spaceOwner:t})=>{let n={resources_attributes:e.map(e=>({id:e.id,resource_type:e.type,metadata:function(e){switch(e.type){case"github_issue":case"github_pull_request":return{owner:e.owner,repo:e.repo,number:e.number};default:throw Error("Unsupported resource")}}(e)})),space_owner:t},a=await (0,A.lS)("/copilot/spaces/validate_url_resources",{method:"POST",body:n}),i=await a.json();if(!a.ok)throw i;return i}});return{validateUrlResources:e,...t}};function s4({onClose:e,onSave:t,resourcesToSave:n,owner:a}){let[i,r]=(0,F.useState)(()=>[new UrlDetails(crypto.randomUUID())]),[s,o]=(0,F.useState)(!1),{validateUrlResources:l}=s3(),d=e=>{e?.preventDefault(),u()},u=async()=>{o(!1);let s=i.filter(e=>""===e.url||"unknown"===e.type||a&&e.owner!==a);if(s.length>0){r(i.map(e=>a&&e.owner&&e.owner!==a?{...e,errorMessage:`This doesn't belong to the ${a} organization.`}:s.some(t=>t.id===e.id)?{...e,errorMessage:"Invalid URL"}:e)),o(!0);return}let c=i;if(void 0!==n){let e=n.filter(e=>"github_issue"===e.type||"github_pull_request"===e.type);c=i.filter(t=>!e.some(e=>e.nwo===`${t.owner}/${t.repo}`&&e.number===t.number&&e.type===t.type))}let d=c.map(e=>({id:e.id,owner:e.owner,repo:e.repo,number:e.number,type:e.type,url:e.url,errorMessage:e.errorMessage}));if(0===d.length){e();return}try{let n=await l({input:d,spaceOwner:a});t(n),e()}catch(e){if(Array.isArray(e)){for(let t of e){let e=i.find(e=>e.id===t.id);e&&(e.errorMessage="Resource not found")}o(!0)}}},m=e=>{let t=[...i];t.splice(e,1),r(t)},p=(e,t)=>{let n=[...i],a=h(t,n[e]||new UrlDetails(crypto.randomUUID()));n[e]=a,r(n)},h=(e,t)=>{let n=e.match(/\/([^/]+)\/([^/]+)\/issues\/(\d+)/),a=e.match(/\/([^/]+)\/([^/]+)\/pull\/(\d+)/);return t.url=e,n?(t.owner=n[1]??"",t.repo=n[2]??"",t.number=parseInt(n[3]??"0",10),t.type="github_issue"):a&&(t.owner=a[1]??"",t.repo=a[2]??"",t.number=parseInt(a[3]??"0",10),t.type="github_pull_request"),t};return(0,c.jsxs)(ek.l,{width:"large",title:"Add via GitHub URL",onClose:e,renderFooter:()=>(0,c.jsx)(ek.l.Footer,{children:(0,c.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[(0,c.jsx)(e0.Q,{onClick:e,children:"Cancel"}),(0,c.jsx)(e0.Q,{variant:"primary",onClick:d,loadingAnnouncement:"Saving resource",children:"Add"})]})}),children:[s&&(0,c.jsx)(B.l,{title:"Failed to save URL(s)",variant:"critical",className:"mb-2"}),(0,c.jsxs)("p",{children:["Paste the URLs of the GitHub content"," ",a&&(0,c.jsx)(tE.yx,{html:`from the <b>${a}</b> organization`})," you want to add. You can include issues, and pull requests."]}),(0,c.jsx)(eS.tL,{commands:{"github:submit-form":()=>d()},children:(0,c.jsx)("form",{onSubmit:d,children:(0,c.jsx)(O.B,{direction:"vertical",align:"center",children:i.map((e,t)=>(0,c.jsxs)("div",{style:{width:"100%"},children:[(0,c.jsx)(s6,{index:t,removeUrlTextInputRow:m,inputCount:i.length,updateUrls:p,urlValue:e.url}),s&&void 0!==e.errorMessage&&(0,c.jsx)(nA.A.Validation,{variant:"error",children:e.errorMessage})]},e.id))})})}),(0,c.jsx)(e0.Q,{leadingVisual:j.PlusIcon,className:"mt-3",onClick:()=>{r([...i,new UrlDetails(crypto.randomUUID())])},children:"Add another"})]})}function s6({index:e,removeUrlTextInputRow:t,inputCount:n,updateUrls:a,urlValue:i}){let[r,s]=(0,F.useState)(i);(0,F.useEffect)(()=>{s(i)},[i]);let o=(0,s2.d)(t=>{a(e,t)},400);return(0,c.jsxs)(nA.A,{className:"d-flex flex-row flex-justify-between flex-items-center width-full",children:[(0,c.jsx)(nA.A.Label,{visuallyHidden:!0,children:"URL"}),(0,c.jsx)(nE.A,{placeholder:"https://github.com/mona/playground/issues/123",value:r,onChange:e=>{let t=e.target.value;s(t),o(t)},className:"width-full"}),n>1&&(0,c.jsx)(M.K,{icon:j.TrashIcon,variant:"invisible","aria-label":"Remove url",className:"ml-2",onClick:()=>t(e)})]})}try{s4.displayName||(s4.displayName="GitHubUrlDialog")}catch{}try{(r=AddUrlTextInputRow).displayName||(r.displayName="AddUrlTextInputRow")}catch{}try{s6.displayName||(s6.displayName="UrlTextInputRow")}catch{}let s7=p.W.customCopilot128kWindow?288e3:144e3;function s8({sizePercentage:e,onClose:t,onSave:n,resource:a}){let[i,r]=(0,F.useState)(a?.name||""),[s,o]=(0,F.useState)(a?.text||""),[l,d]=(0,F.useState)(!1),[u,m]=(0,F.useState)(""),[p,h]=(0,F.useState)(!1),g=a?.text??"",[f,y]=(0,F.useState)({}),{getCopilotSpaceResourceSizes:x}=s1(),v=async e=>{e?.preventDefault();let r=!i.trim(),o=!s.trim();if(r||o){y(e=>({...e,"resources.name":r?"Name is required":"","resources.text":o?"Content is required":""}));return}d(!0),m("");try{let e={id:a?.id||Date.now().toString(),databaseId:a?.databaseId,type:"free_text",name:i,text:s,markedForDestroy:!1},r=await x({resources:[e]});n({...e,sizePercentage:r[e.id]}),t()}catch{m("An unexpected error occurred while validating the text file")}finally{d(!1)}};return(0,c.jsxs)(ek.l,{width:"large",title:"Add a text file",onClose:t,renderFooter:()=>(0,c.jsx)(ek.l.Footer,{children:(0,c.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[(0,c.jsx)(e0.Q,{onClick:t,children:"Cancel"}),(0,c.jsx)(e0.Q,{variant:"primary",onClickCapture:p?void 0:v,loadingAnnouncement:"Validating resource",inactive:p,loading:l,children:"Add"})]})}),children:[u&&(0,c.jsx)(B.l,{variant:"critical",className:"mb-2",title:u}),(0,c.jsx)(eS.tL,{commands:{"github:submit-form":()=>void v()},children:(0,c.jsx)("form",{onSubmit:v,children:(0,c.jsxs)(O.B,{children:[(0,c.jsxs)(nA.A,{required:!0,children:[(0,c.jsx)(nA.A.Label,{children:"Name"}),(0,c.jsx)(nE.A,{block:!0,placeholder:"Give the file a title",value:i,onChange:e=>{r(e.target.value),y(e=>({...e,"resources.name":""}))},maxLength:1e3,validationStatus:f["resources.name"]?"error":void 0}),f["resources.name"]&&(0,c.jsx)(nA.A.Validation,{variant:"error",children:f["resources.name"]})]}),(0,c.jsxs)(nA.A,{required:!0,children:[(0,c.jsx)(nA.A.Label,{children:"Content"}),(0,c.jsx)(D.Ay,{block:!0,rows:7,name:"content",value:s,placeholder:"Enter content here",onChange:e=>{o(e.target.value),y(e=>({...e,"resources.text":""}))}}),f["resources.text"]?(0,c.jsx)(nA.A.Validation,{variant:"error",children:f["resources.text"]}):void 0!==e&&(0,c.jsx)(s9,{text:s,percentage:e,resourceContent:g,setOverSpaceLimit:h})]})]})})})]})}function s9({text:e,percentage:t,resourceContent:n,setOverSpaceLimit:a}){let i=t/100*s7+(e.length>n.length?Math.abs(e.length-n.length):-Math.abs(e.length-n.length)),r=Math.floor(i/s7*100),s=i>s7;return((0,F.useEffect)(()=>{a(s)},[s,a]),s)?(0,c.jsx)(nA.A.Validation,{variant:"error",children:`Total percent used: ${r}%`}):(0,c.jsx)(nA.A.Caption,{children:`Total percent used: ${r}%`})}try{s8.displayName||(s8.displayName="TextFileDialog")}catch{}try{s9.displayName||(s9.displayName="CharacterCount")}catch{}let oe=({children:e,findFileWorkerPath:t,onResourcesAdded:n,owner:a,sizePercentage:i,resourcesToSave:r})=>{let[s,o]=(0,F.useState)(!1),[l,d]=(0,F.useState)(!1),[u,m]=(0,F.useState)(!1),{getCopilotSpaceResourceSizes:h}=s1(),g=async e=>{let t=await h({resources:e});n(e.map(e=>{let n=t[e.id];return{...e,fileExists:!0,markedForDestroy:!1,sizePercentage:n}})),d(!1)},f=(0,F.useRef)(null),y=p.W.spacesIssuesPrsEnabled;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ec.W,{anchorRef:f,children:[(0,c.jsx)(ec.W.Anchor,{children:e}),(0,c.jsx)(ec.W.Overlay,{align:"end",width:y?"small":void 0,children:(0,c.jsxs)(ed.l,{children:[(0,c.jsxs)(ed.l.Item,{onSelect:()=>{d(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.FileCodeIcon,{})}),"Add files, folders..."]}),(0,c.jsxs)(ed.l.Item,{onSelect:()=>{o(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PlusIcon,{})}),"Add a text file"]}),y&&(0,c.jsxs)(ed.l.Item,{onSelect:()=>{m(!0)},children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PasteIcon,{})}),"Add via GitHub URL..."]})]})})]}),s&&(0,c.jsx)(s8,{sizePercentage:i,onClose:()=>o(!1),onSave:e=>n([e])}),l&&(0,c.jsx)(rD.Q,{formData:[],onCancel:()=>{d(!1)},onSave:g,findFileWorkerPath:t,attachmentButtonRef:f,owner:a,openRepoPanel:!0}),u&&(0,c.jsx)(s4,{onClose:()=>m(!1),onSave:e=>n(e),resourcesToSave:r,owner:a})]})};try{oe.displayName||(oe.displayName="AddAttachmentMenu")}catch{}var ot=n(3830);let on={capitalize:"ColorPicker-module__capitalize--TSveX"},oa=rY.map(e=>({leadingVisual:()=>(0,c.jsx)("span",{className:sk[e],style:{display:"inline-block",width:12,height:12,backgroundColor:"var(--avatar-foregroundColor)",borderRadius:"50%"}}),key:e,text:e,color:e}));function oi({value:e,onChange:t}){let[n,a]=(0,F.useState)(!1),[i,r]=(0,F.useState)(""),s=(0,F.useMemo)(()=>oa.filter(t=>t.text===e||t.text?.toLowerCase().startsWith(i.toLowerCase())),[i,e]),o=(0,F.useMemo)(()=>oa.find(t=>t.text===e),[e]),l=(0,F.useId)();return(0,c.jsxs)(nA.A,{children:[(0,c.jsx)(nA.A.Label,{visuallyHidden:!0,htmlFor:l,children:"Color"}),(0,c.jsx)(ot.X,{renderAnchor:({children:e,...t})=>(0,c.jsxs)(e0.Q,{...t,id:l,size:"small",trailingAction:j.TriangleDownIcon,"aria-haspopup":"dialog",className:on.capitalize,children:[(0,c.jsx)("span",{className:"fgColor-muted mr-1",children:"Color:"}),e]}),className:on.capitalize,overlayProps:{width:"small",maxHeight:"medium"},title:"Select a color",placeholder:"Select a color",open:n,onOpenChange:a,items:s,selected:o,placeholderText:"Filter colors",onSelectedChange:e=>{e&&t(e.text)},onFilterChange:r})]})}try{oi.displayName||(oi.displayName="ColorPicker")}catch{}let or={warningIcon:"ReferencesTable-module__warningIcon--cq0Jt",referenceTitle:"ReferencesTable-module__referenceTitle--AdOGq",referenceTitleLink:"ReferencesTable-module__referenceTitleLink--QooZ0"};function os({resources:e,onDeleteResource:t,onUpdateResource:n,sizePercentage:a}){let i=(0,F.useMemo)(()=>rz(e,ol),[e]),r=(0,F.useMemo)(()=>[{id:"id",header:"Name",rowHeader:!0,renderCell:e=>{switch(e.type){case"github_file":{let{filePath:t,fileName:n,fileUrl:a}=(0,ee.q5)(e);return(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"normal",children:[(0,c.jsx)(sv,{attachment:e,className:"fgColor-muted"}),(0,c.jsxs)(O.B,{gap:"none",children:[(0,c.jsx)("div",{children:e.fileExists?(0,c.jsx)(rN.A,{title:n,className:(0,en.$)(or.referenceTitle,"f5 text-normal"),children:(0,c.jsx)(em.A,{rel:"noopener",target:"_blank",href:a,className:or.referenceTitleLink,children:n})}):(0,c.jsx)(rN.A,{title:n,className:(0,en.$)(or.referenceTitle,"f5 text-normal"),children:n})}),(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:t,className:(0,en.$)(or.referenceTitle,"fgColor-muted"),children:t})})]})]})}case"free_text":return(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"normal",children:[(0,c.jsx)(sv,{attachment:e,className:"fgColor-muted"}),(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:e.name,maxWidth:300,className:(0,en.$)(or.referenceTitle,"f5 text-normal"),children:e.name})})]});case"github_pull_request":case"github_issue":return(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"normal",children:[(0,c.jsx)("span",{children:(0,c.jsx)(sv,{attachment:e,className:"fgColor-success"})}),(0,c.jsxs)(O.B,{gap:"none",children:[(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:e.title||"",className:(0,en.$)(or.referenceTitle,"f5 text-bold"),children:(0,c.jsxs)(em.A,{rel:"noopener",target:"_blank",href:e.url,className:or.referenceTitleLink,children:[e.title," ",(0,c.jsx)("span",{className:"fgColor-muted text-light",children:`#${e.number}`})]})})}),(0,c.jsx)("div",{children:(0,c.jsx)(rN.A,{title:e.nwo||"",className:(0,en.$)(or.referenceTitle,"fgColor-muted"),children:e.nwo})})]})]});default:return null}}},{id:"size",header:"Size",align:"end",maxWidth:"auto",width:"growCollapse",renderCell:e=>(0,c.jsx)("span",{className:"fgColor-muted",children:e.sizePercentage&&e.sizePercentage<1?"<1%":`${Math.round(e.sizePercentage||0)}%`})},{id:"actions",header:()=>(0,c.jsx)(r$.s,{children:"Actions"}),maxWidth:"auto",align:"end",renderCell:e=>{let i="github_file"===e.type&&!e.fileExists;return(0,c.jsxs)(c.Fragment,{children:[i&&(0,c.jsx)(M.K,{className:or.warningIcon,icon:j.AlertIcon,variant:"invisible",size:"small","aria-label":"This file no longer exists"}),(0,c.jsx)(oo,{row:e,onEdit:n,onDelete:t,sizePercentage:a})]})}}],[t,n,a]);return(0,c.jsx)(nX.X.Container,{children:(0,c.jsx)(nY.b,{"aria-labelledby":"references-title",cellPadding:"normal",data:i,columns:r})})}let oo=({row:e,onDelete:t,onEdit:n,sizePercentage:a})=>{let[i,r]=(0,F.useState)(null);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ec.W,{children:[(0,c.jsx)(ec.W.Anchor,{children:(0,c.jsx)(M.K,{"aria-label":"Resource actions",title:"Resource actions",icon:j.KebabHorizontalIcon,variant:"invisible"})}),(0,c.jsx)(ec.W.Overlay,{align:"end",children:(0,c.jsxs)(ed.l,{children:["free_text"===e.type&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(ed.l.Item,{onSelect:()=>r(e),children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.PencilIcon,{})}),"Edit"]})}),(0,c.jsxs)(ed.l.Item,{variant:"danger",onSelect:()=>t(e),children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(j.TrashIcon,{})}),"Delete"]})]})})]}),i&&(0,c.jsx)(s8,{sizePercentage:a,resource:i,onSave:n,onClose:()=>r(null)})]})},ol=e=>{switch(e.type){case"github_file":return`${e.repositoryId}@${e.filePath}`;case"github_issue":case"github_pull_request":return e.url;default:return e.id}};try{os.displayName||(os.displayName="ReferencesTable")}catch{}try{oo.displayName||(oo.displayName="RowActions")}catch{}let oc={page:"SpacesForm-module__page--GUtny",header:"SpacesForm-module__header--fGnc8",headerTitleContainer:"SpacesForm-module__headerTitleContainer--TusRL",headerTitleDivider:"SpacesForm-module__headerTitleDivider--Wb3ax",headerTitle:"SpacesForm-module__headerTitle--qj1HC",referencesSizeProgressBar:"SpacesForm-module__referencesSizeProgressBar--bUaQU",referencesSizeText:"SpacesForm-module__referencesSizeText--tbxmM",contextHeader:"SpacesForm-module__contextHeader--U4tA4",attachmentsHeading:"SpacesForm-module__attachmentsHeading--BIqcQ",form:"SpacesForm-module__form--MfKg6",optionalLabel:"SpacesForm-module__optionalLabel--lLHqo",iconPreviewContainer:"SpacesForm-module__iconPreviewContainer--GkGVD",iconPreviewTitle:"SpacesForm-module__iconPreviewTitle--ZbAS9",iconPreviewDescription:"SpacesForm-module__iconPreviewDescription--f2SVU",iconAvatarContainer:"SpacesForm-module__iconAvatarContainer--cYbtV"};function od({onSelect:e}){let[t,n]=(0,F.useState)([]),[a,i]=(0,F.useState)(!1),[r,s]=(0,F.useState)(void 0),o=t=>{s(t),e(t)};(0,F.useEffect)(()=>{(async()=>{try{let e=await (0,A.lS)("/github-copilot/chat/custom_copilots_owners"),t=await e.json(),a=t?.owners;if(!e.ok||!a){l();return}n(a),a[0]&&o(a[0])}catch{l()}})()},[]);let l=()=>{n([]),i(!0)};return(0,c.jsxs)(nA.A,{children:[(0,c.jsx)(nA.A.Label,{children:"Owner"}),(0,c.jsxs)(ec.W,{children:[(()=>{let e=r?.name||"Choose an owner",t=r?(0,c.jsx)(a8.r,{src:r.avatarUrl},r.avatarUrl):void 0;return(0,c.jsx)(ec.W.Button,{"data-testid":"owner-dropdown-anchor",alignContent:"start","aria-label":e,leadingVisual:t,children:e})})(),(0,c.jsx)(ec.W.Overlay,{responsiveVariant:"fullscreen",width:"large",maxHeight:"large",sx:{overflow:"auto"},children:(0,c.jsx)(ed.l,{children:(0,c.jsx)(ed.l.Group,{sx:{maxHeight:350,overflow:"auto"},children:(0,c.jsxs)(ed.l,{selectionVariant:"single",children:[t&&t.map(e=>{let{name:t,avatarUrl:n,displayName:a}=e;return(0,c.jsxs)(ed.l.Item,{selected:t===r?.name,onSelect:()=>o(e),children:[(0,c.jsx)(ed.l.LeadingVisual,{children:(0,c.jsx)(a8.r,{src:n})}),t,(0,c.jsx)(ed.l.Description,{children:a})]},t)}),!t.length&&!a&&(0,c.jsx)(ed.l.Item,{disabled:!0,children:"Fetching owners\u2026"},"fetching-owners"),a&&(0,c.jsx)(ed.l.Item,{disabled:!0,sx:{color:"danger.fg"},children:"An error occurred while loading owners. Please reopen the dialog to try again."},"error-fetching-owners")]})})})})]}),(0,c.jsx)(nA.A.Caption,{children:"Where we will store your space. Once created the space is not transferable."})]})}try{od.displayName||(od.displayName="SpacesOwnerDropdown")}catch{}let ou="auburn";function om({copilotSpace:e,onCancel:t}){(0,S.N)(()=>{let e=document.querySelector("header.AppHeader");e&&(e.style.display="none");let t=document.querySelector(".with-global-sidebar .application-main");return t&&(t.style.marginLeft="0"),()=>{e&&(e.style.display=""),t&&(t.style.marginLeft="")}},[]);let n=(0,k.Z)(),{upsertCopilotSpace:a,isPending:i}=rA(e),[r,s]=(0,F.useState)(e?.iconColor??ou),[o,l]=(0,F.useState)(e?.name??""),[d,u]=(0,F.useState)(e?.description??""),[m,p]=(0,F.useState)(e?.generalInstructions??""),[h,g]=(0,F.useState)(e?.resources??[]),[f,y]=(0,F.useState)(null),x=(0,F.useMemo)(()=>{if(f?.type==="Organization"||e?.ownerIsOrg)return f?.name||e?.owner},[e,f]),[v,_]=(0,F.useState)({}),b=h.filter(e=>!e.markedForDestroy),C=(0,F.useRef)(null),N=!!e,w=(0,F.useMemo)(()=>b.reduce((e,t)=>e+(t.sizePercentage||0),0),[b]),I=(0,F.useId)(),T=w>100,A=(0,F.useMemo)(()=>({name:e?.name.trim()||"",description:(e?.description||"").trim(),generalInstructions:(e?.generalInstructions||"").trim(),owner:e?.owner||"",iconColor:e?.iconColor||ou,resources:e?.resources||[]}),[e]),E=(0,F.useMemo)(()=>o.trim()!==A.name||d.trim()!==A.description||m.trim()!==A.generalInstructions||r!==A.iconColor||h.filter(e=>{if(e.markedForDestroy||!e.databaseId)return!0;if("free_text"===e.type){let t=A.resources.find(t=>t.databaseId===e.databaseId);return!t||e.text.trim()!==t.text.trim()||e.name.trim()!==t.name.trim()}}).length>0,[A,o,d,m,r,h]),R=async()=>{if(!i)try{let e=await a({name:o,description:d,generalInstructions:m,ownerId:f?.id,ownerType:f?.type,resources:h,iconColor:r,iconType:"SpacesIcon"});_({});let t=(0,ee.Cb)(e);return n(t)}catch(e){_(e??{})}};function P(e){let t={...v};for(let n of e)t[n]&&delete t[n];_(t)}return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:oc.header,children:[(0,c.jsxs)("div",{className:oc.headerTitleContainer,children:[(0,c.jsx)(M.K,{icon:j.XIcon,"aria-label":"Close",variant:"invisible",onClick:t}),(0,c.jsx)("div",{className:oc.headerTitleDivider,"aria-hidden":"true"}),(0,c.jsx)("h1",{className:oc.headerTitle,id:"page-title",children:N?"Edit space":"New space"})]}),(0,c.jsxs)(O.B,{align:"center",direction:"horizontal",gap:"condensed",children:[E&&e&&(0,c.jsxs)("div",{className:"fgColor-attention text-small mr-2",children:[(0,c.jsx)(j.DotFillIcon,{size:14}),(0,c.jsx)("span",{children:" Unsaved changes"})]}),(0,c.jsx)(e0.Q,{onClick:t,children:"Cancel"}),(0,c.jsx)(e0.Q,{type:"submit",variant:"primary",form:I,loading:i,children:"Save"})]})]}),(0,c.jsx)("div",{className:oc.page,children:(0,c.jsxs)("form",{id:I,className:oc.form,onSubmit:e=>{e?.preventDefault(),R()},children:[v.base&&(0,c.jsx)(B.l,{title:"Failed to save this space",description:v.base,variant:"critical",className:"mb-2"}),(0,c.jsxs)(nA.A,{children:[(0,c.jsx)(nA.A.Label,{children:"Name"}),(0,c.jsx)(nE.A,{autoFocus:!0,block:!0,name:"name",value:o,onChange:e=>{l(e.target.value),P(["name","slug"])}}),v.name?(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsxs)("span",{children:["Name ",v.name]})}):v.slug?(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsx)("span",{children:ee.j0})}):null,(0,c.jsx)(nA.A.Caption,{children:"Memorable name that helps you find your space."})]}),(0,c.jsxs)("div",{className:oc.iconPreviewContainer,children:[(0,c.jsx)("div",{className:oc.iconAvatarContainer,children:(0,c.jsx)(sT,{size:24,color:r})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:oc.iconPreviewTitle,children:"Icon"}),(0,c.jsx)("div",{className:oc.iconPreviewDescription,children:"Pick a color to make your space more recognizable."}),(0,c.jsx)(oi,{value:r,onChange:s})]})]}),!N&&(0,c.jsx)(od,{onSelect:e=>y(e)}),(0,c.jsxs)(nA.A,{children:[(0,c.jsxs)(nA.A.Label,{required:!1,requiredIndicator:!0,children:["Description ",(0,c.jsx)("span",{className:oc.optionalLabel,children:"(optional)"})]}),(0,c.jsx)(D.Ay,{block:!0,name:"description",value:d,rows:3,resize:"vertical",onChange:e=>{u(e.target.value),P(["description"])}}),v.description?(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsxs)("span",{children:["Description ",v.description]})}):(0,c.jsx)(op,{text:d,promptCharLimit:350}),(0,c.jsx)(nA.A.Caption,{children:"Displays beneath the title on your spaces overview page without impacting responses."})]}),(0,c.jsxs)(nA.A,{id:"instructions",children:[(0,c.jsxs)(nA.A.Label,{required:!1,requiredIndicator:!0,children:["Instructions ",(0,c.jsx)("span",{className:oc.optionalLabel,children:"(optional)"})]}),(0,c.jsx)(D.Ay,{block:!0,name:"instructions",value:m,resize:"vertical",onChange:e=>{p(e.target.value),P(["general_instructions"])}}),v.general_instructions?(0,c.jsx)(nA.A.Validation,{variant:"error",children:(0,c.jsxs)("span",{children:["Instructions ",v.general_instructions]})}):(0,c.jsx)(op,{text:m,promptCharLimit:4e3}),(0,c.jsx)(nA.A.Caption,{children:"Changes how Copilot responds on specific questions or tasks."})]}),(0,c.jsxs)("div",{id:"attachments",children:[(0,c.jsxs)("div",{className:oc.contextHeader,children:[(0,c.jsxs)("div",{className:oc.attachmentsHeading,children:["Attachments ",(0,c.jsx)("span",{className:oc.optionalLabel,children:"(optional)"})]}),(0,c.jsxs)(O.B,{direction:"horizontal",align:"center",gap:"none",children:[w>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(rP.z,{inline:!0,barSize:"small",progress:w,className:oc.referencesSizeProgressBar}),(0,c.jsxs)("span",{className:oc.referencesSizeText,children:[w<1?"<1":Math.round(w),"%"]})]}),(0,c.jsx)(oe,{sizePercentage:w,findFileWorkerPath:"",owner:x,onResourcesAdded:e=>{g(t=>{let n=new Map(t.map(e=>[e.id,e]));for(let t of e)n.set(t.id,t);return Array.from(n.values())})},resourcesToSave:h,children:(0,c.jsx)(e0.Q,{size:"small",leadingVisual:j.PlusIcon,ref:C,children:"Add"})})]})]}),T&&(0,c.jsx)(rt,{}),v["resources.repository"]&&(0,c.jsx)(rn,{}),0===b.length?(0,c.jsx)("div",{children:(0,c.jsxs)(ep.E,{border:!0,spacious:!0,children:[(0,c.jsx)(ep.E.Visual,{children:(0,c.jsx)(j.PaperclipIcon,{size:24})}),(0,c.jsx)(ep.E.Description,{children:"Add text, code files, or GitHub data to set a permanent context"})]})}):(0,c.jsx)(os,{sizePercentage:w,resources:b,onDeleteResource:function(e){e.databaseId?g(t=>t.map(t=>e.databaseId===t.databaseId?{...t,markedForDestroy:!0}:t)):g(t=>t.filter(t=>t.id!==e.id))},onUpdateResource:function(e){g(h.map(t=>t.id===e.id?e:t))}})]})]})})]})}function op({text:e,promptCharLimit:t}){let n=e.length>t,a=(0,c.jsxs)(c.Fragment,{children:[e.length.toLocaleString()," / ",t.toLocaleString()," characters"]});return(0,c.jsx)(c.Fragment,{children:n?(0,c.jsx)(nA.A.Validation,{variant:"error",children:a}):(0,c.jsx)(nA.A.Caption,{children:a})})}try{om.displayName||(om.displayName="SpacesForm")}catch{}try{op.displayName||(op.displayName="CharacterCount")}catch{}function oh(){let e=(0,k.Z)(),t=(0,ee.iI)(),{isPending:n,data:a,error:i}=(0,et.TB)(t);return i instanceof et.Be?(0,c.jsx)(rI,{}):n?(0,c.jsx)(iw,{}):(0,c.jsx)(om,{copilotSpace:a,onCancel:function(){e((0,ee.Cb)(a))}})}try{oh.displayName||(oh.displayName="SpacesEditPage")}catch{}function og(){let e=(0,k.Z)();return(0,c.jsx)(om,{onCancel:function(){e(m.VR)}})}try{og.displayName||(og.displayName="SpacesNewPage")}catch{}function of(){let e=(0,h.Pk)(),{customCopilots:t}=e,{reloadQuota:n}=(0,X.xR)(),a=(0,F.useRef)(null),{previewPaneOpen:i}=(0,q.xx)(),r=(0,u.nu)((0,h.A3)("activePlugin")),s=(0,ea.zy)(),o=(0,et.BV)(),l=p.W.customCopilotOrgOwned,d=o&&(0,ee.VR)(),m=o&&p.W.customCopilotsRedesign&&(0,ee.zY)(),g=o&&p.W.customCopilotsRedesign&&(0,ee.E1)(),f=(0,ee.iI)();(0,et.xs)(o);let y=(0,F.useCallback)(()=>{window.setTimeout(()=>{a.current?.focus()},1),n()},[n,a]),x=(0,F.useRef)(null),[v,_]=(0,F.useState)(()=>!!x.current&&x.current.clientWidth<=1024),[b,j]=(0,F.useState)(()=>x.current?x.current.clientWidth>1024&&(Y.J.getImmersiveSidebarCollapsedState()??!0):Y.J.getImmersiveSidebarCollapsedState()??!0),[C,N]=(0,F.useState)(!1);(0,F.useEffect)(()=>{if(!x.current)return;let e=()=>{let e=x.current?.clientWidth;void 0!==e&&(e<=1024?(_(!0),j(!1)):(_(!1),N(!1),j(Y.J.getImmersiveSidebarCollapsedState()??!0)))},t=new ResizeObserver(()=>{e()});return t.observe(x.current),e(),()=>{t.disconnect()}},[C]);let w=!v&&b,I=!!v&&C,S=(0,F.useRef)(null),[k,T]=(0,F.useState)(()=>!!S.current&&S.current.clientWidth<=1280);return(0,F.useEffect)(()=>{if(!S.current)return;let e=()=>{let e=S.current?.clientWidth;void 0!==e&&e>0&&T(e<=1280)},t=new ResizeObserver(e);return t.observe(S.current),e(),()=>t.disconnect()},[]),(0,c.jsxs)("div",{className:(0,en.$)(nm.container,!r&&k&&nm.fullscreenPreviewPane,r?.fullscreenPreviewArea&&nm.fullscreenPluginPane),"data-testid":"chat-layout","data-hpc":!0,ref:S,children:[(0,c.jsx)("span",{"data-favicon-override":"/favicons/favicon-copilot.svg"}),r?.PageComponent&&r?.matchPage?.(s)?(0,c.jsx)("div",{className:nm.main,children:(0,c.jsx)(oy,{plugin:r})}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:nm.left,ref:x,hidden:k&&i,children:[m||g?null:(0,c.jsx)(rj,{isVisible:I,isPinned:w,isFloating:v,onNewThread:y,onToggle:()=>{if(v)N(!C);else{let e=!b;j(e),Y.J.setImmersiveSidebarCollapsedState(e)}}}),(0,c.jsx)("div",{className:nm.main,children:d?l?(0,c.jsx)(s0,{copilotSpaces:t}):(0,c.jsx)(sQ,{copilotSpaces:t}):m?(0,c.jsx)(og,{}):g?(0,c.jsx)(oh,{}):r?.ViewComponent&&r?.matchView?.(s)?(0,c.jsx)(ox,{plugin:r}):f?(0,c.jsx)(sV,{customCopilotId:f,selectedThreadID:e.selectedThreadID,textAreaRef:a}):(0,c.jsx)(rs,{isMobile:k,textAreaRef:a,isSidebarOpen:v?I:w},e.selectedThreadID)})]}),(0,c.jsx)("div",{className:(0,en.$)(nm.previewPane,i&&nm.active),children:(0,c.jsx)("div",{className:(0,en.$)(nm.viewer),children:(0,c.jsx)(t7,{returnFocusRef:a})})})]})]})}function oy({plugin:e}){let t=(0,h.Pk)(),{PageComponent:n}=e;return n?(0,c.jsx)(n,{chatState:t,plugin:e}):null}function ox({plugin:e}){let t=(0,h.Pk)(),{closePreviewPane:n,openPreviewPane:a}=(0,q.xx)(),{ViewComponent:i}=e;return i?(0,c.jsx)(i,{chatState:t,closePreviewPane:n,openPreviewPane:a,plugin:e}):null}try{of.displayName||(of.displayName="Layout")}catch{}try{oy.displayName||(oy.displayName="PluginPageContent")}catch{}try{ox.displayName||(ox.displayName="PluginViewContent")}catch{}function ov(e){let t=b.fV.pathname;return(0,F.useMemo)(()=>{let n=e.find(e=>e.routes?.some(e=>e.test(t)));return n?n.id:null},[t,e])}var o_=n(99425);let ob=(0,y.E7)();function oj(){return(0,c.jsx)(H.RelayEnvironmentProvider,{environment:ob,children:(0,c.jsx)(oC,{})})}function oC(){let e=(0,f.X)();return e?.copilotChatSettingEnabled?(0,c.jsx)(oN,{children:(0,c.jsx)(ow,{})}):(0,c.jsx)(Z,{})}function oN({children:e}){let t=(0,f.X)(),n=nt(),{refs:a,topic:i}=(0,F.useMemo)(()=>{let e=t.requestedTopic;return(0,m.P)(e)?{refs:[(0,m.UU)(e)],topic:void 0}:t.reference?{refs:[t.reference],topic:e}:{refs:[],topic:e}},[t.requestedTopic,t.reference]),r=(0,F.useMemo)(()=>{let e=[];return p.W.pipesPlugin&&e.push(new g.N(t.apiURL,t.graphqlApiUrl,t.ssoOrganizations.map(e=>e.id),t.previewUrl,t.realIp)),p.W.workbenchPlugin&&e.push(new SparkPlugin),e},[t.apiURL,t.graphqlApiUrl,t.realIp,t.ssoOrganizations,t.previewUrl]),s=ov(r);return(0,c.jsx)(x.LB,{children:(0,c.jsx)(u.Hb,{plugins:r,children:(0,c.jsx)(h.Mj,{workerPath:t.searchWorkerFilePath,threadId:n,pluginId:s,refs:a,mode:"immersive",topic:i,ssoOrganizations:t.ssoOrganizations,copilotUpsellBannerDismissed:t.copilotUpsellBannerDismissed,copilotChatPayload:t,children:(0,c.jsx)(q.BH,{children:e})})})})}function ow(){return!function(){let e=nt(),t=(0,F.useRef)(!0),n=(0,F.useRef)(null),a=(0,e9.b)(),{threads:i,selectedThreadID:r}=(0,h.Pk)(),s=t8();(function(){let{selectedThreadID:e,sharedThreadChannel:t}=(0,h.Pk)(),n=(0,e9.b)();(0,o_.x)(t,()=>{n.fetchSharedThreadMessages(e)})})(),(0,F.useEffect)(()=>{s?a.fetchSharedThreadMessages(r):a.fetchMessages(r)},[]),(0,F.useEffect)(()=>{if(t.current){t.current=!1,n.current=e;return}if(n.current!==e){if(n.current=e,e===r)return;let t=e&&i?.get(e);a.selectThread(t||null,{includeThreads:!1,clearTopic:!0})}},[a,e,i,r])}(),function(){let{selectedThreadID:e}=(0,h.Pk)(),t=(0,u.nu)((0,h.A3)("activePlugin")),n=(0,tp.M)((0,ea.Zp)());(0,F.useEffect)(()=>{if(!e||t?.skipSyncRouteToThread)return;let a=`${m.Jz}/c/${e}`,i=`${m.Jz}/share/${e}`,r=window.location.pathname;r.startsWith(a)||r.startsWith(i)||n.current(a)},[n,t?.skipSyncRouteToThread,e])}(),function(){let e=(0,e9.b)();(0,F.useEffect)(()=>{let t=()=>{window.location.href.includes("/r/")?(e.showTopicPicker(!1),e.selectThread(null)):window.location.href.includes("/c/")||(e.showTopicPicker(!0),e.selectThread(null))};return window.addEventListener("popstate",t),()=>{window.removeEventListener("popstate",t)}},[e])}(),!function(){let e=ov((0,u.qw)()),t=nt(),{activePlugin:n}=(0,h.bP)("activePlugin"),a=(0,e9.b)();(0,F.useEffect)(()=>{t||(n??null)===e||a.selectPlugin(e)},[n,a,e,t])}(),(0,c.jsx)(of,{})}try{oj.displayName||(oj.displayName="CopilotImmersive")}catch{}try{oC.displayName||(oC.displayName="CopilotImmersiveNoRelay")}catch{}try{oN.displayName||(oN.displayName="CopilotImmersiveProviders")}catch{}try{ow.displayName||(ow.displayName="Immersive")}catch{}(0,l.o)("copilot-immersive-v1",()=>({App:d,routes:[(0,o.a)({path:"/copilot",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/c/:threadID",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/d/:docsetName",Component:oj}),(0,o.a)({path:"/copilot/r/:owner/:repository",Component:oj}),(0,o.a)({path:"/copilot/share/:threadID",Component:oj}),(0,o.a)({path:"/copilot/loop/share",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/loops",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/l/:loopID",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/workbench",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/spark",Component:oj,transitionType:s.E.TRANSITION_WITHOUT_FETCH}),(0,o.a)({path:"/copilot/spaces",Component:oj}),(0,o.a)({path:"/copilot/spaces/:spaceID",Component:oj}),(0,o.a)({path:"/copilot/spaces/:owner/:spaceNumber",Component:oj}),(0,o.a)({path:"/copilot/spaces/:owner/:spaceNumber/edit",Component:oj}),(0,o.a)({path:"/copilot/spaces/:spaceID/edit",Component:oj}),(0,o.a)({path:"/copilot/spaces/new",Component:oj})]}))},32837:(e,t,n)=>{n.d(t,{B:()=>i});var a=n(96540);function i(e){let[t,n]=(0,a.useState)(e);return[t,(0,a.useCallback)(()=>n(!0),[]),(0,a.useCallback)(()=>n(!1),[])]}},40186:(e,t,n)=>{n.d(t,{N:()=>PipesPlugin});var a,i,r,s,o=n(74848),l=n(21728),c=n(96540),d=n(34164),u=n(58748),m=n(87330),p=n(38621),h=n(65615),g=n(46988),f=n(27314),y=n(78075);let x={canvasContainer:"Canvas-module__canvasContainer--DcP1I",canvasGraph:"Canvas-module__canvasGraph--oUp5H",diagram:"Canvas-module__diagram--HYI6K",gridPattern:"Canvas-module__gridPattern--CD_S7",nodesOverlay:"Canvas-module__nodesOverlay--oHrnE",nodeWrapper:"Canvas-module__nodeWrapper--jkBOV"};function v(e){return"text"===e.type}let _={code:{color:"pink",contentFields:["content"],icon:()=>p.CodeIcon,description:()=>"Use classic code to process a node",label:()=>"Code",featureFlag:"copilot_pipes_react_nodes",type:"code",outputLabel:"Code output"},"github-graphql":{contentFields:["content"],icon:()=>p.MarkGithubIcon,description:()=>"Retrieve data from GitHub",label:()=>"GitHub GraphQL",color:"gray",featureFlag:"copilot_pipes_github_graphql_nodes",type:"github-graphql",outputLabel:"JSON"},loop:{contentFields:["content"],icon:()=>p.GitPullRequestIcon,description:()=>"Use an existing pipeline as a node",label:()=>"Pipeline",color:"coral",featureFlag:"copilot_pipes_pipeline_nodes",type:"loop",outputLabel:"Pipeline output"},prompt:{contentFields:["content"],icon:()=>p.CopilotIcon,description:()=>"Use AI to process a node",label:()=>"Prompt",color:"purple",type:"prompt",outputLabel:"Markdown"},text:{contentFields:["content"],icon:e=>e&&v(e)?b(e,"icon"):p.TypographyIcon,description:e=>e&&v(e)?b(e,"description"):"Input for nodes",label:e=>e&&v(e)?b(e,"name"):"Input",color:"blue",type:"text"},visualize:{contentFields:["content"],icon:()=>p.GitBranchIcon,description:()=>"Use HTML and CSS to view output",label:()=>"Visualize",color:"olive",featureFlag:"copilot_pipes_react_nodes",type:"visualize"}};function b(e,t){return(j[e.inputType.type]??j.text)[t]}let j={range:{name:"Range",description:"A numeric value within a specified range",icon:p.NumberIcon},text:{name:"Text",description:"Free form text input",icon:p.TypographyIcon},boolean:{name:"Boolean",description:"True or false value",icon:p.CheckIcon},select:{name:"Select",description:"Choose from a list of predefined options",icon:p.ListUnorderedIcon},file:{name:"File",description:"Upload and reference a file",icon:p.FileIcon}},C=(e,t)=>{let n=_[e.type];if(!n)return e;let a={...e};for(let i of n.contentFields)e[i]&&(a[i]=function(e,t,n=!1){let a=N();return e.replace(a,(e,a,i)=>{if(!a||!Object.keys(t).includes(a))return e;let r=t[a];if(i){if("object"==typeof r&&null!==r){try{r=function(e,t){if(!t||!e)return null;let n=t.split("."),a=e;for(let e of n){if(null==a||"object"!=typeof a)return null;a=a[e]}return a}(r,i)}catch(e){throw Error(`Error accessing path "${i}" on node with ID "${a}"`)}if(null===r)throw Error(`Path "${i}" on node with ID "${a}" does not have a value`)}else throw Error(`Cannot access path "${i}" on non-object node with ID "${a}"`)}let s=r;return"string"!=typeof s||n?JSON.stringify(s):s})}(e[i],t,["code","visualize"].includes(e.type)));return a},N=()=>/{{([\w-]+)(?:\.([.\w-]+))?(?:\|([\w-]+))?}}/g;async function w(e){return[{role:"user",content:`${e.content}

Respond with only the content\u{2014}no introductions, explanations, or extra text.

Don't wrap the response in a code block.`}]}let I=e=>{let t={nodes:new Map,edges:[],layers:[]};if(!e.nodes)return t;for(let n of e.nodes){if(!n?.id)continue;let e=k(n.id);t.nodes.set(e,n)}for(let n of e.nodes)for(let e of S(n)){let a=k(e);n?.id&&a&&t.edges.push({from:a,to:n.id})}let n=function(e){let t={},n=new Set,a=(i,r=0)=>{try{if(n.has(i))throw Error(`Potential cycle detected at node ${i}`);if(n.add(i),r>100)return!function(...e){}(`Maximum recursion depth reached for node ${i}`),0;if(void 0!==t[i])return t[i];let s=e.nodes.get(i);if(!s)return t[i]=0,0;let o=S(s);if(o&&0!==o.size){let e=[...o].map(e=>{let t=k(e);return a(t,r+1)});t[i]=Math.max(...e)+1}else{let n=e.edges.filter(e=>e.from===i).map(e=>e.to);0===n.length?t[i]=-1:t[i]=1}return t[i]}finally{n.delete(i)}};for(let[n]of e.nodes)if(!t[n])try{a(n)}catch(e){t[n]=0}let i=Math.max(...Object.values(t))+1;for(let e of Object.keys(t))-1===t[e]&&(t[e]=i);let r=[];for(let[n,a]of Object.entries(t)){let t=e.nodes.get(n);t&&(r[a]||(r[a]=[]),r[a].push(t))}return r.filter(Boolean)}(t);return t.layers=n,t};function S(e){let t=N();return new Set((e.content.match(t)||[]).map(e=>e.replace(/[{}]/g,"")))}function k(e){return e.match(/^[^|.]+/)?.[0]??e}let T=(e,t)=>{if(!e||"object"!=typeof e||!e.title&&!e.description&&!e.content)return null;let n={...e,title:e.title||"",description:e.description||"",type:_[e.type]?e.type:"text",inputType:function(e){if(v(e))return j[e.inputType.type]?e.inputType:{type:"text"}}(e),content:e.content||"",id:(e.id||"").trim()};if("string"!=typeof n.content&&(n.content=""),"loop"===n.type){let e=t.find(e=>e.id===n.loopId);if(e){let t=n.loopInputValues?.reduce((e,t)=>(e[t.inputId]=t,e),{})||{};n.loopInputValues=e.nodes?.filter(e=>v(e)).map(e=>{let n=t[e.id];if(!n)throw Error(`Input not found for node ${e.id}`);return{inputId:e.id,nodeId:n.nodeId,doMapInput:!!n.doMapInput}})}}return n},A=(e,t)=>({...e,nodes:(e.nodes||[]).map(e=>T(e,t)).filter(e=>null!==e)});function E(e){let t=I(e);return e.nodes.filter(e=>!t.edges.some(t=>t.from===e.id)&&t.edges.some(t=>t.to===e.id))}var R=n(37304);let P={value:null,running:!1,pending:!1,progress:0},D={executionState:{nodes:{},iteration:0},uiState:{focusedNodeId:null,hoveredNodeId:null}};function L(e,t){return{...e,executionState:function(e,t){switch(t.type){case"RESTORE_EXECUTION_STATE":return{...t.executionState,nodes:Object.fromEntries(Object.entries(t.executionState.nodes).map(([e,t])=>[e,{...P,value:t.value,error:t.error}]))};case"CLEAR_NODE_RESULTS":{let n={...e.nodes};for(let e of t.nodeIds)delete n[e];return{...e,nodes:n}}case"SET_RUNNING":if(t.iteration!==e.iteration)return e;return{...e,nodes:{...e.nodes,[t.nodeId]:{...e.nodes[t.nodeId]??P,running:t.running}}};case"SET_PENDING":if(t.iteration!==e.iteration)return e;return{...e,nodes:{...e.nodes,[t.nodeId]:{...e.nodes[t.nodeId]??P,pending:t.pending}}};case"UPDATE_PROGRESS":if(t.iteration!==e.iteration)return e;return{...e,nodes:{...e.nodes,[t.nodeId]:{...e.nodes[t.nodeId]??P,progress:t.progress}}};case"UPDATE_NODE_VALUE":if(t.iteration!==e.iteration)return e;return{...e,nodes:{...e.nodes,[t.nodeId]:{...e.nodes[t.nodeId]??P,value:t.value}}};case"UPDATE_NODE_ERROR":if(t.iteration!==e.iteration)return e;return{...e,nodes:{...e.nodes,[t.nodeId]:{...e.nodes[t.nodeId]??P,error:t.error,value:null,running:!1}}};case"CLEAR_PENDING_NODES":if(t.iteration!==e.iteration)return e;return{...e,nodes:Object.fromEntries(Object.entries(e.nodes).map(([e,t])=>[e,{...t,pending:!1}]))};case"CANCEL_EXECUTION":if(t.iteration!==e.iteration)return e;return{...e,nodes:Object.fromEntries(Object.entries(e.nodes).map(([e,t])=>[e,{...t,running:!1,pending:!1,progress:0}]))};case"INCREMENT_ITERATION":return{...e,iteration:e.iteration+1};default:return e}}(e.executionState,t),uiState:function(e,t){switch(t.type){case"FOCUS_NODE":return{...e,focusedNodeId:t.nodeId};case"HOVER_NODE":return{...e,hoveredNodeId:t.nodeId};default:return e}}(e.uiState,t)}}var M=n(10124),O=n(38568);let B=(0,c.createContext)(new R.Lj(D)),F=(0,c.createContext)(()=>{});function $({children:e}){let[t,n]=(0,c.useReducer)(L,D),a=(0,M.AI)(t);(0,O.N)(()=>{a.value=t},[t,a]);let i=(0,c.useCallback)(e=>{n(e)},[n]);return(0,o.jsx)(B.Provider,{value:a,children:(0,o.jsx)(F.Provider,{value:i,children:e})})}function U(e){let t=(0,c.useContext)(B);if(!t)throw Error("usePipesStateLens can only be used inside a PipesProvider");let n=(0,M.Sk)(t,e);return(0,M.HN)(n)}function z(){let e;let t=(0,l.c)(2),n=(0,c.useContext)(B);if(!n)throw Error("useGetPipesState can only be used inside a PipesProvider");return t[0]!==n.value?(e=()=>n.value,t[0]=n.value,t[1]=e):e=t[1],e}function V(){return(0,c.useContext)(F)}try{B.displayName||(B.displayName="PipesStateContext")}catch{}try{F.displayName||(F.displayName="PipesDispatchContext")}catch{}try{$.displayName||($.displayName="PipesStateProvider")}catch{}let W={edge:"CompactStyleEdge-module__edge--fynPR",edgeDefault:"CompactStyleEdge-module__edgeDefault--UXQph",edgeCompleted:"CompactStyleEdge-module__edgeCompleted--M5O4j",edgeError:"CompactStyleEdge-module__edgeError--vDcBp",edgeCompletedAddOn:"CompactStyleEdge-module__edgeCompletedAddOn--mtyH1",edgeAddon:"CompactStyleEdge-module__edgeAddon--XQPi4",edgeIdleAddon:"CompactStyleEdge-module__edgeIdleAddon--cnjTs",edgeProcAddon:"CompactStyleEdge-module__edgeProcAddon--Ll2xI"};var H=n(97286),q=n(47767);let G=(0,c.createContext)(null),K=G.Provider;function Q(){let e=(0,c.useContext)(G);if(!e)throw Error("usePipesService must be used inside a PipesServiceProvider");return e}try{G.displayName||(G.displayName="PipesServiceContext")}catch{}function J(e){return!!e.dummy}let Z=[{id:"dummy-1",dummy:!0,title:"Edit writing",description:"Update writing to make it more engaging",updatedAt:"2025-01-01T00:00:00Z",nodes:[{id:"1a",title:"Your writing",description:"The writing you want to edit",type:"text",inputType:{type:"text"},content:`There is huge potential in building complex, repeatable pipelines that take advantage of LLM capabilities. A way for anyone to create and share tools. A few examples:

- Scientists sharing workflows for turning conference notes into a queryable artifact
- Scientists creating a pipeline for polishing a draft to adhere to proposal writing requirements
- Developers building a \u{201C}check for security flaws\u{201D} pipeline, accessible via API / vscode extension
- Library maintainers creating a \u{201C}make a new codebase with Next.js" or \u{201C}add Tailwind to your codebase\u{201D} pipeline
- Artists building a pipeline to generate images of a certain style. Or process a sketch into a branded image.
- Generating a customized analysis of all of a lawyer\u{2019}s cases
- Summarize medical research on a topic, using only the most trustable sources

I wager there\u{2019}s a huge market in building and discovering pipelines, and a good implementation will look a bit like ChatGPT with people of many stripes building and using them.

GitHub is the right place for this kind of ecosystem for a few reasons:

- It ties into the spirit of Open Source
- It already has a huge audience to help with the cold start problem
- It mirror\u{2019}s GitHub\u{2019}s mission to make \u{201C}code\u{201D} accessible to a larger audience and the platform valuable to more than just developers. The future will look like people of any occupation \u{201C}writing code\u{201D} (really, just building things with logic)`},{id:"2a",title:"Edit guide",description:"The guide on how to edit writing",type:"text",inputType:{type:"text"},content:`# Academish Voice

pvh / Aug 2022

Our publications follow what we call \u{201C}*academish*\u{201D} voice. We follow a largely academic style in our writing but avoid certain academic tendencies.

## Academic Style

- **Make no claims without support.** If you have made an unsupported claim consider its centrality to your argument. If \u{201C}many developers agree\u{201D}, we should be able to link to a source or describe how we know that. If you can\u{2019}t defend it, you should get rid of it.
- **Avoid absolutist language.** It\u{2019}s not \u{201C}the main problem\u{201D}, it\u{2019}s \u{201C}a problem\u{201D}. (Unless, of course, you can defend the claim.)
- **Be precise and specific with your descriptions.** Instead of saying something \u{201C}feels great\u{201D}, describe how it feels. Don\u{2019}t say something \u{201C}is a problem\u{201D} unless you describe what the problem is or to whom. If you\u{2019}re tempted to say something vague because you\u{2019}re not sure, either do enough research until you\u{2019}re sure, or don\u{2019}t say it.
- **Avoid hyperbole.** Use adjectives to add precision, not to persuade. Claiming \u{201C}immense benefits\u{201D} is only appropriate if you have developed a commercially viable fusion power plant. Delete words that are only for emphasis, and keep only those that add substance (e.g. quantify).
- **Structure your writing for incremental reading.** Don\u{2019}t bury the lede. A reader should be able to understand the goals and conclusions of an essay by reading the first couple of paragraphs. Individual sections should briefly reiterate any important material and/or link back to where it is introduced. This may feel repetitive at times but aids readers who take several sessions to read a piece or who jump straight to the sections that interest them.
- **Give credit to others.** Cite earlier work. Link to sources for terms and ideas. Give thanks to contributors, reviewers, and advisors.
- **Be humble and transparent about shortcomings and problems.** We want readers to build on our work, not buy our product.

## Ink & Switch Style

- **Assume the reader is an interested generalist.** Explain jargon. Academic writing is dense with domain terminology because it assumes readers are \u{201C}up to date on the field.\u{201D}  Ink & Switch Essays make use of marginalia in what we call \u{201C}asides\u{201D} to define uncommon terminology. Concretely, you don\u{2019}t need to gloss \u{201C}HTML\u{201D}, but you should probably gloss \u{201C}CRDT\u{201D}.
- **Carefully consider section headings.** Headings should legibly communicate the shape of the essay and serve as a roadmap for a reader to skip to the part of an essay that\u{2019}s most interesting to them. Similarly, avoid including unrelated material in a section with a particular title. If a user already knows \u{201C}How CRDTs Work\u{201D} then they shouldn\u{2019}t miss (much) important information about the project by skipping reading that section.
- **Embrace interactive demonstrations, animations, illustration, and videos.** Sometimes an illustration or demo can offer more clarity on a topic than text alone. As long as the content is self-contained and doesn\u{2019}t rely on external sources, it should be legible for many years to come and viewable offline.
- **It\u{2019}s okay to share hunches and beliefs as long as they\u{2019}re appropriately labeled.** Don\u{2019}t be shy about drawing conclusions, just be clear about the degree of confidence you have and where it comes from.
- **Ensure content looks good in PDF / printed form.** Obviously you lose the elements above, but the PDF version of a paper shouldn\u{2019}t have giant \u{25B6}\u{FE0F} icons obscuring an image. Interactive figures should display a meaningful static view.
- **Use \u{201C}asides\u{201D} for supportive content and marginalia.** Asides can expand on references to other work, link out to related projects, or just share interesting context or historical tidbits.
- **Deploy persuasive or emotional writing appropriately.** You can be enthusiastic in describing your goals but be modest in how you describe your solutions.
- **Keep it classy.** We don\u{2019}t dismiss other people\u{2019}s work or insult their products. Everything around you was made by someone working really hard on it. If we have found a better way, we should show gratitude to those who helped us realize the path forward and humility about our contributions.
- **Sweat the details.** Make sure your colors are carefully chosen. Images should be clear and at the right bit rate. Choose your words carefully. Interactions should be delightful.

The result of these elements should be an essay that is confident, accurate, and readable to almost anyone with a background in technology. Our essays are often long (probably too long) but should consistently reward patient reading and serve as a reference to their readers for many years to come.

---

## About this page

This document aims to articulate the stylistic elements and voice of Ink & Switch Essays.

### **September 1, 2022**

@Martin Kleppmann added some details on academic style.

### **August 17, 2022**

@Todd Matthews made some formatting edits for continuity and scanability.

### **August 16, 2022**

@Peter van Hardenberg created this document. Began with @Adam Wiggins\u{2019} "Essay Playbook" and added notes about Academish Voice, which aim to capture the stylistic elements he looks for when I reading essay drafts. Many of these elements came from @Martin Kleppmann  and @Adam Wiggins reviews of my past writing, so credit to them. This is probably quite useful for everyone working on an essay right now, but is probably not comprehensive. If I've missed anything or anything here is controversial or unclear please feel free to inquire.`},{id:"3a",title:"Edited writing",description:"Writing with suggested changes",type:"prompt",content:"You're a helpful writing tutor here to suggest changes to the writing. Use this guide: {{2a}}. Respond with a full, edited version of {{1a}}. You're a helpful writing tutor here to suggest changes to the writing. Use this guide: {{2a}}. Respond with a full, edited version of {{1a}}. You're a helpful writing tutor here to suggest changes to the writing. Use this guide: {{2a}}. Respond with a full, edited version of {{1a}}."}]},{id:"dummy-2",dummy:!0,title:"Document this function",description:"Document this function so it's easy to understand",updatedAt:"2025-01-01T00:00:00Z",nodes:[{id:"1b",title:"Function to document",description:"The function to document",content:`export function createNodePrompt(node: Node, nodeMap: Record<string, Node>): string {
  let content = node.content;
  const regex = /{{([\\w-]+)}}/g;
  let match;

  while ((match = regex.exec(content)) !== null) {
    const id = match[1];
    const referencedNode = nodeMap[id];
    if (referencedNode) {
      const replacementContent = createNodePrompt(referencedNode, nodeMap);
      content = content.replace(match[0], replacementContent);
    }
  }

  return content;
}`,type:"code"},{id:"2b",title:"Documentation guide",description:"The documentation for the function",content:`Minimum Viable Documentation
A small set of fresh and accurate docs is better than a large assembly of \u{201C}documentation\u{201D} in various states of disrepair.

Write short and useful documents. Cut out everything unnecessary, including out-of-date, incorrect, or redundant information. Also make a habit of continually massaging and improving every doc to suit your changing needs. Docs work best when they are alive but frequently trimmed, like a bonsai tree.

See also these Agile Documentation best practices.

Update Docs with Code
Change your documentation in the same CL as the code change. This keeps your docs fresh, and is also a good place to explain to your reviewer what you\u{2019}re doing.

A good reviewer can at least insist that docstrings, header files, README.md files, and any other docs get updated alongside the CL.

Delete Dead Documentation
Dead docs are bad. They misinform, they slow down, they incite despair in engineers and laziness in team leads. They set a precedent for leaving behind messes in a code base. If your home is clean, most guests will be clean without being asked.

Just like any big cleaning project, it\u{2019}s easy to be overwhelmed. If your docs are in bad shape:

Take it slow, doc health is a gradual accumulation.
First delete what you\u{2019}re certain is wrong, ignore what\u{2019}s unclear.
Get your whole team involved. Devote time to quickly scan every doc and make a simple decision: Keep or delete?
Default to delete or leave behind if migrating. Stragglers can always be recovered.
Iterate.
Prefer the Good Over the Perfect
Documentation is an art. There is no perfect document, there are only proven methods and prudent guidelines. See Better is better than best.

Documentation is the Story of Your Code
Writing excellent code doesn\u{2019}t end when your code compiles or even if your test coverage reaches 100%. It\u{2019}s easy to write something a computer understands, it\u{2019}s much harder to write something both a human and a computer understand. Your mission as a Code Health-conscious engineer is to write for humans first, computers second. Documentation is an important part of this skill.

There\u{2019}s a spectrum of engineering documentation that ranges from terse comments to detailed prose:

Meaningful names: Good naming allows the code to convey information that would otherwise be relegated to comments or documentation. This includes nameable entities at all levels, from local variables to classes, files, and directories.

Inline comments: The primary purpose of inline comments is to provide information that the code itself cannot contain, such as why the code is there.

Method and class comments:

Method API documentation: The header / Javadoc / docstring comments that say what methods do and how to use them. This documentation is the contract of how your code must behave. The intended audience is future programmers who will use and modify your code.

It is often reasonable to say that any behavior documented here should have a test verifying it. This documentation details what arguments the method takes, what it returns, any \u{201C}gotchas\u{201D} or restrictions, and what exceptions it can throw or errors it can return. It does not usually explain why code behaves a particular way unless that\u{2019}s relevant to a developer\u{2019}s understanding of how to use the method. \u{201C}Why\u{201D} explanations are for inline comments. Think in practical terms when writing method documentation: \u{201C}This is a hammer. You use it to pound nails.\u{201D}

Class / Module API documentation: The header / Javadoc / docstring comments for a class or a whole file. This documentation gives a brief overview of what the class / file does and often gives a few short examples of how you might use the class / file.

Examples are particularly relevant when there\u{2019}s several distinct ways to use the class (some advanced, some simple). Always list the simplest use case first.

README.md: A good README.md orients the new user to the directory and points to more detailed explanation and user guides:

What is this directory intended to hold?
Which files should the developer look at first? Are some files an API?
Who maintains this directory and where I can learn more?
See the README.md guidelines.

docs: The contents of a good docs directory explain how to:

Get started using the relevant API, library, or tool.
Run its tests.
Debug its output.
Release the binary.
Design docs, PRDs: A good design doc or PRD discusses the proposed implementation at length for the purpose of collecting feedback on that design. However, once the code is implemented, design docs should serve as archives of these decisions, not as half-correct docs (they are often misused).

Other external docs: Some teams maintain documentation in other locations, separate from the code, such as Google Sites, Drive, or wiki. If you do maintain documentation in other locations, you should clearly point to those locations from your project directory (for example, by adding an obvious link to the location from your project\u{2019}s README.md).

Duplication is Evil
Do not write your own guide to a common Google technology or process. Link to it instead. If the guide doesn\u{2019}t exist or it\u{2019}s badly out of date, submit your updates to the appropriate directory or create a package-level README.md. Take ownership and don\u{2019}t be shy: Other teams will usually welcome your contributions.`,type:"text",inputType:{type:"text"}},{id:"3b",title:"My personal skillset",description:"",content:"I'm a software engineer with 5 years of experience in building web applications. I'm skilled in JavaScript, TypeScript, React, and Node.js. I'm also familiar with Python and have experience with machine learning frameworks like TensorFlow and PyTorch. I'm comfortable with SQL and NoSQL databases, and have experience with Docker and Kubernetes. I'm a quick learner and I'm always looking to improve my skills.",type:"text",inputType:{type:"text"}},{id:"4b",title:"Documented code",description:"The code with documentation",content:`You're documenting your code for your team.

Update this code: {{1b}}

Using this guide: {{2b}}]

And incorporate {{3b}}`,type:"prompt"},{id:"5b",title:"Function tests",description:"Generate a test for the code",content:"You're generating a Jest test for {{4b}}. Our testing guidelines: {{6b}}",type:"prompt"},{id:"6b",title:"Testing guidelines",description:"The guidelines for testing",content:`The Test Anatomy

\u{26AA} \u{FE0F} 1.1 Include 3 parts in each test name
\u{2705} Do: A test report should tell whether the current application revision satisfies the requirements for the people who are not necessarily familiar with the code: the tester, the DevOps engineer who is deploying and the future you two years from now. This can be achieved best if the tests speak at the requirements level and include 3 parts:

(1) What is being tested? For example, the ProductsService.addNewProduct method

(2) Under what circumstances and scenario? For example, no price is passed to the method

(3) What is the expected result? For example, the new product is not approved


\u{274C} Otherwise: A deployment just failed, a test named \u{201C}Add product\u{201D} failed. Does this tell you what exactly is malfunctioning?


\u{1F447} Note: Each bullet has code examples and sometime also an image illustration. Click to expand



\u{26AA} \u{FE0F} 1.2 Structure tests by the AAA pattern
\u{2705} Do: Structure your tests with 3 well-separated sections Arrange, Act & Assert (AAA). Following this structure guarantees that the reader spends no brain-CPU on understanding the test plan:

1st A - Arrange: All the setup code to bring the system to the scenario the test aims to simulate. This might include instantiating the unit under test constructor, adding DB records, mocking/stubbing on objects, and any other preparation code

2nd A - Act: Execute the unit under test. Usually 1 line of code

3rd A - Assert: Ensure that the received value satisfies the expectation. Usually 1 line of code


\u{274C} Otherwise: Not only do you spend hours understanding the main code but what should have been the simplest part of the day (testing) stretches your brain


\u{26AA} \u{FE0F}1.3 Describe expectations in a product language: use BDD-style assertions
\u{2705} Do: Coding your tests in a declarative-style allows the reader to get the grab instantly without spending even a single brain-CPU cycle. When you write imperative code that is packed with conditional logic, the reader is forced to exert more brain-CPU cycles. In that case, code the expectation in a human-like language, declarative BDD style using expect or should and not using custom code. If Chai & Jest doesn't include the desired assertion and it\u{2019}s highly repeatable, consider extending Jest matcher (Jest) or writing a custom Chai plugin

\u{274C} Otherwise: The team will write less tests and decorate the annoying ones with .skip()


\u{26AA}  1.4 Stick to black-box testing: Test only public methods
\u{2705} Do: Testing the internals brings huge overhead for almost nothing. If your code/API delivers the right results, should you really invest your next 3 hours in testing HOW it worked internally and then maintain these fragile tests? Whenever a public behavior is checked, the private implementation is also implicitly tested and your tests will break only if there is a certain problem (e.g. wrong output). This approach is also referred to as behavioral testing. On the other side, should you test the internals (white box approach) \u{2014} your focus shifts from planning the component outcome to nitty-gritty details and your test might break because of minor code refactors although the results are fine - this dramatically increases the maintenance burden

\u{274C} Otherwise: Your tests behave like the boy who cried wolf: shouting false-positive cries (e.g., A test fails because a private variable name was changed). Unsurprisingly, people will soon start to ignore the CI notifications until someday, a real bug gets ignored\u{2026}


\u{26AA}  1.5 Choose the right test doubles: Avoid mocks in favor of stubs and spies
\u{2705} Do: Test doubles are a necessary evil because they are coupled to the application internals, yet some provide immense value (Read here a reminder about test doubles: mocks vs stubs vs spies).

Before using test doubles, ask a very simple question: Do I use it to test functionality that appears, or could appear, in the requirements document? If not, it\u{2019}s a white-box testing smell.

For example, if you want to test that your app behaves reasonably when the payment service is down, you might stub the payment service and trigger some \u{2018}No Response\u{2019} return to ensure that the unit under test returns the right value. This checks our application behavior/response/outcome under certain scenarios. You might also use a spy to assert that an email was sent when that service is down \u{2014} this is again a behavioral check which is likely to appear in a requirements doc (\u{201C}Send an email if payment couldn\u{2019}t be saved\u{201D}). On the flip side, if you mock the Payment service and ensure that it was called with the right JavaScript types \u{2014} then your test is focused on internal things that have nothing to do with the application functionality and are likely to change frequently

\u{274C} Otherwise: Any refactoring of code mandates searching for all the mocks in the code and updating accordingly. Tests become a burden rather than a helpful friend



\u{26AA} 1.6 Don\u{2019}t \u{201C}foo\u{201D}, use realistic input data
\u{2705} Do: Often production bugs are revealed under some very specific and surprising input \u{2014} the more realistic the test input is, the greater the chances are to catch bugs early. Use dedicated libraries like Chance or Faker to generate pseudo-real data that resembles the variety and form of production data. For example, such libraries can generate realistic phone numbers, usernames, credit cards, company names, and even \u{2018}lorem ipsum\u{2019} text. You may also create some tests (on top of unit tests, not as a replacement) that randomize fakers' data to stretch your unit under test or even import real data from your production environment. Want to take it to the next level? See the next bullet (property-based testing).

\u{274C} Otherwise: All your development testing will falsely show green when you use synthetic inputs like \u{201C}Foo\u{201D}, but then production might turn red when a hacker passes-in a nasty string like \u{201C}@3e2ddsf . ##\u{2019} 1 fdsfds . fds432 AAAA\u{201D}

`,type:"text",inputType:{type:"text"}},{id:"7b",title:"Test results",description:"Run the test for the code",content:"You're running tests for {{5b}}. Respond with the results of the tests.",type:"prompt"},{id:"8",title:"Documented and tested code",description:"The code with documentation and test",content:`Here's the documented code: {{4b}}.

Here's the {{5b}} and the {{7b}}.

Respond with "\u{2705} OK" if the tests all pass, and show a code block with the documented code and tests.`,type:"prompt"}]},{id:"dummy-3",dummy:!0,title:"Generate a course teaching me how this code works",description:"Generate a course teaching me how this code works",updatedAt:"2025-01-01T00:00:00Z",nodes:[{id:"1c",title:"Code to explain",description:"The code to explain",content:`import {ticks, tickIncrement} from "d3-array";
import continuous, {copy} from "./continuous.js";
import {initRange} from "./init.js";
import tickFormat from "./tickFormat.js";

export function linearish(scale) {
  var domain = scale.domain;

  scale.ticks = function(count) {
    var d = domain();
    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);
  };

  scale.tickFormat = function(count, specifier) {
    var d = domain();
    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);
  };

  scale.nice = function(count) {
    if (count == null) count = 10;

    var d = domain();
    var i0 = 0;
    var i1 = d.length - 1;
    var start = d[i0];
    var stop = d[i1];
    var prestep;
    var step;
    var maxIter = 10;

    if (stop < start) {
      step = start, start = stop, stop = step;
      step = i0, i0 = i1, i1 = step;
    }

    while (maxIter-- > 0) {
      step = tickIncrement(start, stop, count);
      if (step === prestep) {
        d[i0] = start
        d[i1] = stop
        return domain(d);
      } else if (step > 0) {
        start = Math.floor(start / step) * step;
        stop = Math.ceil(stop / step) * step;
      } else if (step < 0) {
        start = Math.ceil(start * step) / step;
        stop = Math.floor(stop * step) / step;
      } else {
        break;
      }
      prestep = step;
    }

    return scale;
  };

  return scale;
}

export default function linear() {
  var scale = continuous();

  scale.copy = function() {
    return copy(scale, linear());
  };

  initRange.apply(scale, arguments);

  return linearish(scale);
}`,type:"code"},{id:"2c",title:"My skillset",description:"My skillset",content:"I'm a software engineer with 5 years of experience in building web applications. I'm skilled in JavaScript, TypeScript, React, and Node.js. I'm also familiar with Python and have experience with machine learning frameworks like TensorFlow and PyTorch. I'm comfortable with SQL and NoSQL databases, and have experience with Docker and Kubernetes. I'm a quick learner and I'm always looking to improve my skills.",type:"text",inputType:{type:"text"}},{id:"3c",title:"Course outline",description:"The outline of the course",content:"You're generating a course teaching me how to understand {{1c}}. I have the following skillset: {{2c}}. Keep it short and concise, with 2-3 sections.",type:"prompt"},{id:"4c",title:"Course content",description:"The content of the course",content:`Generate a short walkthrough that teaches me how to understand {{1c}}. I have the following skillset: {{2c}}.

Flesh out the {{3c}}. Respond with a short walkthrough, using code blocks for code samples.`,type:"prompt"}]},{id:"dummy-4",dummy:!0,title:"Generate app name",description:"Generate and validate potential names for your app",updatedAt:"2025-01-01T00:00:00Z",nodes:[{id:"1d",title:"App description",description:"Describe your app's purpose and target audience",type:"text",inputType:{type:"text"},content:"An email app that uses AI to help you write emails faster."},{id:"2d",title:"Generate names",description:"Generate potential names based on description",type:"prompt",content:`You're a creative app naming expert. Generate 10 potential names for an app based on this description: {{1d}}

Rules for the names:
- Keep them short and memorable
- Make sure they're easy to spell
- Consider domain name availability
- Avoid trademarked terms

Format: a JSON array with one name per line`},{id:"3d",title:"Check domain availability",description:"Check if domains are available for the generated names",type:"code",content:`// This code checks domain availability using DNS lookup
  const nameList = {{2d}}

  const results = [];

  for (const name of nameList) {
    const cleanName = name.toLowerCase().replace(/[^a-z0-9]/g, '');
    const domain = cleanName + '.com';

    try {
      // Try to resolve the domain - if it fails, domain might be available
      const response = await fetch(\`https://dns.google/resolve?name=\${domain}\`);
      const data = await response.json();

      results.push({
        name: name,
        domain: domain,
        available: data.Status === 3 || !data.Answer // NXDOMAIN status or no answer means likely available
      });
    } catch (error) {
      results.push({
        name: name,
        domain: domain,
        error: 'Failed to check availability'
      });
    }
  }

  return results;
`}]},{id:"dummy-5",dummy:!0,title:"Wikipedia",description:"Generate a wiki article on a topic or question",updatedAt:"2025-01-01T00:00:00Z",nodes:[{id:"1e",title:"Topic or question",description:"The topic or question to generate a wiki article on",type:"text",inputType:{type:"text"},content:"When do babies start to crawl?"},{id:"2e",title:"Split into topics",description:"Split the topic or question into topics",type:"text",inputType:{type:"text"},content:`You're creating a write-up on a concept. You need to split it into 5-6 sections that cover interesting aspects of the concept. Respond with a JSON array with one string per topic.

For example:
Concept: Dogs as pets
Topics:
["Dog breeds", "Dog training", "Dog costs", "Dog health", "Dog accessories"]


Concept: {{1e}}
Topics:`},{id:"3e",title:"Generate article",description:"Generate a wiki article on the concept",type:"prompt",content:"You're a wiki article generator. Generate a wiki article on the concept: {{1e}}. Split it into sections: {{2e}} with a title, a bolded key statement, and a list or 2 paragraphs."},{id:"4e",title:"Image",description:"An image for the article",type:"prompt",content:"Generate an ascii art image for the article: {{3e}}"}]},{id:"dummy-6",dummy:!0,title:"Compare two prompts",description:"Compare the performance of two prompts",updatedAt:"2025-01-01T00:00:00Z",nodes:[{id:"1f",title:"Prompt 1",description:"The first prompt to compare",type:"prompt",content:"Make me a haiku about the color blue"},{id:"2f",title:"Prompt 2",description:"The second prompt to compare",type:"prompt",content:"You are a haiku generator. Make a haiku about the color blue. Your job depends on it."},{id:"3f",title:"Important metrics",description:"The important metrics to compare the prompts on",type:"text",inputType:{type:"text"},content:"Relevance, creativity, accuracy, completeness, and style"},{id:"4f",title:"Compare",description:"Compare the performance of the two prompts",type:"prompt",content:"For each of the {{3f}}, compare the two prompts: {{1f}} and {{2f}}. Respond with a JSON array with one object per metric, with the metric name and a winner key that says which prompt is better (just say 1 or 2)."}]}],X="loop";function Y(){let e,t,n;let a=(0,l.c)(9),{loopID:i}=(0,q.g)(),r=Q();a[0]!==i?(e=[X,i],a[0]=i,a[1]=e):e=a[1],a[2]!==i||a[3]!==r?(t=async()=>{if(!i)return null;let e=Z.find(e=>e.id===i)??null;return e?{loopID:e.id,pipeline:e,threadID:null,draftPipeline:e}:await r.getPipeline(i)},a[2]=i,a[3]=r,a[4]=t):t=a[4];let s=!!i;return a[5]!==e||a[6]!==t||a[7]!==s?(n={queryKey:e,queryFn:t,enabled:s,refetchOnMount:!0},a[5]=e,a[6]=t,a[7]=s,a[8]=n):n=a[8],(0,H.I)(n)}function ee(){let{data:e}=Y();return e?.draftPipeline?e.draftPipeline:e?.pipeline?e.pipeline:null}function et(e){let t;let n=(0,l.c)(3),a=ee();return n[0]!==a||n[1]!==e?(t=e(a),n[0]=a,n[1]=e,n[2]=t):t=n[2],t}let en={MissingProperty:"MissingProperty",CycleDetected:"CycleDetected",NonexistentNode:"NonexistentNode",DisconnectedNode:"DisconnectedNode",InvalidBooleanValue:"InvalidBooleanValue",InvalidRangeValue:"InvalidRangeValue",InvalidSelectValue:"InvalidSelectValue",InvalidFileType:"InvalidFileType",EmptyInputValue:"EmptyInputValue"};function ea(e){let t=function(e){let t=[];for(let n of("string"!=typeof e.title&&t.push({error:"Pipeline is missing a title",errorType:en.MissingProperty,involvedNodes:[]}),Array.isArray(e.nodes)&&0!==e.nodes.length||t.push({error:"Pipeline has no nodes",errorType:en.MissingProperty,involvedNodes:[]}),e.nodes))t=t.concat(function(e){let t=[];return("string"!=typeof e.title||0===e.title.length)&&t.push({error:"Node is missing a title",errorType:en.MissingProperty,involvedNodes:[e.id]}),"text"===e.type&&(t=t.concat(function(e){let t=[],n=e.inputType;if("object"!=typeof n||!n)return t.push({error:"inputType is required for text nodes",errorType:en.MissingProperty,involvedNodes:[e.id]}),t;switch(n.type){case"boolean":["true","false"].includes(e.content)||t.push({error:'A boolean input must have a value of either "true" or "false"',errorType:en.InvalidBooleanValue,involvedNodes:[e.id]});break;case"range":"number"!=typeof n.min&&t.push({error:"A range input must have a min",errorType:en.InvalidRangeValue,involvedNodes:[e.id]}),"number"!=typeof n.max&&t.push({error:"A range input must have a max",errorType:en.InvalidRangeValue,involvedNodes:[e.id]});break;case"select":Array.isArray(n.options)&&0!==n.options.length?n.options.includes(e.content)||t.push({error:"A select node must have content equal to one of its options",errorType:en.InvalidSelectValue,involvedNodes:[e.id]}):t.push({error:"A select input must have options",errorType:en.InvalidSelectValue,involvedNodes:[e.id]});break;case"file":["pdf","video","image","audio","document","code","other"].includes(n.fileType)||t.push({error:`Invalid file type ${n.fileType}`,errorType:en.InvalidFileType,involvedNodes:[e.id]});break;case"text":e.content||t.push({error:"Input needs a value",errorType:en.EmptyInputValue,involvedNodes:[e.id]})}return t}(e))),t}(n));return t}(e),n=I(e);for(let a of n.edges){let n=e.nodes.find(e=>e.id===a.from),i=e.nodes.find(e=>e.id===a.to);n&&i||t.push({error:`Node ${a.to} references a nonexistent node {{${a.from}}}`,errorType:en.NonexistentNode,involvedNodes:[a.to]})}let a=function(e){let t=new Set,n=new Set,a=[],i=r=>{if(n.has(r)){let e=a.indexOf(r);return a.slice(e)}if(t.has(r))return null;for(let s of(t.add(r),n.add(r),a.push(r),e.edges))if(s.from===r){let e=i(s.to);if(e)return e}return n.delete(r),a.pop(),null};for(let n of e.nodes.values())if(!t.has(n.id)){let e=i(n.id);if(e)return e}return null}(n);if(a&&a.length>0){let e=[...a,a[0]];t.push({error:`Pipeline contains a cycle: ${e.join(" \u2192 ")}`,errorType:en.CycleDetected,involvedNodes:a})}let i=function(e){let t=[...e.nodes.values()];if(0===t.length)return[];let n=[],a=new Set,i=(t,n)=>{for(let r of(a.add(t),n.add(t),e.edges))r.from!==t||a.has(r.to)||i(r.to,n),r.to!==t||a.has(r.from)||i(r.from,n)};for(let e of t)if(!a.has(e.id)){let t=new Set;i(e.id,t),n.push(t)}if(n.length<=1)return[];let r=n.reduce((e,t)=>t.size>e.size?t:e,new Set),s=[];for(let e of t)r.has(e.id)||s.push(e.id);return s}(n);return i.length>0&&t.push({error:`Pipeline contains unreachable nodes: ${i.join(", ")}`,errorType:en.DisconnectedNode,involvedNodes:i}),t}function ei(){let e;let t=(0,l.c)(3),n=ee();e:{let a;if(!n){let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=[],t[0]=n):n=t[0],e=n;break e}t[1]!==n?(a=ea(n),t[1]=n,t[2]=a):a=t[2],e=a}return e}function er(e){return e.error}function es(e){let t;let n=(0,l.c)(5),a=ei();if(n[0]!==e||n[1]!==a){let i;n[3]!==e?(i=t=>!e||t.involvedNodes.includes(e),n[3]=e,n[4]=i):i=n[4],t=a.some(i),n[0]=e,n[1]=a,n[2]=t}else t=n[2];return t}function eo(){let e=et(e=>e?.nodes?.map(e=>e.id)?.join("|"));return e?.split("|")??[]}let el=(e,t)=>t?.nodes.find(t=>t.id===e),ec=e=>t=>t.executionState.nodes[e];function ed(e){return et(t=>el(e,t))}function eu(e){return U(t=>ec(e)(t)?.running??!1)}var em=n(30391);let ep=e=>{let t,n,a,i,r,s,u,m,p,h,g,f,y,x,v;let _=(0,l.c)(42),{path:b,source:j,target:C}=e,N=(0,c.useId)(),w=(0,em.DP)(),I=function(e,t){let n=ei();return U(({executionState:a})=>{if(!e||!t)return"IDLE";let i=a.nodes[t]?.running||!1,r=a.nodes[e]?.value&&!a.nodes[e]?.running&&!n.some(t=>t.involvedNodes.includes(e));return a.nodes[e]?.error||n.some(t=>t.involvedNodes.includes(e))?"ERROR":i?"PROCESSING":r?"COMPLETED":"IDLE"})}(j,C),S=`mask-${N}`,k=`path-${N}`,T=`idle-grad-${N}`,A=`proc-grad-${N}`,E=w.colorScheme?.includes("dark")||w.colorScheme?.includes("night")?"#CCC":"#333";t=`${1+2*Math.random()}s`,_[0]!==T||_[1]!==A||_[2]!==S||_[3]!==b||_[4]!==k||_[5]!==I?(n=()=>"IDLE"===I||"PROCESSING"===I?(0,o.jsx)("g",{mask:`url(#${S})`,className:(0,d.$)(W.edgeAddon,"IDLE"===I&&W.edgeIdleAddon,"PROCESSING"===I&&W.edgeProcAddon),children:(0,o.jsx)("circle",{r:"IDLE"===I?25:30,fill:`url(#${"IDLE"===I?T:A})`,children:(0,o.jsx)("animateMotion",{rotate:"auto",dur:"IDLE"===I?"6s":"2s",begin:"IDLE"===I?t:"0s",repeatCount:"indefinite",children:(0,o.jsx)("mpath",{href:`#${k}`})})})}):"COMPLETED"===I?(0,o.jsx)("path",{d:b,strokeWidth:2,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",className:W.edgeCompletedAddOn}):void 0,_[0]=T,_[1]=A,_[2]=S,_[3]=b,_[4]=k,_[5]=I,_[6]=n):n=_[6];let R=n;_[7]!==E?(a=(0,o.jsx)("stop",{stopColor:E,stopOpacity:"0",offset:"0%"}),i=(0,o.jsx)("stop",{stopColor:E,stopOpacity:"0.6",offset:"100%"}),_[7]=E,_[8]=a,_[9]=i):(a=_[8],i=_[9]),_[10]!==T||_[11]!==a||_[12]!==i?(r=(0,o.jsxs)("linearGradient",{id:T,x1:"0%",x2:"100%",y1:"0%",y2:"0%",children:[a,i]}),_[10]=T,_[11]=a,_[12]=i,_[13]=r):r=_[13],_[14]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsx)("stop",{stopColor:"#007bff",stopOpacity:"0",offset:"0%"}),u=(0,o.jsx)("stop",{stopColor:"#007bff",stopOpacity:"1",offset:"100%"}),_[14]=s,_[15]=u):(s=_[14],u=_[15]),_[16]!==A?(m=(0,o.jsxs)("linearGradient",{id:A,x1:"0%",x2:"100%",y1:"0%",y2:"0%",children:[s,u]}),_[16]=A,_[17]=m):m=_[17];let P="PROCESSING"===I?2.5:1.5;_[18]!==b||_[19]!==P?(p=(0,o.jsx)("path",{d:b,stroke:"white",strokeWidth:P,fill:"none",strokeLinecap:"round"}),_[18]=b,_[19]=P,_[20]=p):p=_[20],_[21]!==S||_[22]!==p?(h=(0,o.jsx)("mask",{id:S,children:p}),_[21]=S,_[22]=p,_[23]=h):h=_[23],_[24]!==h||_[25]!==r||_[26]!==m?(g=(0,o.jsxs)("defs",{children:[r,m,h]}),_[24]=h,_[25]=r,_[26]=m,_[27]=g):g=_[27];let D=("IDLE"===I||"PROCESSING"===I)&&W.edgeDefault,L="ERROR"===I&&W.edgeError,M="COMPLETED"===I&&W.edgeCompleted;return _[28]!==D||_[29]!==L||_[30]!==M?(f=(0,d.$)(W.edge,D,L,M),_[28]=D,_[29]=L,_[30]=M,_[31]=f):f=_[31],_[32]!==b||_[33]!==k||_[34]!==f?(y=(0,o.jsx)("path",{d:b,id:k,className:f,strokeWidth:2,fill:"none"}),_[32]=b,_[33]=k,_[34]=f,_[35]=y):y=_[35],_[36]!==R?(x=R(),_[36]=R,_[37]=x):x=_[37],_[38]!==g||_[39]!==y||_[40]!==x?(v=(0,o.jsxs)("g",{children:[g,y,x]}),_[38]=g,_[39]=y,_[40]=x,_[41]=v):v=_[41],v};try{ep.displayName||(ep.displayName="CompactStyleEdge")}catch{}var eh=n(73451),eg=n(9591),ef=n(55847),ey=n(15385),ex=n(89323),ev=n(27331),e_=n(46584),eb=n(97665),ej=n(94747);function eC(){let e,t,n,a,i;let r=(0,l.c)(11),s=(0,eb.jE)(),o=Q();return r[0]!==o?(e=async e=>{let{loopID:t,pipeline:n,draftPipeline:a,threadID:i}=e;if(!(a&&J(a)))return await o.updatePipelineRecord(t,{loopID:t,pipeline:n,draftPipeline:a,threadID:i})},r[0]=o,r[1]=e):e=r[1],r[2]!==s?(t=async e=>{await s.cancelQueries({queryKey:[X,e.loopID]});let t=s.getQueryData([X,e.loopID]);return e.pipeline&&!J(e.pipeline)&&s.setQueryData([X,e.loopID],t=>t?{...t,pipeline:e.pipeline}:e),{previousLoopData:t}},n=e=>{e&&s.invalidateQueries({queryKey:[X,e.loopID]})},a=(e,t,n)=>{n?.previousLoopData&&s.setQueryData([X,t.loopID],n.previousLoopData)},r[2]=s,r[3]=t,r[4]=n,r[5]=a):(t=r[3],n=r[4],a=r[5]),r[6]!==e||r[7]!==t||r[8]!==n||r[9]!==a?(i={mutationFn:e,onMutate:t,onSuccess:n,onError:a},r[6]=e,r[7]=t,r[8]=n,r[9]=a,r[10]=i):i=r[10],(0,ej.n)(i)}function eN(e,t){if(!e)return e;let n=e.draftPipeline||e.pipeline;if(!n)return e;let a={...n,nodes:[...n.nodes||[],t]};return{...e,draftPipeline:a}}function ew(e,t,n){let a=e.draftPipeline||e.pipeline;if(!a)return e;let i=a.nodes.findIndex(e=>e.id===t);if(-1===i)return eN(e,{id:t,type:"text",title:"",description:"",content:"",...n});{let t=a.nodes[i],r={...a,nodes:[...a.nodes.slice(0,i),{...t,...n},...a.nodes.slice(i+1)]};return{...e,draftPipeline:r}}}function eI(){let{data:e}=Y(),{mutate:t,isPending:n}=eC(),a=V(),i=(e,n)=>{e&&t({loopID:e.loopID,pipeline:e.pipeline,draftPipeline:e.draftPipeline,threadID:e.threadID},{onSuccess:n})};return{addNode:t=>{e&&i(eN(e,t),()=>a({type:"FOCUS_NODE",nodeId:t.id}))},removeNode:t=>{e&&i(function(e,t){let n=e.draftPipeline||e.pipeline;if(!n)return e;let a={...n,nodes:n.nodes.filter(e=>e.id!==t)};return{...e,draftPipeline:a}}(e,t),()=>a({type:"FOCUS_NODE",nodeId:null}))},updateNode:(t,n)=>{e&&i(ew(e,t,n))},updateNodeContent:(t,n)=>{e&&i(e.draftPipeline||e.pipeline?ew(e,t,{content:n}):e)},updateLoop:t=>{e&&i({...e,draftPipeline:t})},isPending:n}}let eS={dialogBody:"AddNodeButton-module__dialogBody--cBxuf"};function ek(e){let t,n,a,i,r,s,d,u,m,p,h,g;let f=(0,l.c)(25),{onClose:y,onConfirm:x}=e,[v,_]=(0,c.useState)(""),[b,j]=(0,c.useState)("");return f[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,o.jsx)(ev.l.Header,{children:"Add a new node to your pipeline"}),f[0]=t):t=f[0],f[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)(eh.A.Label,{children:"Node Title"}),f[1]=n):n=f[1],f[2]===Symbol.for("react.memo_cache_sentinel")?(a=e=>_(e.target.value),f[2]=a):a=f[2],f[3]!==v?(i=(0,o.jsxs)(eh.A,{children:[n,(0,o.jsx)(eg.A,{value:v,onChange:a,placeholder:"New node"})]}),f[3]=v,f[4]=i):i=f[4],f[5]===Symbol.for("react.memo_cache_sentinel")?(r=(0,o.jsx)(eh.A.Label,{children:"Node Description"}),f[5]=r):r=f[5],f[6]===Symbol.for("react.memo_cache_sentinel")?(s=e=>j(e.target.value),f[6]=s):s=f[6],f[7]!==b?(d=(0,o.jsxs)(eh.A,{children:[r,(0,o.jsx)(eg.A,{value:b,onChange:s,placeholder:"New node description"})]}),f[7]=b,f[8]=d):d=f[8],f[9]!==i||f[10]!==d?(u=(0,o.jsxs)(ev.l.Body,{className:eS.dialogBody,children:[i,d]}),f[9]=i,f[10]=d,f[11]=u):u=f[11],f[12]!==y?(m=(0,o.jsx)(ef.Q,{onClick:y,children:"Cancel"}),f[12]=y,f[13]=m):m=f[13],f[14]!==b||f[15]!==x||f[16]!==v?(p=(0,o.jsx)(ef.Q,{onClick:()=>x(v,b),variant:"primary",children:"Confirm"}),f[14]=b,f[15]=x,f[16]=v,f[17]=p):p=f[17],f[18]!==p||f[19]!==m?(h=(0,o.jsxs)(ev.l.Footer,{children:[m,p]}),f[18]=p,f[19]=m,f[20]=h):h=f[20],f[21]!==y||f[22]!==h||f[23]!==u?(g=(0,o.jsxs)(ev.l,{title:"Add Node",onClose:y,children:[t,u,h]}),f[21]=y,f[22]=h,f[23]=u,f[24]=g):g=f[24],g}function eT(e){let t,n,a,i,r,s,c;let d=(0,l.c)(18),{nodeType:u,onSelect:m}=e;d[0]!==u?(t=u.icon(),d[0]=u,d[1]=t):t=d[1];let p=t;return d[2]!==u.type||d[3]!==m?(n=()=>m(u.type),d[2]=u.type,d[3]=m,d[4]=n):n=d[4],d[5]!==p?(a=(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p,{})}),d[5]=p,d[6]=a):a=d[6],d[7]!==u?(i=u.label(),d[7]=u,d[8]=i):i=d[8],d[9]!==u?(r=u.description(),d[9]=u,d[10]=r):r=d[10],d[11]!==r?(s=(0,o.jsx)(ey.l.Description,{variant:"block",children:r}),d[11]=r,d[12]=s):s=d[12],d[13]!==n||d[14]!==a||d[15]!==i||d[16]!==s?(c=(0,o.jsxs)(ey.l.Item,{onSelect:n,children:[a,i,s]}),d[13]=n,d[14]=a,d[15]=i,d[16]=s,d[17]=c):c=d[17],c}function eA(){let e,t,n,a,i,r,s,d,u,h,g,f,y;let x=(0,l.c)(37),v=(0,e_.h)(),b=ee(),j=eo(),{addNode:C}=eI(),[N,w]=(0,c.useState)();if(x[0]!==C||x[1]!==v||x[2]!==b||x[3]!==j){d=Symbol.for("react.early_return_sentinel");e:{let l,c,u;let h=Object.values(_);x[12]!==v?(l=(e,t)=>((!t.featureFlag||v[t.featureFlag])&&e.push(t),e),x[12]=v,x[13]=l):l=x[13];let g=h.reduce(l,[]);if(x[14]!==C||x[15]!==b||x[16]!==j?(c=(e,t,n)=>{b&&C(function(e,t,n,a){let i={content:"",id:t,title:n,description:a};switch(e){case"loop":return{...i,type:e,loopId:""};case"text":return{...i,type:e,inputType:{type:"text"}};default:return{...i,type:e}}}(e,(j.reduce(eE,0)+1).toString(),t,n))},x[14]=C,x[15]=b,x[16]=j,x[17]=c):c=x[17],a=c,!v.copilot_loops_post_staff_ship_features){d=null;break e}n=ex.W,x[18]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsx)(ex.W.Anchor,{children:(0,o.jsx)(m.K,{"aria-label":"Add node",icon:p.PlusIcon})}),x[18]=s):s=x[18],t=ex.W.Overlay,r="small",e=ey.l,x[19]===Symbol.for("react.memo_cache_sentinel")?(u=e=>(0,o.jsx)(eT,{nodeType:e,onSelect:()=>w(e.type)},e.type),x[19]=u):u=x[19],i=g.map(u)}x[0]=C,x[1]=v,x[2]=b,x[3]=j,x[4]=e,x[5]=t,x[6]=n,x[7]=a,x[8]=i,x[9]=r,x[10]=s,x[11]=d}else e=x[4],t=x[5],n=x[6],a=x[7],i=x[8],r=x[9],s=x[10],d=x[11];return d!==Symbol.for("react.early_return_sentinel")?d:(x[20]!==e||x[21]!==i?(u=(0,o.jsx)(e,{children:i}),x[20]=e,x[21]=i,x[22]=u):u=x[22],x[23]!==t||x[24]!==r||x[25]!==u?(h=(0,o.jsx)(t,{width:r,children:u}),x[23]=t,x[24]=r,x[25]=u,x[26]=h):h=x[26],x[27]!==n||x[28]!==s||x[29]!==h?(g=(0,o.jsxs)(n,{children:[s,h]}),x[27]=n,x[28]=s,x[29]=h,x[30]=g):g=x[30],x[31]!==a||x[32]!==N?(f=N&&(0,o.jsx)(ek,{onClose:()=>w(void 0),onConfirm:(e,t)=>{a(N,e,t),w(void 0)}}),x[31]=a,x[32]=N,x[33]=f):f=x[33],x[34]!==g||x[35]!==f?(y=(0,o.jsxs)(o.Fragment,{children:[g,f]}),x[34]=g,x[35]=f,x[36]=y):y=x[36],y)}function eE(e,t){return Math.max(e,parseInt(t))}try{ek.displayName||(ek.displayName="AddNodeDialog")}catch{}try{eT.displayName||(eT.displayName="AddNodeListItem")}catch{}try{(a=Icon).displayName||(a.displayName="Icon")}catch{}try{eA.displayName||(eA.displayName="AddNodeButton")}catch{}function eR(e){let t,n,a;let i=(0,l.c)(18),{value:r,isLoading:s,onClick:c,onStop:d,variant:u,disabled:h,iconOnly:g}=e,f=void 0===u?"invisible":u;i[0]!==s||i[1]!==r?(t=()=>s?"Loading...":r?"Run node":"Run loop",i[0]=s,i[1]=r,i[2]=t):t=i[2];let y=t;i[3]!==s||i[4]!==c||i[5]!==d?(n=e=>{s?d?.(e):c(e)},i[3]=s,i[4]=c,i[5]=d,i[6]=n):n=i[6];let x=n;if(!g){let e;let t=s?"danger":f,n=s?"Stop":"Run";return i[7]!==h||i[8]!==x||i[9]!==t||i[10]!==n?(e=(0,o.jsx)(ef.Q,{disabled:h,variant:t,onClick:x,children:n}),i[7]=h,i[8]=x,i[9]=t,i[10]=n,i[11]=e):e=i[11],e}let v=y(),_=s?p.SquareFillIcon:p.SyncIcon,b=s?"danger":f;return i[12]!==h||i[13]!==x||i[14]!==v||i[15]!==_||i[16]!==b?(a=(0,o.jsx)(m.K,{disabled:h,"aria-label":v,icon:_,onClick:x,variant:b}),i[12]=h,i[13]=x,i[14]=v,i[15]=_,i[16]=b,i[17]=a):a=i[17],a}try{eR.displayName||(eR.displayName="ExecuteButton")}catch{}function eP(){let e,t,n;let a=(0,l.c)(6),i=ee(),r=i?.id,s=(0,q.Zp)();return a[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)(ex.W.Anchor,{children:(0,o.jsx)(m.K,{"aria-label":"Development",icon:p.ToolsIcon})}),a[0]=e):e=a[0],a[1]!==r||a[2]!==s?(t=Object.values(Z).map(e=>(0,o.jsx)(ey.l.Item,{value:e.id,selected:r===e.id,onSelect:()=>s(`/copilot/l/${e.id}`),children:e.title},e.id)),a[1]=r,a[2]=s,a[3]=t):t=a[3],a[4]!==t?(n=(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(ex.W,{children:[e,(0,o.jsx)(ex.W.Overlay,{width:"small",children:(0,o.jsx)(ey.l,{selectionVariant:"single",role:"menu",children:t})})]})}),a[4]=t,a[5]=n):n=a[5],n}try{eP.displayName||(eP.displayName="DevelopmentButton")}catch{}function eD(){let e=ee();if(!e)throw Error("useCurrentLoop must be used within a context where a loop exists.");return e}function eL(){let e=V(),t=Q(),n=z(),a=es(),i=eD();return{runPipeline:async r=>{if(!a)try{e({type:"INCREMENT_ITERATION"});let a=n().executionState.iteration+1;r?function(e,t,n){let a=function e(t,n){let a=new Set(t.edges.filter(e=>e.from===n).map(e=>e.to));for(let n of a)for(let i of e(t,n))a.add(i);return a.add(n),a}(I(e),t);n({type:"CLEAR_NODE_RESULTS",pipelineId:e.id,nodeIds:[...a]})}(i,r,e):e({type:"CLEAR_NODE_RESULTS",pipelineId:i.id,nodeIds:i.nodes.map(e=>e.id)}),await t.runPipeline(i,a,e)}catch(e){}},stopPipeline:(0,c.useCallback)(()=>{let a=n().executionState.iteration;t.stopPipeline(i.id,a,e)},[e,n,i.id,t])}}let eM={container:"CanvasHeader-module__container--WYGYo"},eO=()=>{let e;let t=(0,l.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)("svg",{"aria-label":"Alert",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M9.11713 1.41595C9.98012 1.41595 10.6797 2.11555 10.6797 2.97853V8.18712C10.6797 9.05011 9.98012 9.74969 9.11713 9.74969C8.25414 9.74969 7.55455 9.05011 7.55455 8.18712V2.97853C7.55455 2.11555 8.25414 1.41595 9.11713 1.41595ZM11.2006 13.9165C11.2006 15.0672 10.2678 16 9.11713 16C7.96648 16 7.03369 15.0672 7.03369 13.9165C7.03369 12.7659 7.96648 11.8332 9.11713 11.8332C10.2678 11.8332 11.2006 12.7659 11.2006 13.9165Z",fill:"currentColor"})}),t[0]=e):e=t[0],e},eB=()=>{let e;let t=(0,l.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)("svg",{"aria-label":"Focus center",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsxs)("g",{stroke:"currentColor",strokeWidth:"1.5",children:[(0,o.jsx)("circle",{cx:"8",cy:"8",r:"5.25"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.5 8H15M1 8h3.5M8 11.5V15M8 1v3.5"})]})}),t[0]=e):e=t[0],e};try{(i=()=>{let e;let t=(0,l.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)("svg",{"aria-label":"Loops Icon",width:"35",height:"15",viewBox:"0 0 35 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.1875 3.21429C5.8802 3.21429 3.9375 5.17331 3.9375 7.5C3.9375 9.82669 5.8802 11.7857 8.1875 11.7857C9.30351 11.7857 10.5717 11.2628 12.0658 10.227C13.1481 9.47666 14.2434 8.5341 15.3833 7.5C14.2434 6.4659 13.1481 5.52334 12.0658 4.77302C10.5717 3.73721 9.30351 3.21429 8.1875 3.21429ZM17.75 5.32376C16.4971 4.17999 15.1917 3.03949 13.8717 2.1243C12.1783 0.950293 10.259 0 8.1875 0C4.1198 0 0.75 3.39812 0.75 7.5C0.75 11.6019 4.1198 15 8.1875 15C10.259 15 12.1783 14.0496 13.8717 12.8758C15.1917 11.9606 16.4971 10.82 17.75 9.67624C19.0029 10.82 20.3083 11.9606 21.6283 12.8758C23.3218 14.0496 25.2411 15 27.3125 15C31.3802 15 34.75 11.6019 34.75 7.5C34.75 3.39812 31.3802 0 27.3125 0C25.2411 0 23.3218 0.950293 21.6283 2.1243C20.3083 3.03949 19.0029 4.17999 17.75 5.32376ZM20.1167 7.5C21.2566 8.5341 22.3519 9.47666 23.4342 10.227C24.9282 11.2628 26.1964 11.7857 27.3125 11.7857C29.6198 11.7857 31.5625 9.82669 31.5625 7.5C31.5625 5.17331 29.6198 3.21429 27.3125 3.21429C26.1964 3.21429 24.9282 3.73721 23.4342 4.77302C22.3519 5.52334 21.2566 6.4659 20.1167 7.5Z",fill:"#9198A1"})}),t[0]=e):e=t[0],e}).displayName||(i.displayName="LoopIcon")}catch{}try{eO.displayName||(eO.displayName="AlertIcon")}catch{}try{eB.displayName||(eB.displayName="FocusCenterIcon")}catch{}function eF(e){let t;let n=(0,l.c)(2),{onClick:a}=e;return n[0]!==a?(t=(0,o.jsx)(m.K,{"aria-label":"Set center alignment",icon:eB,onClick:e=>a(e)}),n[0]=a,n[1]=t):t=n[1],t}try{eF.displayName||(eF.displayName="CenterAlignButton")}catch{}function e$(e){let t,n,a,i,r,s,c,d;let u=(0,l.c)(17),{centerNodeCanvas:m}=e,{runPipeline:p,stopPipeline:h}=eL(),f=U(e=>Object.values(e.executionState.nodes).some(e=>e.running));u[0]!==p?(t=()=>{(0,g.BI)("dotcom_chat.activate",{target:"CANVAS_HEADER_LOOP_RUN",mode:"loops"}),p()},u[0]=p,u[1]=t):t=u[1];let y=t;u[2]!==h?(n=()=>{(0,g.BI)("dotcom_chat.activate",{target:"CANVAS_HEADER_LOOP_STOP",mode:"loops"}),h()},u[2]=h,u[3]=n):n=u[3];let x=n;u[4]!==m?(a=()=>{(0,g.BI)("dotcom_chat.activate",{target:"CANVAS_HEADER_CANVAS_CENTER",mode:"loops"}),m({duration:500})},u[4]=m,u[5]=a):a=u[5];let v=a;return u[6]===Symbol.for("react.memo_cache_sentinel")?(i=(0,o.jsx)(eA,{}),r=!1,u[6]=i,u[7]=r):(i=u[6],r=u[7]),u[8]!==v?(s=(0,o.jsx)(eF,{onClick:v}),u[8]=v,u[9]=s):s=u[9],u[10]!==y||u[11]!==x||u[12]!==f?(c=(0,o.jsx)(eR,{isLoading:f,onClick:y,onStop:x,variant:"primary"}),u[10]=y,u[11]=x,u[12]=f,u[13]=c):c=u[13],u[14]!==s||u[15]!==c?(d=(0,o.jsxs)("div",{className:eM.container,children:[i,r,s,c]}),u[14]=s,u[15]=c,u[16]=d):d=u[16],d}try{e$.displayName||(e$.displayName="CanvasHeader")}catch{}let eU={compactNode:"CompactNode-module__compactNode--F_pSG",dark:"CompactNode-module__dark--tCgC0",active:"CompactNode-module__active--XEnzK",validationErrorWrapper:"CompactNode-module__validationErrorWrapper--EsSMr",title:"CompactNode-module__title--qrnqG",indicatorDot:"CompactNode-module__indicatorDot--EhKst",topDot:"CompactNode-module__topDot--y0RZw",completed:"CompactNode-module__completed--UhZag",bottomDot:"CompactNode-module__bottomDot--MLm5c",error:"CompactNode-module__error--HEiZ7",indicatorShadowWrapper:"CompactNode-module__indicatorShadowWrapper--UlVUX",indicatorShadow:"CompactNode-module__indicatorShadow--d58PY"},ez={iconContainer:"NodeType-module__iconContainer--cGYME",labelContainer:"NodeType-module__labelContainer--wSFPu",auburn:"NodeType-module__auburn--CbLyN",fgColor:"NodeType-module__fgColor--ZY0uq",bgColor:"NodeType-module__bgColor--zbgzb",blue:"NodeType-module__blue--C4XaG",brown:"NodeType-module__brown--g3pal",coral:"NodeType-module__coral--tYT29",cyan:"NodeType-module__cyan--dyLBa",gray:"NodeType-module__gray--owotq",green:"NodeType-module__green--GbPqF",indigo:"NodeType-module__indigo--kwM0L",lemon:"NodeType-module__lemon--wdfmH",lime:"NodeType-module__lime--uOq6Q",olive:"NodeType-module__olive--uMhT5",orange:"NodeType-module__orange--JNL1G",pine:"NodeType-module__pine--INiZK",pink:"NodeType-module__pink--qtppC",plum:"NodeType-module__plum--ZAP9S",purple:"NodeType-module__purple--slAj5",red:"NodeType-module__red--StjpA",teal:"NodeType-module__teal--DESFD",yellow:"NodeType-module__yellow--VVZrz"};function eV(e){let t,n,a,i,r;let s=(0,l.c)(14),{node:c,size:u,type:m}=e,p=void 0===u?"medium":u,h=_[m],g=h.color;s[0]!==h||s[1]!==c?(t=h.icon(c),s[0]=h,s[1]=c,s[2]=t):t=s[2];let f=t,y="small"===p?10:"large"===p?24:16;s[3]!==y?(n={height:y,width:y},s[3]=y,s[4]=n):n=s[4];let x=g&&ez[g];return s[5]!==x?(a=(0,d.$)(x,ez.fgColor),s[5]=x,s[6]=a):a=s[6],s[7]!==f||s[8]!==y||s[9]!==a?(i=(0,o.jsx)(f,{size:y,className:a}),s[7]=f,s[8]=y,s[9]=a,s[10]=i):i=s[10],s[11]!==n||s[12]!==i?(r=(0,o.jsx)("div",{className:ez.iconContainer,style:n,children:i}),s[11]=n,s[12]=i,s[13]=r):r=s[13],r}function eW(e){let t,n,a;let i=(0,l.c)(8),{node:r,type:s}=e,c=_[s],u=c?.color;i[0]!==c||i[1]!==r?(t=c?.label(r),i[0]=c,i[1]=r,i[2]=t):t=i[2];let m=t,p=u&&ez[u];return i[3]!==p?(n=(0,d.$)(ez.labelContainer,ez.fgColor,ez.bgColor,p),i[3]=p,i[4]=n):n=i[4],i[5]!==m||i[6]!==n?(a=(0,o.jsx)("div",{className:n,children:m}),i[5]=m,i[6]=n,i[7]=a):a=i[7],a}try{eV.displayName||(eV.displayName="NodeType")}catch{}try{(r=Icon).displayName||(r.displayName="Icon")}catch{}try{eW.displayName||(eW.displayName="NodeLabel")}catch{}var eH=n(63867);let eq=e=>{let t,n;let a=(0,l.c)(5),{status:i}=e,r="COMPLETED"===i&&eU.completed,s="ERROR"===i&&eU.error;return a[0]!==r||a[1]!==s?(t=(0,d.$)(eU.indicatorDot,eU.topDot,r,s),a[0]=r,a[1]=s,a[2]=t):t=a[2],a[3]!==t?(n=(0,o.jsx)("div",{className:t}),a[3]=t,a[4]=n):n=a[4],n},eG=e=>{let t,n,a;let i=(0,l.c)(6),{status:r}=e,s="COMPLETED"===r&&eU.completed,c="ERROR"===r&&eU.error;return i[0]!==s||i[1]!==c?(t=(0,d.$)(eU.indicatorDot,eU.bottomDot,s,c),i[0]=s,i[1]=c,i[2]=t):t=i[2],i[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)("div",{className:eU.indicatorShadowWrapper,children:(0,o.jsx)("div",{className:eU.indicatorShadow})}),i[3]=n):n=i[3],i[4]!==t?(a=(0,o.jsx)("div",{className:t,children:n}),i[4]=t,i[5]=a):a=i[5],a};function eK(e){let t,n,a,i,r,s,c,u,m;let p=(0,l.c)(30),{nodeId:h,pipelineId:g,className:f,hasPredecessors:y,hasSuccessors:x,title:v,type:_}=e,b=ed(h),j=eu(h),C=(0,em.DP)();p[0]!==h?(t=e=>el(h,e)?.title,p[0]=h,p[1]=t):t=p[1];let N=et(t);v=v||N;let w=et(e=>el(h,e)?.type??"text");_=_||w,p[2]!==h?(n=e=>e.uiState.focusedNodeId===h,p[2]=h,p[3]=n):n=p[3];let I=U(n),S=function(e){let t=ei();return U(({executionState:n})=>{if(!e)return"IDLE";let a=n.nodes[e]?.running||!1,i=n.nodes[e]?.value&&!n.nodes[e]?.running&&!t.some(t=>t.involvedNodes.includes(e));return n.nodes[e]?.error||t.some(t=>t.involvedNodes.includes(e))?"ERROR":a?"PROCESSING":i?"COMPLETED":"IDLE"})}(h),k=`node-card-${g}-${h}`,T=I?eU.active:null,A=C.colorScheme?.includes("dark")||C.colorScheme?.includes("night")?eU.dark:"";return p[4]!==f||p[5]!==T||p[6]!==A?(a=(0,d.$)(eU.compactNode,f,T,A),p[4]=f,p[5]=T,p[6]=A,p[7]=a):a=p[7],p[8]!==y||p[9]!==S?(i=y&&(0,o.jsx)(eq,{status:S}),p[8]=y,p[9]=S,p[10]=i):i=p[10],p[11]!==x||p[12]!==S?(r=x&&(0,o.jsx)(eG,{status:S}),p[11]=x,p[12]=S,p[13]=r):r=p[13],p[14]!==j||p[15]!==b||p[16]!==_?(s=j?(0,o.jsx)(eH.A,{size:"small"}):(0,o.jsx)(eV,{type:_,size:"medium",node:b}),p[14]=j,p[15]=b,p[16]=_,p[17]=s):s=p[17],p[18]!==v?(c=(0,o.jsx)("p",{className:eU.title,children:v}),p[18]=v,p[19]=c):c=p[19],p[20]!==h?(u=(0,o.jsx)(eQ,{nodeId:h}),p[20]=h,p[21]=u):u=p[21],p[22]!==c||p[23]!==u||p[24]!==k||p[25]!==a||p[26]!==i||p[27]!==r||p[28]!==s?(m=(0,o.jsxs)("div",{id:k,className:a,children:[i,r,s,c,u]}),p[22]=c,p[23]=u,p[24]=k,p[25]=a,p[26]=i,p[27]=r,p[28]=s,p[29]=m):m=p[29],m}function eQ(e){let t;let n=(0,l.c)(1),{nodeId:a}=e;return es(a)?(n[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,o.jsx)("div",{className:eU.validationErrorWrapper,children:(0,o.jsx)(eO,{})}),n[0]=t):t=n[0],t):null}try{eq.displayName||(eq.displayName="InputIndicator")}catch{}try{eG.displayName||(eG.displayName="OutputIndicator")}catch{}try{eK.displayName||(eK.displayName="CompactNode")}catch{}try{eQ.displayName||(eQ.displayName="ValidationErrorsIndicator")}catch{}let eJ="#1f6feb";function eZ(){let e=eo(),t=eD(),n=I(t),[a,i]=(0,c.useState)(null),[r,s]=(0,c.useState)(!1),l=(0,c.useRef)(!0),d=V(),u=U(e=>e.uiState.focusedNodeId),m=e=>{let t=e===u;d({type:"FOCUS_NODE",nodeId:t?null:e}),(0,g.BI)("dotcom_chat.activate",{target:t?"CANVAS_NODE_DESELECT":"CANVAS_NODE_SELECT",mode:"loops"})},{layout:p,pipelineDimensions:h,edges:v}=function(){let e=eD(),t=(0,y.xp)().id(e=>e.id).parentIds(e=>e.parentIds),n=new Set(e.nodes.map(e=>e.id)),a=e.nodes.map(e=>({id:e.id,parentIds:Array.from(new Set([...S(e)].map(k))).map(e=>n.has(e)?e:"")})),i={},r=[];try{let e=t(a),{width:n,height:s}=(0,y.Hz)().nodeSize([250,120]).layering((0,y.AH)()).decross((0,y.X9)().order((0,y.Ys)().base((0,y.n0)()))).gap([10,10])(e);for(let t of e.nodes())t.data.id&&(i[t.data.id]={x:t.x,y:t.y});let o=e=>{if(e.length<2)return"";let[t,n]=e[0]||[0,0],[a,i]=e[e.length-1]||[0,0],r=a-t,s=Math.abs(r);if(s<10)return`M ${t},${n} L ${a},${i}`;let o=(n+i)/2,l=r>0?1:-1;return`
        M ${t},${n}
        L ${t},${o-12}
        A 12,12 0 0 ${l>0?0:1} ${t+12*l},${o}
        L ${t+l*(12+(s-24))},${o}
        A 12,12 0 0 ${l>0?1:0} ${a},${o+12}
        L ${a},${i}
      `.trim().replace(/\s+/g," ")};for(let{points:t,source:n,target:a}of e.links()){let e=o(t);r.push({path:e,points:t.map(([e,t])=>({x:e,y:t})),source:n.data.id||"",target:a.data.id||""})}return{layout:i,edges:r,pipelineDimensions:{width:n,height:s}}}catch{return function(e){let t={},n={width:eX.width,height:e.length*eX.height};for(let n=0;n<e.length;++n)t[e[n]]={x:eX.width/2,y:n*eX.height};return{layout:t,edges:[],pipelineDimensions:n}}(e.nodes.map(e=>e.id))}}(),_=(0,c.useRef)(null),b=()=>{u&&(0,g.BI)("dotcom_chat.activate",{target:"CANVAS_DESELECT",mode:"loops"}),d({type:"FOCUS_NODE",nodeId:null})},j=(0,c.useCallback)(({duration:e=500})=>{if(!a||!_.current)return;let t=a.getBoundingClientRect(),n=t.width,i=t.height,r=Math.max(...Object.values(p).map(e=>e.x))+100,s=Math.max(...Object.values(p).map(e=>e.y))+25,o=f.GSI.translate(n/2-r/2,i/2-s/2).scale(1);(0,f.Ltv)(a).transition().duration(e).ease(f.xA2).call(_.current.transform,o)},[a]),C=(0,c.useCallback)(e=>{if(e){i(e);let t=(0,f.Ltv)(e),n=e=>{(0,f.Ltv)("#dot-pattern").attr("x",e.transform.x).attr("y",e.transform.y).attr("width",25*e.transform.k).attr("height",25*e.transform.k).select("rect").attr("x",25*e.transform.k/2-1).attr("y",25*e.transform.k/2-1).attr("opacity",Math.min(e.transform.k,1))},a=null,r=!1,s=(0,f.s_O)().scaleExtent([1,1]).interpolate(f.GWP).on("start",e=>{a=e.transform,r=!1}).on("zoom",e=>{if(!a)return;let t=e.transform.x-a.x,i=e.transform.y-a.y,s=Math.sqrt(t*t+i*i);(r||!(s<5))&&(r=!0,(0,f.Ltv)("#edges-group").attr("transform",e.transform),(0,f.Ltv)("#nodes-overlay").style("transform-origin","0 0").style("transform",`translate(${e.transform.x}px, ${e.transform.y}px) scale(${e.transform.k})`),n(e))});_.current=s,t.call(s),j({duration:0})}},[j]);return(0,c.useEffect)(()=>{if(r||!u||!a||!_.current)return;let e=p[u];if(!e)return;s(!0);let t=a.getBoundingClientRect(),n=t.width,i=t.height,o=n/2-e.x,c=i/2-e.y,d=f.GSI.translate(o,c).scale(1);!0===l.current?((0,f.Ltv)(a).call(_.current.transform,d),l.current=!1):(0,f.Ltv)(a).transition().duration(500).ease(f.xA2).call(_.current.transform,d),s(!1)},[u,r,a]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e$,{centerNodeCanvas:j}),(0,o.jsx)("div",{className:x.canvasContainer,ref:C,children:(0,o.jsxs)("div",{className:x.canvasGraph,onClick:b,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),b())},children:[(0,o.jsxs)("svg",{"aria-label":"Diagram",className:x.diagram,children:[(0,o.jsxs)("defs",{children:[(0,o.jsx)("pattern",{id:"dot-pattern",patternUnits:"userSpaceOnUse",x:"0",y:"0",width:25,height:25,children:(0,o.jsx)("rect",{x:11.5,y:11.5,rx:"50%",ry:"50%",width:2,height:2,className:x.gridPattern})}),(0,o.jsxs)("linearGradient",{id:"lineGradient",gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.4"}),(0,o.jsx)("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:"0.4"})]}),(0,o.jsxs)("linearGradient",{id:"dotGradient",gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.8"}),(0,o.jsx)("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:"0.8"})]}),(0,o.jsxs)("linearGradient",{id:"activeEdgeGradient",gradientUnits:"userSpaceOnUse",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,o.jsx)("stop",{stopColor:eJ,stopOpacity:"0.5"}),(0,o.jsx)("stop",{stopColor:eJ}),(0,o.jsx)("stop",{offset:"32.5%",stopColor:eJ}),(0,o.jsx)("stop",{offset:"100%",stopColor:eJ,stopOpacity:"0.5"})]})]}),(0,o.jsx)("rect",{fill:"url(#dot-pattern)",width:"100%",height:"100%"}),0!==h.width&&(0,o.jsx)("g",{id:"edges-group",children:v.map(e=>(0,o.jsx)(ep,{path:e.path,source:e.source,target:e.target},`${e.source}-${e.target}`))})]}),(0,o.jsx)("div",{id:"nodes-overlay",className:x.nodesOverlay,children:e.map(e=>(0,o.jsx)("div",{role:"button",tabIndex:0,className:x.nodeWrapper,style:{left:(p[e]?.x??0)-100,top:(p[e]?.y??0)-25},onClick:t=>{t.stopPropagation(),m(e)},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.stopPropagation(),m(e))},children:(0,o.jsx)(eK,{pipelineId:t.id,nodeId:e,hasPredecessors:n.edges.some(t=>t.to===e),hasSuccessors:n.edges.some(t=>t.from===e)})},e))})]})})]})}let eX={width:200,height:100};try{eZ.displayName||(eZ.displayName="Canvas")}catch{}try{(s=D3layout).displayName||(s.displayName="D3layout")}catch{}var eY=n(53526);let e0="all-loops";function e1(){let e,t,n;let a=(0,l.c)(7),i=(0,eb.jE)(),r=Q();return a[0]!==r?(e=async e=>{await r.deletePipeline(e)},a[0]=r,a[1]=e):e=a[1],a[2]!==i?(t=()=>{i.invalidateQueries({queryKey:[e0]})},a[2]=i,a[3]=t):t=a[3],a[4]!==e||a[5]!==t?(n={mutationFn:e,onSuccess:t},a[4]=e,a[5]=t,a[6]=n):n=a[6],(0,ej.n)(n)}function e2(e){let t,n,a,i,r,s,d,u,h,f,y,x,v,_;let b=(0,l.c)(36),{onDelete:j,onCopyLoop:C,onDuplicate:N,onShare:w,loopId:I,variant:S}=e,k=void 0===S?"invisible":S,[T,A]=(0,c.useState)(null),E=(0,c.useRef)(null),{mutate:R,isPending:P}=e1();b[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{A("delete")},b[0]=t):t=b[0];let D=t;b[1]===Symbol.for("react.memo_cache_sentinel")?(n=()=>{A(null)},b[1]=n):n=b[1];let L=n;b[2]!==R||b[3]!==I||b[4]!==j?(a=async()=>{I&&(A(null),R(I,{onSuccess:j}),j?.())},b[2]=R,b[3]=I,b[4]=j,b[5]=a):a=b[5];let M=a;b[6]!==I||b[7]!==N?(i=()=>{I&&N&&((0,g.BI)("dotcom_chat.activate",{target:"LOOP_DUPLICATE",mode:"loops"}),N(I))},b[6]=I,b[7]=N,b[8]=i):i=b[8];let O=i;b[9]!==w?(r=()=>{w?.()},b[9]=w,b[10]=r):r=b[10];let B=r;return I?(b[11]!==P||b[12]!==k?(s=(0,o.jsx)(ex.W.Anchor,{children:(0,o.jsx)(m.K,{loading:P,icon:p.KebabHorizontalIcon,"aria-label":"Manage loop",variant:k})}),b[11]=P,b[12]=k,b[13]=s):s=b[13],b[14]!==C?(d=C&&(0,o.jsxs)(ey.l.Item,{onSelect:C,children:[(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.CopyIcon,{})}),"Copy JSON"]}),b[14]=C,b[15]=d):d=b[15],b[16]!==O||b[17]!==N?(u=N&&(0,o.jsxs)(ey.l.Item,{onSelect:O,children:[(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.ArrowSwitchIcon,{})}),"Duplicate"]}),b[16]=O,b[17]=N,b[18]=u):u=b[18],b[19]!==B||b[20]!==w?(h=w&&(0,o.jsxs)(ey.l.Item,{onSelect:B,children:[(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.LinkIcon,{})}),"Copy share link"]}),b[19]=B,b[20]=w,b[21]=h):h=b[21],b[22]===Symbol.for("react.memo_cache_sentinel")?(f=(0,o.jsxs)(ey.l.Item,{variant:"danger",onSelect:D,children:[(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.TrashIcon,{})}),"Delete"]}),b[22]=f):f=b[22],b[23]!==h||b[24]!==d||b[25]!==u?(y=(0,o.jsx)(ex.W.Overlay,{align:"end",children:(0,o.jsxs)(ey.l,{children:[d,u,h,f]})}),b[23]=h,b[24]=d,b[25]=u,b[26]=y):y=b[26],b[27]!==y||b[28]!==s?(x=(0,o.jsxs)(ex.W,{anchorRef:E,children:[s,y]}),b[27]=y,b[28]=s,b[29]=x):x=b[29],b[30]!==M||b[31]!==T?(v="delete"===T&&(0,o.jsx)(eY.K,{title:"Delete loop",onClose:e=>{"confirm"===e?M():L()},confirmButtonContent:"Delete",confirmButtonType:"danger",children:"Are you sure you want to delete this loop? This action cannot be undone."}),b[30]=M,b[31]=T,b[32]=v):v=b[32],b[33]!==x||b[34]!==v?(_=(0,o.jsxs)(o.Fragment,{children:[x,v]}),b[33]=x,b[34]=v,b[35]=_):_=b[35],_):null}try{e2.displayName||(e2.displayName="LoopsActionMenu")}catch{}var e5=n(46996);function e3(){let{data:e}=Y(),t=!!e?.pipeline,n=!!e?.draftPipeline;return{hasChanges:n&&t&&!function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n={...e,updatedAt:void 0},a={...t,updatedAt:void 0};return(0,e5.A)(n,a)}(e.draftPipeline,e.pipeline),hasPipeline:t||n,isNew:!t&&n}}var e4=n(46928),e6=n(82610);let e7="loops",e8="loops",e9="loop",te=`${e6.Jz}/loops`,tt=/\/copilot\/loops/,tn=/\/copilot\/l\/([a-zA-Z0-9-]+)/,ta=/\/copilot\/loop\/share/,ti={container:"HeaderActions-module__container--SfIXp"};function tr(e){return e?.draftPipeline?{...e,pipeline:e.draftPipeline}:e}function ts(){let e,t,n,a,i;let r=(0,l.c)(14),s=(0,eb.jE)(),o=Q(),c=V();return r[0]!==o?(e=async e=>await o.resetPipeline(e),r[0]=o,r[1]=e):e=r[1],r[2]!==s?(t=async e=>{await s.cancelQueries({queryKey:[X,e]});let t=s.getQueryData([X,e]);return s.setQueryData([X,e],to),{previousLoopData:t}},r[2]=s,r[3]=t):t=r[3],r[4]!==c||r[5]!==s?(n=e=>{e&&(s.invalidateQueries({queryKey:[X,e.loopID]}),c({type:"FOCUS_NODE",nodeId:null}))},r[4]=c,r[5]=s,r[6]=n):n=r[6],r[7]!==s?(a=(e,t,n)=>{n?.previousLoopData&&s.setQueryData([X,t],n.previousLoopData)},r[7]=s,r[8]=a):a=r[8],r[9]!==e||r[10]!==t||r[11]!==n||r[12]!==a?(i={mutationFn:e,onMutate:t,onSuccess:n,onError:a},r[9]=e,r[10]=t,r[11]=n,r[12]=a,r[13]=i):i=r[13],(0,ej.n)(i)}function to(e){return e?.pipeline?{...e,draftPipeline:e.pipeline}:e}function tl(){let e,t,n,a,i,r,s,d,u,m,p;let h=(0,l.c)(43),f=ee(),{hasChanges:y,hasPipeline:x,isNew:v}=e3(),{mutate:_,isPending:b}=function(){let e,t,n,a,i;let r=(0,l.c)(11),s=(0,eb.jE)(),o=Q();return r[0]!==o?(e=async e=>await o.savePipeline(e),r[0]=o,r[1]=e):e=r[1],r[2]!==s?(t=async e=>{await s.cancelQueries({queryKey:[X,e]});let t=s.getQueryData([X,e]);return s.setQueryData([X,e],tr),{previousLoopData:t}},n=e=>{e&&s.invalidateQueries({queryKey:[X,e.loopID]})},a=(e,t,n)=>{n?.previousLoopData&&s.setQueryData([X,t],n.previousLoopData)},r[2]=s,r[3]=t,r[4]=n,r[5]=a):(t=r[3],n=r[4],a=r[5]),r[6]!==e||r[7]!==t||r[8]!==n||r[9]!==a?(i={mutationFn:e,onMutate:t,onSuccess:n,onError:a},r[6]=e,r[7]=t,r[8]=n,r[9]=a,r[10]=i):i=r[10],(0,ej.n)(i)}(),{mutate:j,isPending:C}=ts(),{mutateAsync:N,isPending:w}=e1(),I=(0,e4.Z)(),[S,k]=(0,c.useState)(null);h[0]!==y||h[1]!==C?(e=()=>{!C&&y&&k("reset")},h[0]=y,h[1]=C,h[2]=e):e=h[2];let T=e;h[3]!==w?(t=()=>{w||k("cancel")},h[3]=w,h[4]=t):t=h[4];let A=t;h[5]===Symbol.for("react.memo_cache_sentinel")?(n=()=>{k(null)},h[5]=n):n=h[5];let E=n;h[6]!==f||h[7]!==I||h[8]!==j?(a=()=>{f&&(j(f?.id),k(null),I(te),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_RESET_CHANGES",mode:"loops"}))},h[6]=f,h[7]=I,h[8]=j,h[9]=a):a=h[9];let R=a;h[10]!==y||h[11]!==b||h[12]!==f||h[13]!==_?(i=()=>{!b&&y&&f&&(_(f?.id),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_SAVE",mode:"loops"}))},h[10]=y,h[11]=b,h[12]=f,h[13]=_,h[14]=i):i=h[14];let P=i;h[15]!==b||h[16]!==f||h[17]!==_?(r=()=>{!b&&f&&(_(f?.id),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_CREATE",mode:"loops"}))},h[15]=b,h[16]=f,h[17]=_,h[18]=r):r=h[18];let D=r;h[19]!==N||h[20]!==f||h[21]!==I?(s=async()=>{k(null),f&&await N(f.id),I(te),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_CANCEL",mode:"loops"})},h[19]=N,h[20]=f,h[21]=I,h[22]=s):s=h[22];let L=s;return x?(h[23]!==D||h[24]!==A||h[25]!==T||h[26]!==P||h[27]!==y||h[28]!==w||h[29]!==v||h[30]!==C||h[31]!==b?(d=(0,o.jsx)("div",{className:ti.container,children:v?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ef.Q,{onClick:A,loading:w,children:"Cancel"}),(0,o.jsx)(ef.Q,{variant:"primary",onClick:D,loading:b,children:"Create"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ef.Q,{onClick:T,loading:C&&y,inactive:!y||C&&!y,children:"Cancel"}),(0,o.jsx)(ef.Q,{variant:"primary",onClick:P,loading:b&&y,inactive:!y||b&&!y,children:"Save"})]})}),h[23]=D,h[24]=A,h[25]=T,h[26]=P,h[27]=y,h[28]=w,h[29]=v,h[30]=C,h[31]=b,h[32]=d):d=h[32],h[33]!==R||h[34]!==S?(u="reset"===S&&(0,o.jsx)(eY.K,{title:"Cancel changes",onClose:e=>{"confirm"===e?R():E()},confirmButtonContent:"Discard",confirmButtonType:"danger",children:"Are you sure you want to discard all your changes since your last save? This action cannot be undone."}),h[33]=R,h[34]=S,h[35]=u):u=h[35],h[36]!==L||h[37]!==S?(m="cancel"===S&&(0,o.jsx)(eY.K,{title:"Cancel loop creation",onClose:e=>{"confirm"===e?L():E()},confirmButtonContent:"Delete",confirmButtonType:"danger",children:"Are you sure you want to cancel creating this loop? Any changes will be lost."}),h[36]=L,h[37]=S,h[38]=m):m=h[38],h[39]!==d||h[40]!==u||h[41]!==m?(p=(0,o.jsxs)(o.Fragment,{children:[d,u,m]}),h[39]=d,h[40]=u,h[41]=m,h[42]=p):p=h[42],p):null}try{tl.displayName||(tl.displayName="HeaderActions")}catch{}var tc=n(84976);let td={container:"Header-module__container--VnJT1",left:"Header-module__left--StOkC",right:"Header-module__right--MfDeH",title:"Header-module__title--v_2KB"},tu={button:"UnsavedChangesButton-module__button--qWPC0",active:"UnsavedChangesButton-module__active--kjcih",warningDot:"UnsavedChangesButton-module__warningDot--bniPi"},tm=()=>{let e;let t=(0,l.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)("div",{className:tu.warningDot}),t[0]=e):e=t[0],e};function tp(){let e,t,n,a,i,r,s,u,m,h;let f=(0,l.c)(23),y=ee(),{mutate:x,isPending:v}=ts(),[_,b]=(0,c.useState)(!1),[j,C]=(0,c.useState)(!1),N=_||j;f[0]!==y||f[1]!==x?(e=()=>{y&&(x(y?.id),C(!1),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_RESET_CHANGES",mode:"loops"}))},f[0]=y,f[1]=x,f[2]=e):e=f[2];let w=e;f[3]!==v||f[4]!==y?(t=()=>{!v&&y&&C(!0)},f[3]=v,f[4]=y,f[5]=t):t=f[5];let I=t,S=N&&tu.active;f[6]!==S?(n=(0,d.$)(tu.button,S),f[6]=S,f[7]=n):n=f[7],f[8]===Symbol.for("react.memo_cache_sentinel")?(a=()=>b(!0),i=()=>b(!1),r=()=>b(!0),s=()=>b(!1),f[8]=a,f[9]=i,f[10]=r,f[11]=s):(a=f[8],i=f[9],r=f[10],s=f[11]);let k=N?p.UndoIcon:tm,T=N?"Revert changes":"Unsaved changes";return f[12]!==I||f[13]!==n||f[14]!==k||f[15]!==T?(u=(0,o.jsx)(ef.Q,{className:n,variant:"invisible",onMouseEnter:a,onMouseLeave:i,onFocus:r,onBlur:s,onClick:I,leadingVisual:k,children:T}),f[12]=I,f[13]=n,f[14]=k,f[15]=T,f[16]=u):u=f[16],f[17]!==w||f[18]!==j?(m=j&&(0,o.jsx)(eY.K,{title:"Revert changes",onClose:e=>{"confirm"===e?w():C(!1)},confirmButtonContent:"Revert",confirmButtonType:"danger",children:"Are you sure you want to revert all changes since your last save? This action cannot be undone."}),f[17]=w,f[18]=j,f[19]=m):m=f[19],f[20]!==u||f[21]!==m?(h=(0,o.jsxs)(o.Fragment,{children:[u,m]}),f[20]=u,f[21]=m,f[22]=h):h=f[22],h}try{tm.displayName||(tm.displayName="WarningDot")}catch{}try{tp.displayName||(tp.displayName="UnsavedChangesButton")}catch{}function th(){let e,t,n,a,i,r,s,c,d,u;let h=(0,l.c)(24),f=ee(),y=f?.title,x=(0,q.Zp)(),v=function(){let e;let t=(0,l.c)(4),n=Q(),a=(0,q.Zp)(),i=ee();return t[0]!==i||t[1]!==a||t[2]!==n?(e=async()=>{if(!i)return;let e=crypto.randomUUID(),t={...i,id:e,title:i.title,updatedAt:new Date().toISOString()};await n.createPipelineRecord({loopID:e,pipeline:null,threadID:null,draftPipeline:t}),a(`${e6.Jz}/l/${e}`)},t[0]=i,t[1]=a,t[2]=n,t[3]=e):e=t[3],e}(),{hasChanges:_}=e3();h[0]!==x?(e=()=>{x(te)},h[0]=x,h[1]=e):e=h[1];let b=e;h[2]!==f?(t=()=>{if(!f)return;let e=JSON.stringify({title:f.title,description:f.description,nodes:f.nodes},null,2);navigator.clipboard.writeText(e),(0,g.BI)("dotcom_chat.activate",{target:"HEADER_JSON_COPY",mode:"loops"})},h[2]=f,h[3]=t):t=h[3];let j=t;h[4]!==f?(n=()=>{if(!f)return;let e=function(e){let t=btoa(encodeURIComponent(JSON.stringify({title:e.title,description:e.description,nodes:e.nodes}))),n=window.location.origin;return`${n}/copilot/loop/share?data=${t}`}(f);navigator.clipboard.writeText(e),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_SHARE",mode:"loops"})},h[4]=f,h[5]=n):n=h[5];let C=n;h[6]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(m.K,{"aria-label":"Close workbench",as:tc.N_,icon:p.XIcon,onClick:tg,to:te,variant:"invisible"}),h[6]=a):a=h[6],h[7]!==y?(i=(0,o.jsxs)("div",{className:td.left,children:[a,(0,o.jsx)("div",{className:td.title,children:y})]}),h[7]=y,h[8]=i):i=h[8],h[9]!==_?(r=_&&(0,o.jsx)(tp,{}),h[9]=_,h[10]=r):r=h[10];let N=f?.id;return h[11]!==j||h[12]!==v||h[13]!==b||h[14]!==C||h[15]!==N?(s=(0,o.jsx)(e2,{onDelete:b,onCopyLoop:j,onDuplicate:v,loopId:N,variant:"invisible",onShare:C}),h[11]=j,h[12]=v,h[13]=b,h[14]=C,h[15]=N,h[16]=s):s=h[16],h[17]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(tl,{}),h[17]=c):c=h[17],h[18]!==r||h[19]!==s?(d=(0,o.jsxs)("div",{className:td.right,children:[r,s,c]}),h[18]=r,h[19]=s,h[20]=d):d=h[20],h[21]!==i||h[22]!==d?(u=(0,o.jsxs)("div",{className:td.container,children:[i,d]}),h[21]=i,h[22]=d,h[23]=u):u=h[23],u}function tg(){(0,g.BI)("dotcom_chat.activate",{target:"HEADER_WORKBENCH_CLOSE",mode:"loops"})}try{th.displayName||(th.displayName="Header")}catch{}let tf={container:"Layout-module__container--dG4dp",header:"Layout-module__header--C4lDt",main:"Layout-module__main--nK86t",panelToggleButton:"Layout-module__panelToggleButton--SAcdA",panel:"Layout-module__panel--AXPkf",scrollContainer:"Layout-module__scrollContainer--Pqw64",backdrop:"Layout-module__backdrop--LL3Sk",visible:"Layout-module__visible--n1Y2Z",canvas:"Layout-module__canvas--o3ayZ",placeholder:"Layout-module__placeholder--auzUi",placeholderNode:"Layout-module__placeholderNode--psu4z",placeholderText:"Layout-module__placeholderText--qaws6"};var ty=n(25289),tx=n(43956);let tv={animatedListContainer:"AnimatedList-module__animatedListContainer--zT8Eg",animatedListItem:"AnimatedList-module__animatedListItem--O1ti0"};function t_(e){let t,n,a,i,r;let s=(0,l.c)(10),{children:c,indexFromEnd:d}=e,u=1-.15*d,m=1-.2*d,p=10-10*d;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t={opacity:.5,scale:1.05,top:20,filter:"blur(1px)"},s[0]=t):t=s[0],s[1]!==p||s[2]!==m||s[3]!==u?(n={opacity:m,scale:u,top:p,filter:"blur(0px)"},s[1]=p,s[2]=m,s[3]=u,s[4]=n):n=s[4],s[5]===Symbol.for("react.memo_cache_sentinel")?(a={opacity:0,scale:.5,top:-20,filter:"blur(1px)"},i={type:"spring",stiffness:280,damping:60},s[5]=a,s[6]=i):(a=s[5],i=s[6]),s[7]!==c||s[8]!==n?(r=(0,o.jsx)(ty.P.div,{layout:!0,initial:t,animate:n,exit:a,transition:i,className:tv.animatedListItem,children:c}),s[7]=c,s[8]=n,s[9]=r):r=s[9],r}let tb=c.memo(e=>{let t,n,a,i,r,s,u,m,p,h,g,f,y;let x=(0,l.c)(35);x[0]!==e?({children:t,className:n,delay:i,maxVisible:r,...a}=e,x[0]=e,x[1]=t,x[2]=n,x[3]=a,x[4]=i,x[5]=r):(t=x[1],n=x[2],a=x[3],i=x[4],r=x[5]);let v=void 0===i?3e3:i,_=void 0===r?2:r;x[6]!==t?(s=Array.isArray(t)?t:[t],x[6]=t,x[7]=s):s=x[7];let b=s;x[8]===Symbol.for("react.memo_cache_sentinel")?(u=[],x[8]=u):u=x[8];let[j,C]=(0,c.useState)(u),[N,w]=(0,c.useState)(0);if(x[9]!==b||x[10]!==v||x[11]!==_||x[12]!==N||x[13]!==j.length?(m=()=>{let e=setTimeout(()=>{C(e=>{let t=[...e,b[N]];return t.length>_&&t.shift(),t}),w(e=>(e+1)%b.length)},0===j.length?Math.min(v,300):v);return()=>clearTimeout(e)},x[9]=b,x[10]=v,x[11]=_,x[12]=N,x[13]=j.length,x[14]=m):m=x[14],x[15]!==b||x[16]!==v||x[17]!==_||x[18]!==N||x[19]!==j?(p=[j,N,b,v,_],x[15]=b,x[16]=v,x[17]=_,x[18]=N,x[19]=j,x[20]=p):p=x[20],(0,c.useEffect)(m,p),x[21]!==n?(h=(0,d.$)(tv.animatedListContainer,n),x[21]=n,x[22]=h):h=x[22],x[23]!==N||x[24]!==j){let e;x[26]!==N||x[27]!==j.length?(e=(e,t)=>(0,o.jsx)(t_,{indexFromEnd:j.length-1-t,children:e},e.key??`${t}-${N}`),x[26]=N,x[27]=j.length,x[28]=e):e=x[28],g=j.map(e),x[23]=N,x[24]=j,x[25]=g}else g=x[25];return x[29]!==g?(f=(0,o.jsx)(tx.N,{children:g}),x[29]=g,x[30]=f):f=x[30],x[31]!==a||x[32]!==f||x[33]!==h?(y=(0,o.jsx)("div",{className:h,...a,children:f}),x[31]=a,x[32]=f,x[33]=h,x[34]=y):y=x[34],y});tb.displayName="AnimatedList";try{t_.displayName||(t_.displayName="AnimatedListItem")}catch{}let tj=[{title:"Training the model...",type:"prompt"},{title:"Parsing your prompts...",type:"prompt"},{title:"Predicting next step...",type:"prompt"},{title:"Tokenizing thoughts...",type:"text"},{title:"Analyzing semantics...",type:"code"},{title:"Dreaming in code...",type:"code"},{title:"Activating neural nets...",type:"text"},{title:"Aligning intents...",type:"prompt"},{title:"Expanding vocabulary...",type:"text"},{title:"Crafting solutions...",type:"code"},{title:"Exploring possibilities...",type:"prompt"},{title:"Synthesizing context...",type:"text"},{title:"Optimizing creativity...",type:"text"},{title:"Chatting with AI...",type:"prompt"},{title:"Thinking in tokens...",type:"prompt"},{title:"Generating new ideas...",type:"text"}],tC=()=>{let e,t,n,a;let i=(0,l.c)(7),r=et(tw),s=r&&r.length>0?r:tj;return i[0]!==s?(e=Array.from({length:4},()=>s).flat().map(tI),i[0]=s,i[1]=e):e=i[1],i[2]!==e?(t=(0,o.jsx)(tb,{maxVisible:3,delay:3e3,children:e}),i[2]=e,i[3]=t):t=i[3],i[4]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)("span",{className:tf.placeholderText,children:"Updating your loop..."}),i[4]=n):n=i[4],i[5]!==t?(a=(0,o.jsxs)("div",{className:tf.placeholder,children:[t,n]}),i[5]=t,i[6]=a):a=i[6],a};try{tC.displayName||(tC.displayName="LoopPlaceholder")}catch{}function tN(e){return{title:e.title,type:e.type}}function tw(e){return e?.nodes?.map(tN)??[]}function tI(e,t){return(0,o.jsx)(eK,{title:e.title,type:e.type,nodeId:`node-${t}`,className:tf.placeholderNode,pipelineId:"default-pipeline"},`node-${e.title}-${t}`)}var tS=n(16945);let tk={container:"CompactNodePanel-module__container--TlevF",panelEmptyState:"CompactNodePanel-module__panelEmptyState--cb0p0",header:"CompactNodePanel-module__header--jUGrb",nodeDetails:"CompactNodePanel-module__nodeDetails--zmcQh",nodeTitleContainer:"CompactNodePanel-module__nodeTitleContainer--DHuox",nodeTitleText:"CompactNodePanel-module__nodeTitleText--To3al",descriptionText:"CompactNodePanel-module__descriptionText--CEsjF",nodeActions:"CompactNodePanel-module__nodeActions--aHenk",content:"CompactNodePanel-module__content--AOGbt",input:"CompactNodePanel-module__input--ULaU6",outputContainer:"CompactNodePanel-module__outputContainer--JqWB5",output:"CompactNodePanel-module__output--UUCOs",loading:"CompactNodePanel-module__loading--POtFp",groupTitle:"CompactNodePanel-module__groupTitle--gIXAp",emptyState:"CompactNodePanel-module__emptyState--DZLgm",emptyStateText:"CompactNodePanel-module__emptyStateText--zI1Sm"},tT={container:"NodeContent-module__container--qn3bd",groupTitle:"NodeContent-module__groupTitle--girTe",nodeModel:"NodeContent-module__nodeModel--UsoDt",nodeInput:"NodeContent-module__nodeInput--GBlR4",header:"NodeContent-module__header--_rrGW"};var tA=n(80938);let tE=(0,c.createContext)(null);function tR(e){let t,n,a;let i=(0,l.c)(7),{availableModels:r,previewUrl:s,sendChatMessage:c,children:d}=e;return i[0]!==r||i[1]!==s||i[2]!==c?(n={availableModels:r,previewUrl:s,sendChatMessage:c},i[0]=r,i[1]=s,i[2]=c,i[3]=n):n=i[3],t=n,i[4]!==d||i[5]!==t?(a=(0,o.jsx)(tE.Provider,{value:t,children:d}),i[4]=d,i[5]=t,i[6]=a):a=i[6],a}function tP(){let e=(0,c.useContext)(tE);if(!e)throw Error("useAppContext must be used within an AppContextProvider");return e}try{tE.displayName||(tE.displayName="AppContext")}catch{}try{tR.displayName||(tR.displayName="AppContextProvider")}catch{}function tD(e){let t,n,a;let i=(0,l.c)(9),{onUpdateModel:r,selectedModelName:s}=e,{availableModels:c}=tP();i[0]!==c||i[1]!==s?(t=c?.find(e=>e.id===s),i[0]=c,i[1]=s,i[2]=t):t=i[2];let d=t;i[3]!==r?(n=e=>{r(e.id)},i[3]=r,i[4]=n):n=i[4];let u=n;return c&&d?(i[5]!==c||i[6]!==u||i[7]!==d?(a=(0,o.jsx)(tA.k,{models:c,selectedModel:d,onModelPicked:u,disabled:!1,type:"global",variant:"default"}),i[5]=c,i[6]=u,i[7]=d,i[8]=a):a=i[8],a):null}try{tD.displayName||(tD.displayName="ModelPicker")}catch{}var tL=n(27297),tM=n(34225);let tO={container:"ContentEditor-module__container--nk6da",cmContainer:"ContentEditor-module__cmContainer--vMg4R"},tB=n(24774).Lz.theme({".cm-content":{fontSize:"var(--text-body-size-small, 12px) !important",lineHeight:"18px !important"},".cm-gutterElement":{fontSize:"var(--text-body-size-small, 12px) !important"},".cm-scroller":{scrollbarWidth:"thin"}}),tF=e=>{let t,n,a,i,r,s,c;let u=(0,l.c)(18),{className:m,content:p,onUpdate:h,placeholder:g,extensions:f,inputLabelId:y}=e,x=void 0===g?"Enter a prompt":g;return u[0]!==m?(t=(0,d.$)(tO.container,m),u[0]=m,u[1]=t):t=u[1],u[2]!==f?(n=f??[],u[2]=f,u[3]=n):n=u[3],u[4]!==n?(a=[tB,...n],u[4]=n,u[5]=a):a=u[5],u[6]!==h?(i=e=>h?.(e),u[6]=h,u[7]=i):i=u[7],u[8]===Symbol.for("react.memo_cache_sentinel")?(r={indentUnit:2,indentWithTabs:!1,lineWrapping:!0},u[8]=r):r=u[8],u[9]!==p||u[10]!==y||u[11]!==x||u[12]!==a||u[13]!==i?(s=(0,o.jsx)(tM.default,{ariaLabelledBy:y,containerClassName:tO.cmContainer,extensions:a,height:"100%",hideHelp:!0,onChange:i,placeholder:x,spacing:r,value:p}),u[9]=p,u[10]=y,u[11]=x,u[12]=a,u[13]=i,u[14]=s):s=u[14],u[15]!==t||u[16]!==s?(c=(0,o.jsx)("form",{className:t,children:s}),u[15]=t,u[16]=s,u[17]=c):c=u[17],c};try{tF.displayName||(tF.displayName="ContentEditor")}catch{}var t$=n(47404);async function tU(e,t,n){let a=e.matchBefore(/@\w*/),i=e.matchBefore(/\{\{\w*/),r=a||i;if(!r||r.from===r.to&&!e.explicit)return null;let s=t(),o=a?r.text.slice(1):r.text.slice(2),l=s.filter(e=>e.id.toLowerCase().includes(o.toLowerCase())&&e.id!==n).map(e=>({label:e.title,detail:e.id,apply:`{{${e.id}}}`,boost:1,type:"variable"}));return{from:r.from,options:l,filter:!1}}let tz=e=>{let t,n,a,i,r;let s=(0,l.c)(17),{className:c,content:d,onUpdate:u,placeholder:m,extensions:p,nodeId:h,inputLabelId:g}=e,f=void 0===m?"Enter a prompt":m,y=et(tV);if(s[0]!==y?(t=()=>y,s[0]=y,s[1]=t):t=s[1],s[2]!==h||s[3]!==t){var x;x=t,n=[(0,t$.yU)({override:[async e=>tU(e,x,h)],icons:!1,defaultKeymap:!0})],s[2]=h,s[3]=t,s[4]=n}else n=s[4];let v=n;s[5]!==p?(a=p??[],s[5]=p,s[6]=a):a=s[6],s[7]!==v||s[8]!==a?(i=[...a,v],s[7]=v,s[8]=a,s[9]=i):i=s[9];let _=i;return s[10]!==_||s[11]!==c||s[12]!==d||s[13]!==g||s[14]!==u||s[15]!==f?(r=(0,o.jsx)(tF,{className:c,content:d,onUpdate:u,placeholder:f,extensions:_,inputLabelId:g}),s[10]=_,s[11]=c,s[12]=d,s[13]=g,s[14]=u,s[15]=f,s[16]=r):r=s[16],r};try{tz.displayName||(tz.displayName="ContentEditorWithAutocomplete")}catch{}function tV(e){return e?.nodes??[]}let tW=({className:e,content:t,onUpdate:a,nodeId:i,inputLabelId:r})=>{let[s,l]=(0,c.useState)();return(0,c.useEffect)(()=>{(async()=>{let{graphql:e}=await Promise.all([n.e("vendors-node_modules_vscode-languageserver-types_lib_esm_main_js"),n.e("vendors-node_modules_codemirror_lint_dist_index_js"),n.e("vendors-node_modules_cm6-graphql_dist_index_js")]).then(n.bind(n,1904));l([(0,t$.yU)(),e()])})()},[]),(0,o.jsx)(tz,{className:e,content:t,extensions:s,inputLabelId:r,nodeId:i,onUpdate:a,placeholder:"Enter a GraphQL query"})};try{tW.displayName||(tW.displayName="GraphQLContentEditor")}catch{}var tH=n(65607),tq=n(24743);let tG={rangeValue:"NodeInput-module__rangeValue--N8Vt0",rangeContainer:"NodeInput-module__rangeContainer--cMtak",rangeLabels:"NodeInput-module__rangeLabels--KRuZe",rangeLabel:"NodeInput-module__rangeLabel--nMNnh",booleanContainer:"NodeInput-module__booleanContainer--XU8yP",fileContainer:"NodeInput-module__fileContainer--tHfkd"};function tK(e){let t=(0,l.c)(51),{content:n,nodeId:a,onChange:i,className:r,inputLabelId:s}=e,c=ed(a);if(!c||"text"!==c.type)return null;switch(c.inputType.type){case"range":{let e,a,s,l,d,u,m;t[0]!==n?(e=(0,o.jsx)("div",{className:tG.rangeValue,children:n}),t[0]=n,t[1]=e):e=t[1];let p=n||"0";return t[2]!==i?(a=e=>i(e.target.value),t[2]=i,t[3]=a):a=t[3],t[4]!==r||t[5]!==c.inputType.max||t[6]!==c.inputType.min||t[7]!==p||t[8]!==a?(s=(0,o.jsx)("div",{className:tG.rangeContainer,children:(0,o.jsx)("input",{type:"range",value:p,min:c.inputType.min,max:c.inputType.max,onChange:a,className:r})}),t[4]=r,t[5]=c.inputType.max,t[6]=c.inputType.min,t[7]=p,t[8]=a,t[9]=s):s=t[9],t[10]!==c.inputType.min?(l=(0,o.jsx)("div",{className:tG.rangeLabel,children:c.inputType.min}),t[10]=c.inputType.min,t[11]=l):l=t[11],t[12]!==c.inputType.max?(d=(0,o.jsx)("div",{className:tG.rangeLabel,children:c.inputType.max}),t[12]=c.inputType.max,t[13]=d):d=t[13],t[14]!==l||t[15]!==d?(u=(0,o.jsxs)("div",{className:tG.rangeLabels,children:[l,d]}),t[14]=l,t[15]=d,t[16]=u):u=t[16],t[17]!==e||t[18]!==s||t[19]!==u?(m=(0,o.jsxs)("div",{children:[e,s,u]}),t[17]=e,t[18]=s,t[19]=u,t[20]=m):m=t[20],m}case"boolean":{let e,a;let s="true"===n;return t[21]!==i?(e=e=>i(e.target.checked.toString()),t[21]=i,t[22]=e):e=t[22],t[23]!==r||t[24]!==s||t[25]!==e?(a=(0,o.jsx)("div",{className:tG.booleanContainer,children:(0,o.jsx)(tH.A,{checked:s,onChange:e,className:r})}),t[23]=r,t[24]=s,t[25]=e,t[26]=a):a=t[26],a}case"select":{let e,a,s;return t[27]!==i?(e=e=>i(e.target.value),t[27]=i,t[28]=e):e=t[28],t[29]!==c.inputType.options?(a=c.inputType.options?.map(tQ),t[29]=c.inputType.options,t[30]=a):a=t[30],t[31]!==r||t[32]!==n||t[33]!==e||t[34]!==a?(s=(0,o.jsx)("div",{children:(0,o.jsx)(tq.A,{value:n,onChange:e,className:r,children:a})}),t[31]=r,t[32]=n,t[33]=e,t[34]=a,t[35]=s):s=t[35],s}case"file":{let e,a,s,l;return t[36]!==c.inputType.fileType?(e=function(e){switch(e){case"pdf":return".pdf";case"image":return"image/*";case"video":return"video/*";case"audio":return"audio/*";case"document":return".doc,.docx,.txt,.rtf";case"code":return".js,.jsx,.ts,.tsx,.py,.java,.cpp,.c,.h,.cs";default:return"*/*"}}(c.inputType.fileType),t[36]=c.inputType.fileType,t[37]=e):e=t[37],t[38]!==i?(a=e=>{let t=e.target.files?.[0];t&&i(t.name)},t[38]=i,t[39]=a):a=t[39],t[40]!==r?(s=(0,d.$)(r,tG.fileContainer),t[40]=r,t[41]=s):s=t[41],t[42]!==n||t[43]!==e||t[44]!==a||t[45]!==s?(l=(0,o.jsx)("div",{children:(0,o.jsx)(eg.A,{type:"file",value:n,accept:e,onChange:a,className:s})}),t[42]=n,t[43]=e,t[44]=a,t[45]=s,t[46]=l):l=t[46],l}default:{let e;return t[47]!==n||t[48]!==s||t[49]!==i?(e=(0,o.jsx)(tF,{content:n,inputLabelId:s,onUpdate:i,placeholder:"Enter a value"}),t[47]=n,t[48]=s,t[49]=i,t[50]=e):e=t[50],e}}}function tQ(e){return(0,o.jsx)(tq.A.Option,{value:e,children:e},e)}try{tK.displayName||(tK.displayName="NodeInput")}catch{}var tJ=n(26514);function tZ(e){let t,n,a,i,r,s;let c=(0,l.c)(16),{additionalFields:d,content:u,contentEditor:m,children:h,inputLabelId:g}=e;return c[0]!==g?(t=(0,o.jsx)("div",{className:tT.groupTitle,id:g,children:"Input"}),c[0]=g,c[1]=t):t=c[1],c[2]!==u?(n=u?u.toString():"",c[2]=u,c[3]=n):n=c[3],c[4]!==n?(a=(0,o.jsx)(tJ.T,{icon:p.CopyIcon,variant:"invisible",ariaLabel:"Copy input",textToCopy:n}),c[4]=n,c[5]=a):a=c[5],c[6]!==t||c[7]!==a?(i=(0,o.jsxs)("div",{className:tT.header,children:[t,a]}),c[6]=t,c[7]=a,c[8]=i):i=c[8],c[9]!==h||c[10]!==m||c[11]!==i?(r=(0,o.jsxs)("div",{className:tT.nodeInput,children:[i,m,h]}),c[9]=h,c[10]=m,c[11]=i,c[12]=r):r=c[12],c[13]!==d||c[14]!==r?(s=(0,o.jsxs)("div",{className:tT.container,children:[d,r]}),c[13]=d,c[14]=r,c[15]=s):s=c[15],s}try{tZ.displayName||(tZ.displayName="NodeContentLayout")}catch{}function tX(e){let t=(0,l.c)(39),{nodeId:n,onUpdate:a}=e,i=(0,e_.h)(),r=ed(n),s=et(e=>el(n,e)?.content??""),d=(0,c.useId)();if(!r)return null;switch(r.type){case"loop":default:return null;case"github-graphql":{let e,i,r;t[0]!==a?(e=e=>a({content:e}),t[0]=a,t[1]=e):e=t[1],t[2]!==d||t[3]!==s||t[4]!==n||t[5]!==e?(i=(0,o.jsx)(tW,{content:s,inputLabelId:d,nodeId:n,onUpdate:e}),t[2]=d,t[3]=s,t[4]=n,t[5]=e,t[6]=i):i=t[6];let l=i;return t[7]!==l||t[8]!==d||t[9]!==s?(r=(0,o.jsx)(tZ,{content:s,contentEditor:l,inputLabelId:d}),t[7]=l,t[8]=d,t[9]=s,t[10]=r):r=t[10],r}case"text":{let e,i,r;t[11]!==a?(e=e=>a({content:e}),t[11]=a,t[12]=e):e=t[12],t[13]!==d||t[14]!==s||t[15]!==n||t[16]!==e?(i=(0,o.jsx)(tK,{className:tT.nodeInput,content:s,inputLabelId:d,nodeId:n,onChange:e}),t[13]=d,t[14]=s,t[15]=n,t[16]=e,t[17]=i):i=t[17];let l=i;return t[18]!==l||t[19]!==d||t[20]!==s?(r=(0,o.jsx)(tZ,{content:s,contentEditor:l,inputLabelId:d}),t[18]=l,t[19]=d,t[20]=s,t[21]=r):r=t[21],r}case"prompt":{let e,l,c,u,m;t[22]===Symbol.for("react.memo_cache_sentinel")?(e=(0,tL.wv)(),t[22]=e):e=t[22];let p=e.id;t[23]!==i.copilot_loops_post_staff_ship_features||t[24]!==r||t[25]!==a?(l=i.copilot_loops_post_staff_ship_features?(0,o.jsxs)("div",{className:tT.nodeModel,children:[(0,o.jsx)("div",{className:tT.groupTitle,children:"Model"}),(0,o.jsx)("div",{children:(0,o.jsx)(tD,{selectedModelName:r.model??p,onUpdateModel:e=>a({...r,model:e})})})]}):null,t[23]=i.copilot_loops_post_staff_ship_features,t[24]=r,t[25]=a,t[26]=l):l=t[26];let h=l;t[27]!==a?(c=e=>a({content:e}),t[27]=a,t[28]=c):c=t[28],t[29]!==d||t[30]!==s||t[31]!==n||t[32]!==c?(u=(0,o.jsx)(tz,{content:s,onUpdate:c,nodeId:n,inputLabelId:d}),t[29]=d,t[30]=s,t[31]=n,t[32]=c,t[33]=u):u=t[33];let g=u;return t[34]!==h||t[35]!==g||t[36]!==d||t[37]!==s?(m=(0,o.jsx)(tZ,{additionalFields:h,content:s,contentEditor:g,inputLabelId:d}),t[34]=h,t[35]=g,t[36]=d,t[37]=s,t[38]=m):m=t[38],m}}}try{tX.displayName||(tX.displayName="NodeContent")}catch{}var tY=n(35642),t0=n(55516);function t1(e){let t,n,a,i;let r=(0,l.c)(7),{nodeId:s}=e,c=(0,e_.h)(),{removeNode:d}=eI();r[0]!==s||r[1]!==d?(t=()=>{d(s)},r[0]=s,r[1]=d,r[2]=t):t=r[2];let u=t;return c.copilot_loops_post_staff_ship_features?(r[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)(ex.W.Anchor,{children:(0,o.jsx)(m.K,{"aria-label":"Additional actions",icon:p.KebabHorizontalIcon})}),r[3]=n):n=r[3],r[4]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.TrashIcon,{})}),r[4]=a):a=r[4],r[5]!==u?(i=(0,o.jsxs)(ex.W,{children:[n,(0,o.jsx)(ex.W.Overlay,{align:"end",children:(0,o.jsx)(ey.l,{children:(0,o.jsxs)(ey.l.Item,{onSelect:u,variant:"danger",children:[a,"Delete"]})})})]}),r[5]=u,r[6]=i):i=r[6],i):null}try{t1.displayName||(t1.displayName="NodeContextMenu")}catch{}let t2={errorContainer:"NodeError-module__errorContainer--UPDzR",errorNotice:"NodeError-module__errorNotice--KIWMv",errorIcon:"NodeError-module__errorIcon--ALast",errorText:"NodeError-module__errorText--ywLRv",fixErrorButton:"NodeError-module__fixErrorButton--bct68"};function t5(e){let t,n,a,i,r;let s=(0,l.c)(11),{errors:c,onFixErrorClick:d,title:u}=e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,o.jsx)(p.AlertIcon,{className:t2.errorIcon}),s[0]=t):t=s[0],s[1]!==u?(n=(0,o.jsxs)("div",{className:t2.errorNotice,children:[t,u]}),s[1]=u,s[2]=n):n=s[2],s[3]!==c?(a=c.map(t3),s[3]=c,s[4]=a):a=s[4],s[5]!==d?(i=(0,o.jsx)(ef.Q,{className:t2.fixErrorButton,leadingVisual:p.BeakerIcon,onClick:d,children:"Try to fix it"}),s[5]=d,s[6]=i):i=s[6],s[7]!==n||s[8]!==a||s[9]!==i?(r=(0,o.jsxs)("div",{className:t2.errorContainer,children:[n,a,i]}),s[7]=n,s[8]=a,s[9]=i,s[10]=r):r=s[10],r}function t3(e){return(0,o.jsx)("p",{className:t2.errorText,children:e},e)}try{t5.displayName||(t5.displayName="NodeError")}catch{}var t4=n(58011);let t6={outputHeader:"NodeOutput-module__outputHeader--NrD2t",outputType:"NodeOutput-module__outputType--H7w2K",nodeValue:"NodeOutput-module__nodeValue--haJEw",jsonOutput:"NodeOutput-module__jsonOutput--YkeGl",markdownOutput:"NodeOutput-module__markdownOutput--z0yEE"};var t7=n(19919);let t8={container:"CodeBlocks-module__container--HAo0t",copyContainer:"CodeBlocks-module__copyContainer--qLr5N",copyContent:"CodeBlocks-module__copyContent--WbMzw",copyButton:"CodeBlocks-module__copyButton--xRixl",immersive:"CodeBlocks-module__immersive--WOvoW",code:"CodeBlocks-module__code--fNu3l",codeContainer:"CodeBlocks-module__codeContainer--RWmQU",codeWrap:"CodeBlocks-module__codeWrap--qABxr"};var t9=n(37120);function ne(e){let t,n,a,i,r,s,u,m,p;let h=(0,l.c)(18),{children:f,code:y}=e,x=(0,c.useId)(),{chatMode:v,wrapCodeLines:_}=(0,c.useContext)(t9.F);h[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,d.$)(t8.container,t8.immersive),h[0]=t):t=h[0],h[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,d.$)(t8.copyContainer),a=(0,d.$)(t8.copyContent),h[1]=n,h[2]=a):(n=h[1],a=h[2]),h[3]!==v?(i=()=>{(0,g.BI)("dotcom_chat.activate",{target:"CODE_BLOCK_COPY",mode:v})},h[3]=v,h[4]=i):i=h[4],h[5]!==y||h[6]!==i?(r=(0,o.jsx)("div",{className:n,children:(0,o.jsx)("div",{className:a,children:(0,o.jsx)(tJ.T,{textToCopy:y,ariaLabel:"Copy code",className:t8.copyButton,size:"small",onCopy:i})})}),h[5]=y,h[6]=i,h[7]=r):r=h[7],h[8]===Symbol.for("react.memo_cache_sentinel")?(s=(0,d.$)(t8.codeContainer),h[8]=s):s=h[8];let b=_&&t8.codeWrap;return h[9]!==b?(u=(0,d.$)(b),h[9]=b,h[10]=u):u=h[10],h[11]!==f||h[12]!==u?(m=(0,o.jsx)("div",{className:s,children:(0,o.jsx)("pre",{className:t8.code,tabIndex:0,children:(0,o.jsx)("code",{className:u,children:f})})}),h[11]=f,h[12]=u,h[13]=m):m=h[13],h[14]!==x||h[15]!==r||h[16]!==m?(p=(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("figure",{className:t,"aria-labelledby":x,children:[r,m]})}),h[14]=x,h[15]=r,h[16]=m,h[17]=p):p=h[17],p}try{ne.displayName||(ne.displayName="CodeBlocksForLoop")}catch{}var nt=n(47970);let nn="data-codeblock-for-loop-props",na=(0,t7.F)(nn),ni={code:(e,t)=>{let n=(0,t7.k)(e,nn);return n?(0,o.jsx)(ne,{...n,children:e.children}):t}},nr={diagramContainer:"Mermaid-module__diagramContainer--jkE_P",hiddenSourceCode:"Mermaid-module__hiddenSourceCode--xCGnR",loaderContainer:"Mermaid-module__loaderContainer--deaNV"},ns="data-mermaid-props",no=(0,t7.F)(ns);function nl({code:e,identity:t,viewscreenHost:n}){let a=`${n}/markdown/mermaid`,i=(0,c.useMemo)(()=>btoa(encodeURIComponent(e)),[e]);return(0,o.jsxs)("section",{className:(0,d.$)("js-render-needs-enrichment","render-needs-enrichment",nr.diagramContainer),"data-identity":t,"data-host":n,"data-src":`${a}?data=${i}`,"data-type":"mermaid","aria-label":"Mermaid diagram rendered output container",children:[(0,o.jsx)("div",{className:"js-render-enrichment-target","data-json":JSON.stringify({data:e}),"data-plain":e,children:(0,o.jsx)("div",{className:nr.hiddenSourceCode,children:(0,o.jsx)("pre",{lang:"mermaid",children:e})})}),(0,o.jsx)("span",{className:(0,d.$)("js-render-enrichment-loader",nr.loaderContainer),role:"presentation",children:(0,o.jsx)(eH.A,{})})]})}let nc={code:(e,t)=>{if(!e.className?.includes("language-mermaid"))return t;let n=(0,t7.k)(e,ns);return n?(0,o.jsx)(nl,{code:n.code,identity:n.identity,viewscreenHost:n.viewscreenHost}):t}};try{nl.displayName||(nl.displayName="MermaidRenderer")}catch{}function nd(e){let t,n,a,i,r,s,c,d,u;let m=(0,l.c)(19),{node:h,nodeValue:g}=e,{previewUrl:f}=tP();if(m[0]===Symbol.for("react.memo_cache_sentinel")?(n={transformMarkdown:e=>(0,nt.YR)(e,"code",e=>{e.data={...e.data,hName:"code",hProperties:{[na]:JSON.stringify({language:e.lang??"",code:e.value,startOffset:e.position?.start.offset??-1,endOffset:e.position?.end.offset??-1})}}}),transformHtml:e=>(0,nt.YR)(e,"element",(e,t,n)=>{let a=e.children?.[0];n&&void 0!==t&&"pre"===e.tagName&&e.children?.length===1&&a?.type==="element"&&"code"===a.tagName&&na in a.properties&&n.children.splice(t,1,a)}),reactComponents:ni},m[0]=n):n=m[0],m[1]!==f){if(a=[n],f){var y;a.push((y={viewscreenHost:f},{transformMarkdown:e=>(0,nt.YR)(e,"code",e=>{"mermaid"===e.lang&&(e.data={...e.data,hName:"code",hProperties:{className:["language-mermaid"],[no]:JSON.stringify({code:e.value,identity:`mermaid-${Math.random().toString(36).slice(2,11)}`,viewscreenHost:y.viewscreenHost})}})}),transformHtml:e=>(0,nt.YR)(e,"element",(e,t,n)=>{let a=e.children?.[0];n&&void 0!==t&&"pre"===e.tagName&&e.children?.length===1&&a?.type==="element"&&"code"===a.tagName&&no in a.properties&&n.children.splice(t,1,a)}),reactComponents:nc}))}m[1]=f,m[2]=a}else a=m[2];t=a;let x=_[h.type].outputLabel??"Markdown";m[3]!==g?(i=function e(t){return null==t?"":"string"==typeof t?t:t&&"object"==typeof t?JSON.stringify(t,null,2):Array.isArray(t)?t.map(e).join("\n"):String(t)}(g),m[3]=g,m[4]=i):i=m[4];let v=i;return(m[5]!==x?(r=(0,o.jsx)("div",{className:t6.outputType,children:x}),m[5]=x,m[6]=r):r=m[6],m[7]!==v?(s=(0,o.jsx)(tJ.T,{icon:p.CopyIcon,variant:"invisible",ariaLabel:"Copy output",textToCopy:v}),m[7]=v,m[8]=s):s=m[8],m[9]!==r||m[10]!==s?(c=(0,o.jsxs)("div",{className:t6.outputHeader,children:[r,s]}),m[9]=r,m[10]=s,m[11]=c):c=m[11],m[12]!==t||m[13]!==h||m[14]!==v)?(d=(0,o.jsx)("div",{className:t6.nodeValue,children:"github-graphql"===h.type?(0,o.jsx)("pre",{className:t6.jsonOutput,children:v}):(0,o.jsx)(t4.To,{extensions:t,className:t6.markdownOutput,markdown:v})}),m[12]=t,m[13]=h,m[14]=v,m[15]=d):d=m[15],m[16]!==c||m[17]!==d?(u=(0,o.jsxs)(o.Fragment,{children:[c,d]}),m[16]=c,m[17]=d,m[18]=u):u=m[18],u}try{nd.displayName||(nd.displayName="NodeOutput")}catch{}var nu=n(13250);function nm(){let e,t;let n=(0,l.c)(3),{streamingMessage:a,isWaitingOnCopilot:i}=(0,h.Pk)(),r=a||i;return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)(nu.I,{icon:"node",size:32}),n[0]=e):e=n[0],n[1]!==r?(t=(0,o.jsxs)("div",{className:tk.panelEmptyState,children:[e,r?(0,o.jsx)("span",{children:"Select a node in the loop once creation has completed."}):(0,o.jsx)("span",{children:"Select a node in the loop to view and edit."})]}),n[1]=r,n[2]=t):t=n[2],t}function np(e){let t,n,a,i,r,s,c,d,u,m,p,h,f,y,x,v,_;let b=(0,l.c)(59),{nodeId:j,pipelineId:C}=e;b[0]!==j||b[1]!==C?(t={nodeId:j,pipelineId:C},b[0]=j,b[1]=C,b[2]=t):t=b[2];let{node:N,runPipelineFromNode:w,onStop:I,onUpdate:S}=function({nodeId:e}){let{runPipeline:t,stopPipeline:n}=eL(),{updateNode:a}=eI(),i=es(),r=ed(e),s=E(eD()).some(t=>t.id===e),o=(0,t0.d)(e=>t(e),1e3),l=async()=>{!i&&r&&t(r.id)};return{isOutput:s,node:r,runPipelineFromNode:l,onUpdate:e=>{if(!r)return;let t=T({...r,...e},[]);t&&(a(r.id,t),o(r.id))},onStop:n}}(t),k=U(e=>ec(j)(e)?.error),A=U(e=>ec(j)(e)?.value??null),R=eu(j),P=function(e){let t;let n=(0,l.c)(5),a=ei();if(n[0]!==e||n[1]!==a){let i;n[3]!==e?(i=t=>t.involvedNodes.includes(e),n[3]=e,n[4]=i):i=n[4],t=a.filter(i).map(er),n[0]=e,n[1]=a,n[2]=t}else t=n[2];return t}(j),{sendChatMessage:D}=tP();if(!N)return null;b[3]!==N.id||b[4]!==k||b[5]!==D||b[6]!==P?(n=async()=>{let e;if(P.length||k){if(P.length){let t=P.map(nh).join("\n");e=`The following errors were found in the Loop configuration:
${t}`}else e=`The following error was found when running node ${N.id}:
${k}`;D(e+="\n\nFix the Loop by updating this node or other nodes upstream in the Loop."),(0,g.BI)("dotcom_chat.activate",{target:"PANEL_NODE_FIX_ERROR",mode:"loops"})}},b[3]=N.id,b[4]=k,b[5]=D,b[6]=P,b[7]=n):n=b[7];let L=n;return b[8]!==N?(a=(0,o.jsx)(eV,{type:N.type,node:N}),b[8]=N,b[9]=a):a=b[9],b[10]!==N.title?(i=(0,o.jsx)("span",{className:tk.nodeTitleText,children:N.title}),b[10]=N.title,b[11]=i):i=b[11],b[12]!==N?(r=(0,o.jsx)(eW,{type:N.type,node:N}),b[12]=N,b[13]=r):r=b[13],b[14]!==a||b[15]!==i||b[16]!==r?(s=(0,o.jsxs)("div",{className:tk.nodeTitleContainer,children:[a,i,r]}),b[14]=a,b[15]=i,b[16]=r,b[17]=s):s=b[17],b[18]!==N.description?(c=(0,o.jsx)("span",{className:tk.descriptionText,children:N.description}),b[18]=N.description,b[19]=c):c=b[19],b[20]!==s||b[21]!==c?(d=(0,o.jsxs)("div",{className:tk.nodeDetails,children:[s,c]}),b[20]=s,b[21]=c,b[22]=d):d=b[22],b[23]!==R||b[24]!==N.type||b[25]!==A||b[26]!==I||b[27]!==w?(u=["prompt","code","pipeline","github-graphql"].includes(N.type)&&(0,o.jsx)(eR,{onClick:()=>{w(),(0,g.BI)("node_action.select",{target:"PANEL_NODE_RUN",mode:"loops"})},onStop:()=>{I(),(0,g.BI)("node_action.select",{target:"PANEL_NODE_STOP",mode:"loops"})},isLoading:R,value:A,variant:"default",iconOnly:!0}),b[23]=R,b[24]=N.type,b[25]=A,b[26]=I,b[27]=w,b[28]=u):u=b[28],b[29]!==j?(m=(0,o.jsx)(t1,{nodeId:j}),b[29]=j,b[30]=m):m=b[30],b[31]!==m||b[32]!==u?(p=(0,o.jsxs)("div",{className:tk.nodeActions,children:[u,m]}),b[31]=m,b[32]=u,b[33]=p):p=b[33],b[34]!==p||b[35]!==d?(h=(0,o.jsxs)("div",{className:tk.header,children:[d,p]}),b[34]=p,b[35]=d,b[36]=h):h=b[36],b[37]!==R||b[38]!==j||b[39]!==S||b[40]!==C?(f=(0,o.jsx)("div",{className:tk.input,children:(0,o.jsx)(tX,{nodeId:j,pipelineId:C,isContentVisible:!0,isCollapsed:!1,isLoading:R,onUpdate:S})}),b[37]=R,b[38]=j,b[39]=S,b[40]=C,b[41]=f):f=b[41],b[42]!==R||b[43]!==N||b[44]!==k||b[45]!==A||b[46]!==I||b[47]!==w||b[48]!==L||b[49]!==P?(y=["prompt","code","loop","github-graphql"].includes(N.type)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:tk.groupTitle,children:"Output"}),(0,o.jsx)("div",{className:tk.output,children:R&&!A?(0,o.jsx)("div",{className:tk.loading,children:(0,o.jsx)(tY.r,{lines:3})}):P.length>0?(0,o.jsx)(t5,{errors:P,onFixErrorClick:L,title:"Oops, this node is configured incorrectly"}):k?(0,o.jsx)(t5,{errors:[k],onFixErrorClick:L}):A?(0,o.jsx)(nd,{node:N,nodeValue:A}):(0,o.jsxs)("div",{className:tk.emptyState,children:[(0,o.jsx)(eR,{onClick:()=>{w(),(0,g.BI)("node_action.select",{target:"PANEL_NODE_EMPTY_STATE_RUN",mode:"loops"})},onStop:()=>{I(),(0,g.BI)("node_action.select",{target:"PANEL_NODE_EMPTY_STATE_STOP",mode:"loops"})},isLoading:R,value:A,variant:"default"}),(0,o.jsxs)("p",{className:tk.emptyStateText,children:["No output yet.",(0,o.jsx)("br",{})," Run this node to generate output."]})]})})]}),b[42]=R,b[43]=N,b[44]=k,b[45]=A,b[46]=I,b[47]=w,b[48]=L,b[49]=P,b[50]=y):y=b[50],b[51]!==y?(x=(0,o.jsx)("div",{className:tk.outputContainer,children:y}),b[51]=y,b[52]=x):x=b[52],b[53]!==f||b[54]!==x?(v=(0,o.jsxs)("div",{className:tk.content,children:[f,x]}),b[53]=f,b[54]=x,b[55]=v):v=b[55],b[56]!==h||b[57]!==v?(_=(0,o.jsxs)("div",{className:tk.container,children:[h,v]}),b[56]=h,b[57]=v,b[58]=_):_=b[58],_}function nh(e){return`- ${e}`}function ng(e){let t;let n=(0,l.c)(3),{nodeId:a,pipelineId:i}=e;return n[0]!==a||n[1]!==i?(t=a&&i?(0,o.jsx)(np,{nodeId:a,pipelineId:i}):(0,o.jsx)(nm,{}),n[0]=a,n[1]=i,n[2]=t):t=n[2],t}try{nm.displayName||(nm.displayName="EmptyNodePanel")}catch{}try{np.displayName||(np.displayName="ActiveNodePanel")}catch{}try{ng.displayName||(ng.displayName="CompactNodePanel")}catch{}var nf=n(75507),ny=n(26871);let nx={container:"ChatMessages-module__container--iorVa",scrollContainer:"ChatMessages-module__scrollContainer--CAONK",input:"ChatMessages-module__input--lZJYB"};var nv=n(42157);function n_(e){let t,n;let a=(0,l.c)(7),{textAreaRef:i}=e,r=V(),{sendChatMessage:s}=tP(),c=(0,h.pn)(nb);a[0]!==r||a[1]!==s?(t=async e=>{(0,g.BI)("dotcom_chat.activate",{target:"PANEL_CHAT_MESSAGE_SUBMIT",mode:"loops"}),s(e),r({type:"FOCUS_NODE",nodeId:null})},a[0]=r,a[1]=s,a[2]=t):t=a[2];let d=t,u=!!c;return a[3]!==d||a[4]!==u||a[5]!==i?(n=(0,o.jsx)(nv.V,{textAreaRef:i,onSubmit:d,placeholder:"Refine your loop",size:"large",isStreaming:u,hideAttachmentButton:!0}),a[3]=d,a[4]=u,a[5]=i,a[6]=n):n=a[6],n}function nb(e){return e.streamingMessage}try{n_.displayName||(n_.displayName="ChatInput")}catch{}function nj(e){let t,n,a,i;let r=(0,l.c)(6),{isMobileView:s}=e,d=(0,c.useRef)(null);return r[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,o.jsx)(nf.B,{disableTopicPicker:!0,inputRef:d,showQuotaExceededEmptyState:!1}),r[0]=t):t=r[0],r[1]!==s?(n=(0,o.jsx)(ny.$,{disabled:s,className:nx.scrollContainer,children:t}),r[1]=s,r[2]=n):n=r[2],r[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)("div",{className:nx.input,children:(0,o.jsx)(n_,{textAreaRef:d})}),r[3]=a):a=r[3],r[4]!==n?(i=(0,o.jsxs)("div",{className:nx.container,children:[n,a]}),r[4]=n,r[5]=i):i=r[5],i}try{nj.displayName||(nj.displayName="ChatMessages")}catch{}var nC=n(50781);let nN={container:"SidePanel-module__container--dHo2v",panelHeader:"SidePanel-module__panelHeader--Q5UNL",segmentedControl:"SidePanel-module__segmentedControl--ehaGC",content:"SidePanel-module__content--epJfI"};function nw(e){let t,n,a,i,r,s,d,u,m,f;let y=(0,l.c)(23),{isMobileView:x,nodeId:v,pipelineId:_}=e,{streamingMessage:b,isWaitingOnCopilot:j}=(0,h.Pk)(),C=b||j,[N,w]=(0,c.useState)(C?"chat":"node");y[0]!==C?(t=()=>{C&&w("chat")},n=[C],y[0]=C,y[1]=t,y[2]=n):(t=y[1],n=y[2]),(0,c.useEffect)(t,n),y[3]!==C||y[4]!==v?(a=()=>{v&&!C&&w("node")},i=[C,v],y[3]=C,y[4]=v,y[5]=a,y[6]=i):(a=y[5],i=y[6]),(0,c.useEffect)(a,i),y[7]===Symbol.for("react.memo_cache_sentinel")?(r=e=>{let t=0===e?"chat":"node";w(t),(0,g.BI)("dotcom_chat.activate",{target:"chat"===t?"PANEL_SELECT_CHAT":"PANEL_SELECT_NODE",mode:"loops"})},y[7]=r):r=y[7];let I=r,S="chat"===N;y[8]!==S?(s=(0,o.jsx)(tS.I.Button,{selected:S,leadingIcon:p.CommentIcon,children:"Refine"}),y[8]=S,y[9]=s):s=y[9];let k="node"===N;return y[10]!==k?(d=(0,o.jsx)(tS.I.Button,{selected:k,leadingIcon:nC.GS,children:"Node"}),y[10]=k,y[11]=d):d=y[11],y[12]!==s||y[13]!==d?(u=(0,o.jsx)("div",{className:nN.panelHeader,children:(0,o.jsxs)(tS.I,{"aria-label":"Loops panel",className:nN.segmentedControl,onChange:I,children:[s,d]})}),y[12]=s,y[13]=d,y[14]=u):u=y[14],y[15]!==N||y[16]!==x||y[17]!==v||y[18]!==_?(m=(0,o.jsx)("div",{className:nN.content,children:"node"===N?(0,o.jsx)(ng,{pipelineId:_,nodeId:v},v||"empty"):(0,o.jsx)(nj,{isMobileView:x})}),y[15]=N,y[16]=x,y[17]=v,y[18]=_,y[19]=m):m=y[19],y[20]!==u||y[21]!==m?(f=(0,o.jsxs)("div",{className:nN.container,children:[u,m]}),y[20]=u,y[21]=m,y[22]=f):f=y[22],f}try{nw.displayName||(nw.displayName="SidePanel")}catch{}function nI(){let e,t,n,a,i,r,s,f,y,x,v,_;let b=(0,l.c)(34),j=ee(),C=!!j,N=U(nk),w=j?.id,I=V(),[S,k]=(0,c.useState)(!1),{streamingMessage:T,isWaitingOnCopilot:A}=(0,h.Pk)(),E=T||A,[R,P]=(0,c.useState)(nS);b[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{P(window.innerWidth<1024)},b[0]=e):e=b[0],(0,u.w)(e);let D=!!N&&!!w,L=!R||S||D;b[1]!==I||b[2]!==R?(t=()=>{I({type:"FOCUS_NODE",nodeId:null}),R&&k(!1)},b[1]=I,b[2]=R,b[3]=t):t=b[3];let M=t;b[4]!==S?(n=()=>{(0,g.BI)("dotcom_chat.activate",{target:S?"PANEL_MOBILE_CLOSE":"PANEL_MOBILE_OPEN",mode:"loops"}),k(!S)},b[4]=S,b[5]=n):n=b[5];let O=n;return b[6]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)("div",{className:tf.header,children:(0,o.jsx)(th,{})}),b[6]=a):a=b[6],b[7]!==R||b[8]!==S||b[9]!==O?(i=R&&(0,o.jsx)(m.K,{className:tf.panelToggleButton,onClick:O,icon:p.HistoryIcon,"aria-label":S?"Close panel":"Open panel","aria-expanded":S}),b[7]=R,b[8]=S,b[9]=O,b[10]=i):i=b[10],b[11]!==M||b[12]!==R||b[13]!==L?(r=R&&L&&(0,o.jsx)("div",{className:tf.backdrop,onClick:M}),b[11]=M,b[12]=R,b[13]=L,b[14]=r):r=b[14],b[15]!==L?(s=(0,d.$)(tf.panel,{[tf.visible]:L}),b[15]=L,b[16]=s):s=b[16],b[17]!==R||b[18]!==w||b[19]!==N?(f=(0,o.jsx)("div",{className:tf.scrollContainer,children:(0,o.jsx)(nw,{isMobileView:R,nodeId:N,pipelineId:w})}),b[17]=R,b[18]=w,b[19]=N,b[20]=f):f=b[20],b[21]!==s||b[22]!==f?(y=(0,o.jsx)("div",{className:s,children:f}),b[21]=s,b[22]=f,b[23]=y):y=b[23],b[24]!==C||b[25]!==E?(x=E?(0,o.jsx)(tC,{}):C?(0,o.jsx)(eZ,{}):null,b[24]=C,b[25]=E,b[26]=x):x=b[26],b[27]!==x?(v=(0,o.jsx)("div",{className:tf.canvas,children:x}),b[27]=x,b[28]=v):v=b[28],b[29]!==v||b[30]!==i||b[31]!==r||b[32]!==y?(_=(0,o.jsxs)("div",{className:tf.container,children:[a,(0,o.jsxs)("div",{className:tf.main,children:[i,r,y,v]})]}),b[29]=v,b[30]=i,b[31]=r,b[32]=y,b[33]=_):_=b[33],_}function nS(){return"undefined"!=typeof window&&window.innerWidth<1024}function nk(e){return e.uiState.focusedNodeId}try{nI.displayName||(nI.displayName="Layout")}catch{}let nT={container:"PipesPreviewArea-module__container--aXrRa"};function nA(e,t,n=!1){for(let a of[...t].reverse())if("assistant"===a.role||n)for(let t of a.references??[])try{if("pipe"===t.type||t.type===e9){if(nE(t)){let e={description:t.description,id:t.id,title:t.title,nodes:t.nodes,updatedAt:a.createdAt},n=A(e,[]);return{messageId:a.id,pipeline:n}}}else if("text"===t.type&&t.text){let n=JSON.parse(t.text);if(nE(n)){let t=A(n,[]);return t.id=e??n.title.replace(/\s+/g,"-").toLowerCase(),{messageId:a.id,pipeline:t}}}}catch{continue}}function nE(e){return!!e&&"object"==typeof e&&"title"in e&&"nodes"in e}let nR=new Set([en.EmptyInputValue]);function nP(e){let t=new Set(ea(e).reduce((e,t)=>e.concat(t.involvedNodes),[]));for(let n of I(e).layers)for(let e of n)if(t.has(e.id))return e.id}var nD=n(7426);function nL(e){return e?.id}function nM(e){return e.executionState}let nO="The following errors were found in the Loop configuration:",nB="The following errors were found while running the Loop:";function nF(e){return`- ${e.error} (Nodes ${e.involvedNodes.join(", ")})`}function n$(e){return`- ${e.error} (Node ${e.nodeId})`}async function nU(){return new Promise(e=>setTimeout(e,10))}function nz(e){let t=e.messages.toReversed().filter(e=>"user"===e.role).slice(0,2);return!(t.length<2)&&(t.every(e=>e.content?.startsWith(nO))||t.every(e=>e.content?.startsWith(nB)))}function nV(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function nW(e,t){var n=nV(e,t,"get");return n.get?n.get.call(e):n.value}function nH(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function nq(e,t,n){var a=nV(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,a,n),n}var nG=new WeakMap,nK=new WeakMap,nQ=new WeakMap;let NodeRunner=class NodeRunner{async run(e){switch(nW(this,nG).type){case"prompt":{let t=await w(nW(this,nG));return nW(this,nQ).getChatCompletion(t,nW(this,nG).model,void 0,e)}case"github-graphql":{let t=await nW(this,nK).getGraphQLResponse(nW(this,nG).content,e);return t?.data??null}default:return nW(this,nG).content}}constructor(e,t,n){nH(this,nG,{writable:!0,value:void 0}),nH(this,nK,{writable:!0,value:void 0}),nH(this,nQ,{writable:!0,value:void 0}),nq(this,nG,e),nq(this,nK,t),nq(this,nQ,n)}};function nJ(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function nZ(e,t){var n=nJ(e,t,"get");return n.get?n.get.call(e):n.value}function nX(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function nY(e,t,n){var a=nJ(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,a,n),n}var n0=new WeakMap,n1=new WeakMap,n2=new WeakMap,n5=new WeakMap,n3=new WeakMap,n4=new WeakMap,n6=new WeakMap,n7=new WeakMap;let PipelineRunner=class PipelineRunner{async run(e){let t=E(nZ(this,n5));if(0===t.length)throw Error("No output node");await Promise.all(t.map(t=>this.runNodeUnlessRunning(t,e)))}stop(e){nZ(this,n7).abort(),e({type:"CANCEL_EXECUTION",iteration:nZ(this,n3)})}isCancelled(){return nZ(this,n7).signal.aborted}async runNodeUnlessRunning(e,t){let n=nZ(this,n6).get(e.id);if(n)return n;let a=this.runNode(e,t);return nZ(this,n6).set(e.id,a),a}async runNode(e,t){if(this.isCancelled())return null;let n=await nZ(this,n0).getExecutionState(nZ(this,n5).id,nZ(this,n3)),a=n?.nodes[e.id]?.value;if(a)return a;t({type:"SET_PENDING",nodeId:e.id,pending:!0,iteration:nZ(this,n3)});let i=[...new Set(nZ(this,n4).edges.filter(t=>t.to===e.id).map(e=>e.from))].map(e=>nZ(this,n5).nodes.find(t=>t.id===e)).filter(e=>!!e),r=await Promise.all(i.map(async e=>[e.id,await this.runNodeUnlessRunning(e,t)]));if(r.some(([e,t])=>null===t)||this.isCancelled())return null;let s=Object.fromEntries(r);try{let n=C(e,s),a=new NodeRunner(n,nZ(this,n1),nZ(this,n2));t({type:"SET_PENDING",nodeId:e.id,pending:!1,iteration:nZ(this,n3)}),t({type:"SET_RUNNING",nodeId:e.id,running:!0,iteration:nZ(this,n3)});let i=await a.run(nZ(this,n7).signal);return this.isCancelled()||(t({type:"UPDATE_NODE_VALUE",pipelineId:nZ(this,n5).id,nodeId:e.id,value:i,iteration:nZ(this,n3)}),t({type:"SET_RUNNING",nodeId:e.id,running:!1,iteration:nZ(this,n3)})),i}catch(n){return this.isCancelled()||t({type:"UPDATE_NODE_ERROR",pipelineId:nZ(this,n5).id,nodeId:e.id,error:n instanceof Error?n.message:"string"==typeof n?n:"object"==typeof n?JSON.stringify(n):"",iteration:nZ(this,n3)}),null}}constructor(e,t,n,a,i){nX(this,n0,{writable:!0,value:void 0}),nX(this,n1,{writable:!0,value:void 0}),nX(this,n2,{writable:!0,value:void 0}),nX(this,n5,{writable:!0,value:void 0}),nX(this,n3,{writable:!0,value:void 0}),nX(this,n4,{writable:!0,value:void 0}),nX(this,n6,{writable:!0,value:void 0}),nX(this,n7,{writable:!0,value:void 0}),nY(this,n0,n),nY(this,n1,a),nY(this,n2,i),nY(this,n5,e),nY(this,n3,t),nY(this,n4,I(e)),nY(this,n6,new Map),nY(this,n7,new AbortController)}};function n8(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function n9(e,t){var n=n8(e,t,"get");return n.get?n.get.call(e):n.value}function ae(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function at(e,t,n){var a=n8(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,a,n),n}var an=new WeakMap,aa=new WeakMap,ai=new WeakMap,ar=new WeakMap;let PipesService=class PipesService{async getGraphQLResponse(e){return n9(this,aa).getGraphQLResponse(e)}async getAllPipelineRecords(){return n9(this,an).getAllPipelineRecords()}async getAllPipelines(){let e=await n9(this,an).getAllPipelineRecords();return e?e.reduce((e,t)=>(t.pipeline&&e.push(t.pipeline),e),[]).sort((e,t)=>{var n,a;return n=t.updatedAt,a=e.updatedAt,new Date(n).getTime()-new Date(a).getTime()}):[]}async getPipeline(e){return n9(this,an).getPipeline(e)}async createPipelineRecord(e){return n9(this,an).createPipelineRecord(e)}async updatePipelineRecord(e,t){return n9(this,an).updatePipelineRecord(e,n=>({...n,...t,loopID:e}))}async resetPipeline(e){return n9(this,an).updatePipelineRecord(e,t=>{if(!t.pipeline)throw Error(`Cannot undo: Pipeline with ID ${e} has no saved pipeline`);return{...t,draftPipeline:t.pipeline,loopID:e}})}async savePipeline(e){return n9(this,an).updatePipelineRecord(e,t=>{if(!t.draftPipeline)throw Error(`Cannot save: Pipeline with ID ${e} has no draft pipeline`);return{...t,pipeline:t.draftPipeline,loopID:e}})}async deletePipeline(e){return n9(this,an).deletePipeline(e)}async getExecutionState(e,t){return n9(this,an).getExecutionState(e,t)}async updateExecutionState(e,t,n){return n9(this,an).updateExecutionState(e,t,n)}async runPipeline(e,t,n){if(ea(e).length>0)return;let a=new PipelineRunner(e,t,n9(this,an),n9(this,aa),n9(this,ai)),i=this.createRunnerKey(e.id,t);n9(this,ar).set(i,a);try{return await a.run(n)}finally{n9(this,ar).delete(i)}}stopPipeline(e,t,n){let a=this.createRunnerKey(e,t),i=n9(this,ar).get(a);i&&(i.stop(n),n9(this,ar).delete(a))}createRunnerKey(e,t){return`${e}:${t}`}constructor(e,t,n){ae(this,an,{writable:!0,value:void 0}),ae(this,aa,{writable:!0,value:void 0}),ae(this,ai,{writable:!0,value:void 0}),ae(this,ar,{writable:!0,value:new Map}),at(this,an,e),at(this,aa,t),at(this,ai,n)}};function as(e){return e.id===e7&&"service"in e&&e.service instanceof PipesService}var ao=n(2640);function al(){let e,t;let n=(0,l.c)(5),a=(0,q.zy)(),i=(0,q.Zp)(),r=Q(),s=(0,c.useRef)(!0);return n[0]!==a.search||n[1]!==i||n[2]!==r?(e=()=>{s.current&&(s.current=!1,async function(){let e=`${e6.Jz}/loops`;try{let t=new URLSearchParams(a.search).get("data");if(!t){i(e);return}let n=function(e){try{let t=decodeURIComponent(atob(e)),n=JSON.parse(t);if(!n.title||!n.nodes)return null;return n}catch{return null}}(t);if(!n){i(e);return}let s={id:crypto.randomUUID(),title:n.title??"Shared Loop",description:n.description||"",nodes:n.nodes||[],updatedAt:new Date().toISOString()};await r.createPipelineRecord({draftPipeline:s,loopID:s.id,pipeline:null,threadID:null}),(0,g.BI)("dotcom_chat.activate",{target:"LOOP_IMPORT_SHARED",mode:"loops"}),i(`${e6.Jz}/l/${s.id}`)}catch{i(e)}}())},t=[a.search,i,r],n[0]=a.search,n[1]=i,n[2]=r,n[3]=e,n[4]=t):(e=n[3],t=n[4]),(0,c.useEffect)(e,t),null}try{al.displayName||(al.displayName="SharedLoopImporter")}catch{}function ac(e){let t,n,a,i,r,s;let c=(0,l.c)(20),{chatState:d,plugin:u}=e;if(!as(u))throw Error("PipesPreviewArea can only be used with a PipesPlugin");let{loopID:m}=(0,q.g)(),p=(0,nD.b)(),{currentReferences:h}=d,g=u.service;c[0]!==d||c[1]!==p?(t=p.getSelectedThread(d),c[0]=d,c[1]=p,c[2]=t):t=c[2];let f=t;c[3]===Symbol.for("react.memo_cache_sentinel")?(n=[],c[3]=n):n=c[3],(0,O.N)(ad,n),c[4]!==h||c[5]!==m||c[6]!==g||c[7]!==p||c[8]!==f?(a=async e=>{if(!m)return;let t=e.trim();if(""===t)return;let n=h,a=await g.getPipeline(m);a?.pipeline&&(n=[...n,{type:e9,...a.pipeline}]),p.sendChatMessage({thread:f,content:t,modeOverride:e8,references:n})},c[4]=h,c[5]=m,c[6]=g,c[7]=p,c[8]=f,c[9]=a):a=c[9];let y=a;return c[10]!==d?(i=(0,o.jsx)($,{children:(0,o.jsx)(au,{chatState:d})}),c[10]=d,c[11]=i):i=c[11],c[12]!==u.service||c[13]!==i?(r=(0,o.jsx)(K,{value:u.service,children:i}),c[12]=u.service,c[13]=i,c[14]=r):r=c[14],c[15]!==d.availableModels||c[16]!==u.previewUrl||c[17]!==y||c[18]!==r?(s=(0,o.jsx)(tR,{availableModels:d.availableModels,previewUrl:u.previewUrl,sendChatMessage:y,children:r}),c[15]=d.availableModels,c[16]=u.previewUrl,c[17]=y,c[18]=r,c[19]=s):s=c[19],s}function ad(){let e=document.querySelector("header.AppHeader");return e&&(e.style.display="none"),()=>{e&&(e.style.display="")}}function au(e){let t,n,a;let i=(0,l.c)(6),{chatState:r}=e;(function(e){let t,n,a;let i=(0,l.c)(18),{data:r}=Y(),s=(0,nD.b)();i[0]!==e||i[1]!==s?(t=s.getSelectedThread(e),i[0]=e,i[1]=s,i[2]=t):t=i[2];let o=t,{threads:d,threadsLoading:u}=e,m=!!r;i[3]!==r||i[4]!==m||i[5]!==s||i[6]!==o?.id||i[7]!==d||i[8]!==u.state?(n=()=>{(async()=>{if("pending"===u.state){s.fetchThreads();return}if(!m||"loaded"!==u.state)return;let e=r.threadID;if(e&&o?.id!==e){let t=d.get(e);t&&await s.selectThread(t,{includeThreads:!1})}})()},i[3]=r,i[4]=m,i[5]=s,i[6]=o?.id,i[7]=d,i[8]=u.state,i[9]=n):n=i[9];let p=r?.threadID,h=o?.id;i[10]!==r||i[11]!==m||i[12]!==s||i[13]!==p||i[14]!==h||i[15]!==d||i[16]!==u?(a=[m,p,s,h,d,u,r],i[10]=r,i[11]=m,i[12]=s,i[13]=p,i[14]=h,i[15]=d,i[16]=u,i[17]=a):a=i[17],(0,c.useEffect)(n,a)})(r),function(e){let{data:t}=Y(),n=V(),a=Q(),i=function(e,t){let{loopID:n}=(0,q.g)(),{pipeline:a,messageId:i}=nA(e,t)??{};return(0,c.useMemo)(()=>n&&a?{...a,id:n}:a,[i,n])}(e.selectedThreadID,e.messages),r=z(),{sendChatMessage:s}=tP(),{updateLoop:o}=eI(),l=(0,c.useRef)(null);(0,c.useEffect)(()=>{let c=!1,d=async e=>{!c&&e&&n({type:"RESTORE_EXECUTION_STATE",executionState:e})},u=async(t,i,o)=>{if(await nU(),c)return;if(o.length>0&&o.every(e=>nR.has(e.errorType))){let e=nP(t);e&&n({type:"FOCUS_NODE",nodeId:e});return}if(o.length>0&&(!nz(e)||!i)){s(`${nO}

${o.map(nF)}

Fix the Loop by modifying its nodes to resolve these errors.`);return}let l=Object.keys(r().executionState.nodes);if(n({type:"CLEAR_NODE_RESULTS",pipelineId:t.id,nodeIds:l}),await nU(),c)return;let d=r().executionState.iteration;if(await a.runPipeline(t,d,n),c||(await nU(),c))return;let u=Object.entries(r().executionState.nodes).filter(([e,t])=>!!t.error).map(([e,t])=>({nodeId:e,error:t.error}));if(!(u.length>0)||nz(e)&&i){let e=o.reduce((e,t)=>e.concat(t.involvedNodes),[]);if(e.length>0){let[t]=e;n({type:"FOCUS_NODE",nodeId:t??null})}else{let[e]=E(t);e&&n({type:"FOCUS_NODE",nodeId:e.id})}}else{s(`${nB}

${u.map(n$)}

Fix the Loop by modifying its nodes to resolve these errors.`);return}};return(async()=>{let e=t?.pipeline,r=!e||J(e);if(!i&&!e)return;let s=new Date(e?.updatedAt??0)>=new Date(i?.updatedAt??0)?e:i;if(!s)return;let m=await a.getExecutionState(s.id);if(c)return;let p=s===i,h=p||!i&&!m;if(l.current===s)return;l.current=s,p&&o(s);let g=ea(s);if(h)u(s,h&&!r,g);else{d(m);let e=nP(s);e&&n({type:"FOCUS_NODE",nodeId:e})}})(),()=>{c=!0}},[i,n,a])}(r),function(e){let t,n;let a=(0,l.c)(5),{data:i}=Y(),{mutate:r}=eC(),s=i?.threadID,o=e??s??null;a[0]!==i||a[1]!==o||a[2]!==r?(t=()=>{let e=i?.pipeline;!e||J(e)||i.threadID===o||r({...i,threadID:o})},n=[i,r,o],a[0]=i,a[1]=o,a[2]=r,a[3]=t,a[4]=n):(t=a[3],n=a[4]),(0,c.useEffect)(t,n)}(r.selectedThreadID),function(){let e,t;let n=(0,l.c)(5),a=Q(),i=U(nM),r=et(nL);n[0]!==i||n[1]!==r||n[2]!==a?(e=()=>{r&&a.updateExecutionState(r,i.iteration,i)},t=[r,i,a],n[0]=i,n[1]=r,n[2]=a,n[3]=e,n[4]=t):(e=n[3],t=n[4]),(0,c.useEffect)(e,t)}();let s=ee(),d=(0,q.zy)(),u=ta.test(d.pathname);i[0]!==s?(t=()=>{let e=s?.title?`${s.title} \xb7 Loops \xb7 GitHub Copilot`:"Loops \xb7 GitHub Copilot";(0,ao.D)(e)},i[0]=s,i[1]=t):t=i[1];let m=s?.title;if(i[2]!==m?(n=[m],i[2]=m,i[3]=n):n=i[3],(0,c.useEffect)(t,n),u){let e;return i[4]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)(al,{}),i[4]=e):e=i[4],e}return i[5]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)("div",{className:nT.container,children:(0,o.jsx)(nI,{})}),i[5]=a):a=i[5],a}try{ac.displayName||(ac.displayName="PipesPreviewArea")}catch{}try{au.displayName||(au.displayName="PipesPreview")}catch{}var am=n(2497),ap=n(47584);function ah(e){let t,n;let a=(0,l.c)(4),{onLinkClick:i}=e;a[0]!==i?(t=(e,t)=>{i?.(e,t)},a[0]=i,a[1]=t):t=a[1];let r=t;return a[2]!==r?(n=(0,o.jsx)(am.Vx,{"aria-current":ap.fV.pathname===te?"page":void 0,displayName:"Loops",href:te,icon:nC.LP,id:e7,onLinkClick:r}),a[2]=r,a[3]=n):n=a[3],n}try{ah.displayName||(ah.displayName="PipesNavigation")}catch{}function ag(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function af(e){return!!e&&"object"==typeof e&&"loopID"in e&&"string"==typeof e.loopID}function ay(e){return!!e&&"object"==typeof e&&"pipelineId"in e&&"string"==typeof e.pipelineId&&"iteration"in e&&"number"==typeof e.iteration&&"executionState"in e&&"object"==typeof e.executionState}let IndexedDBPipesStorage=class IndexedDBPipesStorage{async getAllPipelineRecords(){return this.withTransaction(IndexedDBPipesStorage.PIPELINES_STORE,"readonly",e=>e.getAll(),e=>Array.isArray(e)?e.filter(e=>af(e)?e.pipeline:null):[])}async getPipeline(e){return this.withTransaction(IndexedDBPipesStorage.PIPELINES_STORE,"readonly",t=>t.get(e),e=>af(e)?e:null)}createPipelineRecord(e){let t=new Date().toISOString(),n=e.pipeline?{...e.pipeline,updatedAt:t}:e.pipeline,a={...e,pipeline:n};return this.withTransaction(IndexedDBPipesStorage.PIPELINES_STORE,"readwrite",e=>e.put(a),()=>a)}async updatePipelineRecord(e,t){let n=await this.getDatabase();return new Promise((a,i)=>{let r=n.transaction(IndexedDBPipesStorage.PIPELINES_STORE,"readwrite");r.oncomplete=()=>n.close(),r.onerror=()=>i(r.error);let s=r.objectStore(IndexedDBPipesStorage.PIPELINES_STORE),o=s.get(e);o.onerror=()=>i(o.error),o.onsuccess=()=>{let n=o.result;if(!af(n)){i(Error(`Pipeline with ID ${e} not found`));return}try{let e=t(n),r=new Date().toISOString(),o=e.draftPipeline?{...e.draftPipeline,updatedAt:r}:e.draftPipeline,l={...e,draftPipeline:o},c=s.put(l);c.onerror=()=>i(c.error),c.onsuccess=()=>a(l)}catch(e){i(e)}}})}deletePipeline(e){return this.withTransaction(IndexedDBPipesStorage.PIPELINES_STORE,"readwrite",t=>t.delete(e),()=>e)}getExecutionState(e,t){return void 0!==t?this.withTransaction(IndexedDBPipesStorage.EXECUTION_STORE,"readonly",n=>n.get([e,t]),e=>ay(e)?e.executionState:null):this.withTransaction(IndexedDBPipesStorage.EXECUTION_STORE,"readonly",t=>t.index("pipelineId").getAll(e),e=>{if(!Array.isArray(e))return null;let t=e.filter(ay);if(0===t.length)return null;let n=Math.max(...t.map(e=>e.iteration));return t.find(e=>e.iteration===n)?.executionState??null})}updateExecutionState(e,t,n){return this.withTransaction(IndexedDBPipesStorage.EXECUTION_STORE,"readwrite",a=>a.put({pipelineId:e,iteration:t,executionState:n}),()=>n)}async withTransaction(e,t,n,a){let i=await this.getDatabase();return new Promise((r,s)=>{let o=i.transaction(e,t);o.oncomplete=()=>i.close(),o.onerror=()=>s(o.error);let l=n(o.objectStore(e));l.onsuccess=()=>r(a(l.result)),l.onerror=()=>s(l.error)})}getDatabase(){return new Promise((e,t)=>{let n=indexedDB.open(IndexedDBPipesStorage.PIPES_DB,IndexedDBPipesStorage.CURRENT_VERSION);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=async e=>{try{await IndexedDBPipesStorage.handleDatabaseUpgrade(n.result,e)}catch(e){t(e)}}})}static async handleDatabaseUpgrade(e,t){let n=t.oldVersion;if(0===n){await IndexedDBPipesStorage.upgradeFromVersion0(e);return}n<2&&await IndexedDBPipesStorage.upgradeFromVersion1(t),n<3&&await IndexedDBPipesStorage.upgradeFromVersion2(t),n<4&&await IndexedDBPipesStorage.upgradeFromVersion3(t)}static upgradeFromVersion0(e){return new Promise((t,n)=>{try{e.createObjectStore(IndexedDBPipesStorage.PIPELINES_STORE,{keyPath:"loopID"}).createIndex("loopID","loopID",{unique:!0});let n=e.createObjectStore(IndexedDBPipesStorage.EXECUTION_STORE,{keyPath:["pipelineId","iteration"]});n.createIndex("pipelineId, iteration",["pipelineId","iteration"],{unique:!0}),n.createIndex("pipelineId","pipelineId",{unique:!1}),t()}catch(e){n(e)}})}static async waitForAllAndResolve(e,t,n){try{await Promise.all(e),t()}catch(e){n(e)}}static upgradeFromVersion1(e){return new Promise((t,n)=>{if(!e.target)return t();let a=e.target.transaction;if(!a)return t();let i=a.objectStore(IndexedDBPipesStorage.PIPELINES_STORE).openCursor(),r=[];i.onsuccess=function(e){let a=e.target?.result;if(a)try{let e=a.value;e.pipeline&&(e.pipeline.updatedAt=new Date().toISOString());let t=new Promise((t,n)=>{let i=a.update(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)});r.push(t),a.continue()}catch(e){n(e)}else IndexedDBPipesStorage.waitForAllAndResolve(r,t,n)},i.onerror=function(){n(i.error)}})}static upgradeFromVersion2(e){return new Promise((t,n)=>{if(!e.target)return t();let a=e.target.transaction;if(!a)return t();let i=[],r=a.objectStore(IndexedDBPipesStorage.PIPELINES_STORE).openCursor();r.onsuccess=function(e){let r=e.target?.result;if(r){let e=r.value;e?.pipeline&&!e.pipeline.updatedAt&&(e.pipeline.updatedAt=new Date().toISOString()),i.push(e),r.continue()}else try{a.db.deleteObjectStore(IndexedDBPipesStorage.PIPELINES_STORE);let e=a.db.createObjectStore(IndexedDBPipesStorage.PIPELINES_STORE,{keyPath:"loopID"});e.createIndex("loopID","loopID",{unique:!0});let r=i.map(e=>({loopID:e.pipeline.id,threadID:e.threadID,pipeline:e.pipeline}));if(0===r.length){t();return}let s=[];for(let t of r){let n=new Promise((n,a)=>{let i=e.put(t);i.onsuccess=()=>n(),i.onerror=()=>a(i.error)});s.push(n)}IndexedDBPipesStorage.waitForAllAndResolve(s,t,n)}catch(e){n(e)}},r.onerror=function(){n(r.error)}})}static upgradeFromVersion3(e){return new Promise((t,n)=>{if(!e.target)return t();let a=e.target.transaction;if(!a)return t();let i=a.objectStore(IndexedDBPipesStorage.PIPELINES_STORE).openCursor(),r=[];i.onsuccess=function(e){let a=e.target?.result;if(a)try{let e=a.value;if(e.pipeline&&!e.draftPipeline){e.draftPipeline={...e.pipeline};let t=new Promise((t,n)=>{let i=a.update(e);i.onsuccess=()=>t(),i.onerror=e=>n(e)});r.push(t)}a.continue()}catch(e){n(e)}else IndexedDBPipesStorage.waitForAllAndResolve(r,t,n)},i.onerror=function(){n(i.error)}})}};ag(IndexedDBPipesStorage,"PIPES_DB","copilot-pipes"),ag(IndexedDBPipesStorage,"PIPELINES_STORE","pipelines"),ag(IndexedDBPipesStorage,"EXECUTION_STORE","executionStates"),ag(IndexedDBPipesStorage,"CURRENT_VERSION",4);var ax=n(49339);async function av(e,t,n){let a=new TextDecoder,i=e.getReader(),r="";for(;;){if(t?.aborted)return;let{done:e,value:n}=await i.read();if(e)return;if((r+=a.decode(n)).endsWith("\n\ndata: [DONE]\n\n")){var s;return r.replace("data: ","").replace("\n\ndata: [DONE]\n\n","").split("\n\ndata: ").map(e=>{try{let t=JSON.parse(e).choices[0];return t?.delta?.content??""}catch(e){}}).join("")}}}function a_(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function ab(e,t){var n=a_(e,t,"get");return n.get?n.get.call(e):n.value}function aj(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function aC(e,t,n){var a=a_(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,a,n),n}var aN=new WeakMap,aw=new WeakMap,aI=new WeakMap;let ChatCompletionsClient=class ChatCompletionsClient{async getChatCompletion(e,t,n,a){let i=(0,tL.wv)(),r=t??i.id,s=await ab(this,aN).getAuthToken(),o=await (0,e6.p)({basePath:ab(this,aw),body:{messages:e,model:r,stream:!0},path:"/chat/completions",method:"POST",streamingResponse:!0,authToken:s,integrationId:this.directConnectConfiguration.integrationID,realIp:ab(this,aI),signal:a});if(!o.ok){let e=await o.response?.text()??"Unknown error",t=e;try{let n=JSON.parse(e);t=n.error?.message||o.error}catch(e){}throw(0,g.BI)("dotcom_chat.error",{type:"execution",nodeType:"prompt",mode:"pipes",errorMessage:t}),Error(`Failed to get chat completion: ${t}`)}return a?.aborted||!o.body?"":await av(o.body,a,n)??""}get directConnectConfiguration(){return{integrationID:"copilot-chat"}}constructor(e,t,n=""){aj(this,aN,{writable:!0,value:void 0}),aj(this,aw,{writable:!0,value:void 0}),aj(this,aI,{writable:!0,value:void 0}),aC(this,aw,e),aC(this,aN,new ax.J(t)),aC(this,aI,n)}};var aS=n(57572);let ak=["SAML"],aT={FORBIDDEN:["SAML error"]};function aA(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var aE=new WeakMap;let GraphQLClient=class GraphQLClient{async getGraphQLResponse(e,t){var n;let a=await (0,aS.Sr)((n=aA(this,aE,"get")).get?n.get.call(this):n.value,{method:"POST",body:{query:e},signal:t});if(a.ok){let e=await a.json();if(function(e,t){var n;if("errors"in(e="errors"in(n=e)?{...n,errors:n.errors.filter(e=>!ak.includes(e.type)&&!aT[e.type]?.includes(e.message))}:n)&&e.errors.length){let t=e.errors.map(e=>`${e.message}${e.path?` (path: ${e.path})`:""}`).join(", ");throw(0,g.BI)("dotcom_chat.error",{type:"execution",nodeType:"graphql",mode:"pipes",errorMessage:t}),Error(t)}if(!("data"in e)){let n=`Expected data property in response: ${JSON.stringify(e)}. requestId: ${t}`;throw(0,g.BI)("dotcom_chat.error",{type:"execution",nodeType:"graphql",mode:"pipes",errorMessage:n}),Error("Failed to fetch data.")}return!0}(e,a.headers.get("X-Github-Request-Id")||""))return e}else throw Error("Failed to get GraphQL response.")}constructor(e){!function(e,t,n){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}(this,aE,{writable:!0,value:void 0}),function(e,t,n){var a=aA(e,t,"set");!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,a,n)}(this,aE,e)}};var aR=n(97891),aP=n(26443);let aD={header:"LoopsView-module__header--SAuoB",input:"LoopsView-module__input--vIdQn"};var aL=n(14987);let aM={header:"LoopsViewHeader-module__header--rHbds",rightControls:"LoopsViewHeader-module__rightControls--aKkbw"};function aO(){let e,t,n,a;let i=(0,l.c)(4),r=(0,c.useRef)(null),s=(0,c.useRef)(null);return i[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,o.jsx)(ex.W.Anchor,{children:(0,o.jsx)(m.K,{icon:p.KebabHorizontalIcon,"aria-label":"Menu",onClick:aF})}),i[0]=e):e=i[0],i[1]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{r.current?.openDialog(),(0,g.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_GIVE_FEEDBACK",mode:"immersive"})},i[1]=t):t=i[1],i[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsxs)(ey.l.Item,{onSelect:t,children:["Give feedback",(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.CommentIcon,{})})]}),i[2]=n):n=i[2],i[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)("div",{className:aM.header,children:(0,o.jsxs)("div",{className:aM.rightControls,children:[(0,o.jsxs)(ex.W,{anchorRef:s,children:[e,(0,o.jsx)(ex.W.Overlay,{width:"small",children:(0,o.jsx)(ey.l,{children:(0,o.jsxs)(ey.l.Group,{children:[n,(0,o.jsxs)(ey.l.LinkItem,{href:"/settings/copilot",onClick:aB,children:[(0,o.jsx)(ey.l.LeadingVisual,{children:(0,o.jsx)(p.GearIcon,{})}),"Settings"]})]})})})]}),(0,o.jsx)(aL.l,{ref:r,mode:"immersive",returnFocusRef:s})]})}),i[3]=a):a=i[3],a}function aB(){return(0,g.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU_SETTINGS",mode:"immersive"})}function aF(){return(0,g.BI)("dotcom_chat.activate",{target:"META_CONTEXT_MENU",mode:"immersive"})}try{aO.displayName||(aO.displayName="LoopsViewHeader")}catch{}let a$=[{altText:"GitHub Battle Royale report",assetPath:"/images/modules/loops/BattleRoyal.png",loop:{title:"GitHub Battle Royale",description:"Compare two GitHub users based on their pull request contributions and metrics",nodes:[{id:"1",type:"text",title:"Start Date",description:"The date 6 months ago from which to fetch data",content:"2024-11-06",inputType:{type:"text"}},{id:"5",type:"text",title:"First Username",description:"GitHub username for the first contestant",content:"jonrohan",inputType:{type:"text"}},{id:"6",type:"text",title:"Second Username",description:"GitHub username for the second contestant",content:"colebemis",inputType:{type:"text"}},{id:"7",type:"text",title:"Repository",description:"The repository to analyze (in owner/name format)",content:"primer/react",inputType:{type:"text"}},{id:"2",type:"github-graphql",title:"First User PRs",description:"Fetch PRs for the first user",content:'query {\n  search(query: "repo:{{7}} author:{{5}} is:pr created:>={{1}}", type: ISSUE, first: 100) {\n    edges {\n      node {\n        ... on PullRequest {\n          title\n          merged\n          closed\n          createdAt\n          mergedAt\n          additions\n          deletions\n          commits {\n            totalCount\n          }\n          repository {\n            nameWithOwner\n          }\n        }\n      }\n    }\n  }\n}'},{id:"3",type:"github-graphql",title:"Second User PRs",description:"Fetch PRs for the second user",content:'query {\n  search(query: "repo:{{7}} author:{{6}} is:pr created:>={{1}}", type: ISSUE, first: 100) {\n    edges {\n      node {\n        ... on PullRequest {\n          title\n          merged\n          closed\n          createdAt\n          mergedAt\n          additions\n          deletions\n          commits {\n            totalCount\n          }\n          repository {\n            nameWithOwner\n          }\n        }\n      }\n    }\n  }\n}'},{id:"4",type:"prompt",title:"Battle Analysis",description:"Compare the two users and determine a winner",content:"You're a GitHub Battle Royale announcer. Compare the following metrics between these two contestants based on their pull request data:\n\n# Battle Royal \u{1F934}\u{1F5E1}\uFE0F\u{1F478}\n\n1. Total PRs created\n2. PR merge rate\n3. Lines of code changed (additions + deletions)\n4. Average commits per PR\n5. PR velocity (PRs per month)\n\nUser 1 ({{5}}) data: {{2}}\nUser 2 ({{6}}) data: {{3}}\n\nAnalyze each metric and assign points (1-10) for each category. Then declare an overall winner with a dramatic announcement. Format your response as an exciting battle commentary."}]}},{altText:"Battle Royale report",assetPath:"/images/modules/loops/FirstResponder.png",loop:{title:"First Responder Activity Report",description:"Generates a summary of a first responder's activity including new issues, PR reviews, and issue involvement from the past week",nodes:[{id:"1",type:"text",title:"First Responder Username",description:"GitHub username of the first responder",content:"",inputType:{type:"text"}},{id:"2",type:"text",title:"Start Date",description:"Start date for the report (1 week ago)",content:"2025-05-02",inputType:{type:"text"}},{id:"repo",type:"text",title:"Repository",description:"The full repository name (e.g. owner/repo)",content:"primer/react",inputType:{type:"text"}},{id:"3",type:"github-graphql",title:"Created Issues",description:"Issues created by the user in the past week",content:'query {\n  search(query: "repo:{{repo}} author:{{1}} is:issue created:>{{2}}", type: ISSUE, first: 100) {\n    edges {\n      node {\n        ... on Issue {\n          title\n          url\n          createdAt\n          state\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}'},{id:"4",type:"github-graphql",title:"PR Reviews",description:"PR reviews submitted by the user in the past week",content:'query {\n  search(query: "repo:{{repo}} is:pr reviewed-by:{{1}} updated:>{{2}}", type: ISSUE, first: 100) {\n    edges {\n      node {\n        ... on PullRequest {\n          title\n          url\n          reviews(first: 5, author: "{{1}}") {\n            edges {\n              node {\n                state\n                submittedAt\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}'},{id:"involved_issues",type:"github-graphql",title:"Involved Issues",description:"Issues where the user was involved (commented or assigned) in the past week",content:'query {\n  search(query: "repo:{{repo}} involves:{{1}} is:issue updated:>{{2}}", type: ISSUE, first: 100) {\n    edges {\n      node {\n        ... on Issue {\n          title\n          url\n          updatedAt\n          state\n          comments(last: 5) {\n            nodes {\n              author {\n                login\n              }\n              createdAt\n            }\n          }\n          assignees(first: 5) {\n            nodes {\n              login\n            }\n          }\n        }\n      }\n    }\n  }\n}'},{id:"5",type:"prompt",title:"Activity Summary",description:"Summary report of the first responder's activity",content:"Generate a comprehensive summary report of the first responder's ({{1}}) activity in the {{repo}} repository over the past week. Include their issue creation, PR review activities, and issue involvement.\n\nIssues Created:\n{{3}}\n\nPR Reviews:\n{{4}}\n\nIssue Involvement:\n{{involved_issues}}\n\nPlease format the report with these sections:\n1. Overview (total numbers)\n2. Issue Activity\n   - Created Issues\n   - Issue Involvement (comments, assignments)\n3. PR Review Activity (highlight significant reviews)\n4. Key Observations\n\nKeep the tone professional and focus on what the next first responder needs to know about as they come in for the next shift."}]}},{altText:"GitHub repo feature announcement magazine",assetPath:"/images/modules/loops/NewsFlash.png",loop:{title:"Multi-Repo GitHub Feature Announcement Magazine",description:"Creates a tabloid-style frontpage focusing on new features and enhancements across multiple GitHub repositories",nodes:[{id:"repo1",type:"text",title:"Repository 1",description:"First repository to analyze (format: owner/repo)",content:"facebook/react",inputType:{type:"text"}},{id:"repo2",type:"text",title:"Repository 2",description:"Second repository to analyze (format: owner/repo)",content:"microsoft/vscode",inputType:{type:"text"}},{id:"repo3",type:"text",title:"Repository 3",description:"Third repository to analyze (format: owner/repo)",content:"primer/react",inputType:{type:"text"}},{id:"days",type:"text",title:"Days Limit",description:"Number of days to look back for data",content:"30",inputType:{type:"text"}},{id:"date_limit",type:"prompt",title:"Calculate Date Limit",description:"Calculate the date limit based on the number of days",content:"Calculate the date {{days}} days ago from today in YYYY-MM-DD format."},{id:"3",type:"github-graphql",title:"Feature PRs - Repository 1",description:"Fetch recent feature/enhancement pull requests from the first repository",content:'query {\n  search(query: "repo:{{repo1}} is:pr created:>={{date_limit}} sort:updated-desc", type: ISSUE, first: 10) {\n    edges {\n      node {\n        ... on PullRequest {\n          title\n          url\n          author {\n            login\n          }\n          createdAt\n          additions\n          deletions\n          changedFiles\n          body\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n          reviews(first: 3) {\n            nodes {\n              author {\n                login\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}'},{id:"4",type:"github-graphql",title:"Feature PRs - Repository 2",description:"Fetch recent feature/enhancement pull requests from the second repository",content:'query {\n  search(query: "repo:{{repo2}} is:pr created:>={{date_limit}} sort:updated-desc", type: ISSUE, first: 10) {\n    edges {\n      node {\n        ... on PullRequest {\n          title\n          url\n          author {\n            login\n          }\n          createdAt\n          additions\n          deletions\n          changedFiles\n          body\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n          reviews(first: 3) {\n            nodes {\n              author {\n                login\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}'},{id:"5",type:"github-graphql",title:"Feature PRs - Repository 3",description:"Fetch recent feature/enhancement pull requests from the third repository",content:'query {\n  search(query: "repo:{{repo3}} is:pr created:>={{date_limit}} sort:updated-desc", type: ISSUE, first: 10) {\n    edges {\n      node {\n        ... on PullRequest {\n          title\n          url\n          author {\n            login\n          }\n          createdAt\n          additions\n          deletions\n          changedFiles\n          body\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n          reviews(first: 3) {\n            nodes {\n              author {\n                login\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}'},{id:"6",type:"github-graphql",title:"Feature Requests - Repository 1",description:"Fetch recent feature request issues from the first repository",content:'query {\n  search(query: "repo:{{repo1}} is:issue label:\\"Type: Feature Request\\" created:>={{date_limit}} sort:updated-desc", type: ISSUE, first: 10) {\n    edges {\n      node {\n        ... on Issue {\n          title\n          url\n          author {\n            login\n          }\n          createdAt\n          body\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n          comments {\n            totalCount\n          }\n        }\n      }\n    }\n  }\n}'},{id:"7",type:"github-graphql",title:"Feature Requests - Repository 2",description:"Fetch recent feature request issues from the second repository",content:'query {\n  search(query: "repo:{{repo2}} is:issue label:enhancement,feature-request created:>={{date_limit}} sort:updated-desc", type: ISSUE, first: 10) {\n    edges {\n      node {\n        ... on Issue {\n          title\n          url\n          author {\n            login\n          }\n          createdAt\n          body\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n          comments {\n            totalCount\n          }\n        }\n      }\n    }\n  }\n}'},{id:"8",type:"github-graphql",title:"Feature Requests - Repository 3",description:"Fetch recent feature request issues from the third repository",content:'query {\n  search(query: "repo:{{repo3}} is:issue label:enhancement,feature-request created:>={{date_limit}} sort:updated-desc", type: ISSUE, first: 10) {\n    edges {\n      node {\n        ... on Issue {\n          title\n          url\n          author {\n            login\n          }\n          createdAt\n          body\n          labels(first: 5) {\n            edges {\n              node {\n                name\n              }\n            }\n          }\n          comments {\n            totalCount\n          }\n        }\n      }\n    }\n  }\n}'},{id:"9",type:"text",title:"Magazine Style",description:"Define the style of the feature announcement magazine",content:"\u2728\u{1F4AB} \u{1F31F} OPEN SOURCE NEWS FLASH \u{1F31F} \u{1F4AB} \u2728\n\u{1F680} BREAKING UPDATES \u{1F680} EXCLUSIVE FEATURES \u{1F3AF} HOT RELEASES \u{1F525}\n\nYour #1 source for hot new features in your favorite open source projects! \u{1F308}",inputType:{type:"text"}},{id:"10",type:"prompt",title:"Feature Magazine Content",description:"Generate tabloid-style headlines focusing on new features",content:"You are a tech magazine writer specializing in new feature announcements. Create an exciting frontpage covering the latest features and enhancements from these repositories: {{repo1}}, {{repo2}}, and {{repo3}}.\n\nUse this data for each repository:\nRepository 1:\n- PRs: {{3}}\n- Issues: {{6}}\n\nRepository 2:\n- PRs: {{4}}\n- Issues: {{7}}\n\nRepository 3:\n- PRs: {{5}}\n- Issues: {{8}}\n\nStart with this header:\n{{9}}\n\nFor each repository:\n1. Create a section with an appropriate emoji\n2. Include 2-3 exciting headlines about new features or requests\n3. Focus on user impact and benefits\n4. Include the original URLs as 'READ MORE' links\n5. Mention scope of changes for PRs (additions + deletions)\n\nEnd with a 'FEATURE FORECAST' section comparing the most exciting upcoming features across repositories.\n\nFormat everything in markdown and use emojis liberally."}]}}];var aU=n(72819);let az=["auburn","blue","brown","coral","cyan","gray","green","indigo","lemon","lime","olive","orange","pine","pink","plum","purple","red","teal","yellow"];function aV(e){let t,n,a,i,r,s,c,d;let u=(0,l.c)(22),{item:m,onClick:p}=e,h=m.id,g=`${e6.Jz}/l/${m.id}`;return u[0]!==m.title?(t=function(e,t){let n=function(e){let t=0;for(let n=0;n<e.length;n++)t=(31*t+e.charCodeAt(n))%0x3b9aca07;return t}(e)%t.length;return t[n]}(m.title,az),u[0]=m.title,u[1]=t):t=u[1],u[2]!==t?(n=(0,o.jsx)(aU.Z.Icon,{icon:"loops",color:t}),u[2]=t,u[3]=n):n=u[3],u[4]!==m.title?(a=(0,o.jsx)(aU.Z.Heading,{children:m.title}),u[4]=m.title,u[5]=a):a=u[5],u[6]!==m.description?(i=(0,o.jsx)(aU.Z.Description,{children:m.description}),u[6]=m.description,u[7]=i):i=u[7],u[8]===Symbol.for("react.memo_cache_sentinel")?(r=(0,o.jsx)(nC.GS,{}),u[8]=r):r=u[8],u[9]!==m.nodes.length?(s=(0,o.jsxs)(aU.Z.Metadata,{children:[r,m.nodes.length]}),u[9]=m.nodes.length,u[10]=s):s=u[10],u[11]!==m.id?(c=(0,o.jsx)(aU.Z.Menu,{children:(0,o.jsx)(e2,{loopId:m.id})}),u[11]=m.id,u[12]=c):c=u[12],u[13]!==m.id||u[14]!==p||u[15]!==g||u[16]!==n||u[17]!==a||u[18]!==i||u[19]!==s||u[20]!==c?(d=(0,o.jsxs)(aU.Z,{href:g,onClick:p,children:[n,a,i,s,c]},h),u[13]=m.id,u[14]=p,u[15]=g,u[16]=n,u[17]=a,u[18]=i,u[19]=s,u[20]=c,u[21]=d):d=u[21],d}try{aV.displayName||(aV.displayName="LoopCard")}catch{}function aW(e){let t,n,a,i,r,s,c;let d=(0,l.c)(20),{altText:u,assetPath:m,exampleLoop:p,onSelect:h}=e;d[0]!==p||d[1]!==h?(t=()=>{(0,g.BI)("dotcom_chat.activate",{target:"OVERVIEW_EXAMPLE_LOOP_SELECT",mode:"loops"}),h({...p,id:crypto.randomUUID(),updatedAt:new Date().toISOString()})},d[0]=p,d[1]=h,d[2]=t):t=d[2];let f=t;return d[3]!==u||d[4]!==m?(n=(0,o.jsx)(aU.Z.Image,{alt:u,img:m}),d[3]=u,d[4]=m,d[5]=n):n=d[5],d[6]!==p.title?(a=(0,o.jsx)(aU.Z.Heading,{children:p.title}),d[6]=p.title,d[7]=a):a=d[7],d[8]!==p.description?(i=(0,o.jsx)(aU.Z.Description,{children:p.description}),d[8]=p.description,d[9]=i):i=d[9],d[10]===Symbol.for("react.memo_cache_sentinel")?(r=(0,o.jsx)(nC.GS,{}),d[10]=r):r=d[10],d[11]!==p.nodes.length?(s=(0,o.jsxs)(aU.Z.Metadata,{children:[r,p.nodes.length]}),d[11]=p.nodes.length,d[12]=s):s=d[12],d[13]!==p.title||d[14]!==f||d[15]!==n||d[16]!==a||d[17]!==i||d[18]!==s?(c=(0,o.jsxs)(aU.Z,{onClick:f,children:[n,a,i,s]},p.title),d[13]=p.title,d[14]=f,d[15]=n,d[16]=a,d[17]=i,d[18]=s,d[19]=c):c=d[19],c}try{aW.displayName||(aW.displayName="LoopExampleCard")}catch{}function aH(e){let t,n;let a=(0,l.c)(3),{plugin:i}=e;if(!i||!as(i))throw Error("LoopsView can only be used with a PipesPlugin");return a[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,o.jsx)(aq,{}),a[0]=t):t=a[0],a[1]!==i.service?(n=(0,o.jsx)(K,{value:i.service,children:t}),a[1]=i.service,a[2]=n):n=a[2],n}function aq(){let e,t,n,a,i,r,s,d,u,m,p,h,f,y,x;let v=(0,l.c)(31),{data:_,isLoading:b}=function(){let e,t;let n=(0,l.c)(3),a=Q();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[e0],n[0]=e):e=n[0],n[1]!==a?(t={queryKey:e,queryFn:async()=>await a.getAllPipelines(),enabled:!0,refetchOnMount:!0},n[1]=a,n[2]=t):t=n[2],(0,H.I)(t)}(),j=(0,nD.b)(),C=(0,q.Zp)(),N=Q();v[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],v[0]=e):e=v[0],(0,c.useEffect)(aQ,e),v[1]!==j?(t=()=>{j.selectThread(null,{includeThreads:!1,clearTopic:!0})},n=[j],v[1]=j,v[2]=t,v[3]=n):(t=v[2],n=v[3]),(0,c.useEffect)(t,n),v[4]!==N||v[5]!==j||v[6]!==C?(a=async e=>{let t=e.trim();if(""===t)return;(0,g.BI)("dotcom_chat.activate",{target:"OVERVIEW_INITIAL_CREATE",mode:"loops"});let n=crypto.randomUUID(),a=await j.createThread();await N.createPipelineRecord({loopID:n,draftPipeline:null,threadID:a.id,pipeline:null}),j.sendChatMessage({content:t,references:[],thread:a}),C(`${e6.Jz}/l/${n}`)},v[4]=N,v[5]=j,v[6]=C,v[7]=a):a=v[7];let w=a;v[8]!==N||v[9]!==C?(i=async e=>{await N.createPipelineRecord({loopID:e.id,draftPipeline:e,threadID:null,pipeline:null}),C(`${e6.Jz}/l/${e.id}`)},v[8]=N,v[9]=C,v[10]=i):i=v[10];let I=i;return v[11]===Symbol.for("react.memo_cache_sentinel")?(r=(0,o.jsx)(aO,{}),v[11]=r):r=v[11],v[12]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsxs)(aP.A.Header,{children:[(0,o.jsx)(aP.A.Icon,{icon:(0,o.jsx)(nu.I,{icon:"loops",size:32})}),(0,o.jsx)(aP.A.Title,{children:"Automate once. Loop forever."}),(0,o.jsx)(aP.A.Description,{children:"Loops simplifies workflow automation by allowing you to define processes with clear inputs, prompts, and outputs\u2014no manual setup required. Powered by Copilot, Loops makes it easy to automate and manage tasks, streamlining your operations with minimal effort."})]}),v[12]=s):s=v[12],v[13]!==w?(d=(0,o.jsx)(nv.V,{hideAttachmentButton:!0,placeholder:"What would you like to automate?",size:"large",onSubmit:w}),v[13]=w,v[14]=d):d=v[14],v[15]===Symbol.for("react.memo_cache_sentinel")?(u=(0,o.jsx)(aR.h,{}),v[15]=u):u=v[15],v[16]!==d?(m=(0,o.jsxs)("div",{className:aD.header,children:[s,(0,o.jsxs)("div",{className:aD.input,children:[d,u]})]}),v[16]=d,v[17]=m):m=v[17],v[18]!==b||v[19]!==_?(p=b||_&&_.length>0?(0,o.jsxs)(aP.A.Section,{children:[(0,o.jsx)(aP.A.Section.Title,{children:"Your loops"}),(0,o.jsx)(aP.A.Section.Grid,{loading:b,children:_?.map(aG)})]}):null,v[18]=b,v[19]=_,v[20]=p):p=v[20],v[21]===Symbol.for("react.memo_cache_sentinel")?(h=(0,o.jsx)(aP.A.Section.Title,{children:"Examples"}),v[21]=h):h=v[21],v[22]!==I?(f=a$.map(e=>{let{altText:t,assetPath:n,loop:a}=e;return(0,o.jsx)(aW,{altText:t,assetPath:n,exampleLoop:a,onSelect:I},a.title)}),v[22]=I,v[23]=f):f=v[23],v[24]!==b||v[25]!==f?(y=(0,o.jsxs)(aP.A.Section,{children:[h,(0,o.jsx)(aP.A.Section.Grid,{loading:b,children:f})]}),v[24]=b,v[25]=f,v[26]=y):y=v[26],v[27]!==p||v[28]!==y||v[29]!==m?(x=(0,o.jsxs)(o.Fragment,{children:[r,(0,o.jsxs)(aP.A.Container,{children:[m,p,y]})]}),v[27]=p,v[28]=y,v[29]=m,v[30]=x):x=v[30],x}function aG(e){return(0,o.jsx)(aV,{item:e,onClick:aK},e.id)}function aK(){return(0,g.BI)("dotcom_chat.activate",{target:"OVERVIEW_USER_LOOP_SELECT",mode:"loops"})}function aQ(){(0,ao.D)("Loops \xb7 GitHub Copilot")}try{aH.displayName||(aH.displayName="LoopsView")}catch{}try{aq.displayName||(aq.displayName="LoopsViewInner")}catch{}function aJ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let PipesPlugin=class PipesPlugin{matchPage(e){return!!e&&(tn.test(e.pathname)||ta.test(e.pathname))}matchView(e){return!!e&&tt.test(e.pathname)}matchThread(e,t){return!!this.routes.some(e=>e.test(ap.fV.pathname))||!!nA(e,t,!0)}async overrideCreateMessageOptions(e){return{...e,mode:e8}}constructor(e,t,n,a,i){aJ(this,"id",e7),aJ(this,"displayName","Loops"),aJ(this,"service",void 0),aJ(this,"previewUrl",void 0),aJ(this,"routes",[tt,tn,ta]),aJ(this,"skipSyncRouteToThread",!0),aJ(this,"PageComponent",ac),aJ(this,"ViewComponent",aH),aJ(this,"NavigationComponent",ah),this.service=new PipesService(new IndexedDBPipesStorage,new GraphQLClient(t),new ChatCompletionsClient(e,n,i)),this.previewUrl=a}}},72100:(e,t,n)=>{n.d(t,{BV:()=>g,Be:()=>CustomCopilotNotFoundError,CF:()=>m,TB:()=>p,Tx:()=>h,kt:()=>d,xs:()=>u});var a=n(97665),i=n(94747),r=n(97286),s=n(55649),o=n(7426),l=n(96540),c=n(65615);let CustomCopilotNotFoundError=class CustomCopilotNotFoundError extends Error{constructor(e="Custom Copilot not found"){super(e),this.name="CustomCopilotNotFoundError"}};function d(){let e=(0,a.jE)();return(0,i.n)({mutationFn:async e=>{let t=await (0,s.dt)(e);if(!t.ok)throw Error(String(t.error));return{status:t.status,ok:!0,payload:t.payload}},onSuccess:async()=>{await e.invalidateQueries({queryKey:s.rt})}})}function u(e){let t=(0,o.b)(),{data:n}=m(e);(0,l.useEffect)(()=>{n&&t.dispatch({type:"SET_CUSTOM_COPILOTS",customCopilots:n})},[n,t])}function m(e){return(0,r.I)({queryKey:s.rt,queryFn:s.nn,enabled:e,staleTime:3e5})}function p(e){return(0,r.I)({queryKey:(0,s.TP)(e),queryFn:async()=>{let t=await (0,s.Qb)(e);if(!t.ok){if(404===t.status)throw new CustomCopilotNotFoundError;throw Error(t.error)}return t.payload},enabled:!!e})}function h(e,t){return(0,r.I)({queryKey:["visibility-settings",e,t],queryFn:async()=>(0,s.A2)({owner:e,id:t}),enabled:!!(e&&void 0!==t),staleTime:3e5})}function g(){return(0,c.A3)("customCopilotsEnabled")}},55649:(e,t,n)=>{n.d(t,{A2:()=>p,Qb:()=>u,TP:()=>l,dt:()=>m,ix:()=>c,nn:()=>d,rt:()=>o});var a=n(82610),i=n(68956),r=n(57572);let s="/github-copilot/chat",o=["copilot-chat","custom-copilots"];function l(e){return e?["copilot-chat","custom-copilot",{id:e.id,owner:e.owner}]:["copilot-chat","custom-copilot",null]}function c(e){return void 0!==e.id}async function d(){let e=await (0,r.lS)(`${s}/custom_copilots`);if(!e.ok)throw Error(`Failed to fetch spaces: ${a.nN[e.status]||a.DW}`);return await e.json()}async function u(e){let t;if(!e)return{status:500,ok:!1,error:"unexpected null custom copilot id"};let{owner:n,id:i}=e;t=n?`${s}/custom_copilots/${n}/${i}`:`${s}/custom_copilots/${i}`;let o=await (0,r.lS)(t);if(!o.ok)return{status:o.status,ok:!1,error:a.nN[o.status]||a.DW};let l=await o.json();return{status:o.status,ok:!0,payload:l}}async function m(e){let t=await (0,r.lS)((0,i.fn)(e),{method:"DELETE"});return t.ok?{status:t.status,ok:!0,payload:null}:t}async function p(e){let t=await (0,r.lS)(`${(0,i.fn)(e)}/settings/visibility`);if(!t.ok)throw Error("Error fetching visibility settings");try{let e=await t.json();return{memberCount:e.member_count&&"number"==typeof e.member_count?e.member_count:null}}catch(e){throw Error(`Error parsing visibility settings: ${e}`)}}},2640:(e,t,n)=>{n.d(t,{D:()=>r,Y:()=>s});var a=n(13080),i=n(47584);function r(e){if(!i.XC)return;let t=i.XC.querySelector("title"),n=i.XC.createElement("title");n.textContent=e,t?t.textContent!==e&&(t.replaceWith(n),(0,a.i)(e)):(i.XC.head.appendChild(n),(0,a.i)(e))}function s(e){return document.body.classList.contains("logged-out")?`${e} \xb7 GitHub`:e}},75028:(e,t,n)=>{n.d(t,{G:()=>i,K:()=>r});var a=n(47584);let i=a.XC?.readyState==="interactive"||a.XC?.readyState==="complete"?Promise.resolve():new Promise(e=>{a.XC?.addEventListener("DOMContentLoaded",()=>{e()})}),r=a.XC?.readyState==="complete"?Promise.resolve():new Promise(e=>{a.cg?.addEventListener("load",e)})},42445:(e,t,n)=>{n.d(t,{N7:()=>f});var a=n(36301),i=n(77065),r=n(24212);function s(e){return(0,r.q)(e.stack||"").map(e=>({filename:e.file||"",function:String(e.methodName),lineno:(e.lineNumber||0).toString(),colno:(e.column||0).toString()}))}function o(e){let t=document.querySelectorAll(e);if(t.length>0)return t[t.length-1]}var l=n(9080),c=n(47584),d=n(95505);let u=!1,m=0,p=Date.now(),h=new Set(["AbortError","AuthSessionExpiredError","TypeError"]),g=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","Unable to perform this operation. Please try again later."]);function f(e,t={}){if(!(e instanceof Error||"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"message"in e&&"string"==typeof e.message)){if(function(e){if(!e||"boolean"==typeof e||"number"==typeof e)return!0;if("string"==typeof e){if(b.some(t=>e.includes(t)))return!0}else if("object"==typeof e&&"string"==typeof e.message&&"number"==typeof e.code)return!0;return!1}(e))return;let n=Error(),a=function(e){try{return JSON.stringify(e)}catch{return"Unserializable"}}(e);y(x({type:"UnknownError",value:`Unable to report error, due to a thrown non-Error type: ${typeof e}, with value ${a}`,stacktrace:s(n),catalogService:void 0},t));return}e.name&&("AbortError"===e.name||h.has(e.name)&&g.has(e.message)||e.name.startsWith("ApiError")&&g.has(e.message))||y(x({type:e.name,value:e.message,stacktrace:s(e),catalogService:e.catalogService},t))}async function y(e){if(!(!_&&!u&&m<10&&(0,i.TT)()))return;let t=document.head?.querySelector('meta[name="browser-errors-url"]')?.content;if(t){if(e.error.stacktrace.some(e=>v.test(e.filename)||v.test(e.function))){u=!0;return}m++;try{await fetch(t,{method:"post",body:JSON.stringify(e)})}catch{}}}function x(e,t={}){return Object.assign({error:e,sanitizedUrl:`${window.location.protocol}//${window.location.host}${function(){let e=o("meta[name=analytics-location]");return e?e.content:window.location.pathname}()+function(){let e=o("meta[name=analytics-location-query-strip]"),t="";e||(t=window.location.search);let n=o("meta[name=analytics-location-params]");for(let e of(n&&(t+=(t?"&":"?")+n.content),document.querySelectorAll("meta[name=analytics-param-rename]"))){let n=e.content.split(":",2);t=t.replace(RegExp(`(^|[?&])${n[0]}($|=)`,"g"),`$1${n[1]}$2`)}return t}()}`||window.location.href,readyState:document.readyState,referrer:(0,d.dR)(),timeSinceLoad:Math.round(Date.now()-p),user:function(){let e=document.head?.querySelector('meta[name="user-login"]')?.content;if(e)return e;let t=(0,a.y)();return`anonymous-${t}`}()||void 0,actorId:document.head?.querySelector('meta[name="octolytics-actor-id"]')?.content,bundler:l.v,ui:!!document.querySelector('meta[name="ui"]'),release:document.head?.querySelector('meta[name="release"]')?.content},t)}let v=/(chrome|moz|safari)-extension:\/\//,_=!1;c.cg?.addEventListener("pageshow",()=>_=!1),c.cg?.addEventListener("pagehide",()=>_=!0),"function"==typeof BroadcastChannel&&new BroadcastChannel("shared-worker-error").addEventListener("message",e=>{f(e.data.error)});let b=["Object Not Found Matching Id","Not implemented on this platform","provider because it's not your default extension"]},75632:(e,t,n)=>{n.d(t,{G7:()=>l,XY:()=>c,fQ:()=>o});var a=n(5225),i=n(56176);function r(){return new Set((0,i._$)().featureFlags)}let s=n(47584).X3||function(){try{return process?.env?.STORYBOOK==="true"}catch{return!1}}()?r:(0,a.A)(r);function o(){return Array.from(s())}function l(e){return s().has(e)}let c={isFeatureEnabled:l}},11086:(e,t,n)=>{n.d(t,{t:()=>i});var a=n(5804);let i=({items:e,filter:t,key:n,secondaryKey:i})=>{let r=e.map(e=>[(0,a.dt)(t,n(e)),e]);return i&&(r=r.map(([e,n])=>[Math.max(e,(0,a.dt)(t,i(n))),n])),r.filter(([e])=>e>a.IP).sort(([e,t],[a,i])=>a===e?n(t).localeCompare(n(i)):a-e).map(([,e])=>e)}},5804:(e,t,n)=>{n.d(t,{Dx:()=>s,IP:()=>r,M4:()=>i,dt:()=>o});var a=n(91385);let i=1/0,r=-1/0,s=1,o=(e,t,n=s)=>{let o=e.trim().toLowerCase(),l=t.trim().toLowerCase();if(o===l)return i;if(0===l.length||0===o.length)return r;let c=(0,a.fN)(o,l);return c===1/0&&o!==l?r:l.startsWith(o)||l.endsWith(o)?c+n:c}},87913:(e,t,n)=>{n.d(t,{A:()=>r});let a=n.p+"jetbrains-e16495e63a33.png",i=n.p+"neovim-3301f23c4307.png",r={vscode:{url:"https://marketplace.visualstudio.com/items?itemName=GitHub.copilot",icon:n.p+"vscode-380056900de8.png",name:"Visual Studio Code",eventName:"VSCODE"},visualstudio:{url:"https://visualstudio.microsoft.com/github-copilot/",icon:n.p+"vsstudio-806c4b726938.png",name:"Visual Studio",eventName:"VS"},xcode:{url:"https://github.com/github/CopilotForXcode",icon:n.p+"xcode-a6c2735aa7ac.png",name:"Xcode",eventName:"XCODE"},jetbrains:{url:"https://plugins.jetbrains.com/plugin/17718-github-copilot",icon:a,name:"JetBrains",eventName:"JETBRAINS"},neovim:{url:"https://github.com/github/copilot.vim",icon:i,name:"Neovim",eventName:"NEOVIM"}}},67416:(e,t,n)=>{n.d(t,{FC:()=>l,I0:()=>s,dV:()=>o,h$:()=>d,jK:()=>c});let a=null,i=!1;function r(e){let t=function(){let e=document.querySelector("context-region");return e&&e.isConnected&&e.pushCrumb&&"function"==typeof e.pushCrumb?e:null}();if(t){e(t);return}a=e,function(){if(i)return;i=!0;let e=document.querySelector("context-region");e&&e.addEventListener("context-region-connected",()=>{a&&(a(e),a=null)},{once:!0})}()}function s(e){r(t=>t.pushCrumb(e))}function o(){r(e=>e.popCrumb())}function l(e){r(t=>t.replaceCrumbs(e))}function c(e){r(t=>t.renameCurrentCrumb(e))}function d(e){r(t=>t.replaceCurrentCrumb(e))}},4460:(e,t,n)=>{n.d(t,{C3:()=>o,JV:()=>i,K3:()=>u,MM:()=>l,OE:()=>m,Zu:()=>d,bj:()=>r,jc:()=>c,kd:()=>s});var a=n(47584);function i(){return a.Kn?.state||{}}function r(e){p(i(),"",e)}function s(e){a.Kn?.pushState({appId:i().appId},"",e),h()}function o(e){p({...i(),...e},"",location.href)}function l(e){r(`?${e.toString()}${a.fV.hash}`)}function c(){r(a.fV.pathname+a.fV.hash)}function d(e){r(e.startsWith("#")?e:`#${e}`)}function u(){r(a.fV.pathname+a.fV.search)}function m(){a.Kn?.back()}function p(e,t,n){a.Kn?.replaceState(e,t,n),h()}function h(){a.cg?.dispatchEvent(new CustomEvent("statechange",{bubbles:!1,cancelable:!1}))}},73218:(e,t,n)=>{n.d(t,{l:()=>a});let a=()=>void 0},64128:(e,t,n)=>{n.d(t,{Y:()=>a});function a(){let e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}},74753:(e,t,n)=>{n.d(t,{A:()=>o});let{getItem:a,setItem:i,removeItem:r}=(0,n(80688).A)("localStorage"),s="REACT_PROFILING_ENABLED",o={enable:()=>i(s,"true"),disable:()=>r(s),isEnabled:()=>!!a(s)}},9080:(e,t,n)=>{n.d(t,{k:()=>s,v:()=>o});var a=n(5225),i=n(47584);let r=(0,a.A)(function(){return i.XC?.head?.querySelector('meta[name="runtime-environment"]')?.content||""}),s=(0,a.A)(function(){return"enterprise"===r()}),o="webpack"},80688:(e,t,n)=>{n.d(t,{A:()=>s,D:()=>o});var a=n(47584),i=n(57516);let r=class NoOpStorage{getItem(){return null}setItem(){}removeItem(){}clear(){}key(){return null}get length(){return 0}};function s(e,t={throwQuotaErrorsOnSet:!1},n=a.cg,o=e=>e,l=e=>e){let c;try{if(!n)throw Error();c=n[e]||new r}catch{c=new r}let{throwQuotaErrorsOnSet:d}=t;function u(e){t.sendCacheStats&&(0,i.i)({incrementKey:e})}function m(e){try{if(c.removeItem(e),t.ttl){let t=`${e}:expiry`;c.removeItem(t)}}catch{}}return{getItem:function(e,t=Date.now()){try{let n=c.getItem(e);if(!n)return null;let a=`${e}:expiry`,i=Number(c.getItem(a));if(i&&t>i)return m(e),m(a),u("SAFE_STORAGE_VALUE_EXPIRED"),null;return u("SAFE_STORAGE_VALUE_WITHIN_TTL"),o(n)}catch{return null}},setItem:function(e,n,a=Date.now()){try{if(c.setItem(e,l(n)),t.ttl){let n=`${e}:expiry`,i=a+t.ttl;c.setItem(n,i.toString())}}catch(e){if(d&&e instanceof Error&&e.message.toLowerCase().includes("quota"))throw e}},removeItem:m,clear:c.clear,getKeys:function(){return Object.keys(c)},get length(){return c.length}}}function o(e){return s(e,{throwQuotaErrorsOnSet:!1},a.cg,JSON.parse,JSON.stringify)}},32329:(e,t,n)=>{n.d(t,{Ai:()=>r,Gq:()=>a,SO:()=>i});let{getItem:a,setItem:i,removeItem:r}=(0,n(80688).A)("sessionStorage")},67307:(e,t,n)=>{n.d(t,{Kq:()=>SoftNavErrorEvent,RQ:()=>SoftNavEndEvent,gh:()=>SoftNavPayloadEvent,ni:()=>SoftNavSuccessEvent,sW:()=>SoftNavStartEvent});var a=n(18056);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let r=class SoftNavEvent extends Event{constructor(e,t){super(t),i(this,"mechanism",void 0),this.mechanism=e}};let SoftNavStartEvent=class SoftNavStartEvent extends r{constructor(e){super(e,a.z.START)}};let SoftNavSuccessEvent=class SoftNavSuccessEvent extends r{constructor(e,t){super(e,a.z.SUCCESS),i(this,"visitCount",void 0),this.visitCount=t}};let SoftNavErrorEvent=class SoftNavErrorEvent extends r{constructor(e,t){super(e,a.z.ERROR),i(this,"error",void 0),this.error=t}};let SoftNavEndEvent=class SoftNavEndEvent extends r{constructor(e){super(e,a.z.END)}};let SoftNavPayloadEvent=class SoftNavPayloadEvent extends Event{constructor(e){super("soft-nav:payload"),i(this,"payload",void 0),i(this,"appPayload",void 0),this.payload=e.payload,this.appPayload=e.appPayload}}},73081:(e,t,n)=>{n.d(t,{Bu:()=>h,SC:()=>c,Ti:()=>m,iS:()=>d,k5:()=>l,o4:()=>u,rZ:()=>p});var a=n(18056),i=n(67307),r=n(6211),s=n(95505);let o=0;function l(){o=0,document.dispatchEvent(new Event(a.z.INITIAL)),(0,s.xT)()}function c(e){(0,s.LM)()||(document.dispatchEvent(new Event(a.z.PROGRESS_BAR.START)),document.dispatchEvent(new i.sW(e)),(0,s.Vy)(e),(0,s.ZW)(),(0,s.HK)(),(0,r.E5)())}function d(e={}){f(e)&&(o+=1,document.dispatchEvent(new i.ni((0,s.di)(),o)),m(e))}function u(e={}){if(!f(e))return;o=0;let t=(0,s.my)()||s.BW;document.dispatchEvent(new i.Kq((0,s.di)(),t)),g(),(0,r.Cd)(t),(0,s.xT)()}function m(e={}){if(!f(e))return;let t=(0,s.di)();g(),document.dispatchEvent(new i.RQ(t)),(0,s.Ff)(),(0,s.JA)(t)}function p(e={}){f(e)&&((0,r.Im)(),document.dispatchEvent(new Event(a.z.RENDER)))}function h(){document.dispatchEvent(new Event(a.z.FRAME_UPDATE))}function g(){document.dispatchEvent(new Event(a.z.PROGRESS_BAR.END))}function f({skipIfGoingToReactApp:e,allowedMechanisms:t=[]}={}){return(0,s.LM)()&&(0===t.length||t.includes((0,s.di)()))&&(!e||!(0,s.gc)())}},18056:(e,t,n)=>{n.d(t,{z:()=>a});let a=Object.freeze({INITIAL:"soft-nav:initial",START:"soft-nav:start",REPLACE_MECHANISM:"soft-nav:replace-mechanism",SUCCESS:"soft-nav:success",ERROR:"soft-nav:error",FRAME_UPDATE:"soft-nav:frame-update",END:"soft-nav:end",RENDER:"soft-nav:render",PROGRESS_BAR:{START:"soft-nav:progress-bar:start",END:"soft-nav:progress-bar:end"}})},6211:(e,t,n)=>{n.d(t,{Cd:()=>l,E5:()=>o,Im:()=>c,nW:()=>s});var a=n(57516),i=n(95505);let r="stats:soft-nav-duration",s={turbo:"TURBO",react:"REACT","turbo.frame":"FRAME",ui:"UI",hard:"HARD"};function o(){window.performance.clearResourceTimings(),window.performance.mark(r)}function l(e){(0,a.i)({turboFailureReason:e,turboStartUrl:(0,i.dR)(),turboEndUrl:window.location.href})}function c(){let e=function(){if(0===performance.getEntriesByName(r).length)return null;performance.measure(r,r);let e=performance.getEntriesByName(r).pop();return e?e.duration:null}();if(!e)return;let t=s[(0,i.di)()],n=Math.round(e);t===s.react&&document.dispatchEvent(new CustomEvent("staffbar-update",{detail:{duration:n}})),(0,a.i)({requestUrl:window.location.href,softNavigationTiming:{mechanism:t,destination:(0,i.fX)()||"rails",duration:n,initiator:(0,i.Pv)()||"rails"}})}},95505:(e,t,n)=>{n.d(t,{BW:()=>i,Ff:()=>p,HK:()=>v,JA:()=>w,LM:()=>h,Pv:()=>j,Vy:()=>m,ZW:()=>b,dR:()=>_,di:()=>g,fX:()=>C,gc:()=>N,k9:()=>x,my:()=>y,r7:()=>I,wG:()=>f,xT:()=>u});var a=n(32329);let i="reload",r="soft-nav:fail",s="soft-nav:fail-referrer",o="soft-nav:referrer",l="soft-nav:marker",c="soft-nav:react-app-name",d="soft-nav:latest-mechanism";function u(){(0,a.SO)(l,"0"),(0,a.Ai)(o),(0,a.Ai)(r),(0,a.Ai)(s),(0,a.Ai)(c),(0,a.Ai)(d)}function m(e){(0,a.SO)(l,e)}function p(){(0,a.SO)(l,"0")}function h(){let e=(0,a.Gq)(l);return e&&"0"!==e}function g(){return(0,a.Gq)(l)}function f(){return!!y()}function y(){return(0,a.Gq)(r)}function x(e){(0,a.SO)(r,e||i),(0,a.SO)(s,window.location.href)}function v(){(0,a.SO)(o,window.location.href)}function _(){return(0,a.Gq)(o)||document.referrer}function b(){let e=C();e?(0,a.SO)(c,e):(0,a.Ai)(c)}function j(){return(0,a.Gq)(c)}function C(){return document.querySelector('react-partial[partial-name="repos-overview"]')?"repos-overview":document.querySelector("react-app")?.getAttribute("app-name")}function N(){return!!document.querySelector("react-app")?.getAttribute("app-name")}function w(e){(0,a.SO)(d,e)}function I(){return(0,a.Gq)(d)}},47584:(e,t,n)=>{n.d(t,{KJ:()=>a.KJ,Kn:()=>i.Kn,X3:()=>a.X3,XC:()=>i.XC,cg:()=>i.cg,fV:()=>i.fV,g5:()=>a.g5});var a=n(25992),i=n(39833)},39833:(e,t,n)=>{n.d(t,{Kn:()=>s,XC:()=>i,cg:()=>r,fV:()=>o});let a="undefined"!=typeof FORCE_SERVER_ENV&&FORCE_SERVER_ENV,i="undefined"==typeof document||a?void 0:document,r="undefined"==typeof window||a?void 0:window,s="undefined"==typeof history||a?void 0:history,o="undefined"==typeof location||a?{pathname:"",origin:"",search:"",hash:"",href:""}:location},25992:(e,t,n)=>{n.d(t,{KJ:()=>r,X3:()=>i,g5:()=>s});var a=n(39833);let i=void 0===a.XC,r=!i;function s(){return!!i||!a.XC||!!(a.XC.querySelector('react-app[data-ssr="true"]')||a.XC.querySelector('react-partial[data-ssr="true"][partial-name="repos-overview"]'))}},57516:(e,t,n)=>{n.d(t,{X:()=>h,i:()=>d});var a=n(47584),i=n(75028),r=n(9080),s=n(75632),o=n(56176),l=n(70170);let c=[];function d(e,t=!1,n=.5){if(!a.X3&&!0!==(0,s.G7)("browser_stats_disabled")){if(n<0||n>1)throw RangeError("Sampling probability must be between 0 and 1");void 0===e.timestamp&&(e.timestamp=Date.now()),e.loggedIn=(0,o.M3)(),e.staff=h(),e.bundler=r.v,Math.random()<n&&c.push(e),t?p():m()}}let u=null,m=(0,l.n)(async function(){await i.K,null==u&&(u=window.requestIdleCallback(p))},5e3);function p(){if(u=null,!c.length)return;let e=a.XC?.head?.querySelector('meta[name="browser-stats-url"]')?.content;if(e){for(let t of function(e){let t=[],n=e.map(e=>JSON.stringify(e));for(;n.length>0;)t.push(function(e){let t=e.shift(),n=[t],a=t.length;for(;e.length>0&&a<=65536;){let t=e[0].length;if(a+t<=65536){let i=e.shift();n.push(i),a+=t}else break}return n}(n));return t}(c))!function(e,t){try{navigator.sendBeacon&&navigator.sendBeacon(e,t)}catch{}}(e,`{"stats": [${t.join(",")}] }`);c=[]}}function h(){return!!a.XC?.head?.querySelector('meta[name="user-staff"]')?.content}a.XC?.addEventListener("pagehide",p),a.XC?.addEventListener("visibilitychange",p)},45996:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(38568),i=n(96540);function r(){let e=(0,i.useRef)(!1),t=(0,i.useCallback)(()=>e.current,[]);return(0,a.N)(()=>(e.current=!0,()=>{e.current=!1}),[]),t}},38568:(e,t,n)=>{n.d(t,{N:()=>r});var a=n(47584),i=n(96540);let r=void 0!==a.cg?.document?.createElement?i.useLayoutEffect:i.useEffect},42252:(e,t,n)=>{n.d(t,{S:()=>i});var a=n(96540);function i(e){let t=(0,a.useRef)(void 0);return(0,a.useEffect)(()=>{t.current=e},[e]),t.current}},82060:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(45996),i=n(96540);let r=function(e){let t=(0,a.A)(),[n,r]=(0,i.useState)(e);return[n,(0,i.useCallback)(e=>{t()&&r(e)},[t])]}},59418:(e,t,n)=>{n.d(t,{y:()=>s});var a=n(74848),i=n(21728),r=n(50045);function s(e){let t,n,s;let o=(0,i.c)(7),{children:l,appName:c,category:d,metadata:u}=e;return o[0]!==c||o[1]!==d||o[2]!==u?(n={appName:c,category:d,metadata:u},o[0]=c,o[1]=d,o[2]=u,o[3]=n):n=o[3],t=n,o[4]!==l||o[5]!==t?(s=(0,a.jsx)(r.I.Provider,{value:t,children:l}),o[4]=l,o[5]=t,o[6]=s):s=o[6],s}try{s.displayName||(s.displayName="AnalyticsProvider")}catch{}},34225:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var a=n(74848),i=n(24774),r=n(96540),s=n(6585),o=n(5853),l=n(9299),c=n(45230),d=n(54528),u=n(15874);let m=(0,n(91752).zw)()?[]:[{key:"Alt-g",run:()=>!0,preventDefault:!0}],p=[(0,c.b6)(),(0,u.WD)(),(0,i.$K)({formatNumber:e=>e.toString().padStart(3," ")}),(0,u.SG)(),(0,i.vX)({position:"absolute"}),(0,d.$P)({top:!0}),i.Lz.editorAttributes.of({class:"js-codemirror-editor","data-testid":"codemirror-editor"}),i.w4.of([...m,...c.pw,...d.Eo,...c.cL])];var h=n(43720);let g={"&":{background:"var(--codeMirror-bgColor, var(--color-codemirror-bg))",color:"var(--codeMirror-fgColor, var(--color-codemirror-text))",cursor:"text"},".cm-gutters":{background:"var(--codeMirror-gutters-bgColor, var(--color-codemirror-gutters-bg))",borderRightWidth:0},".cm-lineNumbers .cm-gutterElement":{color:"var(--codeMirror-lineNumber-fgColor, var(--color-codemirror-linenumber-text))",fontFamily:"var(--fontStack-monospace)",fontSize:"var(--codeMirror-gutter-fontSize, var(--codeMirror-content-fontSize, 12px))",lineHeight:"20px",padding:"0 16px 0 16px"},".cm-content":{caretColor:"var(--codeMirror-cursor-fgColor, var(--color-codemirror-cursor))",fontFamily:"var(--fontStack-monospace)",fontSize:"var(--codeMirror-content-fontSize, 12px)",background:"var(--codeMirror-lines-bgColor, var(--color-codemirror-lines-bg))",lineHeight:"20px",paddingTop:"8px"},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"var(--codeMirror-selection-bgColor, var(--color-codemirror-selection-bg, #d7d4f0))"},"&.cm-focused":{outline:"none"},"&.hide-help-until-focus":{"&.cm-focused .cm-panels-bottom":{display:"block"},"& .cm-panels-bottom":{display:"none"}},"&.hide-help":{"& .cm-panels-top":{display:"none",position:"absolute"}},".cm-content ::-moz-selection":{backgroundColor:"var(--codeMirror-selection-bgColor, var(--color-codemirror-selection-bg, #d7d4f0))"},".cm-activeLine":{backgroundColor:"var(--codeMirror-activeline-bgColor, var(--color-codemirror-activeline-bg))"},".cm-line":{paddingLeft:"16px"},".cm-help-panel":{background:"var(--bgColor-muted, var(--color-canvas-subtle))",padding:"7px 10px",margin:0,fontSize:"13px",lineHeight:"16px",color:"var(--fgColor-muted, var(--color-fg-muted))",cursor:"default"},".cm-panels-bottom":{borderTop:"var(--borderWidth-thin, 1px) solid var(--borderColor-default, var(--color-border-default))",background:"none"},".js-upload-markdown-image & .cm-panels-bottom":{bottom:"30px !important"},".cm-panel.cm-search":{background:"var(--bgColor-muted, var(--color-canvas-subtle))",padding:"8px",fontSize:"16px"},".cm-panel.cm-search > button":{borderRadius:"6px",padding:"4px 8px",background:"var(--codeMirror-bgColor, var(--color-codemirror-bg))",color:"var(--button-default-fgColor-rest, var(--color-btn-text))",border:"1px solid var(--button-default-borderColor-rest, var(--color-btn-border))",textTransform:"capitalize"},".cm-panel.cm-search > label":{color:"var(--fgColor-default, var(--color-fg-default))",textTransform:"capitalize",fontSize:"12px"},".cm-panel.cm-search > input":{borderRadius:"6px",padding:"4px 8px",background:"var(--bgColor-default, var(--color-canvas-default))",color:"var(--fgColor-default, var(--color-fg-default))",border:"1px solid var(--borderColor-default, var(--color-border-default))",fontSize:"12px"},'.cm-panel.cm-search > button[name="close"]':{padding:"4px"},".cm-panels-top":{borderBottom:"var(--borderWidth-thin, 1px) solid var(--color-border-default)",background:"none"},".cm-panel.cm-search input, .cm-panel.cm-search button, .cm-panel.cm-search label":{marginRight:"8px",marginBottom:"4px",marginTop:"4px",marginLeft:0},".cm-lintRange":{cursor:"help",backgroundImage:"none !important"},".cm-placeholder":{height:"1em",color:"var(--fgColor-muted)"},"&.custom-tooltips .cm-tooltip":{border:"none !important",backgroundColor:"transparent !important"},"&.custom-tooltips .cm-diagnostic":{padding:0,marginLeft:"0 !important",borderLeft:"none !important",whiteSpace:"unset"}},f=[{tag:[h._A.keyword],color:"var(--codeMirror-syntax-fgColor-keyword, var(--color-codemirror-syntax-keyword))"},{tag:[h._A.comment],color:"var(--codeMirror-syntax-fgColor-comment, var(--color-codemirror-syntax-comment))"},{tag:[h._A.bracket],color:"var(--codeMirror-matchingBracket-fgColor, var(--color-codemirror-matchingbracket-text))"},{tag:[h._A.string,h._A.url,h._A.regexp],color:"var(--codeMirror-syntax-fgColor-string, var(--color-codemirror-syntax-string))"},{tag:[h._A.constant(h._A.name),h._A.propertyName,h._A.attributeName],color:"var(--codeMirror-syntax-fgColor-constant, var(--color-codemirror-syntax-constant))"},{tag:[h._A.atom,h._A.number,h._A.bool],color:"var(--codeMirror-syntax-fgColor-constant, var(--color-codemirror-syntax-constant))"},{tag:[h._A.function(h._A.variableName)],color:"var(--codeMirror-syntax-fgColor-entity, var(--color-codemirror-syntax-entity))"},{tag:h._A.definition(h._A.variableName),color:"var(--codeMirror-syntax-fgColor-variable, var(--color-codemirror-syntax-variable))"},{tag:h._A.meta,color:"inherit"},{tag:h._A.heading,fontWeight:"bold",color:"inherit !important"},{tag:h._A.monospace,color:"var(--codeMirror-syntax-fgColor-comment, var(--color-codemirror-syntax-comment))"}],y=[{tag:h._A.link,textDecoration:"underline"},{tag:h._A.emphasis,fontStyle:"italic"},{tag:h._A.strong,fontWeight:"bold"},{tag:h._A.strikethrough,textDecoration:"line-through"}],x=[...f,...y],v=[...f,...y];function _(e=[]){let t=[...null!==document.querySelector('[data-color-mode="dark"]')?v:x,...e];return[i.Lz.theme(g),(0,u.y9)(u.cr.define(t),{fallback:!0})]}let b=e=>{let t=[s.$t.tabSize.of(e.indentUnit)];return e.indentWithTabs?t.push(u.Xt.of("	")):t.push(u.Xt.of(" ".repeat(e.indentUnit))),e.lineWrapping&&t.push(i.Lz.lineWrapping),t};var j=n(42378);let C=(e,t)=>{let{state:n,placeholder:a,replacementText:i}=e.detail;"uploading"===n?(0,j.w0)(t)?(0,j.tJ)(t,a):(0,j.TC)(t,i):("uploaded"===n||"failed"===n)&&(0,j.TB)(t,a,i)},N=(e,t)=>{let{left:n,top:a}=e.detail,i=t.posAtCoords({x:n,y:a});i&&t.dispatch({selection:{anchor:i,head:i}})},w=new WeakMap;function I(e,t){if((0,j.w0)(e)){let n=(0,j.Lo)(e.state);(0,j.tJ)(e,`${t}${n}${t}`)}else{let n=(0,j.BE)(e);(0,j.TC)(e,t.repeat(2)),(0,j.f9)(e,n.anchor+t.length)}return!0}function S(e,t){let n=(0,j.BE)(e),a=e.state.doc.lineAt(n.from),i=(0,j.Lo)(e.state),r=RegExp(`^${"ol"===t?"\\d+\\.":t}\\s`);if(i){let n=(i.endsWith("\n")?i.slice(0,-2):i).split("\n").map((t,n)=>{let i=a.number+n;return{text:e.state.doc.line(i).text,lineNumber:i}}),s=n.every(e=>r.test(e.text));for(let a=0;a<n.length;a++){let i=n[a];if(s){let t=i.text.match(r);t&&(0,j.YH)(e,i?.lineNumber,t[0])}else{let n=`${"ol"===t?`${a+1}.`:t} `;(0,j.Md)(e,i?.lineNumber,n)}}}else{let i=a.text.match(r);if(i)(0,j.YH)(e,a.number,i[0]);else{let i=`${"ol"===t?"1.":t} `;(0,j.Md)(e,a.number,i),a.text||(0,j.f9)(e,n.anchor+i.length)}}return!0}let k=[{key:"Mod-i",run:e=>I(e,"_"),preventDefault:!0},{key:"Mod-b",run:e=>I(e,"**"),preventDefault:!0},{key:"Mod-e",run:e=>I(e,"`"),preventDefault:!0},{key:"Mod-k",run:e=>{let t=(0,j.Lo)(e.state);if(t){let n=`[${t}](url)`;(0,j.tJ)(e,n);let a=(0,j.I6)(e,n).value.from;(0,j.td)(e,a+t.length+3,a+t.length+6)}else{let t=(0,j.BE)(e);(0,j.TC)(e,"[](url)"),(0,j.f9)(e,t.anchor+1)}return!0},preventDefault:!0},{key:"Shift-Mod-.",run:e=>S(e,">"),preventDefault:!0},{key:"Shift-Mod-7",run:e=>S(e,"ol"),preventDefault:!0},{key:"Shift-Mod-8",run:e=>S(e,"-"),preventDefault:!0},{key:"Mod-v",run:e=>(w.set(e,!1),!1)},{key:"Shift-Mod-v",run:e=>(w.set(e,!0),!1)}];function T(e){let t=i.NZ.line({attributes:{dir:"auto"}}),n=new s.vB;for(let{from:a,to:i}of e.visibleRanges)for(let r=a;r<=i;){let a=e.state.doc.lineAt(r);n.add(a.from,a.from,t),r=a.to+1}return n.finish()}let A=i.Z9.fromClass(class{update(e){(e.docChanged||e.viewportChanged)&&(this.decorations=T(e.view))}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"decorations",void 0),this.decorations=T(e)}},{decorations:e=>e.decorations}),E=[i.Lz.domEventHandlers({keydown(e){(e.metaKey||e.ctrlKey)&&"k"===e.key&&e.stopPropagation()},paste(e,t){w.get(t)||function(e,t){let n=(0,j.Lo)(e.state),a=t.clipboardData;if(n&&a){let i=a.getData("text/plain");if(!/^https?:\/\//i.test(i))return;i&&(t.preventDefault(),(0,j.tJ)(e,`[${n}](${i})`))}}(t,e),w.set(t,!1)}}),i.w4.of(k),A];var R=n(47404),P=n(5225),D=n(48741),L=n(55156);let M=(0,P.A)(async function(){let e=new Request("/autocomplete/emojis_for_editor",{method:"GET",credentials:"same-origin",headers:{Accept:"application/json",...(0,L.kt)()}}),t=await fetch(e);if(200!==t.status)throw Error(`emoji request failed with a ${t.status}`);let n=await t.json();return Object.keys(n).map(e=>{let t=n[e];return{name:e,src:t[0],emoji:t[1]}})}),O=s.Pe.define({map:({from:e,to:t,severity:n},a)=>({from:a.mapPos(e),to:a.mapPos(t),severity:n})}),B=s.sU.define({create:()=>i.NZ.none,update(e,t){for(let n of(e=e.map(t.changes),t.effects))n.is(O)&&("error"===n.value.severity?e=e.update({add:[F.range(n.value.from,n.value.to)]}):"warning"===n.value.severity?e=e.update({add:[$.range(n.value.from,n.value.to)]}):"info"===n.value.severity&&(e=e.update({add:[U.range(n.value.from,n.value.to)]})));return e},provide:e=>i.Lz.decorations.from(e)}),F=i.NZ.mark({class:"CodeMirror-lint-mark-error"}),$=i.NZ.mark({class:"CodeMirror-lint-mark-warning"}),U=i.NZ.mark({class:"CodeMirror-lint-mark-info"}),z=(e,t)=>{let{from:n,to:a,severity:i}=e.detail,r=(0,j.TU)(t,{line:n.lineNumber,ch:n.character}),s=(0,j.TU)(t,{line:a.lineNumber,ch:a.character});t.dispatch({effects:[O.of({from:r,to:s,severity:i})]})},V={ruby:[{tag:h._A.variableName,color:"var(--codeMirror-syntax-fgColor-variable, var(--color-codemirror-syntax-variable))"}],html:[{tag:h._A.meta,color:"var(--color-prettylights-syntax-constant)"},{tag:h._A.name,color:"var(--color-prettylights-syntax-entity-tag)"}],javascript:[{tag:h._A.name,color:"var(--color-prettylights-syntax-variable)"}],typescript:[{tag:h._A.name,color:"var(--color-prettylights-syntax-variable)"},{tag:h._A.typeName,color:"var(--color-prettylights-syntax-keyword)"}],java:[{tag:h._A.typeName,color:"var(--color-prettylights-syntax-entity)"}],"c++":[{tag:h._A.meta,color:"var(--color-prettylights-syntax-constant)"},{tag:h._A.typeName,color:"var(--color-prettylights-syntax-keyword)"}],php:[{tag:h._A.processingInstruction,color:"var(--color-prettylights-syntax-constant)"},{tag:h._A.name,color:"var(--color-prettylights-syntax-entity)"}]},W=Object.keys(V);var H=n(48031);let q={key:"Tab",run:({state:e,dispatch:t})=>e.selection.ranges.some(e=>!e.empty)?(0,c.UY)({state:e,dispatch:t}):(t(e.update(e.replaceSelection(e.facet(u.Xt)),{scrollIntoView:!0,userEvent:"input"})),!0),shift:c.Mg},G=[],K=[],Q=(0,r.forwardRef)((e,t)=>{let{value:n="",extensions:c=G,keyBindings:d=K,height:u="85vh",width:m="100%",focusNextRenderRef:h,containerClassName:g,...f}=e,y=(0,r.useRef)(null),x=function({extensions:e=[],fileName:t="",onChange:n,spacing:a,isHpc:c,isReadOnly:d,enableFileUpload:u,parentRef:m,placeholder:h="Enter file contents here",ariaLabelledBy:g,value:f,width:y="",height:x="",minHeight:v="",hideHelpUntilFocus:j,hideHelp:w,onCreateEditor:I,onDestroyEditor:S}){let k=(0,r.useRef)(void 0),T=(0,r.useMemo)(()=>new s.xx,[]),A=(0,r.useMemo)(()=>new s.xx,[]),P=(0,r.useMemo)(()=>new s.xx,[]),L=(0,r.useCallback)(e=>{e.docChanged&&n(e.state.doc.toString()||"")},[n]),O=(0,r.useMemo)(()=>i.Lz.updateListener.of(L),[L]),F=(0,r.useMemo)(()=>i.Lz.theme({"&":{height:x,minHeight:v,width:y}}),[x,v,y]),$=(0,r.useMemo)(()=>{let t=[...p,O,F,(0,i.qf)(h),...b(a),[i.Lz.domEventHandlers({"secret-detected:lint":z}),B],T.of([]),A.of([]),P.of([_()]),[i.Z9.fromClass(class{constructor(e){e.scrollDOM.tabIndex=0,e.scrollDOM.setAttribute("role","region"),e.scrollDOM.setAttribute("aria-labelledby",g)}})],i.Lz.contentAttributes.of({"aria-labelledby":`${g} focus-trap-help-panel`}),i.Lz.editorAttributes.of({class:j?"hide-help-until-focus":""}),i.Lz.editorAttributes.of({class:w?"hide-help":""})];return(u&&(t.push((0,i.A)()),t.push([i.Lz.domEventHandlers({"upload:editor:change":C,"upload:editor:cursor":N})])),c&&t.push(i.Lz.editorAttributes.of({"data-hpc":"true"})),d)?t.push(s.$t.readOnly.of(!0)):t.push([function(e,t,n){let a=new s.xx;return[a.of(n?t:[]),i.w4.of([{key:e,run:function(e){let n=a.get(e.state)===t;return e.dispatch({effects:a.reconfigure(n?[]:t)}),!0}}])]}("Shift-Ctrl-m",i.w4.of([q]),!0),(0,H.G)(function(){let e=document.createElement("div"),t=e=>{let t=document.createElement("kbd");return t.textContent=e,t};return e.append("Use ",t("Control + Shift + m")," to toggle the ",t("tab")," key moving focus. Alternatively, use ",t("esc")," then ",t("tab")," to move to the next interactive element on the page."),e.className="cm-help-panel",e.id="focus-trap-help-panel",e}(),w?"top":"bottom")]),t.push(...e),t},[O,F,h,a,T,A,P,g,j,w,u,c,d,e]);return(0,r.useEffect)(()=>{let e=m.current;if(!e)return;let t=s.$t.create({doc:f,extensions:$}),n=new i.Lz({state:t,parent:e});return I?.(n),k.current=n,()=>{n.destroy(),S?.(n)}},[]),(0,r.useEffect)(()=>{k.current&&(k.current.dispatch({effects:A.reconfigure([])}),k.current.dispatch({effects:s.Pe.reconfigure.of($)}))},[A,$]),(0,r.useEffect)(()=>{if(k.current&&void 0!==f){let e=k.current.state.doc.toString()||"",t=f||"";t!==e&&k.current.dispatch({changes:{from:0,to:e.length,insert:t}})}},[f]),(0,r.useEffect)(()=>{let e=async()=>{let e=t.split(".").pop()||"",n=e?o.e.find(n=>n.extensions.includes(e)||n.filename&&n.filename.test(t)):void 0;if(n&&k.current){var a;let e=(a=n.name,W.includes(a.toLowerCase())?V[a.toLowerCase()]:null);e&&k.current.dispatch({effects:P.reconfigure(_(e))}),"Markdown"===n.name?(k.current.dispatch({effects:T.reconfigure((0,l.markdown)({base:l.markdownLanguage}))}),k.current.dispatch({effects:s.Pe.reconfigure.of([...E,...$])}),k.current.dispatch({effects:A.reconfigure([D.E,(0,R.yU)({override:[async e=>(function(e,t=[]){let n=e.matchBefore(/:\w+/);if(!n||n&&n.from===n.to&&!e.explicit)return null;let a=t.filter(e=>-1!==e.name.indexOf(n.text.replace(":",""))).map(e=>({label:e.name,apply:e.emoji||`:${e.name}:`,type:e.src}));return{from:n.from,to:n.to,options:a,filter:!1}})(e,await M())],icons:!1,addToOptions:[{render:e=>{let t=document.createElement("img");return t.className="emoji emoji-result mr-2",t.height=20,t.width=20,t.alt=`:${e.label}:`,t.src=e.type,t.setAttribute("async",""),t},position:0}]}),s.Nb.highest(i.w4.of([{key:"Tab",run:R.$w}]))])})):(k.current.dispatch({effects:A.reconfigure([])}),k.current.dispatch({effects:T.reconfigure(await n.load())}))}};k.current&&e()},[t,T,A,$,P]),k}({parentRef:y,value:n,height:u,width:m,extensions:(0,r.useMemo)(()=>[...c,i.w4.of(d)],[c,d]),...f});return(0,r.useImperativeHandle)(t,()=>({editor:y.current,view:x.current}),[y,x]),h?.current&&x&&(window.requestAnimationFrame(()=>{x.current&&!x.current.hasFocus&&x.current.focus()}),h.current=!1),(0,a.jsx)("div",{className:g,ref:y})});Q.displayName="CodeMirror";let J=Q},47173:(e,t,n)=>{n.d(t,{P:()=>o});var a=n(74848),i=n(37827),r=n(7426);let s={ambientErrorBanner:"AmbientErrorBanner-module__ambientErrorBanner--iXbHt",largeBorderRadius:"AmbientErrorBanner-module__largeBorderRadius--Qk23B",mediumBorderRadius:"AmbientErrorBanner-module__mediumBorderRadius--dREtI"};function o({ambientError:e,useLargerBorderRadius:t=!1}){let n=(0,r.b)(),o=t?s.largeBorderRadius:s.mediumBorderRadius;return(0,a.jsx)(i.l,{className:`${s.ambientErrorBanner} ${o}`,description:e.message,variant:"critical",title:"Error during copilot chat has occurred.",hideTitle:!0,onDismiss:()=>{n.dismissAmbientError()}})}try{o.displayName||(o.displayName="AmbientErrorBanner")}catch{}},75507:(e,t,n)=>{n.d(t,{r:()=>eU,B:()=>eL});var a,i=n(74848),r=n(21728),s=n(5796),o=n(47584),l=n(38621),c=n(5420),d=n(63867),u=n(55847),m=n(62456),p=n(84217),h=n(46309),g=n(47139);let f={"contacts-container":"Contact-module__contacts-container--agbyj","contact-list":"Contact-module__contact-list--rJuRJ","contact-container":"Contact-module__contact-container--hYL0Q","contact-info-container":"Contact-module__contact-info-container--gGPwl"},y={monogram:"Monogram-module__monogram--gRaga"},x=e=>{let t;let n=(0,r.c)(2),{initials:a}=e;return n[0]!==a?(t=(0,i.jsx)("div",{className:y.monogram,children:a}),n[0]=a,n[1]=t):t=n[1],t};try{x.displayName||(x.displayName="Monogram")}catch{}let v=e=>{let t,n,a,s,o;let l=(0,r.c)(14),{size:c,information:d}=e,u=void 0===c?48:c;return l[0]!==d.avatar_url||l[1]!==d.username||l[2]!==u?(t=d.avatar_url?(0,i.jsx)(m.r,{square:!0,size:u,src:d.avatar_url,alt:d.username||"User avatar"}):(0,i.jsx)(x,{initials:d.username.charAt(0)}),l[0]=d.avatar_url,l[1]=d.username,l[2]=u,l[3]=t):t=l[3],l[4]!==d.username?(n=(0,i.jsx)(p.A,{as:"h2",variant:"small",children:d.username}),l[4]=d.username,l[5]=n):n=l[5],l[6]!==d.rank?(a=(0,i.jsx)(h.B,{direction:"horizontal",wrap:"wrap",children:(0,i.jsx)(g.A,{children:d.rank},d.rank)}),l[6]=d.rank,l[7]=a):a=l[7],l[8]!==n||l[9]!==a?(s=(0,i.jsxs)("div",{className:f["contact-info-container"],children:[n,a]}),l[8]=n,l[9]=a,l[10]=s):s=l[10],l[11]!==t||l[12]!==s?(o=(0,i.jsxs)("div",{className:f["contact-container"],children:[t,s]}),l[11]=t,l[12]=s,l[13]=o):o=l[13],o},_=e=>{let t,n,a;let s=(0,r.c)(5),{contacts:o}=e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)(p.A,{as:"h1",variant:"medium",children:"Who to talk to"}),s[0]=t):t=s[0],s[1]!==o?(n=o?.map(b),s[1]=o,s[2]=n):n=s[2],s[3]!==n?(a=(0,i.jsxs)("div",{className:f["contacts-container"],children:[t,(0,i.jsx)("div",{className:f["contact-list"],children:n})]}),s[3]=n,s[4]=a):a=s[4],a};try{v.displayName||(v.displayName="Contact")}catch{}try{_.displayName||(_.displayName="ContactList")}catch{}function b(e){return(0,i.jsx)(v,{information:e},e.id)}let j={"spinner-container":"CopilotMetadata-module__spinner-container--RKoek","tab-container":"CopilotMetadata-module__tab-container--DMNby",muted:"CopilotMetadata-module__muted--rz00u","metadata-container":"CopilotMetadata-module__metadata-container--oWP34","referrer-button":"CopilotMetadata-module__referrer-button--FJeFp"};var C=n(49339),N=n(57572),w=n(96540);let I=({setLoading:e,issueNumber:t,makeCAPIRequest:n,fileContext:a})=>{let[i,r]=(0,w.useState)([]),{repoOwner:s,repoName:o,ref:l,path:c}=a??{},d=(0,w.useCallback)(async()=>{try{if(!a)return"";let e=await (0,N.lS)(`/${s}/${o}/collaborator_prompt/${c}?ref=${l}${t?`&issue=${t}`:""}`);if(!e.ok)throw Error("Something went wrong");let i=await e.text(),r=new C.J([]),d=await r.getAuthToken(),u=await n({basePath:"https://api.githubcopilot.com",body:{messages:[{role:"user",content:i}],model:"gpt-4o-mini",stream:!1,response_format:{type:"json_schema",json_schema:{name:"Collaborators",description:"List of metadata objects for the top collaborators",strict:!0,schema:{type:"object",additionalProperties:!1,properties:{collaborators:{type:"array",items:{type:"object",additionalProperties:!1,properties:{id:{type:"integer",description:"The collaborator's GitHub user ID."},username:{type:"string",description:"The collaborator's GitHub handle."},avatar_url:{type:"string",description:"The URL of the collaborator's GitHub user avatar."},rank:{type:"string",description:"The rank assignment of the collaborator."},explanation:{type:"string",description:"A brief 1-2 sentence description of the rank assignment."}},required:["id","username","avatar_url","rank","explanation"]}}},required:["collaborators"]}},temperature:0}},path:"/chat/completions",method:"POST",streamingResponse:!1,authToken:d,integrationId:"copilot-directory"});if(!u.ok)throw Error("Something went wrong");let m=await u.json();return m.choices[0]?.message?.content}catch{throw Error("Something went wrong")}},[]);return(0,w.useEffect)(()=>{i?.length||d().then(t=>{e(!1),r(JSON.parse(t)?.collaborators)},()=>{e(!1)})},[]),{collaborators:i,getCollaborators:d}},S=e=>{let t,n,a,m,p,h,g,f,y,x,v,b,C,N,w;let S=(0,r.c)(44),{currentTab:k,setCurrentTab:T,loading:A,setLoading:E,makeCAPIRequest:R,fileContext:P}=e,D=void 0===A||A,L=P?.repoOwner,M=P?.repoName;S[0]===Symbol.for("react.memo_cache_sentinel")?(t=new URLSearchParams(o.cg?.location.search).get("issue")||"",S[0]=t):t=S[0];let O=t;S[1]!==L||S[2]!==M?(n=L&&M&&O?(0,s.dRG)({owner:L,repo:M,issueNumber:Number(O)}):void 0,S[1]=L,S[2]=M,S[3]=n):n=S[3];let B=n;S[4]!==P||S[5]!==R||S[6]!==E?(a={fileContext:P,setLoading:E,issueNumber:O,makeCAPIRequest:R},S[4]=P,S[5]=R,S[6]=E,S[7]=a):a=S[7];let{collaborators:F}=I(a);S[8]!==B?(m=()=>{B&&(window.location.href=B)},S[8]=B,S[9]=m):m=S[9];let $=m,U="chat"===k?"page":void 0;S[10]!==T?(p=()=>T("chat"),S[10]=T,S[11]=p):p=S[11],S[12]!==U||S[13]!==p?(h=(0,i.jsx)(c.O.Item,{"aria-current":U,onSelect:p,children:"Chat"}),S[12]=U,S[13]=p,S[14]=h):h=S[14];let z="directory"===k?"page":void 0;S[15]!==F?.length||S[16]!==D||S[17]!==T?(g=()=>{!D&&F?.length&&T("directory")},S[15]=F?.length,S[16]=D,S[17]=T,S[18]=g):g=S[18],S[19]!==F?.length?(f=F?.length?{}:{className:j.muted},S[19]=F?.length,S[20]=f):f=S[20];let V=F?.length||D?"Directory":"Directory unavailable";return S[21]!==f||S[22]!==V?(y=(0,i.jsx)("span",{...f,children:V}),S[21]=f,S[22]=V,S[23]=y):y=S[23],S[24]!==D?(x=D&&(0,i.jsx)("div",{className:j["spinner-container"],children:(0,i.jsx)(d.A,{size:"small"})}),S[24]=D,S[25]=x):x=S[25],S[26]!==y||S[27]!==x?(v=(0,i.jsxs)("div",{className:j["tab-container"],children:[y,x]}),S[26]=y,S[27]=x,S[28]=v):v=S[28],S[29]!==g||S[30]!==v||S[31]!==z?(b=(0,i.jsx)(c.O.Item,{"aria-current":z,onSelect:g,children:v}),S[29]=g,S[30]=v,S[31]=z,S[32]=b):b=S[32],S[33]!==b||S[34]!==h?(C=(0,i.jsxs)(c.O,{"aria-label":"Repository",children:[h,b]}),S[33]=b,S[34]=h,S[35]=C):C=S[35],S[36]!==F||S[37]!==k||S[38]!==B||S[39]!==$?(N="directory"===k&&(0,i.jsxs)("div",{className:j["metadata-container"],children:[(0,i.jsx)("div",{children:(0,i.jsx)(_,{contacts:F})}),B&&(0,i.jsx)("div",{className:j["referrer-button"],children:(0,i.jsx)(u.Q,{variant:"link",leadingVisual:l.ArrowLeftIcon,onClick:$,children:`Return to Issue${O?` ${O}`:""}`})})]}),S[36]=F,S[37]=k,S[38]=B,S[39]=$,S[40]=N):N=S[40],S[41]!==C||S[42]!==N?(w=(0,i.jsxs)("div",{children:[C,N]}),S[41]=C,S[42]=N,S[43]=w):w=S[43],w};try{S.displayName||(S.displayName="CopilotMetadata")}catch{}var k=n(75632),T=n(4460),A=n(46988),E=n(38568),R=n(75177),P=n(52464),D=n(30729),L=n(2120),M=n(39363),O=n(82610),B=n(93589),F=n(77342),$=n(2622),U=n(65615),z=n(7426),V=n(27297),W=n(56212),H=n(47173);let q={legalText:"Chat-module__legalText--wsTEU"};var G=n(42157),K=n(78176),Q=n(56056),J=n(26871),Z=n(72160),X=n(15385);let Y={ActionList_Heading:"CopilotSuggestions-module__ActionList_Heading--ArthG"},ee=({suggestionKind:e})=>{let t=(0,U.Pk)(),n=(0,z.b)(),a=(0,w.useCallback)(e=>{n.sendChatMessage({thread:n.getSelectedThread(t),content:e.prompt??e.question,intent:e.intent,modeOverride:e.mode,references:t.currentReferences,topic:t.currentTopic,context:t.context}),(0,A.BI)("copilot_generated_suggestion_click",{intent:e.intent,mode:e.mode,contextType:t.context?.[0]?.type,content:e.question})},[n,t]),r=(0,w.memo)(function({suggestion:e}){return(0,i.jsxs)(X.l.Item,{onSelect:()=>a(e),sx:{mx:0,border:"1px solid",borderColor:"border.default",width:"fit-content"},children:[(0,i.jsx)(X.l.LeadingVisual,{children:(0,i.jsx)(D.A,{icon:l.PaperAirplaneIcon})}),(0,i.jsxs)("span",{children:[" ",e.question]})]})}),s="loading"===t.messagesLoading.state||!!t.streamingMessage,{suggestions:o}=t,c=t.currentReferences[0],d=1===t.currentReferences.length&&c?.type==="repository"&&c.id===t.currentRepository?.id;return!s&&($.W.topicsAsReferences?d:!t.showTopicPicker&&0===t.currentReferences.length)&&o&&o.suggestions?(0,i.jsxs)(X.l,{className:"copilot-suggestions",sx:{pt:0,pb:3,display:"flex",gap:2,flexDirection:"column"},children:["initial"===e&&(0,i.jsx)(X.l.Heading,{as:"h2",className:Y.ActionList_Heading,children:function(e){return e?`Ask about the ${e.replace(/-/g," ")}:`:"Ask anything:"}(o.referenceType)}),o?.suggestions.map(e=>i.jsx(r,{suggestion:e},e.question))]}):null},et=(0,w.memo)(ee);try{ee.displayName||(ee.displayName="CopilotSuggestions")}catch{}try{(a=CopilotSuggestion).displayName||(a.displayName="CopilotSuggestion")}catch{}var en=n(97891),ea=n(89401),ei=n(2914),er=n(10871),es=n(87330);let eo={container:"CustomBanner-module__container--uV55s",expanded:"CustomBanner-module__expanded--fDTFJ",actions:"CustomBanner-module__actions--tUuz0",iconButton:"CustomBanner-module__iconButton--WWgYX",content:"CustomBanner-module__content--xhiU7",icon:"CustomBanner-module__icon--WrRHA"};function el({icon:e,content:t,actions:n,onDismiss:a}){let r=(0,w.useRef)(null),[s,o]=(0,w.useState)(!1);return(0,w.useEffect)(()=>{let e=r.current;if(!e)return;let t=new ResizeObserver(t=>{for(let n of t)n.target===e&&(n.contentRect.height>40?o(!0):o(!1))});return t.observe(e),()=>{t.disconnect()}},[]),(0,i.jsxs)("div",{ref:r,className:`${eo.container} ${s?eo.expanded:""}`,children:[(0,i.jsx)("div",{className:eo.icon,children:e}),(0,i.jsx)("div",{className:eo.content,children:t}),(0,i.jsxs)("div",{className:eo.actions,children:[n,a&&(0,i.jsx)(es.K,{className:eo.iconButton,variant:"invisible",icon:l.XIcon,size:"medium","aria-label":"Close",onClick:a})]})]})}try{el.displayName||(el.displayName="CustomBanner")}catch{}function ec(){let{resetDate:e}=(0,ei.xR)(),t=(0,i.jsx)(l.InfoIcon,{}),n=(0,i.jsxs)(i.Fragment,{children:["You have reached your free plan limit. It will reset on ",e]}),a=(0,i.jsx)(er.z,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,A.BI)("dotcom_chat.activate",{target:"QUOTA_EXCEEDED_BANNER_LINK_UPGRADE",mode:"assistive"})},children:"Upgrade"});return(0,i.jsx)(el,{icon:t,content:n,actions:a})}try{ec.displayName||(ec.displayName="QuotaExceededBanner")}catch{}var ed=n(34614);let eu={container:"QuotaExceededEmptyState-module__container--ZMWEG",main:"QuotaExceededEmptyState-module__main--g2hJz",hero:"QuotaExceededEmptyState-module__hero--IrY09",copy:"QuotaExceededEmptyState-module__copy--VyrMt",heading:"QuotaExceededEmptyState-module__heading--LzJGU",description:"QuotaExceededEmptyState-module__description--KbMyl",footer:"QuotaExceededEmptyState-module__footer--evZ9_"};function em(){let{resetDate:e}=(0,ei.xR)();return(0,i.jsxs)("div",{className:eu.container,children:[(0,i.jsxs)("div",{className:eu.main,children:[(0,i.jsx)("img",{className:eu.hero,src:"/images/modules/copilot-immersive-v1/hero.png",alt:"Hero"}),(0,i.jsxs)("div",{className:eu.copy,children:[(0,i.jsx)("h2",{className:eu.heading,children:"You\u2019ve reached your free plan limit"}),(0,i.jsxs)("p",{className:eu.description,children:["Your limits will reset on ",e,"."]}),(0,i.jsx)(er.z,{as:"a",variant:"primary",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,A.BI)("dotcom_chat.activate",{target:"QUOTA_EXCEEDED_EMPTY_STATE_LINK_UPGRADE",mode:"assistive"})},children:"Upgrade"})]})]}),(0,i.jsxs)("div",{className:eu.footer,children:[(0,i.jsx)("strong",{children:"Part of an organization?"}),(0,i.jsxs)("span",{children:["Upgrade to"," ",(0,i.jsx)(ed.A,{href:"https://github.com/github-copilot/business_signup/choose_business_type?cft=copilot_li.features_copilot.cfb",inline:!0,children:"Copilot Business"})," ","to enable across teams."]})]})]})}try{em.displayName||(em.displayName="QuotaExceededEmptyState")}catch{}var ep=n(37937);let eh={container:"QuotaMeterBanner-module__container--QJsKZ"};function eg(){let{isLicensedLimited:e,chatQuotaRemaining:t}=(0,ei.xR)(),[n,a]=(0,w.useState)(()=>ep.J.getMeterBannerFlag()??!1);if((0,w.useEffect)(()=>{if(e&&void 0!==t){let e=ep.J.getMeterBannerFlag();t>0&&t<=10?null===e?(ep.J.setMeterBannerFlag(!0),a(!0)):a(e):(ep.J.removeMeterBannerFlag(),a(!1))}},[e,t]),!n||void 0===t)return null;let r=(0,i.jsx)(l.InfoIcon,{}),s=(0,i.jsx)(i.Fragment,{children:"You only have a few free responses remaining."}),o=(0,i.jsx)(er.z,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,A.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"assistive"})},children:"Upgrade"});return(0,i.jsx)("div",{className:eh.container,children:(0,i.jsx)(el,{icon:r,content:s,actions:o,onDismiss:()=>{ep.J.setMeterBannerFlag(!1),a(!1)}})})}try{eg.displayName||(eg.displayName="QuotaMeterBanner")}catch{}var ef=n(10967);function ey(){let{currentTopic:e}=(0,U.Pk)(),t=(0,O.P)(e),n=(0,O.Z6)(e),a=null;e&&n&&(a=`${e.ownerLogin}/${e.name}`);let r=t?e.repos:a?[a]:[],[s,o]=(0,ef.M8)(r),l=s.requestStatus===ef.xG.CanIndex&&(n&&s.code===ef.W5.Unindexed||t&&s.docs===ef.W5.Unindexed),c=(0,w.useRef)(!1);return(0,w.useEffect)(function(){let e=t?s.docs:s.code;!c.current&&e===ef.W5.Unindexed&&l&&(c.current=!0,o())},[s.code,s.docs,t,l,o]),(0,i.jsx)(i.Fragment,{})}try{ey.displayName||(ey.displayName="TopicIndexedMessage")}catch{}var ex=n(34164);let ev={container:"TopicIndicatorFlash-module__container--gbqCC",containerAssistive:"TopicIndicatorFlash-module__containerAssistive--y3Nwm",icon:"TopicIndicatorFlash-module__icon--sOj3C",status:"TopicIndicatorFlash-module__status--cIez4",removeButton:"TopicIndicatorFlash-module__removeButton--MuZqW",assistive:"TopicIndicatorFlash-module__assistive--ZNjQ0",mobileOnly:"TopicIndicatorFlash-module__mobileOnly--KLDnQ",nonMobileOnly:"TopicIndicatorFlash-module__nonMobileOnly--Jyc_q"};function e_({icon:e,topic:t,additionalNonMobileActions:n,mobileActions:a,removeButtonRef:r}){let s=(0,z.b)(),{mode:o,currentReferences:c,selectedThreadID:d}=(0,U.Pk)(),u=(0,O.Z6)(t)?`${t.ownerLogin}/${t.name}`:t.name;return(0,i.jsxs)("div",{className:(0,ex.$)(ev.container,{[ev.containerAssistive]:"immersive"!==o}),children:[(0,i.jsx)("span",{className:ev.icon,children:e}),(0,i.jsx)("span",{children:u}),(0,i.jsx)("span",{style:{flex:1}}),(0,i.jsx)("div",{className:(0,ex.$)(ev.nonMobileOnly,ev.status),children:void 0!==n&&(0,i.jsx)(i.Fragment,{children:n})}),void 0!==a&&(0,i.jsx)("div",{className:ev.mobileOnly,children:a}),(0,i.jsx)(es.K,{icon:l.XIcon,variant:"invisible",size:"small","aria-label":"Remove topic",onClick:()=>{ep.J.setSelectedTopic(d??"",null),s.clearCurrentTopic(),s.clearCurrentReferences(["image","issue"]);let e=[];for(let n of c)t&&((0,O.SI)(n)||(0,O.Zn)(n))&&n.repoID===t.id&&e.push(n);s.removeReferences(e)},className:(0,ex.$)(ev.removeButton,{[ev.assistive]:"assistive"===o}),ref:r})]})}try{e_.displayName||(e_.displayName="TopicIndicatorFlash")}catch{}function eb(){let{currentTopic:e}=(0,U.Pk)(),t=(0,U.pn)(e=>e.currentReferences.find(e=>"docset"===e.type)),n=e??t,a=(0,w.useRef)(null);return n?(0,i.jsx)(e_,{icon:(0,i.jsx)(l.RepoIcon,{}),topic:n,removeButtonRef:a}):null}try{eb.displayName||(eb.displayName="TopicIndicator")}catch{}var ej=n(37824),eC=n(8932);function eN({mode:e}){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.A,{sx:{height:"3rem",mb:2,display:"flex",justifyContent:"center"},children:(0,i.jsx)(eC.A,{})}),(0,i.jsx)(p.A,{as:"h1",sx:{textAlign:"center",fontSize:3,mb:2},children:"Ask Copilot"}),(0,i.jsx)(P.A,{as:"p",sx:{textAlign:"center",color:"fg.muted",mb:"immersive"===e?5:3,px:3,textWrap:"balance"},children:"Select a repository to get started. Ask questions about your codebase to get answers fast and learn your way around."})]})}try{eN.displayName||(eN.displayName="ChatWithCopilotHeader")}catch{}function ew({docset:e,size:t}){return(0,i.jsx)(m.r,{src:e.avatarUrl,square:"organization"===e.ownerType,size:t})}try{ew.displayName||(ew.displayName="KnowledgeBaseAvatar")}catch{}var eI=n(70170),eS=n(9591),ek=n(41980),eT=n(96558),eA=n(59010);function eE(){let e=(0,z.b)(),{mode:t,selectedThreadID:n}=(0,U.Pk)(),[a,r]=(0,w.useState)(""),s=(0,eI.s)(e=>r(e),400,{start:!1}),{repositories:o,loading:c,resetTopRepoResults:u}=(0,ek.U)(a,!0,4),m=(0,w.useCallback)(async a=>{if(u(),void 0===a){e.showTopicPicker(!1),e.clearCurrentTopic(),e.clearCurrentReferences(),"immersive"===t&&(0,T.kd)("/copilot"),n&&ep.J.setSelectedTopic(n,null);return}await e.fetchCurrentRepo(Number(a)),e.showTopicPicker(!1)},[u,e,t,n]),p=(0,w.useMemo)(()=>c?"Loading repositories":0===o.length?"No repositories found":1===o.length?"1 repository found":`${o.length} repositories found`,[c,o.length]);return(0,i.jsxs)(R.A,{sx:{border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:2,display:"flex",flexDirection:"column",mb:3},children:[(0,i.jsx)(R.A,{sx:{p:3,pb:0},children:(0,i.jsx)(eS.A,{id:eT.uN,leadingVisual:l.SearchIcon,name:"topic-search","aria-label":"Search repositories to chat about",placeholder:"Search repositories to chat about",onChange:e=>s(e.target.value),sx:{width:"100%","input:placeholder-shown":{textOverflow:"ellipsis"}}})}),(0,i.jsxs)(X.l,{children:[(0,i.jsx)("div",{role:"status",className:"sr-only",children:p}),c?(0,i.jsx)(R.A,{as:"li",sx:{display:"flex",justifyContent:"center",py:2,height:"190px",alignItems:"center"},children:(0,i.jsx)(d.A,{})}):0===o.length?(0,i.jsxs)(X.l.Item,{disabled:!0,children:[(0,i.jsx)(X.l.LeadingVisual,{sx:{color:"fg.muted"},children:(0,i.jsx)(l.CircleSlashIcon,{})}),(0,i.jsx)(P.A,{sx:{color:"fg.muted"},children:"No results found"})]}):(0,i.jsx)(i.Fragment,{children:o.length>0&&(0,i.jsxs)(X.l.Group,{children:[(0,i.jsx)(X.l.GroupHeading,{as:"h3",children:"Recent repositories"}),o.map(e=>(0,i.jsx)(eA.W,{repo:e,onSelect:m,trailingVisualComponent:(0,i.jsx)(l.ArrowRightIcon,{})},e.nwo))]})}),(0,i.jsx)(X.l.Divider,{sx:{marginInline:0}}),(0,i.jsxs)(X.l.Item,{id:"chat-with-no-context",onSelect:()=>m(void 0),sx:{"#chat-with-no-context--label":{marginBottom:"0px !important"}},children:["General purpose chat",(0,i.jsx)(X.l.TrailingVisual,{children:(0,i.jsx)(l.ArrowRightIcon,{})})]},"chat-with-no-context")]})]})}try{eE.displayName||(eE.displayName="TopicList")}catch{}let eR=()=>{let e=(0,U.Pk)(),t=(0,w.useMemo)(()=>e.ssoOrganizations?e.ssoOrganizations.map(e=>e.login):[],[e.ssoOrganizations]);return(0,i.jsx)(R.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1,height:"100%"},children:(0,i.jsxs)(R.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,i.jsx)(eN,{mode:e.mode}),(0,i.jsx)(R.A,{sx:{px:3,"> button":{m:"0 auto"}},children:(0,i.jsx)(eE,{})}),(0,i.jsx)(ej.x,{portalContainerName:ea.E5,protectedOrgs:t,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${location.href}`,sx:{mx:3,mb:3}}),(0,i.jsx)(eP,{currentTopic:e.currentTopic})]})})};function eP({currentTopic:e}){return(0,O.P)(e)?(0,i.jsx)(R.A,{sx:{mt:3,mb:4},children:(0,i.jsx)(eD,{docset:e})}):null}function eD({docset:e}){return(0,i.jsxs)(R.A,{sx:{display:"flex",flexDirection:"column",gap:3,border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"var(--borderRadius-large)",padding:3},children:[(0,i.jsxs)(R.A,{sx:{display:"flex",alignItems:"baseline",gap:2},children:[(0,i.jsx)(ew,{docset:e,size:24}),(0,i.jsx)(p.A,{as:"h3",sx:{fontSize:1,m:0},children:e.name})," ",(0,i.jsx)(P.A,{sx:{fontSize:0,color:"fg.muted"},children:"Knowledge base added to conversation"})]}),(0,i.jsx)(p.A,{as:"h4",sx:{fontSize:0,m:0,color:"fg.muted",fontWeight:"500"},children:"Repositories in this knowledge base"}),(0,i.jsx)(R.A,{sx:{display:"flex",flexWrap:"wrap",gap:3},children:e.repos.map(e=>(0,i.jsxs)(R.A,{sx:{whiteSpace:"nowrap"},children:[(0,i.jsx)(l.RepoIcon,{}),` ${e}`]},e))})]})}try{eR.displayName||(eR.displayName="TopicPicker")}catch{}try{eP.displayName||(eP.displayName="TopicDescription")}catch{}try{eD.displayName||(eD.displayName="DocsetDescription")}catch{}let eL=({disableTopicPicker:e,inputRef:t,showQuotaExceededEmptyState:n})=>{let a=(0,U.Pk)(),{showTopicPicker:r,streamingMessage:s}=a,o="immersive"===a.mode,{scrollToBottom:l}=(0,J.b)(),{messages:c,groupedMessages:d}=(0,M.a)(a);return(0,E.N)(()=>l("instant"),[l]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{className:"sr-only",children:"Copilot Chat"}),n?(0,i.jsx)(em,{}):r&&!e?(0,i.jsx)(eR,{}):(0,i.jsx)(R.A,{sx:{display:"flex",flexDirection:"column",minHeight:"0",flexGrow:1},children:(0,i.jsxs)(R.A,{className:"copilot-messages-container",sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[0===c.length&&(0,i.jsx)("p",{className:q.legalText,children:(0,i.jsx)(en.h,{})}),!o&&!$.W.topicsAsReferences&&(0,i.jsx)(ey,{}),d.map((e,n)=>(0,i.jsx)(Q.i,{isLastGroup:n===d.length-1,children:e.map((r,o)=>{let l=n===d.length-1&&o===e.length-1;return(r===s||r.id===F.Wp||!eM(r)||!$.W.dotcomChatClientSideSkills||r.error||eB(r,l,a))&&(0,i.jsx)(K.c,{isLatestMessage:l,isFirstReply:1===c.length,isStreaming:r.id===s?.id,message:r,inputRef:t},o)})},n)),a.clientSkillConfirmation&&$.W.dotcomChatClientSideSkills&&(0,i.jsx)("div",{className:"m-3",children:(0,i.jsx)(Z.m,{confirmation:a.clientSkillConfirmation,handleConfirmation:e=>a.clientSkillConfirmation?.onSubmit?.("accepted"===e.state),isLatestMessage:!0})})]})})]})},eM=e=>!e.content&&(!e.confirmations||0===e.confirmations.length)&&(!e.clientConfirmations||0===e.clientConfirmations.length),eO=e=>e.clientSkillsRequests&&e.clientSkillsRequests.length>0||e.clientToolResults&&e.clientToolResults.length>0,eB=(e,t,n)=>eO(e)&&t&&!n.streamingMessage&&!n.clientSkillConfirmation,eF=()=>(0,i.jsxs)(R.A,{sx:{m:"auto",display:"flex",flexDirection:"column",alignItems:"center",height:"100%",justifyContent:"center"},children:[(0,i.jsx)(d.A,{size:"large"}),(0,i.jsx)(R.A,{sx:{p:3,color:"fg.subtle"},children:"Loading conversation\u2026"})]}),e$=()=>{let{mode:e,reviewLab:t}=(0,U.Pk)();return(0,i.jsxs)(R.A,{sx:{display:"flex",gap:"2",alignItems:"center",py:3,pr:3,pl:"immersive"===e?3:2,color:"fg.subtle"},children:[(0,i.jsx)(D.A,{icon:l.AlertIcon}),"Failed to load previous messages.",t&&(0,i.jsx)(i.Fragment,{children:"\xa0You are in a review lab. Please check that you are connected to the Developer VPN."})]})},eU=({inputRef:e})=>{let t=(0,U.Pk)(),n=(0,z.b)(),{currentReferences:a,messagesLoading:r,messagesRestored:s,threadsLoading:o,currentTopic:l,messages:c,mode:d,selectedThreadID:u,showTopicPicker:m,context:p}=t,h=n.getSelectedThread(t),g=(0,w.useMemo)(()=>(0,O.k4)(Object.keys(W.Pe)).slice(0,4).map(e=>({heading:e,content:(0,O.k4)(W.Pe[e])[0]})),[]),{textAreaRef:f}=(0,L.Y)(e),{chatQuotaExceeded:y,isLicensedLimited:x,reloadQuota:v}=(0,ei.xR)(),{ambientError:_}=(0,U.Pk)(),[b,j]=(0,w.useState)(!0),[C,N]=(0,w.useState)("chat"),I=(0,k.G7)("copilot_metadata_poc"),E=!!p&&p[0]&&("file"===p[0].type||"file-v2"===p[0].type),P=(0,V.GF)(t.availableModels);(0,w.useEffect)(()=>{if(!u||"assistive"===d)return;let e=`${O.Jz}/c/${u}`;window.location.pathname!==e&&0!==c.length&&(0,T.kd)(e)},[u,d,c.length]);let D=(0,w.useCallback)(async e=>{""!==e.trim()&&(v(),await n.sendChatMessage({thread:h,content:e,references:a,topic:l,context:p,customInstructions:t.customInstructions,skillOptions:t.skillOptions,model:P}))},[v,n,h,a,l,p,t.customInstructions,t.skillOptions,P]),M=s&&c.length>0,F="loading"===r.state&&t.selectedThreadID&&!m&&!M,q="error"===r.state||"error"===o.state,K="loaded"===r.state||M,Q=y&&(m||!h),[Z]=(0,w.useState)(t.renderAttachKnowledgeBaseHerePopover),X=(0,B.B)(c),Y=!!(!F&&!t.currentTopic&&!m&&0===X.length&&!Z&&0===a.length);return(0,i.jsxs)(i.Fragment,{children:[I&&E&&(0,i.jsx)(S,{fileContext:p[0],loading:b,setLoading:j,currentTab:C,setCurrentTab:N,makeCAPIRequest:O.p}),(!I||!!I&&"chat"===C)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(J.$,{className:"copilot-chat-messages",style:{flex:"1 1 auto"},children:[F&&(0,i.jsx)(eF,{}),q&&(0,i.jsx)(e$,{}),K&&!F&&(0,i.jsx)(eL,{inputRef:f,showQuotaExceededEmptyState:Q}),(0,i.jsx)(ea.Cb,{})]}),Y&&(0,i.jsx)(R.A,{className:"copilot-chat-messages",sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,px:3,mb:3,scrollbarGutter:"stable"},children:g.map((e,a)=>(0,i.jsx)(ez,{heading:e.heading,content:e.content,onSubmit:()=>{n.sendChatMessage({thread:n.getSelectedThread(t),content:e.content,references:t.currentReferences,topic:t.currentTopic,context:t.context}),(0,A.BI)("copilot_chat_suggestion_click",{topic:t.currentTopic?.name})}},a))}),!F&&!m&&!Q&&(0,i.jsx)(R.A,{className:"copilot-chat-input copilot-chat-input-outer",sx:{display:"flex",flexDirection:"column",mt:"auto",px:3,pb:3,zIndex:1},children:y?(0,i.jsx)(ec,{}):(0,i.jsxs)(i.Fragment,{children:[!Y&&0===X.length&&!t.showTopicPicker&&(0,i.jsx)(et,{suggestionKind:"initial"}),(0,i.jsxs)("div",{children:[x&&(0,i.jsx)(eg,{}),_&&(0,i.jsx)(H.P,{ambientError:_}),!$.W.topicsAsReferences&&(0,i.jsx)(eb,{}),(0,i.jsx)(G.V,{textAreaRef:f,onSubmit:D,isStreaming:!!t.streamingMessage,size:"small"},u)]})]})})]}),(0,i.jsx)(ea.zc,{})]})};function ez({heading:e,content:t,onSubmit:n}){return(0,i.jsxs)(u.Q,{sx:{bg:"canvas.default",height:"auto",minWidth:"auto",borderBottom:"1px solid",borderColor:"border.default",border:"1px solid var(--borderColor-default, var(--color-border-default))",flex:"1 1 49%",display:"flex",flexDirection:"column",justifyContent:"center",p:2},onClick:n,children:[(0,i.jsx)(p.A,{as:"h3",sx:{textAlign:"center",fontSize:1,m:0,mb:1,wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:e}),(0,i.jsx)(P.A,{as:"p",sx:{fontSize:0,fontWeight:400,textAlign:"center",color:"fg.muted",m:0,textWrap:"balance",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:t})]})}try{eL.displayName||(eL.displayName="Messages")}catch{}try{eF.displayName||(eF.displayName="Loading")}catch{}try{e$.displayName||(e$.displayName="Error")}catch{}try{eU.displayName||(eU.displayName="Chat")}catch{}try{ez.displayName||(ez.displayName="SuggestedPrompt")}catch{}},1088:(e,t,n)=>{n.d(t,{o:()=>c});var a=n(74848),i=n(34164),r=n(96540);let s={chatImageAttachment:"ChatImage-module__chatImageAttachment--A31NV",squareView:"ChatImage-module__squareView--z0mEJ",fullView:"ChatImage-module__fullView--n3xkp",userAttachedImage:"ChatImage-module__userAttachedImage--fpKCB",overlay:"ChatImage-module__overlay--KqENn",overlayScreen:"ChatImage-module__overlayScreen--QlNhZ",expandIcon:"ChatImage-module__expandIcon--B0sBN"};function o({className:e,size:t}){return(0,a.jsx)("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",width:t||14,height:t||14,fill:"none",viewBox:"0 0 14 14",role:"presentation",children:(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M13.672 5.342a.8.8 0 0 0 .05-.295V.805a.75.75 0 0 0-.75-.75H8.73a.75.75 0 0 0 0 1.5h2.433L8.138 4.577A.75.75 0 0 0 9.2 5.638l3.024-3.023v2.432a.75.75 0 0 0 1.45.295M.328 8.657a.8.8 0 0 0-.05.295v4.243a.75.75 0 0 0 .75.75h4.243a.75.75 0 0 0 0-1.5H2.838l3.024-3.023A.75.75 0 1 0 4.8 8.362l-3.024 3.023V8.952a.75.75 0 0 0-1.45-.295",clipRule:"evenodd"})})}try{o.displayName||(o.displayName="ExpandIcon")}catch{}let l=({src:e,alt:t,onClick:n,useOverlay:l,mode:c,squareView:d})=>{let[u,m]=(0,r.useState)(!1);return(0,a.jsxs)("div",{className:(0,i.$)(s.chatImageAttachment,d?s.squareView:s.fullView,{assistive:"assistive"===c}),children:[(0,a.jsx)("img",{className:(0,i.$)(s.userAttachedImage,d?s.squareView:s.fullView),src:e,alt:t}),(0,a.jsx)("a",{href:e,className:(0,i.$)(s.overlay,{hovered:u,[s.squareView]:d}),onClick:n,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),"aria-label":"Open image thumbnail",target:"_blank",rel:"noreferrer",children:l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:s.overlayScreen}),(0,a.jsx)(o,{className:s.expandIcon,size:20})]})})]})},c=(0,r.memo)(l);try{l.displayName||(l.displayName="ChatImageUnmemoized")}catch{}try{c.displayName||(c.displayName="ChatImage")}catch{}},42157:(e,t,n)=>{n.d(t,{V:()=>tc});var a,i=n(74848),r=n(46988),s=n(53949),o=n(11499),l=n(38621),c=n(65556),d=n(55847),u=n(34164),m=n(96540),p=n(94747),h=n(57572),g=n(7426);let f=e=>{switch(e){case"issue":return"issue";case"pull-request":return"pull_request";case"discussion":return"discussion";case"file":return"file"}},y=RegExp("^(?:http:\\/\\/github\\.localhost|https:\\/\\/github\\.com)\\/(?<repo>[^/]+\\/[^/]+)\\/(?<type>issues|pull|discussions)\\/(?<id>[^/]+)"),x=RegExp("^@(?<repo>[\\w-.]+\\/[\\w-.]+)(?:\\/(?<type>\\w+)\\/(?<id>.+))?$"),v={fromUrlType(e){switch(e){case"issues":return"issue";case"pull":return"pull-request";case"discussions":return"discussion";case"files":return"file";case void 0:return"repository"}}},_={fromUrl(e){let t=y.exec(e)?.groups;if(!t)return;let{repo:n="",type:a,id:i}=t,r=v.fromUrlType(a);return r?{repo:n,type:r,id:i}:void 0},stringify(e){switch(e.type){case"issue":return`@${e.repo}/issues/${e.id??""}`;case"pull-request":return`@${e.repo}/pull/${e.id??""}`;case"discussion":return`@${e.repo}/discussions/${e.id??""}`;case"repository":return`@${e.repo}`;case"file":return`@${e.repo}/files/${e.id??""}`}},parse(e){let t=x.exec(e)?.groups;if(!t)return;let n=v.fromUrlType(t.type);return n?{repo:t.repo,type:n,id:t.id}:void 0},refersTo(e,t){switch(e.type){case"repository":return"repository"===t.type&&`${t.ownerLogin}/${t.name}`===e.repo;case"discussion":return"discussion"===t.type&&`${t.repository.owner}/${t.repository.name}`===e.repo&&t.number.toString()===e.id;case"issue":return"issue"===t.type&&`${t.repository.owner}/${t.repository.name}`===e.repo&&t.number.toString()===e.id;case"pull-request":return"pull-request"===t.type&&`${t.repository.ownerLogin}/${t.repository.name}`===e.repo&&t.number.toString()===e.id;case"file":return("file"===t.type||"folder"===t.type)&&`${t.repoOwner}/${t.repoName}`===e.repo&&t.path===e.id;default:return!1}}},b=/^(?:https:\/\/)?(?:www\.)?(figma\.com\/.+)$/,j=class FigmaNotAuthorizedError extends Error{constructor(){super(),this.name="FigmaNotAuthorizedError"}};var C=n(38568),N=n(47767),w=n(84976),I=n(37937);let S=({manager:e})=>[{label:"Delete conversation",command:"delete",icon:l.TrashIcon,requiresParams:!1,action:async(t,n)=>{e.dispatch({type:"SLASH_COMMANDS_LOADING"});try{let t=e.getSelectedThread(n);if(!t)throw Error("Thread not found");await e.deleteThread(t),(0,r.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_DELETE_THREAD",mode:n.mode}),e.dispatch({type:"SLASH_COMMANDS_LOADED"})}catch{e.dispatch({type:"SLASH_COMMANDS_ERROR"})}}},{label:"Rename conversation",command:"rename",icon:l.PencilIcon,requiresParams:!0,action:async(t,n)=>{e.dispatch({type:"SLASH_COMMANDS_LOADING"});try{let a=e.getSelectedThread(n);if(!a)throw Error("Thread not found");await e.renameThread(a,t),(0,r.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_RENAME",mode:n.mode}),e.dispatch({type:"SLASH_COMMANDS_LOADED"})}catch{e.dispatch({type:"SLASH_COMMANDS_ERROR"})}}},{label:"Start a new conversation",command:"new",icon:l.PlusIcon,requiresParams:!1,action:async(t,n)=>{e.dispatch({type:"SLASH_COMMANDS_LOADING"});try{await e.selectThread(null),(0,r.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_NEW_THREAD",mode:n.mode}),e.dispatch({type:"SLASH_COMMANDS_LOADED"})}catch{e.dispatch({type:"SLASH_COMMANDS_ERROR"})}}}],k=async(e,t,n)=>{if((e[0]??"")!=="/")return!1;e=e.substring(1);let a=S({manager:n}).filter(t=>{let n=(e.split(" ",1)[0]??"").toLowerCase().trim();return t.command.toLowerCase().includes(n)});if(1!==a.length)return!1;let i=a[0],r=e.substring(i.command.length).trim();return await i.action(r,t),!0};var T=n(65615);function A(e,t,n){if("immersive"===e&&("/copilot"===t||"/copilot/"===t)){let e=n.get("prompt");if(e)return e}}var E=n(96558),R=n(2622),P=n(39046),D=n(5271),L=n(48186),M=n(68956),O=n(89323),B=n(15385),F=n(22678),$=n(82610),U=n(21057),z=n(62456);function V({onSelectPanel:e,onSelectAgent:t}){let{availableAgents:n,showLimit:a,disabled:s,loading:o}=(0,U.JE)(),c=n&&n.length>0;return o?(0,i.jsxs)(B.l.Item,{disabled:!0,children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.MentionIcon,{})}),"Extension"]}):s?(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_NOT_SUPPORTED",mode:"immersive"}),e("agents-not-supported")},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.MentionIcon,{})}),"Extension\u2026"]}):c?(0,i.jsxs)(O.W,{children:[(0,i.jsx)(O.W.Anchor,{children:(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION",mode:"immersive"})},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.MentionIcon,{})}),"Extension"]})}),(0,i.jsx)(O.W.Overlay,{width:"small",children:(0,i.jsxs)(B.l,{children:[n.map(e=>(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_SELECTED",mode:"immersive"}),t(e)},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(z.r,{src:e.avatarUrl})}),e.name,(0,i.jsxs)(B.l.Description,{variant:"inline",truncate:!0,children:[U.Z3,e.slug]}),a&&(0,i.jsx)(B.l.Description,{variant:"block",children:"Start a new conversation to use other extensions."})]},e.slug)),(0,i.jsx)(B.l.Divider,{}),(0,i.jsxs)(B.l.LinkItem,{href:U.bn,onClick:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_MARKETPLACE",mode:"immersive"})},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.TelescopeIcon,{})}),"Marketplace",(0,i.jsx)(B.l.TrailingVisual,{children:(0,i.jsx)(l.LinkExternalIcon,{})})]})]})})]}):(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_NOT_AVAILABLE",mode:"immersive"}),e("no-agents-available")},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.MentionIcon,{})}),"Extension\u2026"]})}try{V.displayName||(V.displayName="AgentMenu")}catch{}var W=n(72100),H=n(75177),q=n(34614),G=n(27331),K=n(27297);function Q({onClose:e}){return(0,i.jsx)(G.l,{width:"large",title:"Extensions",position:{narrow:"fullscreen",regular:"center"},onClose:e,renderBody:()=>(0,i.jsx)(H.A,{sx:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center",justifyContent:"center",px:4,py:8,flex:1,height:"100%"},children:(0,i.jsxs)(H.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,color:"fg.muted"},children:[(0,i.jsx)(l.TelescopeIcon,{size:24}),(0,i.jsx)(H.A,{as:"h3",sx:{fontSize:2,fontWeight:"bold",mt:2,color:"fg.default"},children:"Chat with your favorite tools and services"}),(0,i.jsx)(H.A,{as:"p",sx:{fontSize:1,fontWeight:"normal"},children:"Browse the marketplace to find extensions for the tools and services you rely on"}),(0,i.jsx)(d.Q,{as:"a",href:U.bn,children:"Browse marketplace"}),(0,i.jsx)(H.A,{sx:{mt:2},children:(0,i.jsx)(q.A,{href:"https://gh.io/copilot-extensions-docs",children:"Documentation"})})]})})})}function J({onClose:e}){let t=(0,g.b)(),n=(0,T.Pk)(),a=(0,W.BV)(),r=(0,K.GF)(n.availableModels);return(0,i.jsx)(G.l,{width:"large",title:"Extensions",position:{narrow:"fullscreen",regular:"center"},onClose:e,renderBody:()=>(0,i.jsx)(H.A,{sx:{display:"flex",flexDirection:"column",textAlign:"center",px:4,py:10,height:"100%",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)(H.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,color:"fg.muted"},children:[(0,i.jsx)(H.A,{sx:{display:"flex",color:"attention.fg"},children:(0,i.jsx)(l.AlertIcon,{size:24})}),(0,i.jsxs)(H.A,{as:"h3",sx:{fontSize:2,fontWeight:"bold",mt:2,color:"fg.default"},children:[a?"Copilots and extensions":"Extensions"," aren't supported by this model"]}),(0,i.jsxs)(H.A,{as:"p",sx:{fontSize:1,fontWeight:"normal"},children:["Switch back to the ",r.displayName," model or start a new conversation"]}),(0,i.jsx)(d.Q,{onClick:()=>{t.selectThread(null),t.selectModel(r)},children:"New conversation"})]})})})}try{Q.displayName||(Q.displayName="NoAgentsAvailableDialog")}catch{}try{J.displayName||(J.displayName="AgentsNotSupportedDialog")}catch{}var Z=n(80688),X=n(87330),Y=n(3830),ee=n(85349),et=n(84217),en=n(52464),ea=n(30631),ei=n(30729),er=n(40961);let es={disabledForPreviewModelsPanel:"KnowledgeSelectPanel-module__disabledForPreviewModelsPanel--NqDvF"},eo=(0,m.forwardRef)(function({open:e,setOpen:t,...n},a){return(0,i.jsx)(X.K,{ref:a,"aria-expanded":!!e||void 0,"aria-haspopup":!0,"aria-label":"Attach knowledge base","aria-labelledby":void 0,icon:l.BookIcon,onClick:()=>t(!e),sx:{color:"fg.muted"},variant:"invisible",...n})});function el({disabledForPreviewModelsProps:e,emptyKnowledgeBaseProps:t,open:n,onOpenChange:a,anchorRef:r}){let o=(0,T.Pk)(),l=(0,g.b)(),c=(0,Z.A)("localStorage"),{knowledgeBases:d}=o,[u,p]=(0,m.useState)([]),[h,f]=(0,m.useState)(!0),[y,x]=(0,m.useState)(""),v=(0,m.useRef)(null),_=c.getItem("lastUsedKnowledgeBaseId")||"",b=c.getItem("lastUsedKnowledgeBaseOrg")||"",{currentReferences:j}=o;(0,m.useEffect)(()=>{n||x("")},[n]);let C=(0,m.useMemo)(()=>""===y?d:d.filter(e=>e.name.toLowerCase().includes(y.toLowerCase())),[y,d]),N=(0,m.useMemo)(()=>C.reduce((e,t)=>{let n=e.find(e=>e.org===t.ownerLogin);return n?n.docsets.push(t):e.push({org:t.ownerLogin,docsets:[t]}),e},[]),[C]),[w,S]=(0,m.useState)(!1),k=h||"pending"===o.knowledgeBasesLoading.state,A=w||"error"===o.knowledgeBasesLoading.state;(0,m.useEffect)(()=>{let e=async()=>{f(!0),await l.fetchKnowledgeBases();let e=await l.service.listAdministratedCopilotEnterpriseOrganizations();e.ok?p(e.payload||[]):S(!0),f(!1)};n&&e()},[n]);let E=ep(),P=e=>{l.dismissAttachKnowledgeBaseHerePopover(),l.clearCurrentReferences(["image","issue"]),l.clearCurrentTopic(),o.selectedThreadID&&I.J.setSelectedTopic(o.selectedThreadID,null);let t=(0,$.UU)(e);l.addReference(t,"docsetMenu"),c.setItem("lastUsedKnowledgeBaseId",e.id),c.setItem("lastUsedKnowledgeBaseOrg",e.ownerLogin)},D=e=>{let t=e.filter(e=>(0,$.P)(e)&&!j.some(t=>(0,$.P)(t)&&t.id===e.id));for(let t of j.filter(t=>(0,$.P)(t)&&!e.some(e=>e.id===t.id)))l.removeReference(t);for(let e of t)l.addReference((0,$.UU)(e),"docsetMenu")};if(o.model?.hasLimitedCapabilities)return(0,i.jsx)(eg,{open:n,setOpen:a,...e});if(!k&&0===d.length)return(0,i.jsx)(ec,{administratedCopilotEnterpriseOrganizations:u,persistentPanelStyles:{position:["fixed","fixed","absolute"],bottom:["60px","60px","0 !important"],"@media screen and (max-height: 480px)":{bottom:"0 !important"},top:"initial !important",left:["18px","18px","calc(50% - 360px) !important"],maxHeight:"100%"},open:n,setOpen:a,mode:o.mode,...t});let L=e=>{if(R.W.topicsAsReferences)D(e.map(e=>d.find(t=>t.id===e.id)).filter(e=>void 0!==e));else{let t=e?d.find(t=>t.id===e.id):void 0;t&&e&&P(t)}},M=C.sort((e,t)=>e.id===_?-1:t.id===_?1:0).map(e=>({id:e.id,key:e.id,groupId:e.ownerLogin,text:e.name,description:e.description,disabled:!e.canChat,descriptionVariant:"block"})),O=[...N].sort((e,t)=>e.org===b?-1:t.org===b?1:0).map(e=>({id:e.org,key:e.org,text:e.org,groupId:e.org,header:{title:e.org}})),B=d.filter(e=>j.some(t=>(0,$.P)(t)&&t.id===e.id)),F={selected:B.length>0?B[0]:void 0,onSelectedChange:e=>L(e)};return(0,i.jsx)("div",{ref:v,...(0,s.G)("knowledge-select-panel"),children:(0,i.jsx)(Y.X,{title:R.W.topicsAsReferences?"Select knowledge bases":"Select a knowledge base",subtitle:"Knowledge bases consolidate content from multiple repositories for an improved chat experience.",onCancel:()=>{(0,er.flushSync)(()=>a(!1)),r.current?.focus()},open:n,renderAnchor:null,anchorRef:r,onOpenChange:a,loading:k,items:M,onFilterChange:x,groupMetadata:O,notice:null!==E?{text:E,variant:"info"}:void 0,message:A?{variant:"error",title:"Failed to load knowledge bases",body:"Try again later"}:0===N.length?{variant:"empty",title:`No knowledge bases found for \`${y}\``,body:"Try a different search term"}:void 0,...R.W.topicsAsReferences?{selected:B,onSelectedChange:e=>L(e)}:F,variant:"modal",overlayProps:{maxHeight:"xlarge"},width:"large"})})}function ec({administratedCopilotEnterpriseOrganizations:e,anchorRef:t,open:n,setOpen:a}){let r=ep(),o=t?{anchorRef:t,renderAnchor:null}:{anchorRef:void 0,renderAnchor:({...e})=>(0,i.jsx)(eo,{open:n,setOpen:a,...e})},c=e?.length===0;return(0,i.jsx)(ee.T,{open:n,onOpen:()=>a(!0),onClose:()=>a(!1),overlayProps:{anchorSide:"outside-bottom",sx:{width:"min(100%, 350px)"}},...o,children:(0,i.jsxs)(H.A,{role:"dialog","aria-labelledby":"knowledge-base-dialog-title",sx:{display:"flex",flexDirection:"column",...c?{height:"100%"}:{}},...(0,s.G)("empty-knowledge-base-picker"),children:[(0,i.jsx)(H.A,{sx:{borderBottom:"1px solid",borderColor:"border.muted"},children:(0,i.jsxs)(H.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:2,px:3},children:[(0,i.jsx)(et.A,{id:"knowledge-base-dialog-title",as:"h4",sx:{fontSize:1},children:"Attach a knowledge base"}),(0,i.jsx)(X.K,{unsafeDisableTooltip:!0,"aria-label":"Close",icon:l.XIcon,variant:"invisible",onClick:()=>a(!1)})]})}),(0,i.jsxs)(H.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:3,pt:3,...c?{flexGrow:1,maxHeight:"100%",overflowY:"auto"}:{}},children:[(0,i.jsx)(ei.A,{icon:l.BookIcon,size:"medium",sx:{color:"fg.muted"}}),(0,i.jsxs)(H.A,{sx:{gap:2,display:"flex",alignItems:"center",flexDirection:"column",...c?{maxHeight:"100%"}:{}},children:[(0,i.jsx)(en.A,{sx:{fontSize:1,fontWeight:600},children:"You don't have any knowledge bases"}),(0,i.jsxs)(H.A,{sx:{color:"fg.muted",textAlign:"center",fontSize:0,px:3},children:[(0,i.jsx)("p",{children:"Knowledge bases consolidate content from multiple repositories for an improved chat experience."}),c&&(0,i.jsx)(en.A,{as:"p",sx:{mt:3,mb:4},...(0,s.G)("ask-admin-for-knowledge-base"),children:"Speak with an organization owner about creating a knowledge base for your organization."})]}),e.length>0&&(0,i.jsx)(ed,{administratedCopilotEnterpriseOrganizations:e})]})]}),r&&(0,i.jsx)(H.A,{sx:{borderTop:"1px solid",borderColor:"border.muted",px:2,py:3},children:(0,i.jsx)(em,{message:r})})]})})}function ed({administratedCopilotEnterpriseOrganizations:e}){return 1===e.length?(0,i.jsx)(d.Q,{as:"a",href:eh(e[0]),sx:{mb:4},...(0,s.G)("create-knowledge-base-button"),children:"Create a knowledge base"}):(0,i.jsxs)(H.A,{sx:{width:"100%",textAlign:"left",borderTop:"1px solid",borderColor:"border.muted",pt:3},...(0,s.G)("create-knowledge-base-dropdown"),children:[(0,i.jsx)(et.A,{as:"h3",sx:{fontSize:0,color:"fg.muted",pl:3},children:"Create a knowledge base for an organization"}),(0,i.jsx)(B.l,{sx:{maxHeight:"160px",overflow:"scroll"},children:e.map(e=>(0,i.jsx)(eu,{org:e},e.id))})]})}function eu({org:e}){return(0,i.jsx)(B.l.Item,{children:(0,i.jsxs)(q.A,{sx:{flex:1,color:"fg.default"},href:eh(e),children:[(0,i.jsx)(z.r,{square:!0,src:e.avatarUrl,alt:e.login,sx:{mr:2},"aria-hidden":"true"}),(0,i.jsx)(ea.A,{inline:!0,title:e.login,sx:{minWidth:"80%"},children:e.login})]})})}function em({message:e}){return e?(0,i.jsx)(H.A,{"data-testid":"knowledge-select-panel-sso",sx:{color:"fg.muted",fontSize:0,ml:2},children:e}):null}function ep(){let e=(0,T.Pk)(),t=e.ssoOrganizations.map(e=>e.login);for(let n of e.knowledgeBases)for(let e of n.protectedOrganizations)t.includes(e)||t.push(e);if(!t||0===t.length)return null;if(1===t.length)return`Single sign-on to see content from ${t[0]}.`;if(2===t.length)return`Single sign-on to see content from ${t[0]} and ${t[1]}.`;{let e=t.length-2;return`Single sign-on to see content from ${t[0]}, ${t[1]}, and ${e} organization${e>1?"s":""}`}}function eh(e){return`/organizations/${e.login}/settings/copilot/chat_settings/new`}function eg({anchorRef:e,open:t,setOpen:n}){let a=e?{anchorRef:e,renderAnchor:null}:{anchorRef:void 0,renderAnchor:({...e})=>(0,i.jsx)(eo,{open:t,setOpen:n,...e})};return(0,i.jsx)(ee.T,{open:t,onOpen:()=>n(!0),onClose:()=>n(!1),...a,children:(0,i.jsxs)("div",{className:(0,u.$)("m-3 d-flex flex-column flex-items-center text-center",es.disabledForPreviewModelsPanel),children:[(0,i.jsx)(l.AlertIcon,{className:"fgColor-attention mb-3"}),(0,i.jsx)("h3",{className:"h5 mb-2",children:"Knowledge bases aren't supported by this model"}),(0,i.jsx)("span",{className:"text-small fgColor-muted",children:"Switch back to the GPT-4o model or start a new conversation"})]})})}try{eo.displayName||(eo.displayName="KBIconButton")}catch{}try{(a=KBIconButtonInner).displayName||(a.displayName="KBIconButtonInner")}catch{}try{el.displayName||(el.displayName="KnowledgeSelectPanel")}catch{}try{ec.displayName||(ec.displayName="EmptyKnowledgeBase")}catch{}try{ed.displayName||(ed.displayName="CreateKnowledgeBaseButton")}catch{}try{eu.displayName||(eu.displayName="CreateKnowledgeBaseActionRow")}catch{}try{em.displayName||(em.displayName="SSOFooter")}catch{}try{eg.displayName||(eg.displayName="DisabledForPreviewModels")}catch{}var ef=n(89401),ey=n(70170),ex=n(61597),ev=n(97286);async function e_(e,t,n,a){return new Promise((i,r)=>{if(!window.Worker){setTimeout(()=>i(e.filter(e=>e.includes(t))));return}let s=new Worker(n);s.addEventListener("message",e=>i(e.data.list)),s.addEventListener("error",e=>r(Error(`Worker error: ${e.message}`))),a.addEventListener("abort",()=>{s.terminate(),r(Error("Worker aborted"))}),s.postMessage({baseList:e,query:t})})}function eb(e,t){let{findFileWorkerPath:n}=(0,T.Pk)();return(0,ev.I)({queryKey:["copilot-worker-filter",n,e,t],queryFn:async({signal:a})=>e?0===t.length?e:e_(e,t,n,a):[],enabled:null!==e,staleTime:1/0,gcTime:1e4,networkMode:"always",retry:!1,placeholderData:e=>e})}function ej(e,t=!0){let n=(0,g.b)();return(0,ev.I)({enabled:null!==e,queryKey:["copilot-repository-files",e,t],queryFn:async()=>{if(!e)return{};let a=await n.service.listRepoFiles(e,t);if(!a.ok)throw Error("Failed to fetch files for repository");return a.payload},staleTime:3e5})}function eC(e,t){let n=(0,g.b)();return(0,ev.I)({enabled:null!==e&&t.length>0,queryKey:["copilot-repository-symbols",e,t],queryFn:async()=>{if(!e)return[];let a=await n.service.querySymbols(e,t);if(!a.ok)throw Error("Failed to fetch symbols for repository");return a.payload.filter(e=>!!e.symbol)}})}var eN=n(1750);let ew={chooseRepoInstructionPanel:"ReferencesSelectPanel-module__chooseRepoInstructionPanel--ZB4TR",chooseRepoTitle:"ReferencesSelectPanel-module__chooseRepoTitle--WR2cM",chooseRepoSubtitle:"ReferencesSelectPanel-module__chooseRepoSubtitle--D5U0G"};var eI=n(61818);let eS="Search",ek=e=>{let t=e.includes("files"),n=e.includes("folders"),a=e.includes("symbols");return t&&n&&a?"Select files, folders, and symbols":t&&n?"Select files and folders":t&&a?"Select files and symbols":n&&a?"Select folders and symbols":t?"Select files":n?"Select folders":a?"Select symbols":"Select references"},eT=(e,t)=>{let n=t.includes("files"),a=t.includes("folders"),i=t.includes("symbols"),r="references";return n&&a&&i?r="files, folders, and symbols":n&&a?r="files and folders":n&&i?r="files and symbols":a&&i?r="folders and symbols":n?r="files":a?r="folders":i&&(r="symbols"),`Choose ${r} from ${e} to chat about. Use fewer references for more accurate responses.`},eA=e=>{let t=e.includes("files"),n=e.includes("folders"),a=e.includes("symbols");return t&&n&&a?"Fetching files, folders, and symbols\u2026":t&&n?"Fetching files and folders\u2026":t&&a?"Fetching files and symbols\u2026":n&&a?"Fetching folders and symbols\u2026":t?"Fetching files\u2026":n?"Fetching folders\u2026":a?"Fetching symbols\u2026":"Fetching references\u2026"},eE=e=>{let t=e.includes("files"),n=e.includes("folders"),a=e.includes("symbols"),i="References";return t&&n&&a?i="Files, folders, and symbols":t&&n?i="Files and folders":t&&a?i="Files and symbols":n&&a?i="Folders and symbols":t?i="Files":n?i="Folders":a&&(i="Symbols"),i},eR=e=>{let t=e.includes("files"),n=e.includes("folders"),a=e.includes("symbols");return t&&n&&a?"Choose a repository to browse for files, folders, and symbols.":t&&n?"Choose a repository to browse for files and folders.":t&&a?"Choose a repository to browse for files and symbols.":n&&a?"Choose a repository to browse for folders and symbols.":t?"Choose a repository to browse for files.":n?"Choose a repository to browse for folders.":a?"Choose a repository to browse for symbols.":"Choose a repository to browse for references."},eP=e=>{let t=e.includes("files"),n=e.includes("folders"),a=e.includes("symbols");return t&&n&&a?"No files, folders, or symbols found":t&&n?"No files or folders found":t&&a?"No files or symbols found":n&&a?"No folders or symbols found":t?"No files found":n?"No folders found":a?"No symbols found":"No references found"},eD=({open:e,onOpenChange:t,...n})=>{let{currentTopic:a}=(0,T.Pk)();return(0,$.Z6)(a)?(0,i.jsx)(eO,{...n,open:e,onOpenChange:t,sourceRepository:a}):(0,i.jsx)(eB,{open:e,setOpen:t})},eL=({open:e,onOpenChange:t,cancelReturnFocusRef:n,submitReturnFocusRef:a,...r})=>{let s=(0,g.b)(),[o,l]=(0,m.useState)();(0,m.useEffect)(()=>l(void 0),[e]);let c=new Set((0,T.pn)(e=>e.currentReferences).filter(e=>"repository"===e.type).map(e=>e.id)),[d,u]=(0,m.useState)(),p=(0,m.useRef)(!1),h=async e=>{u(void 0),p.current=!0;let t=await s.service.fetchRepo(e);t.ok?l(t.payload):u("Error: failed to load repository details. Please try again."),p.current=!1},f=eR(r.supportedReferenceTypes??eM);return o?(0,i.jsx)(eO,{...r,open:e,onOpenChange:t,sourceRepository:o,cancelReturnFocusRef:n,submitReturnFocusRef:a}):(0,i.jsx)(eI.X1,{selectionVariant:"instant",open:e,onOpenChange:e=>{p.current||t(e)},selectedRepoIds:new Set,onSelectRepo:h,cancelReturnFocusRef:n,submitReturnFocusRef:a,description:f,featuredRepoIds:c,error:d})},eM=["files","folders","symbols"],eO=({renderAnchor:e,anchorRef:t,open:n,onOpenChange:a,submitReturnFocusRef:r,cancelReturnFocusRef:s,sourceRepository:o,supportedReferenceTypes:l=eM})=>{let[c,d]=(0,m.useState)(""),u=(0,m.useRef)((0,ey.s)(d,250));(0,m.useEffect)(()=>{n||d("")},[n]);let{initialLoading:p,filterLoading:h,selected:f,unselected:y,toggleSelection:x}=function(e,t,n,a=eM){let i=(0,T.Pk)(),r=(0,g.b)(),s=function(e,t,n,a=eM){let i=a.includes("folders"),r=a.includes("symbols"),s=a.includes("files"),o=n?t:null,l=ej(o,i),c=eb(l.data?.paths??null,e),d=eb(l.data?.directories??null,e),u=eC(r?o:null,e),m=eb(u.data?.map(e=>$.Sm(e))??null,e),p=[...s?c.data?.slice(0,7).map(e=>({type:"file",text:e}))??[]:[],...i?d.data?.slice(0,7).map(e=>({type:"folder",text:e}))??[]:[],...m.data?.slice(0,7).map(e=>({type:"symbol",text:e}))??[]],h=null===c.data&&null===d.data&&null===u.data;return{items:p,filterLoading:l.isFetching||c.isFetching||d.isFetching||u.isFetching||m.isFetching,initialLoading:h}}(t,n,e,a),o=a.includes("symbols"),l=eC(e&&o?n:null,t).data,[c,d,u]=(0,m.useMemo)(()=>{let e=new Set,t=new Set,a=new Set;for(let r of i.currentReferences)"file"===r.type&&r.repoOwner===n?.ownerLogin&&r.repoName===n?.name?e.add(r.path):"folder"===r.type&&r.repoOwner===n?.ownerLogin&&r.repoName===n?.name?t.add(r.path):"symbol"===r.type&&"suggestionSymbol"===r.kind&&r.suggestionDefinitions?.some(e=>e.repoOwner===n?.ownerLogin&&e.repoName===n?.name)&&a.add(r.name);return[e,t,a]},[i.currentReferences,n?.ownerLogin,n?.name]),{selected:p=[],unselected:h=[]}=(0,eN.O)(s.items,e=>{switch(e.type){case"file":return c.has(e.text)?"selected":"unselected";case"folder":return d.has(e.text)?"selected":"unselected";case"symbol":return u.has(e.text)?"selected":"unselected"}}),f=(0,m.useCallback)(e=>{let t;if(!n)return;switch(e.type){case"file":t=(0,$.Od)(e.text,n);break;case"folder":t=(0,$.OC)(e.text,n);break;case"symbol":{let a=l?.find(t=>$.Sm(t)===e.text);if(!a)return;t=(0,$.Qt)(a,n)}}let a=(0,$.Vb)(t),s=i.currentReferences.find(e=>a===(0,$.Vb)(e));s?r.removeReference(s):r.addReference(t,"references-menu")},[r,n,i.currentReferences,l]);return{...s,selected:p,unselected:h,toggleSelection:f}}(n,c,o,l),v=f.length+y.length,_=`${o.ownerLogin}/${o.name}`;return(0,i.jsxs)(H.A,{sx:{flexGrow:"0 !important"},children:[e?.({}),(0,i.jsxs)(ex.X,{anchorRef:t,title:ek(l),description:eT(_,l),onCancel:()=>{(0,er.flushSync)(()=>a(!1)),r.current?.focus()},onSubmit:()=>{(0,er.flushSync)(()=>a(!1)),s.current?.focus()},open:n,selectionVariant:"multiple",variant:"modal",width:"large",maxHeight:"xlarge",children:[(0,i.jsx)(ex.X.Header,{children:(0,i.jsx)(ex.X.SearchInput,{loading:h,onChange:e=>u.current(e.target.value),placeholder:eS,"aria-label":eS})}),(0,i.jsx)(B.l,{sx:{minHeight:340},children:p?(0,i.jsx)(ex.X.Loading,{children:eA(l)}):0!==v||h?(0,i.jsxs)(i.Fragment,{children:[f.map(e=>(0,i.jsx)(e$,{item:e,selected:!0,toggleSelection:x},eF(e))),f.length>0&&y.length>0&&(0,i.jsx)(B.l.Divider,{}),y.map(e=>(0,i.jsx)(e$,{item:e,selected:!1,toggleSelection:x},eF(e)))]}):(0,i.jsx)(ex.X.Message,{variant:"empty",title:eP(l),children:"Try a different search term"})})]})]})};function eB({open:e,setOpen:t,renderAnchor:n}){return(0,i.jsx)(ee.T,{open:e,onOpen:()=>t(!0),onClose:()=>t(!1),renderAnchor:e=>n?.(e)??(0,i.jsx)(i.Fragment,{}),children:(0,i.jsxs)("div",{className:ew.chooseRepoInstructionPanel,children:[(0,i.jsx)(l.PaperclipIcon,{}),(0,i.jsx)("h3",{className:ew.chooseRepoTitle,children:"Attach a repository first"}),(0,i.jsx)("p",{className:ew.chooseRepoSubtitle,children:"To pick attachments, attach a repository where the files are stored."})]})})}let eF=e=>`${e.type}#${e.text}`;function e$({toggleSelection:e,selected:t,item:n}){return(0,i.jsxs)(B.l.Item,{onSelect:()=>{e(n),setTimeout(()=>{document.getElementById(eF(n))?.focus()})},selected:t,"aria-checked":t,id:eF(n),sx:{mx:2,'&[data-is-active-descendant="activated-directly"]':{backgroundColor:"transparent",outline:"2px solid var(--focus-outlineColor, var(--color-accent-emphasis))",outlineOffset:"-2px"}},children:[(0,i.jsx)(B.l.LeadingVisual,{children:"symbol"===n.type?(0,i.jsx)(l.CodeSquareIcon,{}):"folder"===n.type?(0,i.jsx)(l.FileDirectoryFillIcon,{}):(0,i.jsx)(l.FileIcon,{})}),(0,i.jsx)(H.A,{sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:n.text})]})}try{eD.displayName||(eD.displayName="TopicReferencesSelectPanel")}catch{}try{eL.displayName||(eL.displayName="MultistepReferencesSelectPanel")}catch{}try{eO.displayName||(eO.displayName="ReferencesSelectPanel")}catch{}try{eB.displayName||(eB.displayName="ChooseRepositoryInstruction")}catch{}try{e$.displayName||(e$.displayName="ReferenceListItem")}catch{}let eU=(0,m.memo)(({panel:e,onPanelChange:t,anchorRef:n,...a})=>{let{inputRef:o}=a,c=(0,g.b)(),d=(0,T.Pk)(),{supportedAttachmentTypes:u,supportedReferenceTypes:p}=function(){let e=(0,T.Pk)(),{model:t}=(0,T.bP)("model"),n=null!==(0,F.d)(),a=[],i=!!R.W.topicsAsReferences||(0,$.Z6)(e.currentTopic),r=e.renderKnowledgeBases&&(e.currentTopic&&(0,$.Z6)(e.currentTopic)||!e.currentTopic),s=R.W.attachImagesImmersive&&"immersive"===e.mode&&!!t.capabilities.supports.vision||!1,o=R.W.pasteTextFiles;return n||a.push("repositories"),i&&a.push("references"),r&&!n&&a.push("knowledge-bases"),(s||o)&&a.push("upload"),n||a.push("agents"),{supportedAttachmentTypes:a,supportedReferenceTypes:n?["files"]:["files","folders","symbols"]}}(),{model:h}=(0,T.bP)("model"),f=R.W.attachImagesImmersive&&"immersive"===d.mode&&!!h.capabilities.supports.vision||!1,y=R.W.attachMultipleImages,x=R.W.pasteTextFiles,v=(0,U.kw)(a),_=(0,m.useRef)(null),b=(0,F.d)();return(0,i.jsxs)("div",{children:[u.includes("upload")&&(0,i.jsx)("input",{id:"image-uploader",...(0,s.G)("image-uploader"),hidden:!0,ref:_,type:"file",accept:[f?P.s.getAllowedImageFileExtensions(h):"",x?L.E.getTextFileExtensions():""].join(","),multiple:x||y,onChange:e=>{if(!e.target.files)return;let[t,n]=P.s.getAllowedFiles([...e.target.files],h),a=[];if(f?new P.s(d,c).addImageAttachments(t,"menu",b):a.push(...t),x)for(let e of n)new L.E(c).addAttachment(e);else a.push(...n);for(let e of a)(0,r.BI)("dotcom_chat.upload_unsupported_file",{name:e.name,type:e.type,size:e.size});e.currentTarget.value=""}}),(0,i.jsx)(O.W,{anchorRef:n,open:"attachment-types"===e,onOpenChange:e=>t(t=>e&&null===t?"attachment-types":e||"attachment-types"!==t?t:null),children:(0,i.jsx)(O.W.Overlay,{width:"small",side:"outside-top",align:"start",portalContainerName:"assistive"===d.mode?ef.E5:void 0,children:(0,i.jsxs)(B.l,{children:[u.includes("repositories")&&(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_REPOSITORIES",mode:d.mode}),t("repositories")},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.RepoIcon,{})}),R.W.topicsAsReferences?"Repositories":"Repository","\u2026"]}),(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_REFERENCES",mode:d.mode}),t("references")},inactiveText:u.includes("references")?void 0:"First attach a repository",children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.FileCodeIcon,{})}),eE(p),"\u2026"]}),u.includes("knowledge-bases")&&(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_KNOWLEDGE_BASES",mode:d.mode}),t("knowledge-bases")},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.BookIcon,{})}),(0,i.jsxs)("span",{...(0,s.G)("knowledge-bases-action-list-item"),children:[R.W.topicsAsReferences?"Knowledge bases":"Knowledge base","\u2026"]})]}),u.includes("upload")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(B.l.Divider,{}),(0,i.jsxs)(B.l.Item,{onSelect:()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_IMAGES",mode:d.mode}),t(null),_.current?.click()},children:[(0,i.jsx)(B.l.LeadingVisual,{children:x?(0,i.jsx)(l.UploadIcon,{}):(0,i.jsx)(l.ImageIcon,{})}),x?"Upload from computer":"Image\u2026"]})]}),u.includes("agents")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(B.l.Divider,{}),(0,i.jsx)(V,{onSelectPanel:e=>t(e),onSelectAgent:e=>setTimeout(()=>v(e.slug))})]})]})})}),R.W.topicsAsReferences?(0,i.jsx)(eL,{open:"references"===e,onOpenChange:e=>t(e?"references":null),submitReturnFocusRef:o,cancelReturnFocusRef:n,supportedReferenceTypes:p}):(0,i.jsx)(eD,{open:"references"===e,onOpenChange:e=>t(e?"references":null),submitReturnFocusRef:o,cancelReturnFocusRef:n,supportedReferenceTypes:p}),R.W.topicsAsReferences?(0,i.jsx)(eI.FZ,{open:"repositories"===e,onOpenChange:e=>t(e?"repositories":null),submitReturnFocusRef:o,cancelReturnFocusRef:n}):(0,i.jsx)(eI.Ee,{open:"repositories"===e,onOpenChange:e=>t(e?"repositories":null),submitReturnFocusRef:o,cancelReturnFocusRef:n}),u.includes("knowledge-bases")&&(0,i.jsx)(el,{disabledForPreviewModelsProps:{anchorRef:n},emptyKnowledgeBaseProps:{anchorRef:n},open:"knowledge-bases"===e,onOpenChange:e=>t(e?"knowledge-bases":null),anchorRef:n}),"no-agents-available"===e&&(0,i.jsx)(Q,{onClose:()=>t(null)}),"agents-not-supported"===e&&(0,i.jsx)(J,{onClose:()=>t(null)})]})});eU.displayName="AttachmentMenu";var ez=n(70255);function eV({agent:e,showLimit:t,...n}){return(0,i.jsxs)(B.l.Item,{...n,children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(z.r,{src:e.avatarUrl})}),e.name,(0,i.jsxs)(B.l.Description,{variant:"inline",truncate:!0,children:[U.Z3,e.slug]}),t&&(0,i.jsx)(B.l.Description,{variant:"block",children:"Start a new conversation to use other extensions."})]})}try{eV.displayName||(eV.displayName="AgentSuggestion")}catch{}function eW({children:e}){let{mode:t}=(0,T.Pk)(),[n,a]=(0,m.useState)(()=>"undefined"!=typeof document);(0,m.useEffect)(()=>a(!0),[]);let[s,o]=(0,m.useState)(null),[l,c]=(0,m.useState)([]),d=(0,m.useMemo)(()=>[{triggerChar:U.Z3,insertSpaceOnCommit:!0}],[]),u=(0,U.JE)(null!==s);(0,m.useEffect)(()=>{s?function(){if(!s)return;let e=s.query.toLowerCase(),n=t=>{let n=t.toLowerCase();return n.startsWith(e)&&n!==e};u.disabled&&c([]),u.loading&&c(["loading"]),""===e&&(0,r.BI)("dotcom_chat.activate",{target:"AGENT_COMMAND_MENU_TRIGGERED",mode:t}),c((u.availableAgents?.filter(e=>n(e.slug)).slice(0,10)??[]).map(e=>({value:e.slug,key:e.slug,render:t=>(0,i.jsx)(eV,{agent:e,showLimit:u.showLimit,...t})})))}():c([])},[u.availableAgents,u.disabled,u.loading,u.showLimit,t,s]);let p=(0,m.useCallback)(e=>{o(e)},[]),h=(0,m.useCallback)(()=>{o(null)},[]);return n?(0,i.jsx)(ez.a,{fullWidth:!0,suggestions:l,triggers:d,tabInsertsSuggestions:!1,onHideSuggestions:h,onShowSuggestions:p,onSelectSuggestion:({suggestion:e})=>{(0,r.BI)("dotcom_chat.activate",{target:"AGENT_COMMAND_MENU_ITEM_SELECTED",mode:t,suggestion:"string"==typeof e?e:e.value})},children:e}):(0,i.jsx)("div",{children:e})}try{eW.displayName||(eW.displayName="AgentAutocomplete")}catch{}let eH=[{name:"Extensions",icon:l.StackIcon,value:"agents",where:"start"},{name:"Repositories",icon:l.RepoIcon,value:"repositories",where:"anywhere"},{name:"Files and folders",icon:l.FileIcon,value:"repositories:files",where:"anywhere"},{name:"Issues",icon:l.IssueOpenedIcon,value:"repositories:issues",where:"anywhere"},{name:"Pull requests",icon:l.GitPullRequestIcon,value:"repositories:pulls",where:"anywhere"},{name:"Discussions",icon:l.CommentDiscussionIcon,value:"repositories:discussions",where:"anywhere"}],eq={is:e=>eH.some(t=>t.value===e)};function eG({category:{name:e,icon:t},...n}){return(0,i.jsxs)(B.l.Item,{...n,children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(t,{})}),e,(0,i.jsx)(B.l.TrailingVisual,{children:(0,i.jsx)(l.ChevronRightIcon,{})})]})}try{eG.displayName||(eG.displayName="CategorySuggestion")}catch{}let eK={asyncSuggestion:"shared-module__asyncSuggestion--lDyxK",stale:"shared-module__stale--IEVWo"};function eQ({discussion:e,stale:t,className:n,...a}){return(0,i.jsxs)(B.l.Item,{...a,className:(0,u.$)(eK.asyncSuggestion,t&&eK.stale,n),children:[(0,i.jsxs)(B.l.LeadingVisual,{children:["open"===e.state&&(0,i.jsx)(l.CommentDiscussionIcon,{className:"fgColor-open"}),"closed"===e.state&&(0,i.jsx)(l.DiscussionClosedIcon,{className:"fgColor-muted"})]}),(0,i.jsx)(ea.A,{title:e.title,maxWidth:350,children:e.title}),(0,i.jsxs)(B.l.Description,{children:["#",e.number]})]})}try{eQ.displayName||(eQ.displayName="DiscussionSuggestion")}catch{}function eJ({type:e,path:t,stale:n,className:a,...r}){let s=t.split("/"),o=s.pop();return(0,i.jsxs)(B.l.Item,{...r,className:(0,u.$)(eK.asyncSuggestion,n&&eK.stale,a),children:[(0,i.jsx)(B.l.LeadingVisual,{children:"folder"===e?(0,i.jsx)(l.FileDirectoryFillIcon,{}):(0,i.jsx)(l.FileIcon,{})}),o,(0,i.jsxs)(B.l.Description,{variant:"inline",children:[s.join("/"),"/"]})]})}try{eJ.displayName||(eJ.displayName="FileSuggestion")}catch{}function eZ({issue:e,stale:t,className:n,...a}){return(0,i.jsxs)(B.l.Item,{...a,className:(0,u.$)(eK.asyncSuggestion,t&&eK.stale,n),children:[(0,i.jsxs)(B.l.LeadingVisual,{children:["draft"===e.state&&(0,i.jsx)(l.IssueDraftIcon,{className:"fgColor-neutral"}),"open"===e.state&&(0,i.jsx)(l.IssueOpenedIcon,{className:"fgColor-open"}),"closed"===e.state&&(0,i.jsx)(l.IssueClosedIcon,{className:"fgColor-done"})]}),(0,i.jsx)(ea.A,{title:e.title,maxWidth:350,children:e.title}),(0,i.jsxs)(B.l.Description,{children:["#",e.number]})]})}try{eZ.displayName||(eZ.displayName="IssueSuggestion")}catch{}function eX({pullRequest:e,stale:t,className:n,...a}){return(0,i.jsxs)(B.l.Item,{...a,className:(0,u.$)(eK.asyncSuggestion,t&&eK.stale,n),children:[(0,i.jsxs)(B.l.LeadingVisual,{children:["draft"===e.state&&(0,i.jsx)(l.GitPullRequestDraftIcon,{className:"fgColor-neutral"}),"open"===e.state&&(0,i.jsx)(l.GitPullRequestIcon,{className:"fgColor-open"}),"closed"===e.state&&(0,i.jsx)(l.GitPullRequestClosedIcon,{className:"fgColor-done"})]}),(0,i.jsx)(ea.A,{title:e.title,maxWidth:350,children:e.title}),(0,i.jsxs)(B.l.Description,{children:["#",e.number]})]})}try{eX.displayName||(eX.displayName="PullRequestSuggestion")}catch{}var eY=n(41980);function e0({repository:e,isMultistep:t,stale:n,className:a,...r}){return(0,i.jsxs)(B.l.Item,{...r,className:(0,u.$)(eK.asyncSuggestion,n&&eK.stale,a),children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(z.r,{src:e.ownerAvatarUrl,alt:"",size:16,square:e.isInOrganization})}),e.nwo,t&&(0,i.jsx)(B.l.TrailingVisual,{children:(0,i.jsx)(l.ChevronRightIcon,{})})]},e.nwo)}try{e0.displayName||(e0.displayName="RepositorySuggestion")}catch{}let e1=e=>(t,n)=>e.has(t.databaseId)&&!e.has(n.databaseId)?-1:e.has(n.databaseId)&&!e.has(t.databaseId)?1:0,e2=[{triggerChar:"@",insertSpaceOnCommit:!0,keepTriggerCharOnCommit:!1,multiWord:!0}];function e5({children:e,onSelectReference:t,onShowAgentsDialog:n}){let{mode:a}=(0,T.Pk)(),[s,o]=(0,m.useState)(()=>"undefined"!=typeof document);(0,m.useEffect)(()=>o(!0),[]);let[c,d]=(0,m.useState)(null),u=function(e){var t;let n=(t=e?.category==="categories"?e:null,(0,m.useMemo)(()=>t?eH.filter(e=>e.name.toLowerCase().includes(t.filter.toLowerCase())&&function(e,t){switch(e){case"start":return 0===t.index;case"anywhere":return!0}}(e.where,t)).map(e=>({value:null,key:e.value,render:t=>(0,i.jsx)(eG,{category:e,...t})})):null,[t])),a=function(e){let{availableAgents:t,loading:n,showLimit:a,disabled:r}=(0,U.JE)(null!==e);return(0,m.useMemo)(()=>r||!e?null:n&&!t?"loading":t?.filter(t=>e?.category==="agents"&&t.name.toLowerCase().includes(e.filter.toLowerCase())).map(e=>({value:`@${e.slug}`,render:t=>i.jsx(eV,{agent:e,showLimit:a,...t})})).concat({value:null,key:`open-link:${U.bn}`,render:e=>i.jsxs(i.Fragment,{children:[t.length>0&&i.jsx(B.l.Divider,{}),i.jsxs(B.l.Item,{...e,children:[i.jsx(B.l.LeadingVisual,{children:i.jsx(l.TelescopeIcon,{})}),"Marketplace",i.jsx(B.l.TrailingVisual,{children:i.jsx(l.LinkExternalIcon,{})})]})]})})??null,[r,e,n,t,a])}(e?.category==="agents"?e:null),r=function(e){let{currentReferences:t}=(0,T.Pk)(),{repositories:n,loading:a}=(0,eY.U)(e?.filter??"",null!==e),r=(0,m.useMemo)(()=>new Set(t.filter(e=>"repository"===e.type).map(e=>e.id)),[t]);return(0,m.useMemo)(()=>{if(!e)return null;if("initial"===a)return"loading";let t=void 0!==e.nextCategory;return n.toSorted(e1(r)).slice(0,5).map(e=>({value:t?null:_.stringify({type:"repository",repo:e.nwo}),key:e.nwo,render:n=>(0,i.jsx)(e0,{repository:e,isMultistep:t,stale:!!a,...n})}))??null},[n,a,e,r])}(e?.category==="repositories"?e:null),s=function(e){let{service:t}=(0,g.b)(),n=(0,ev.I)({enabled:null!==e,queryKey:["copilot-autocomplete-issues",e?.repository,e?.filter],queryFn:async()=>t.fetchAutocompleteIssues(e.repository,e.filter),placeholderData:e=>e});return(0,m.useMemo)(()=>e?n.isLoading?"loading":n.data?.map(t=>({value:_.stringify({type:"issue",repo:e.repository,id:t.number.toString()}),key:t.number.toString(),render:e=>i.jsx(eZ,{...e,issue:t,stale:n.isPlaceholderData})}))??null:null,[n.data,n.isLoading,n.isPlaceholderData,e])}(e?.category==="issues"?e:null),o=function(e){let{service:t}=(0,g.b)(),n=(0,ev.I)({enabled:null!==e,queryKey:["copilot-autocomplete-pulls",e?.repository,e?.filter],queryFn:async()=>t.fetchAutocompletePullRequests(e.repository,e.filter),placeholderData:e=>e});return(0,m.useMemo)(()=>e?n.isLoading?"loading":n.data?.map(t=>({value:_.stringify({type:"pull-request",repo:e.repository,id:t.number.toString()}),key:t.number.toString(),render:e=>i.jsx(eX,{...e,pullRequest:t,stale:n.isPlaceholderData})}))??null:null,[n.data,n.isLoading,n.isPlaceholderData,e])}(e?.category==="pulls"?e:null),c=function(e){let{service:t}=(0,g.b)(),n=(0,ev.I)({enabled:null!==e,queryKey:["copilot-autocomplete-discussions",e?.repository,e?.filter],queryFn:async()=>t.fetchAutocompleteDiscussions(e.repository,e.filter),placeholderData:e=>e});return(0,m.useMemo)(()=>e?n.isLoading?"loading":n.data?.map(t=>({value:_.stringify({type:"discussion",repo:e.repository,id:t.number.toString()}),key:t.number.toString(),render:e=>i.jsx(eQ,{...e,discussion:t,stale:n.isPlaceholderData})}))??null:null,[n.data,n.isLoading,n.isPlaceholderData,e])}(e?.category==="discussions"?e:null),d=function(e){let t=(0,g.b)(),n=(0,ev.I)({enabled:null!==e,queryKey:["copilot-repository",e?.repository],queryFn:async()=>{if(!e?.repository)return null;let n=await t.service.fetchRepo(e?.repository);if(!n.ok)throw Error("Failed to fetch repository");return n.payload},staleTime:3e5}),a=ej(n.data??null),r=(0,m.useMemo)(()=>new Set(a.data?.directories??[]),[a.data?.directories]),s=eb(a.data?(a.data.paths??[]).concat(a.data.directories??[]):null,e?.filter??"");return(0,m.useMemo)(()=>{if(!e)return null;if(n.isLoading||a.isLoading||s.isLoading)return"loading";let t=[...s.data?.slice(0,5).map(t=>({value:_.stringify({repo:e.repository,type:"file",id:t}),key:t,render:e=>i.jsx(eJ,{...e,path:t,type:r.has(t)?"folder":"file",stale:s.isPlaceholderData})}))??[]];return t.length>0?t:null},[r,s.data,s.isLoading,a.isLoading,s.isPlaceholderData,e,n.isLoading])}(e?.category==="files"?e:null);switch(e?.category){case void 0:return null;case"categories":return n;case"repositories":return r;case"issues":return s;case"agents":return a;case"discussions":return c;case"pulls":return o;case"files":return d}}(c);return(!function({query:e,onShowAgentsDialog:t}){let n=e?.category==="agents",{availableAgents:a,loading:i,disabled:r}=(0,U.JE)(n);(0,m.useEffect)(()=>{!n||i||(r?t("agents-not-supported"):a?.length||t("no-agents-available"))},[n,i,a,r,t])}({query:c,onShowAgentsDialog:n}),s)?(0,i.jsx)(ez.a,{fullWidth:!0,suggestions:u,triggers:e2,tabInsertsSuggestions:!1,onHideSuggestions:()=>d(null),onShowSuggestions:e=>d(t=>t?{...t,filter:e.query}:{category:"categories",filter:e.query,index:(e.target.selectionStart??0)-(e.query.length+e.trigger.triggerChar.length)}),onSelectSuggestion:({suggestion:e})=>{let n="string"==typeof e?e:e.value;(0,r.BI)("dotcom_chat.activate",{target:"AUTOCOMPLETE_ITEM_SELECTED",mode:a,suggestion:n});let i=null!==n&&c?.category!=="agents"?_.parse(n):void 0;if(i&&t(i),!("object"==typeof e&&null===e.value))return;let s=/^open-link:(.+)$/.exec(e.key);if(s){window.open(s[1],"_blank");return}switch(c?.category){case"categories":eq.is(e.key)&&d(function(e){switch(e){case"repositories":return{category:"repositories",filter:""};case"agents":return{category:"agents",filter:""};case"repositories:discussions":return{category:"repositories",filter:"",nextCategory:"discussions"};case"repositories:issues":return{category:"repositories",filter:"",nextCategory:"issues"};case"repositories:pulls":return{category:"repositories",filter:"",nextCategory:"pulls"};case"repositories:files":return{category:"repositories",filter:"",nextCategory:"files"}}}(e.key));break;case"repositories":c.nextCategory&&d({category:c.nextCategory,filter:"",repository:e.key})}},suggestionsPlacement:"above",children:e}):(0,i.jsx)("div",{children:e})}try{e5.displayName||(e5.displayName="UnifiedAutocomplete")}catch{}function e3({children:e,onSelectReference:t,onShowAgentsDialog:n}){return R.W.chatAutocomplete?(0,i.jsx)(e5,{onSelectReference:t,onShowAgentsDialog:n,children:e}):(0,i.jsx)(eW,{children:e})}try{e3.displayName||(e3.displayName="Autocomplete")}catch{}let e4={container:"ChatInput-module__container--NFzCy",input:"ChatInput-module__input--iApWs",clicked:"ChatInput-module__clicked--hHA9l",attachments:"ChatInput-module__attachments--a9G6d",inputContainer:"ChatInput-module__inputContainer--BcExV",inputPreview:"ChatInput-module__inputPreview--f_0H3",token:"ChatInput-module__token--g4p0s",toolbar:"ChatInput-module__toolbar--ZtCiG",toolbarLeft:"ChatInput-module__toolbarLeft--cjV2H",toolbarRight:"ChatInput-module__toolbarRight--PiQJn",containerSmall:"ChatInput-module__containerSmall--PJkO5"},e6=(0,m.forwardRef)(function({text:e},t){let n=e.split(/(\s+)/),a=U.qj.test(n[0]??""),{availableAgents:r}=(0,U.JE)(a),{currentReferences:o}=(0,T.Pk)(),l=(0,g.b)(),c=new Set,d=n.map((e,t)=>{let n=0===t&&U.qj.exec(e)?.groups?.slug;if(n&&r?.some(e=>e.slug===n))return(0,i.jsx)("span",{className:e4.token,children:e},t);let a=_.parse(e),l=a&&o.find(e=>_.refersTo(a,e));return l?(c.add((0,$.Vb)(l)),(0,i.jsx)("span",{className:e4.token,...(0,s.G)("input-preview-ref"),children:e},t)):e}),u=(0,m.useRef)(c);return(0,m.useEffect)(function(){for(let e of u.current)if(!c.has(e)){let t=o.find(t=>(0,$.Vb)(t)===e);t&&l.removeReference(t)}u.current=c}),(0,i.jsx)("div",{id:"copilot-chat-textarea-preview",...(0,s.G)("copilot-chat-input-textarea-preview"),"aria-hidden":!0,className:e4.inputPreview,ref:t,role:"presentation",children:d})});try{e6.displayName||(e6.displayName="ChatInputPreview")}catch{}var e7=n(69676),e8=n(82678),e9=n(63867),te=n(69425),tt=n(10967);let tn={container:"ChatInputReferences-module__container--kZx3r",attachmentsList:"ChatInputReferences-module__attachmentsList--c0Z3e",scrolledToEnd:"ChatInputReferences-module__scrolledToEnd--qEVr3",loading:"ChatInputReferences-module__loading--G1S4m",divider:"ChatInputReferences-module__divider--m7eF_",menuButton:"ChatInputReferences-module__menuButton--R82CM",functionLoading:"ChatInputReferences-module__functionLoading--_Tp1T",convertToFileButton:"ChatInputReferences-module__convertToFileButton--JUfME",hoveringDismissConvertToFile:"ChatInputReferences-module__hoveringDismissConvertToFile--BVZ5r",removeConvertToFileButton:"ChatInputReferences-module__removeConvertToFileButton--qaOmX"};var ta=n(60068);let ti=(0,m.memo)(({className:e,isLoading:t,returnFocusRef:n,tokenSize:a="medium",onClickReference:r,getReferenceVersion:o,showConvertToFileText:c,onConvertToFile:p,onConvertToFileDismiss:h})=>{let{currentReferences:f}=(0,T.Pk)(),y=(0,g.b)(),x=(0,m.useRef)(null),v=(0,te.g)(x),[_,b]=(0,m.useState)(!1),j=(0,m.useMemo)(()=>(0,$.rT)(f),[f]),N=(0,m.useRef)(null);(0,e8.G)({containerRef:N,focusableElementFilter:e=>!e.hasAttribute("aria-hidden"),bindKeys:e7.z0.ArrowHorizontal|e7.z0.HomeAndEnd,focusInStrategy:"previous",focusOutBehavior:"stop"},[j]);let w=(0,m.useRef)([]),I=(e,t)=>{let a=w.current[t+1]??w.current[t-1]??n.current;a?.focus(),y.removeReference(e)},S=(0,m.useRef)(j);(0,C.N)(()=>{if(S.current.length<j.length){let e=j.find(e=>!S.current.find(t=>(0,$.x_)(t,e))),t=e?j.indexOf(e):-1;w?.current?.[t]?.scrollIntoView({behavior:"smooth",inline:"end"})}S.current=j},[j]);let k=(0,m.useCallback)(e=>{b(!1),h?.(),e.stopPropagation(),e.preventDefault()},[h]);return 0!==j.length||t||c?(0,i.jsxs)("div",{role:"toolbar","aria-label":"Attachments",className:(0,u.$)(e,tn.container),ref:N,children:[(0,i.jsxs)("div",{className:(0,u.$)(tn.attachmentsList,v&&tn.scrolledToEnd,t&&tn.loading),ref:x,children:[c&&(0,i.jsx)(d.Q,{onClick:p,leadingVisual:l.FileIcon,className:(0,u.$)(tn.convertToFileButton,_&&tn.hoveringDismissConvertToFile),children:(0,i.jsxs)("div",{className:"d-flex",children:["Convert to file",(0,i.jsx)(X.K,{className:tn.removeConvertToFileButton,variant:"invisible",icon:l.XIcon,"aria-label":"Remove",tooltipDirection:"n",onClick:k,size:"small",onMouseOver:()=>b(!0),onMouseLeave:()=>b(!1)})]})}),j.map((e,t)=>"repository"===e.type?(0,i.jsx)(tr,{reference:e,ref:e=>{w.current[t]=e},"data-index":t,size:a,onRemove:()=>I(e,t),onClick:r,getReferenceVersion:o},(0,$.Vb)(e)):(0,i.jsx)(ta.B,{reference:e,ref:e=>{w.current[t]=e},"data-index":t,size:a,onRemove:()=>I(e,t),onClick:r,getReferenceVersion:o},(0,$.Vb)(e))),t&&(0,i.jsxs)("div",{className:tn.functionLoading,...(0,s.G)("loading-indicator"),children:[(0,i.jsx)(e9.A,{size:"small"}),"Retrieving\u2026"]})]}),j.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:tn.divider}),(0,i.jsxs)(O.W,{children:[(0,i.jsx)(O.W.Anchor,{children:(0,i.jsx)(X.K,{icon:l.KebabHorizontalIcon,"aria-label":"Attachments options",variant:"invisible",tooltipDirection:"n",className:tn.menuButton,size:a})}),(0,i.jsx)(O.W.Overlay,{width:"small",children:(0,i.jsx)(B.l,{children:(0,i.jsxs)(B.l.Item,{onSelect:()=>{setTimeout(()=>n.current?.focus()),y.clearCurrentReferences()},children:[(0,i.jsx)(B.l.LeadingVisual,{children:(0,i.jsx)(l.TrashIcon,{})}),"Remove attachments"]})})})]})]})]}):null});ti.displayName="ChatInputReferences";let tr=(0,m.forwardRef)(function(e,t){let n=e.reference,a=(0,T.pn)(e=>e.model&&!e.model.hasLimitedCapabilities),r=`${n.ownerLogin}/${n.name}`,[s,o]=(0,tt.vn)(r),l=(0,m.useRef)(!1),c=s.code===tt.W5.Unindexed||s.docs===tt.W5.Unindexed;return(0,m.useEffect)(function(){!l.current&&c&&a&&(l.current=!0,o())},[a,c,o]),(0,i.jsx)(ta.B,{ref:t,...e})});try{tr.displayName||(tr.displayName="RepoReferenceToken")}catch{}try{tr.displayName||(tr.displayName="RepoReferenceToken")}catch{}var ts=n(80938),to=n(2914);let tl=["github:cancel","copilot-chat:send-message","copilot-chat:edit-last-message"],tc=e=>{let t=(0,T.Pk)(),n=(0,g.b)(),a=n.maxMessagesReached(),[l,d]=(0,m.useState)(""),y="loading"===t.slashCommandLoading.state,{safeSetTimeout:x}=(0,c.A)(),{isLicensedLimited:v}=(0,to.xR)(),{typingHasStarted:S,textAreaRef:O,textareaPreviewRef:B,textAreaPreviewContainerRef:F,text:$,setText:U,handleSubmit:z,handleSubmitToNewThread:V,handleScroll:W,handleChange:H,handleStop:q,handleFocus:G}=function(e){let t=(0,T.Pk)(),n=(0,g.b)(),{selectedThreadID:a,mode:i,autoSubmit:s,model:o}=t,{setConvertToFileText:l}=e,c=I.J.getSavedMessage(a),d=I.J.getSavedUserMessageOnError(a),{pathname:u}=(0,N.zy)(),[p,h]=(0,w.ok)(),[f,y]=(0,m.useState)(()=>A(t.mode,u,p)??d??c??""),[x,v]=(0,m.useState)(!1),_=(0,m.useRef)(null),b=e.textAreaRef||_,j=(0,m.useRef)(null),S=(0,m.useRef)(null),E=(0,m.useRef)(0),R=(0,m.useRef)(null),P=(0,m.useRef)(()=>{}),D=(0,m.useRef)(!1),L=(0,m.useCallback)(async()=>{t.renderAttachKnowledgeBaseHerePopover&&await n.fetchKnowledgeBases()},[n,t.renderAttachKnowledgeBaseHerePopover]);(0,m.useEffect)(()=>{L()},[L]),(0,m.useEffect)(()=>{I.J.setSavedMessage(a,f)},[a,f]),(0,C.N)(()=>{let e=0;!function t(){if(!b.current||!S.current||!j.current)return;e++,0===b.current.scrollHeight&&e<10&&setTimeout(t,1),b.current.style.height="0";let n=b.current.scrollHeight,a=Math.min(n,300);j.current.style.height=`${n}px`,b.current.style.height=`${n}px`,S.current.style.height=`${a}px`}()},[f,b,j]);let M=(0,m.useCallback)(()=>{b?.current&&j?.current&&S?.current&&(j.current.scrollTop=b.current.scrollTop,j.current.scrollLeft=b.current.scrollLeft)},[b]),O=(0,m.useMemo)(()=>t.currentReferences.filter(e=>!("isClientOnly"in e)||!e.isClientOnly),[t.currentReferences]),B=async i=>{if(v(!1),I.J.clearSavedUserMessage(a),I.J.clearSavedUserMessageOnError(a),t.defaultRecipient&&!f.includes(`@${t.defaultRecipient}`)&&(t.defaultRecipient=void 0),i?.preventDefault(),"assistive"===t.mode&&await k(f,t,n)){(0,r.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_EXECUTED",mode:t.mode,command:f}),"/new"===f.trim()&&I.J.setSavedMessageFast(a,null),y("");return}if(!e.isLoading){let t=f;if(!t){let[e,a]=n.tryInferMessage(O);if(!e||!a)return;t=a}y(""),await e.onSubmit?.(t)}},F=(0,m.useCallback)(()=>n.sendMessageToNewThread(a,f,O,t.context),[n,a,t.context,O,f]);(0,m.useEffect)(()=>{(async()=>{let e=A(i,u,p),t=new URLSearchParams(p),n=t.get("model"),a=!n||n===o.id;e&&a&&!D.current&&(t.delete("prompt"),t.delete("model"),(0,r.BI)("dotcom_chat.activate",{target:"COPILOT_PROMPT_LOADED_FROM_URL",mode:"immersive"}),h(t,{replace:!0}),s&&(D.current=!0,await Promise.resolve(),await B()))})()},[u,p,h,i,s,o]);let $=(0,m.useCallback)(e=>{v(!0),b?.current&&(y(e.target.value),l?.(""),E.current=0,M())},[M,l,b]),U=(0,m.useCallback)(async()=>{await n.stopStreaming(),null!=a&&(n.startThreadReload(),await new Promise(e=>{R.current=setTimeout(()=>e(a),6e3)}),P.current=await n.fetchMessages(a,!0,!0))},[n,a]);return(0,m.useEffect)(()=>{P.current&&(P.current(),P.current=()=>{})},[t.messages]),(0,m.useEffect)(()=>()=>{R.current&&(clearTimeout(R.current),R.current=null),n.cancelThreadReload(),P.current=()=>{}},[n]),{typingHasStarted:x,textAreaRef:b,textareaPreviewRef:j,textAreaPreviewContainerRef:S,text:f,setText:y,handleSubmit:B,handleSubmitToNewThread:F,handleScroll:M,handleChange:$,handleStop:U,handleFocus:e=>{e.currentTarget.selectionStart>0||e.currentTarget.setSelectionRange(e.currentTarget.value.length,e.currentTarget.value.length)}}}({isLoading:t.isWaitingOnCopilot||y||t.currentReferences.some(e=>"image"===e.type&&!e.attachment.isLoaded),onSubmit:e.onSubmit,textAreaRef:e.textAreaRef,setConvertToFileText:d}),{isLoading:K,addReferenceForUrl:Q}=function({figmaAuthUrl:e}){let t=(0,g.b)(),n=(0,p.n)({mutationFn:async e=>{let t=await (0,h.lS)(`/copilot/chat-links?item_url=${e}`);if(!t.ok)throw Error(`Failed to fetch reference data (${t.status}: ${t.statusText})`);return await t.json()},onSuccess:e=>t.addReference(e,"chatInput")}),a=(0,p.n)({mutationFn:async e=>{let t=await (0,h.lS)(`/copilot/immersive/figma-link?item_url=${e}`);if(!t.ok){if(403===t.status)throw new j;throw Error(`Failed to fetch Figma reference data (${t.status}: ${t.statusText})`)}return await t.json()},onSuccess:e=>t.addReference(e,"chatInput"),onError:(n,a)=>{e&&n instanceof j&&t.addReference({type:"figma",title:"Sign in to Figma",id:`forbidden-${a}`,url:e,thumbnailUrl:"",fullImageUrl:"",authenticationRequired:!0},"chatInput")}});return{isLoading:n.isPending||a.isPending,addReferenceForUrl:e=>{let t=_.fromUrl(e);t&&(n.mutate(e),e=_.stringify(t));let i=b.exec(e);return i&&(a.mutate(e),e=i[1]),e}}}({figmaAuthUrl:e.figmaAuthUrl}),{isLoading:J,addReferenceForMention:Z}=function(){let e=(0,g.b)(),t=(0,p.n)({mutationFn:async e=>{let t="repository"===e.type?[e.repo]:[e.repo,f(e.type),e.id??""],n=await (0,h.lS)(`/copilot/chat/reference/${t.join("/")}`);if(!n.ok)throw Error(`Failed to fetch reference data (${n.status}: ${n.statusText})`);return await n.json()},onSuccess:t=>e.addReference(t,"chatInput")});return{isLoading:t.isPending,addReferenceForMention:t.mutate}}(),X=y||t.currentReferences.some(e=>"image"===e.type&&!e.attachment.isLoaded)||K||J||t.isWaitingOnAttachment,Y=0===$.length,ee=(0,m.useCallback)(()=>{(0,r.BI)("dotcom_chat.activate",{target:"CHAT_MESSAGE_STOP",mode:t.mode}),q()},[q,t.mode]),et=(0,m.useCallback)(()=>{X||((0,r.BI)("dotcom_chat.activate",{target:"CHAT_MESSAGE_SUBMIT",mode:t.mode}),z())},[z,t.mode,X]),en=(0,m.useCallback)(()=>{X||V()},[V,X]),ea=(0,m.useCallback)(()=>{let e=t.messages.findLast(e=>"user"===e.role)?.id;e&&n.startEditingMessage(e)},[n,t.messages]),ei=t.isWaitingOnCopilot?`Copilot is responding\u{2026}`:t.defaultRecipient?void 0:a?"Message limit reached. To continue chatting with Copilot, start a new conversation.":e.placeholder?e.placeholder:"How can I help you?";t.defaultRecipient&&""===$&&!S&&U(`@${t.defaultRecipient} `);let er=(0,m.useRef)(null),[es,eo]=(0,m.useState)(null),el=(0,m.useCallback)(()=>{(0,r.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU",mode:t.mode}),eo(e=>"attachment-types"===e?null:"attachment-types")},[t.mode]),ec=(0,m.useCallback)(()=>{(0,r.BI)("dotcom_chat.activate",{target:"DEEP_CODESEARCH",mode:t.mode}),n.dispatch({type:"SET_DEEP_CODESEARCH",deepCodeSearch:!t.skillOptions?.deepCodeSearch})},[n,t.mode,t.skillOptions?.deepCodeSearch]),{model:ed}=(0,T.bP)("model"),eu=R.W.attachImagesImmersive&&"immersive"===t.mode&&!!ed.capabilities.supports.vision||!1,em=(0,m.useCallback)(async(a,i)=>{let r=new P.s(t,n),s=new L.E(n,e.existingFileNames),o=[],[l,c]=P.s.getAllowedFiles([...a],ed);if(eu){let t=await r.addImageAttachments(l,i,e.customCopilotId);t&&o.push(...t)}let d=[];for(let e of c)if(R.W.pasteTextFiles&&await L.E.isAttachable(e)){let t=await s.addAttachment(e);t&&o.push(t)}else d.push(e.type);return eu&&d.length>0&&(0,D.d)("included_unsupported_file",{fileTypes:d.join(","),uploadType:i}),o},[eu,ed,t,n,e.existingFileNames,e.customCopilotId]),ep=(0,m.useCallback)(async()=>{let e=new File([l],"",{type:L.x}),t=await em([e],"paste");t.length>0&&t[0]?.type==="thread-scoped-file"&&(U($.replaceAll(l,`@${t[0].name}`)),d(""))},[l,em,U,$]),eh=(0,m.useCallback)(()=>{d("")},[]),eg=(0,m.useCallback)(e=>{e.preventDefault();let t=e.dataTransfer?.files;t&&em(t,"drag")},[em]),ef=eu&&R.W.wholeAreaDragDrop;(0,m.useEffect)(()=>{if(ef&&!e.customCopilotId)return;let t=O?.current;if(!t)return;let n=e=>e.preventDefault(),a=e.customCopilotId?(0,M.xh)(eg):eg,i=e.customCopilotId?(0,M.xh)(n):n;return t.addEventListener("dragover",i),t.addEventListener("drop",a),()=>{t.removeEventListener("dragover",i),t.removeEventListener("drop",a)}},[O,ef,eg,e.customCopilotId]);let ey=e.isStreaming||t.isWaitingOnCopilot;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.tL,{commands:(0,m.useMemo)(()=>({"github:cancel":ey?ee:void 0,"copilot-chat:send-message":et,"copilot-chat:send-message-new-conversation":en,"copilot-chat:add-attachment":el,"copilot-chat:edit-last-message":Y?ea:void 0,"copilot-chat:deep-codesearch":ec}),[el,ea,et,en,ec,ee,ey,Y]),children:(0,i.jsxs)("form",{className:(0,u.$)(e4.container,{[e4.containerSmall]:"small"===e.size}),children:[(0,i.jsx)(ti,{className:e4.attachments,returnFocusRef:er,tokenSize:"small"===e.size?"small":"medium",isLoading:K||J,onClickReference:e.onClickReference,getReferenceVersion:e.getReferenceVersion,showConvertToFileText:!!l&&!t.isWaitingOnAttachment,onConvertToFile:ep,onConvertToFileDismiss:eh}),(0,i.jsxs)(o.tL.LimitKeybindingScope,{commandIds:tl,className:e4.inputContainer,ref:F,children:[(0,i.jsx)(e3,{onSelectReference:Z,onShowAgentsDialog:eo,children:(0,i.jsx)("textarea",{autoFocus:!0,id:E.wg,className:e4.input,autoComplete:"off",autoCorrect:"off",spellCheck:"false","aria-multiline":"true",onPaste:e=>{let t=e.clipboardData;if(t?.items){let n=[];for(let a=0;a<t.items.length;a++){let i=t.items[a];if(i){if("file"===i.kind){let e=i.getAsFile();e&&n.push(e)}else if("string"===i.kind&&["text","text/plain"].includes(i.type)){let n=t.getData(i.type);if(R.W.pasteTextFiles&&n.length>1e3&&n.length<=L.E.getAttachmentSizeLimit())x(()=>d(n),1);else if(R.W.copilotUIRefs){let t=Q(n);t!==n&&(e.preventDefault(),U(e=>`${e.substring(0,O.current?.selectionStart??0)}${t}${e.substring(O.current?.selectionEnd??0)}`))}}}}n.length>0&&(e.preventDefault(),em(n,"paste"))}},ref:O,onScroll:W,onChange:H,onFocus:G,placeholder:ei,value:$,"data-react-autofocus":!0,disabled:a||e.disabled,...(0,s.G)("copilot-chat-input-textarea")})}),(0,i.jsx)(e6,{text:$,ref:B})]}),(0,i.jsx)(td,{addAttachment:el,attachmentButtonRef:er,deepCodeSearch:t.skillOptions?.deepCodeSearch,hideAttachmentButton:!!e.hideAttachmentButton,stoppable:ey,submitDisabled:X,onNewThreadSelected:e.onNewThreadSelected,showModelPicker:e.showModelPicker,isLicensedLimited:v})]})}),(0,i.jsx)(eU,{inputRef:O,inputOnChange:H,anchorRef:er,panel:es,onPanelChange:eo})]})},td=(0,m.memo)(({addAttachment:e,attachmentButtonRef:t,deepCodeSearch:n,hideAttachmentButton:a,stoppable:r,submitDisabled:s,onNewThreadSelected:c,showModelPicker:m,isLicensedLimited:p})=>(0,i.jsxs)("div",{className:e4.toolbar,children:[(0,i.jsxs)("div",{className:e4.toolbarLeft,children:[R.W.showDeepCodeSearchButton&&(0,i.jsx)(o.N5,{commandId:"copilot-chat:deep-codesearch",icon:l.RocketIcon,variant:"invisible",tooltipDirection:"n",className:(0,u.$)({[e4.clicked]:n})}),!a&&(0,i.jsx)(d.Q,{ref:t,leadingVisual:l.PaperclipIcon,variant:"invisible",onClick:e,"data-testid":"attachment-menu-button",children:"Attach"})]}),(0,i.jsxs)("div",{className:e4.toolbarRight,children:[c&&m&&(0,i.jsx)(ts.Yb,{onNewThreadSelected:c,limited:p}),r?(0,i.jsx)(tm,{}):(0,i.jsx)(tu,{disabled:s})]})]}));function tu({disabled:e}){return(0,i.jsx)(o.N5,{commandId:"copilot-chat:send-message",variant:"invisible",size:"medium",icon:l.PaperAirplaneIcon,"aria-label":"Send now",disabled:e,tooltipDirection:"n"})}function tm(){return(0,i.jsx)(o.N5,{...(0,s.G)("copilot-chat-stop-button"),commandId:"github:cancel",variant:"invisible",size:"medium",icon:l.SquareFillIcon,tooltipDirection:"n",sx:{bg:"danger.subtle",color:"danger.fg",":hover":{bg:"danger.muted"}}})}td.displayName="ChatInputToolbar";try{tc.displayName||(tc.displayName="ChatInput")}catch{}try{tu.displayName||(tu.displayName="SubmitButton")}catch{}try{tm.displayName||(tm.displayName="StopButton")}catch{}},78176:(e,t,n)=>{n.d(t,{c:()=>D});var a=n(74848),i=n(58011),r=n(26514),s=n(62456),o=n(46988),l=n(34407),c=n(53949),d=n(38621),u=n(75177),m=n(52464),p=n(34164),h=n(96540),g=n(40650),f=n(82610),y=n(2622),x=n(65615),v=n(7426),_=n(1088),b=n(79929),j=n(72659),C=n(66349),N=n(72160),w=n(67264),I=n(61982),S=n(47920),k=n(32132),T=n(79887),A=n(82005),E=n(4181),R=n(50260);let P=({isLatestMessage:e,isFirstReply:t,isStreaming:n,...P})=>{let{message:D}=(0,j.V)(),L=(0,x.Pk)(),M=(0,v.b)(),{author:O,handleConfirmationAction:B,handleRetryErrorMessage:F,hasClientConfirmations:$,isAI:U,isCopilot:z,isError:V,isAgentError:W,isInterrupted:H,isLoading:q,isUser:G,myRef:K,onFeedbackSubmitted:Q,rendererConfig:J,renderFeedback:Z,shouldShowMessageActions:X,skillExecutionToUseForRespondingText:Y,showRetryButton:ee}=(0,g.p)({excludeFeedback:P.excludeFeedback,inputRef:P.inputRef,isLatestMessage:e,isLoading:P.isLoading,isStreaming:n,excludeReferencesFromFocusZone:!0}),et=D.clientToolResults&&D.clientToolResults.length>0,en=D.clientSkillsRequests&&D.clientSkillsRequests.length>0,ea=G&&!et,ei=q||et||en,er=ei&&e,es=z||et,eo=(0,h.useMemo)(()=>(0,f.rT)(D.references??[]),[D.references]),el=(0,h.useMemo)(()=>M.maxMessagesReached(),[M]),ec=eo.filter(e=>"image"!==e.type&&"org-instructions"!==e.type),ed=(0,h.useMemo)(()=>D.mediaContent?.filter(e=>e.mediaType.startsWith("image/")),[D.mediaContent]),eu=(0,h.useMemo)(()=>y.W.attachImagesImmersive&&void 0!==ed&&ed.length>0||!1,[ed]),em=(0,h.useCallback)(e=>{let t=e.target.href,n=eo.find(e=>e.url===t);n&&"immersive"===L.mode&&(M.selectReference(n),e.preventDefault())},[M,eo,L.mode]),ep=(0,h.useCallback)(e=>{M.setWrapCodeLines(e)},[M]);return(0,a.jsxs)("div",{className:(0,p.$)("message-container",b.A.messageContainer,ea&&b.A.user,U&&b.A.ai),ref:K,...(0,c.G)(`message-${V?"error":n?"streaming":D.id}`),children:[ea&&eu&&(0,a.jsx)("div",{children:ed?.map(e=>a.jsx(_.o,{src:e?.url||"",alt:"Uploaded image",mode:L.mode},e?.url||""))}),es||et?(0,a.jsx)(w.W,{isLoading:ei&&e,isError:V&&D.error?.type!=="agentUnauthorized",mode:L.mode,isFirstMessage:t,isLoadingSkills:(D.skillExecutions??[]).length>0&&ei&&""===D.content&&e,message:D.content||"",createdAt:D.createdAt}):U?(0,a.jsx)("div",{className:b.A.avatar,children:(0,a.jsx)(s.r,{src:O.avatarURL,size:24,"aria-label":`${O.name} avatar`,alt:`${O.name} avatar`,"data-testid":"chat-message-author-avatar"})}):null,ea&&(0,a.jsx)(C.t,{size:"small",className:"mb-2",references:ec}),(0,a.jsxs)("div",{className:(0,p.$)(b.A.message,ea&&b.A.user),children:[$&&D.clientConfirmations?.length?(0,a.jsx)(u.A,{className:"my-1",sx:{display:"flex",alignItems:"baseline",justifyContent:ea?"flex-end":""},"data-testid":"chat-message-client-confirmations",children:(0,a.jsxs)(m.A,{sx:{fontWeight:"normal",color:"var(--fgColor-muted)"},children:[(0,a.jsx)(d.CheckIcon,{})," ",O.name," ",D.clientConfirmations?.[0]?.state," the action"]})}):null,z&&er&&!D.content&&(0,a.jsx)(R.b,{className:(0,p.$)(b.A.skillExecutionText,"mb-2 mt-1 ml-2"),children:`${(0,k.WA)(Y)}...`}),(0,a.jsx)("div",{className:(0,p.$)(b.A.messageContent,!!$&&b.A.hasClientConfirmations),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.A,{className:"js-snippet-clipboard-copy-unpositioned",sx:{fontSize:1,px:2,py:1,zIndex:1,".snippet-clipboard-content":{position:"relative",overflow:"auto",display:"flex",justifyContent:"space-between",backgroundColor:"canvas.subtle",marginBottom:3,zIndex:1,pre:{marginBottom:0},"clipboard-copy":{width:"28px",height:"28px"}}},children:["assistant"===D.role&&D.content&&(eo?.length?(0,a.jsx)(C.s,{className:"mb-2",references:eo}):null),z&&P.isLoading?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.O,{variant:"rounded",height:"12px",width:"random"}),(0,a.jsx)(l.O,{variant:"rounded",height:"12px",width:"random"}),(0,a.jsx)(l.O,{variant:"rounded",height:"12px",width:"random"})]}):!$&&(ea?(0,a.jsx)(E.R,{children:D.content??""}):D.content&&(0,a.jsx)(i.To,{markdown:D.content,onLinkClick:em,chatMode:"assistive",wrapCodeLines:L.wrapCodeLines,onWrapCodeLinesChange:ep,...J})),V?(0,a.jsx)(I.K,{manager:M}):null,W&&D.agentErrors?.length?(0,a.jsx)(I.h,{errors:D.agentErrors}):null,H?(0,a.jsx)(T.h,{messageHasContent:!!D.content||!!D.skillExecutions?.length}):null,(z||(0,f.yh)(O))&&(0,f.Ye)(D.confirmations).map((t,n)=>"indexrepo"===t.confirmation.name?null:(0,a.jsx)(N.m,{confirmation:t,handleConfirmation:B,isLatestMessage:e},n))]}),!X&&ee&&(0,a.jsx)(A.$,{handleRetryMessage:F,disabled:el}),X&&(0,a.jsxs)(u.A,{className:"message-actions","data-testid":"message-action-bar",sx:{display:"inline-flex",alignItems:"center",position:e?void 0:"absolute",bottom:e?void 0:"-2.25rem",borderRadius:e?void 0:2,boxShadow:e?void 0:"var(--shadow-floating-small)",opacity:e?void 0:0,pointerEvents:e?void 0:"none","&::before":{content:e?void 0:'""',inset:"-0.5rem -0.75rem",zIndex:-1,position:"absolute"}},children:[Z&&(0,a.jsx)(S.G,{iconSize:"small",onFeedbackSubmitted:Q}),z&&!!D.content&&!n&&(0,a.jsx)(r.T,{textToCopy:D.content??"",ariaLabel:"Copy to clipboard",size:"small",className:"d-flex flex-items-center",onCopy:()=>{(0,o.BI)("copilot_chat.activate",{target:"CHAT_MESSAGE_COPY",mode:L.mode})}}),ee&&(0,a.jsx)(A.$,{handleRetryMessage:F,disabled:el})]})]})})]})]})},D=({message:e,...t})=>(0,a.jsx)(j.$,{message:e,children:(0,a.jsx)(P,{...t})});try{P.displayName||(P.displayName="InnerChatMessage")}catch{}try{D.displayName||(D.displayName="ChatMessage")}catch{}},72659:(e,t,n)=>{n.d(t,{$:()=>s,V:()=>o});var a=n(74848),i=n(96540);let r=(0,i.createContext)(void 0),s=({message:e,children:t})=>{let n=(0,i.useMemo)(()=>({message:e}),[e]);return(0,a.jsx)(r.Provider,{value:n,children:t})},o=()=>{let e=(0,i.useContext)(r);if(!e)throw Error("useChatMessage must be used with ChatMessageProvider.");return e};try{r.displayName||(r.displayName="ChatMessageContext")}catch{}try{s.displayName||(s.displayName="ChatMessageProvider")}catch{}},56056:(e,t,n)=>{n.d(t,{A:()=>c,i:()=>l});var a=n(74848),i=n(47584),r=n(96540),s=n(65615),o=n(26871);let l=({isLastGroup:e,children:t})=>{let n;let{scrollContainerHeight:l,scrollToBottom:c}=(0,o.b)(),{threadHasNewMessages:d}=(0,s.Pk)(),u=e&&d;return(0,r.useEffect)(()=>{u&&c("smooth")},[u,c]),u&&(n=i.cg?.CSS?.supports("container-type: size")?{minHeight:"100cqh"}:{minHeight:l}),(0,a.jsx)("div",{style:n,children:t})};function c(e){return e.reduce((e,t)=>{let n=e.at(-1);return"assistant"===(n?.at(-1)?.role??"assistant")&&"user"===t.role?e.push([t]):n?.push(t),e},[])}try{l.displayName||(l.displayName="ChatMessagesGroup")}catch{}},66349:(e,t,n)=>{n.d(t,{t:()=>E,s:()=>T});var a,i=n(74848),r=n(38621),s=n(72010),o=n(38695),l=n(15385),c=n(34614),d=n(30729),u=n(34164),m=n(96540),p=n(82610),h=n(2622),g=n(65615),f=n(54006),y=n(30631),x=n(89323),v=n(7426),_=n(89401),b=n(60068);function j({reference:e}){let t;let n=(0,g.Pk)(),a=(0,v.b)(),s=(0,m.useRef)(null),[o,c]=(0,m.useState)(!1),d=n?.mode??"assistive",{currentReferences:u}=n??{currentReferences:[]},f=(0,m.useMemo)(()=>u.map(e=>(0,p.Vb)(e)),[u]),j=(0,m.useMemo)(()=>(0,p.Vb)(e),[e]),C=(0,m.useMemo)(()=>"repo-instructions"===e.type,[e]),N=(0,m.useMemo)(()=>"org-instructions"===e.type,[e]),w=!C&&!N&&"web-search-result"!==e.type,I=(0,m.useMemo)(()=>C||N||f.includes(j),[C,N,f,j]),S=(0,m.useCallback)(t=>{t.stopPropagation(),I||a.addReference(e,"refMenu")},[a,e,I]),k=(0,p.JP)(e),T=(0,p.Xs)(k),A=(0,b.a)(e,(0,p.P)(n?.currentTopic));if(h.W.newImmersiveReferencesUI)switch(e.type){case"file":case"snippet":{t=`${e.repoName}`;let n=e.path.lastIndexOf("/");-1!==n&&(t=`${t}/${e.path.substring(0,n)}`);break}case"web-search-result":t=new URL(e.url,window.location.origin).hostname.replace(/^www\./,"")}let E=(0,p.z$)(e);return(0,i.jsxs)(l.l.LinkItem,{href:k,rel:"noopener",sx:{wordBreak:"break-word",width:"100%"},className:"reference-action",target:"immersive"===d||"third-party"===e.type?"_blank":void 0,children:[A&&(0,i.jsx)(l.l.LeadingVisual,{children:(0,i.jsx)(A,{})}),(0,i.jsxs)(y.A,{title:E,maxWidth:"100%",className:h.W.newImmersiveReferencesUI?"text-semibold":void 0,children:[E,t&&(0,i.jsx)("span",{className:"color-fg-muted ml-2",children:t})]}),w&&(0,i.jsx)(l.l.TrailingAction,{onClick:()=>c(!0),icon:r.KebabHorizontalIcon,label:"More reference options",ref:s}),w&&(0,i.jsx)(x.W,{anchorRef:s,open:o,onOpenChange:c,children:(0,i.jsx)(_.UJ,{portalContainerName:_.Dq,children:(0,i.jsxs)(l.l,{children:[T&&("immersive"===d||["third-party","folder","repository","docset"].includes(e.type)?(0,i.jsxs)(l.l.LinkItem,{href:k,rel:"noopener",target:"_blank",children:[(0,i.jsx)(l.l.LeadingVisual,{children:(0,i.jsx)(r.LinkIcon,{})}),"Open"]}):(0,i.jsxs)(l.l.Item,{onSelect:()=>{a.selectReference(e)},children:[(0,i.jsx)(l.l.LeadingVisual,{children:(0,i.jsx)(r.LinkIcon,{})}),"Preview"]})),(0,i.jsxs)(l.l.Item,{onSelect:S,disabled:I,children:[(0,i.jsx)(l.l.LeadingVisual,{children:(0,i.jsx)(r.PaperclipIcon,{})}),"Attach to chat"]})]})})})]})}try{j.displayName||(j.displayName="OutputReference")}catch{}try{(a=Icon).displayName||(a.displayName="Icon")}catch{}let C={referencesContainer:"ChatReferences-module__referencesContainer--Lxpin",referencesListImmersiveContainer:"ChatReferences-module__referencesListImmersiveContainer--iscAs",title:"ChatReferences-module__title--zwhMS",assistiveTitle:"ChatReferences-module__assistiveTitle--vngwU",Details:"ChatReferences-module__Details--IrWzZ",referenceTokensOuterContainer:"ChatReferences-module__referenceTokensOuterContainer--tFG8Q",referenceTokensContainer:"ChatReferences-module__referenceTokensContainer--PGYAF",chatMessageReferenceListFooter:"ChatReferences-module__chatMessageReferenceListFooter--nkt6v"};var N=n(63867);let w={referenceToken:"FigmaChatReference-module__referenceToken--Qn1Il",name:"FigmaChatReference-module__name--fKkEE",content:"FigmaChatReference-module__content--X8uXy",thumbnail:"FigmaChatReference-module__thumbnail--PaX46",thumbnailHidden:"FigmaChatReference-module__thumbnailHidden--PBOGz",thumbnailOuter:"FigmaChatReference-module__thumbnailOuter--sO8P4",thumbnailLoading:"FigmaChatReference-module__thumbnailLoading--PKK05",figmaIconOuter:"FigmaChatReference-module__figmaIconOuter--dd0HF",figmaIcon:"FigmaChatReference-module__figmaIcon--iPM9K"};var I=n(90591);let S=(0,m.forwardRef)(function({reference:e,...t},n){let[a,r]=(0,m.useState)(!0);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("a",{href:(0,p.JP)(e),className:(0,u.$)(w.referenceToken),ref:n,target:"_blank",rel:"noreferrer",...t,children:[(0,i.jsx)("span",{className:w.thumbnailOuter,children:e.thumbnailUrl&&(0,i.jsxs)(i.Fragment,{children:[a&&(0,i.jsx)("span",{className:w.thumbnailLoading,children:(0,i.jsx)(N.A,{size:"medium"})}),(0,i.jsx)("img",{className:(0,u.$)(w.thumbnail,{[w.thumbnailHidden]:a}),src:e.thumbnailUrl,alt:`preview thumbnail for ${e.title}`,onLoad:()=>r(!1)})]})}),(0,i.jsxs)("span",{className:w.content,children:[(0,i.jsx)("div",{className:w.figmaIconOuter,children:(0,i.jsx)(I._,{className:w.figmaIcon})}),(0,i.jsx)("span",{className:w.name,children:(0,p.z$)(e)})]})]})})});try{S.displayName||(S.displayName="FigmaChatReference")}catch{}var k=n(73786);function T({references:e,onToggle:t,isImmersive:n,className:a}){let h=(0,g.Pk)(),f=(0,m.useMemo)(()=>(0,p.rT)(e),[e]),{getDetailsProps:y}=(0,s.A)({}),x=(0,m.useMemo)(()=>(0,p.P)(h?.currentTopic)&&f.every(A),[h?.currentTopic,f]),v=(0,m.useMemo)(()=>f.some(e=>"web-search-result"===e.type),[f]);if(0===f.length)return null;let _=x&&h?.currentTopic?.name?`Search results from ${h.currentTopic.name}`:`${f.length} ${1===f.length?"reference":"references"}`;return(0,i.jsxs)(o.A,{...y(),onToggle:t,className:(0,u.$)(a,C.Details),children:[(0,i.jsxs)("summary",{className:(0,u.$)(C.referencesContainer),children:[(0,i.jsx)("span",{className:(0,u.$)(C.title,n?"":C.assistiveTitle),children:_}),(0,i.jsx)(d.A,{icon:r.ChevronDownIcon,className:"references-chevron-down",sx:{color:"fg.muted"}}),(0,i.jsx)(d.A,{icon:r.ChevronUpIcon,sx:{display:"none !important",color:"fg.muted"},className:"references-chevron-up"})]}),(0,i.jsxs)(l.l,{sx:{mt:2,mx:"-1rem",p:1},className:(0,u.$)(n&&C.referencesListImmersiveContainer),children:[f.map(e=>(0,i.jsx)(j,{reference:e},(0,p.Vb)(e))),v&&(0,i.jsxs)("div",{className:C.chatMessageReferenceListFooter,children:["Copilot used the"," ",(0,i.jsx)(c.A,{inline:!0,href:"https://gh.io/azure-ai-agent-with-bing-grounding",target:"_blank",rel:"noopener noreferrer",children:"Bing Search"})," ","tool."," ",(0,i.jsx)(c.A,{inline:!0,href:"https://privacy.microsoft.com/privacystatement",rel:"nofollow",target:"_blank",children:"Microsoft Privacy Statement"})]})]})]})}function A(e){return"snippet"===e.type&&!!e.languageName&&f.Yr.has(e.languageName)}function E({references:e,className:t,size:n,onClickReference:a,getReferenceVersion:r}){let{bigReferences:s,smallReferences:o}=(0,m.useMemo)(()=>(function(e){let t=(0,p.rT)(e),n=[],a=[];for(let e of t)R.has(e.type)?n.push(e):a.push(e);return{bigReferences:n,smallReferences:a}})(e),[e]),l=e=>"figma"===e.type&&h.W.immersiveFigmaIntegration?(0,i.jsx)(S,{reference:e,onClick:t=>a?.(t,e)},(0,p.Vb)(e)):(0,i.jsx)(b.B,{reference:e,size:n,onClick:t=>a?.(t,e),getReferenceVersion:r},(0,p.Vb)(e));return(0,i.jsxs)(k.M,{"aria-label":"Attachments",className:(0,u.$)(C.referenceTokensOuterContainer,t),children:[s.map(l),(0,i.jsx)("div",{className:C.referenceTokensContainer,children:o.map(l)})]})}let R=new Set(["figma","image"]);try{T.displayName||(T.displayName="ChatMessageReferencesList")}catch{}try{E.displayName||(E.displayName="ChatMessageReferenceTokens")}catch{}try{R.displayName||(R.displayName="BIG_REFERENCE_TYPES")}catch{}},26871:(e,t,n)=>{n.d(t,{$:()=>l,b:()=>c});var a=n(74848),i=n(34164),r=n(96540);let s={container:"ChatScrollContainer-module__container--b73rS"},o=(0,r.createContext)(null);function l({children:e,disabled:t,...n}){let l=(0,r.useRef)(null),c=(0,r.useRef)(null),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=new IntersectionObserver(([e])=>u(!e?.isIntersecting),{root:l.current,threshold:0,rootMargin:"50px"});return e.observe(c.current),()=>e.disconnect()},[]);let[m,p]=(0,r.useState)();(0,r.useEffect)(()=>{let e=()=>{if(!l.current)return;let e=getComputedStyle(l.current);p(`calc(${l.current.clientHeight}px - ${e.paddingTop} - ${e.paddingBottom})`)},t=new ResizeObserver(e);return e(),t.observe(l.current),()=>t.disconnect()},[]);let h=(0,r.useCallback)(e=>{t||c.current?.scrollIntoView({behavior:e,block:"end"})},[t]),g=(0,r.useMemo)(()=>({isScrolledUp:d,scrollToBottom:h,scrollContainerHeight:m}),[d,h,m]);return(0,a.jsx)(o.Provider,{value:g,children:(0,a.jsxs)("div",{ref:l,...n,className:(0,i.$)(s.container,n.className),children:[e,(0,a.jsx)("div",{ref:c,style:{height:"1px",marginTop:"-1px"}})]})})}let c=()=>{let e=(0,r.useContext)(o);if(!e)throw Error("useChatScroll may only be called in a descendant of ChatScrollContainer");return e};try{o.displayName||(o.displayName="ChatScrollContext")}catch{}try{l.displayName||(l.displayName="ChatScrollContainer")}catch{}},72160:(e,t,n)=>{n.d(t,{m:()=>d});var a=n(74848),i=n(75177),r=n(84217),s=n(52464),o=n(55847),l=n(96540),c=n(65615);function d({confirmation:e,handleConfirmation:t,isLatestMessage:n}){let d=(0,c.Pk)(),u=JSON.stringify(Object.values(e.confirmation).sort()),m=d.allClientConfirmations?.includes(u),[p,h]=(0,l.useState)(m&&!n),g=n=>{h(!0),t({state:n,confirmation:e.confirmation},e.title,e.onSubmit)};return(0,a.jsxs)(i.A,{className:"border rounded-2",sx:{display:"flex",flexDirection:"column",p:3,marginTop:3},children:[(0,a.jsx)(r.A,{as:"h3",sx:{mb:1,fontSize:1,lineHeight:"condensed"},children:e.title}),e.message.split("\n").map(e=>(0,a.jsx)(s.A,{as:"p",sx:{color:"fg.muted",mb:0},children:e},e)),!p&&(0,a.jsxs)(i.A,{sx:{display:"flex",justifyContent:"flex-start",gap:2,mt:3},children:[(0,a.jsx)(o.Q,{variant:"primary",onClick:()=>g("accepted"),children:"Allow"}),(0,a.jsx)(o.Q,{onClick:()=>g("dismissed"),children:"Dismiss"})]})]})}try{d.displayName||(d.displayName="Confirmation")}catch{}},14987:(e,t,n)=>{n.d(t,{l:()=>u});var a=n(74848),i=n(51349),r=n(57572),s=n(96540),o=n(2622),l=n(54912);let c=(0,a.jsxs)("svg",{width:"16",height:"16","aria-hidden":"true",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.65646 10.7C6.15313 9.85483 7.09616 9.3 8 9.3C8.47794 9.3 9.0345 9.50535 9.54632 9.9146C9.83116 10.1424 10.0753 10.4124 10.2645 10.7H5.65646ZM11.8447 11.016C11.3379 9.39273 9.66897 8 8 8C6.30092 8 4.60185 9.23723 4.12902 11.011C3.98676 11.5446 4.44771 12 5 12H11C11.5523 12 12.0093 11.5432 11.8447 11.016Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.89649 4.7586C4.02981 4.42529 4.40809 4.26317 4.7414 4.39649L7.00928 5.30364C7.63789 5.55509 7.6379 6.44491 7.00928 6.69636L4.7414 7.60351C4.40809 7.73683 4.02981 7.57471 3.89649 7.2414C3.76317 6.90809 3.92529 6.52981 4.2586 6.39649L5.24982 6L4.2586 5.60351C3.92529 5.47019 3.76317 5.09191 3.89649 4.7586Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.1035 4.7586C11.9702 4.42529 11.5919 4.26317 11.2586 4.39649L8.99072 5.30364C8.36211 5.55509 8.3621 6.44491 8.99072 6.69636L11.2586 7.60351C11.5919 7.73683 11.9702 7.57471 12.1035 7.2414C12.2368 6.90809 12.0747 6.52981 11.7414 6.39649L10.7502 6L11.7414 5.60351C12.0747 5.47019 12.2368 5.09191 12.1035 4.7586Z"})]}),d=[{name:"Hate it",value:1,icon:c,color:"veryDissatisfied"},{name:"Not great",value:2,icon:(0,a.jsxs)("svg",{width:"16",height:"16","aria-hidden":"true",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z"}),(0,a.jsx)("path",{d:"M6.5 6.5C6.5 7.05228 6.05228 7.5 5.5 7.5C4.94772 7.5 4.5 7.05228 4.5 6.5C4.5 5.94772 4.94772 5.5 5.5 5.5C6.05228 5.5 6.5 5.94772 6.5 6.5Z"}),(0,a.jsx)("path",{d:"M11.5 6.5C11.5 7.05228 11.0523 7.5 10.5 7.5C9.94772 7.5 9.5 7.05228 9.5 6.5C9.5 5.94772 9.94772 5.5 10.5 5.5C11.0523 5.5 11.5 5.94772 11.5 6.5Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.3416 11.8591C9.33064 10.0058 6.66936 10.0058 5.65842 11.8591C5.46007 12.2228 5.0045 12.3568 4.64086 12.1584C4.27722 11.9601 4.14323 11.5045 4.34158 11.1409C5.92104 8.24518 10.079 8.24518 11.6584 11.1409C11.8568 11.5045 11.7228 11.9601 11.3591 12.1584C10.9955 12.3568 10.5399 12.2228 10.3416 11.8591Z"})]}),color:"dissatisfied"},{name:"It\u2019s ok",value:3,icon:(0,a.jsxs)("svg",{width:"16","aria-hidden":"true",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z"}),(0,a.jsx)("path",{d:"M6.5 6.5C6.5 7.05228 6.05228 7.5 5.5 7.5C4.94772 7.5 4.5 7.05228 4.5 6.5C4.5 5.94772 4.94772 5.5 5.5 5.5C6.05228 5.5 6.5 5.94772 6.5 6.5Z"}),(0,a.jsx)("path",{d:"M11.5 6.5C11.5 7.05228 11.0523 7.5 10.5 7.5C9.94772 7.5 9.5 7.05228 9.5 6.5C9.5 5.94772 9.94772 5.5 10.5 5.5C11.0523 5.5 11.5 5.94772 11.5 6.5Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.3569 9.61413C9.28933 11.3934 6.71067 11.3934 5.64312 9.61413C5.43001 9.25894 4.96931 9.14377 4.61413 9.35688C4.25894 9.56999 4.14377 10.0307 4.35688 10.3859C6.00704 13.1361 9.99296 13.1361 11.6431 10.3859C11.8562 10.0307 11.7411 9.56999 11.3859 9.35688C11.0307 9.14377 10.57 9.25894 10.3569 9.61413Z"})]}),color:"satisfied"},{name:"Love it",value:4,icon:(0,a.jsxs)("svg",{width:"16","aria-hidden":"true",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.65646 10.3C6.15313 11.1452 7.09616 11.7 8 11.7C8.47794 11.7 9.0345 11.4947 9.54632 11.0854C9.83116 10.8576 10.0753 10.5876 10.2645 10.3H5.65646ZM11.8447 9.98403C11.3379 11.6073 9.66897 13 8 13C6.30092 13 4.60185 11.7628 4.12902 9.98904C3.98676 9.45539 4.44771 9 5 9H11C11.5523 9 12.0093 9.45684 11.8447 9.98403Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.3292 6.83541C10.9875 6.15213 10.0125 6.15213 9.67082 6.83541C9.48558 7.20589 9.03507 7.35606 8.66459 7.17082C8.29411 6.98558 8.14394 6.53507 8.32918 6.16459C9.22361 4.37574 11.7764 4.37574 12.6708 6.16459C12.8561 6.53507 12.7059 6.98558 12.3354 7.17082C11.9649 7.35606 11.5144 7.20589 11.3292 6.83541Z"}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.32918 6.83541C5.98754 6.15213 5.01246 6.15213 4.67082 6.83541C4.48558 7.20589 4.03507 7.35606 3.66459 7.17082C3.29411 6.98558 3.14394 6.53507 3.32918 6.16459C4.22361 4.37574 6.77639 4.37574 7.67082 6.16459C7.85606 6.53507 7.70589 6.98558 7.33541 7.17082C6.96493 7.35606 6.51442 7.20589 6.32918 6.83541Z"})]}),color:"verySatisfied"}],u=(0,s.forwardRef)(function({mode:e,returnFocusRef:t},n){let c=(0,s.useRef)(null),u=(0,s.useRef)(null),m=(0,s.useRef)(void 0);(0,s.useImperativeHandle)(n,()=>({openDialog:e=>{m.current=e,o.W.copilotChatInterviewSurvey?c.current?.openDialog():u.current?.openDialog(e)}}));let p=async(t,n)=>{let a=[];if(null==t&&a.push("Please select a rating."),n.length>2e3&&a.push("Please keep your feedback within 2000 characters or less."),a.length>0)return a;let i={rating:t,content:n,hostname:window.location.hostname,path:window.location.pathname,mode:e};try{(await (0,r.lS)("/github-copilot/feedback",{method:"POST",body:i})).ok||a.push("An error occurred while submitting your feedback.")}catch{a.push("An error occurred while submitting your feedback.")}return a};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.E,{ref:c,onClose:e=>{"no-thanks"===e&&u.current?.openDialog(m.current)}}),(0,a.jsx)(i.N,{ref:u,options:d,onSubmit:p,returnFocusRef:t})]})});u.displayName="ConversationFeedbackDialog"},67264:(e,t,n)=>{n.d(t,{W:()=>p});var a=n(74848),i=n(72334),r=n(75177),s=n(34164),o=n(96540);let l={copilotBadge:"CopilotBadgeV2-module__copilotBadge--OJjfk",loading:"CopilotBadgeV2-module__loading--NG3DO",animation:"CopilotBadgeV2-module__animation--cRY_E",assistive:"CopilotBadgeV2-module__assistive--aZiUP"},c=[i.L.Tickle,i.L.Celebrate,i.L.JumpWiggle],d=["yes","absolutely","certainly","sure","definitely","right","correct","indeed","precisely","exactly","true","affirmative","agree","agreed"],u=["no","never","negative","wrong","false","untrue","cannot","can't","sorry","incorrect","deny","disagree","refuse","unfortunately"];function m(e){let t=new Date(e);return(new Date().getTime()-t.getTime())/1e3/60<.5}function p({isFirstMessage:e=!1,isLoading:t,isLoadingSkills:n,isError:p,className:h,mode:g,message:f,createdAt:y}){let[x,v]=(0,o.useState)(()=>({animationType:e&&(!y||m(y))?i.L.Celebrate:i.L.Static,onFinish:i.L.Static,loopAnimation:!1,hasLoadedMessage:!1}));return(0,o.useEffect)(()=>{m(y)&&v(e=>(function({previousState:e,isLoadingSkills:t,isAffirmativeSentiment:n,isNegativeSentiment:a,isError:r,isLoading:s}){switch(e.animationType){case i.L.Static:if((n||a)&&!r&&!e.hasLoadedMessage)return{animationType:n?i.L.Affirmative:i.L.Negative,onFinish:i.L.Static,loopAnimation:!1,hasLoadedMessage:!0};if(t)return{...e,animationType:i.L.Thinking,loopAnimation:!0};if(!s&&!e.hasLoadedMessage&&!r)return{animationType:i.L.Confirm,onFinish:i.L.Static,loopAnimation:!1,hasLoadedMessage:!0};if(r&&!e.hasLoadedMessage)return{animationType:i.L.Negative,onFinish:i.L.Static,loopAnimation:!1,hasLoadedMessage:!0};return e;case i.L.Thinking:if(!t)return{...e,animationType:r?i.L.Negative:i.L.Static,loopAnimation:!1};return e;default:return e}})({previousState:e,isLoadingSkills:n||!1,isError:p||!1,isLoading:t||!1,isAffirmativeSentiment:function(e){if(e.length<200){let t=e.toLowerCase().split(/\W+/).filter(Boolean);return d.some(e=>t.includes(e.toLowerCase()))}return!1}(f),isNegativeSentiment:function(e){if(e.length<200){let t=e.toLowerCase().split(/\W+/).filter(Boolean);return u.some(e=>t.includes(e.toLowerCase()))}return!1}(f)}))},[n,p,t,x.animationType,x.hasLoadedMessage,e,f,y]),(0,a.jsx)("div",{className:(0,s.$)(l.copilotBadge,t&&l.loading,h),"aria-label":"Copilot badge",role:"img",children:(0,a.jsx)(r.A,{sx:{":hover":{cursor:"pointer"}},onClick:()=>{t||v({...x,animationType:c[Math.floor(Math.random()*c.length)],onFinish:i.L.Static,loopAnimation:!1})},children:(0,a.jsx)(i.N,{animationType:x.animationType,onAnimationEnd:()=>v(e=>({...e,animationType:e.onFinish})),loopAnimation:x.loopAnimation,className:(0,s.$)(l.animation,"assistive"===g&&l.assistive)})})})}try{p.displayName||(p.displayName="CopilotBadge")}catch{}},61982:(e,t,n)=>{n.d(t,{K:()=>f,h:()=>x});var a=n(74848),i=n(58011),r=n(53949),s=n(38621),o=n(87330),l=n(55847),c=n(37827),d=n(34164),u=n(96540),m=n(82610),p=n(93326),h=n(79929),g=n(72659);function f({manager:e}){let{message:t}=(0,g.V)(),{error:n}=t;if(!n)return null;switch(n.type){case"agentUnauthorized":return(0,a.jsx)(y,{error:n,manager:e});case"agentRequest":return(0,a.jsx)(x,{errors:[n.details]});default:return(0,a.jsx)(c.l,{...(0,r.G)("error-message-banner"),title:"Error",hideTitle:!0,description:n.message||"Something went wrong",variant:"warning"})}}function y({error:e,manager:t}){let{details:n}=e,[i,c]=(0,u.useState)(!1),p=(0,u.useCallback)(()=>{c(!0),t.dispatch({type:"MESSAGE_ADDED",message:(0,m.Y6)({role:"user",content:`Dismissed the connection with ${n.name}.`,mediaContent:[],parentMessageID:t.FindLastMessageID()})}),t.dispatch({type:"MESSAGE_ADDED",message:(0,m.Y6)({role:"assistant",content:`I was unable to connect you to ${n.name} because you cancelled the authentication.`,mediaContent:[],parentMessageID:t.FindLastMessageID()})})},[n.name,t]);return(0,a.jsxs)("div",{className:"position-relative d-flex flex-column flex-items-center gap-3 border rounded-2 p-5",...(0,r.G)("agent-unauthorized-error"),children:[!i&&(0,a.jsx)(o.K,{"aria-label":"Close",className:"position-absolute top-0 right-0 mt-2 mr-2",icon:s.XIcon,onClick:p,variant:"invisible",unsafeDisableTooltip:!0}),(0,a.jsxs)("div",{className:"d-flex flex-items-center gap-2",children:[(0,a.jsx)(s.MarkGithubIcon,{size:48,className:"border circle borderColor-muted"}),(0,a.jsx)(s.LinkIcon,{className:"fgColor-muted"}),(0,a.jsx)("img",{className:(0,d.$)("avatar",h.A.agentUnauthorizedAvatar,"border circle borderColor-muted"),src:n.avatar_url,alt:`icon for ${n.name}`})]}),(0,a.jsxs)("p",{className:"h4 m-0 text-center",children:["Connect with ",n.name]}),(0,a.jsxs)("p",{className:"fgColor-muted text-center",children:["To use the ",n.name," extension, you\u2019ll need to connect your GitHub account to your ",n.name," account."]}),!i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Q,{as:"a",variant:"primary",size:"large",className:"width-full",href:n.authorize_url,rel:"noopener",target:"_blank",children:"Connect"}),(0,a.jsxs)("p",{className:"fgColor-muted text-center f6 m-0",children:["Click connect to be redirected to ",n.authorize_url]})]})]})}function x({errors:e}){return(0,a.jsx)("div",{className:"d-flex flex-column gap-2",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 border rounded-2",children:[(0,a.jsxs)("div",{className:"text-bold",children:[(0,a.jsx)(s.AlertFillIcon,{className:"mr-1 fgColor-attention"})," ","http"===e.type?`${e.code} ${e.identifier}`:`${(0,p.Z)(e.type)} error`]}),(0,a.jsx)(i.To,{markdown:e.message})]},t))})}try{f.displayName||(f.displayName="ErrorMessage")}catch{}try{y.displayName||(y.displayName="AgentUnauthorizedError")}catch{}try{x.displayName||(x.displayName="AgentErrors")}catch{}},47920:(e,t,n)=>{n.d(t,{G:()=>y});var a=n(74848),i=n(38621),r=n(87330),s=n(96540),o=n(65615),l=n(7426),c=n(72659),d=n(51349),u=n(2622),m=n(37937),p=n(54912);let h={thumbsUp:"MessageFeedbackDialog-module__thumbsUp--L1svG",thumbsDown:"MessageFeedbackDialog-module__thumbsDown--xdoe9"},g=[{name:"Bad",value:"NEGATIVE",icon:(0,a.jsx)(i.ThumbsdownIcon,{className:h.thumbsDown}),color:"bad"},{name:"Good",value:"POSITIVE",icon:(0,a.jsx)(i.ThumbsupIcon,{className:h.thumbsUp}),color:"good"}],f=(0,s.forwardRef)(function({messageId:e,threadId:t,returnFocusRef:n,onSubmitted:i,onClose:r},o){let c=(0,l.b)(),h=(0,s.useRef)(null),f=(0,s.useRef)(null),y=(0,s.useRef)(void 0);(0,s.useImperativeHandle)(o,()=>({openDialog:e=>{y.current=e,u.W.copilotChatInterviewSurvey?h.current?.openDialog():f.current?.openDialog(e)}}));let x=async(n,a)=>{let r=[];if(null==n&&r.push("Please select a rating."),a.length>500&&r.push("Please keep your feedback within 500 characters or less."),r.length>0)return r;try{(await c.service.sendFeedback({feedback:n,feedbackChoice:[],messageId:e,threadId:t,textResponse:a})).ok?i?.(n):r.push("An error occurred while submitting your feedback.")}catch{r.push("An error occurred while submitting your feedback.")}return r};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.E,{ref:h,title:"Give additional feedback",onClose:e=>{"no-thanks"===e?f.current?.openDialog(y.current):r?.()}}),(0,a.jsx)(d.N,{title:"Give additional feedback",ref:f,options:g,onSubmit:x,onClose:r,requestID:m.J.getRequestID(e),returnFocusRef:n})]})});function y({iconSize:e,onFeedbackSubmitted:t}){let{message:n}=(0,c.V)(),d=n.id,u=n.threadID,m=(0,l.b)(),p=(0,s.useRef)(null),h=(0,s.useRef)(null),g=(0,s.useCallback)(e=>{m.handleFeedback(n,e),t?.()},[m,n,t]),{optedInToUserFeedback:y}=(0,o.Pk)(),x=(0,s.useCallback)(e=>{m.service.sendFeedback({feedback:e,messageId:d,threadId:u}),g(e),y?p.current?.openDialog(e):h.current?.focus()},[m.service,d,u,h,g,y]);return(0,a.jsxs)(a.Fragment,{children:[null!=n.feedback?(0,a.jsx)(r.K,{ref:h,"aria-label":`${n.feedback.toLocaleLowerCase()} feedback submitted`,icon:"POSITIVE"===n.feedback?i.ThumbsupIcon:i.ThumbsdownIcon,variant:"invisible",size:e,"aria-disabled":!0,sx:{color:"fg.default",bg:"canvas.subtle"}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.K,{icon:i.ThumbsupIcon,"aria-label":"Good response",onClick:()=>x("POSITIVE"),variant:"invisible",size:e,className:"feedback-action"}),(0,a.jsx)(r.K,{icon:i.ThumbsdownIcon,size:e,"aria-label":"Bad response",onClick:()=>x("NEGATIVE"),variant:"invisible",className:"feedback-action"})]}),(0,a.jsx)(f,{ref:p,messageId:d,threadId:u,onSubmitted:g,returnFocusRef:h})]})}f.displayName="MessageFeedbackDialog";try{y.displayName||(y.displayName="Feedback")}catch{}},32132:(e,t,n)=>{n.d(t,{WA:()=>en,BO:()=>et});var a=n(74848),i=n(91295),r=n(38621),s=n(30631),o=n(75177),l=n(84217),c=n(52464),d=n(96540),u=n(77342),m=n(2622),p=n(37937),h=n(34614),g=n(63867),f=n(55847),y=n(15385),x=n(30729),v=n(82610),_=n(65615);let b={functionReferenceListContainer:"FunctionLoadingUtils-module__functionReferenceListContainer--nLEFp",functionLoading:"FunctionLoadingUtils-module__functionLoading--ksfrz",spinner:"FunctionLoadingUtils-module__spinner--dWC1I",functionReferenceButton:"FunctionLoadingUtils-module__functionReferenceButton--RThXV",functionReferenceButtonContents:"FunctionLoadingUtils-module__functionReferenceButtonContents--p5oMB",functionReferenceTitle:"FunctionLoadingUtils-module__functionReferenceTitle--P1oyO",functionReferenceListFooter:"FunctionLoadingUtils-module__functionReferenceListFooter--xNrSv"};function j({chatManager:e,functionCall:t,skillArgs:n}){let i=n.query;return(0,a.jsx)(L,{additionalFooterContent:(0,a.jsx)(h.A,{href:"https://privacy.microsoft.com/privacystatement",rel:"nofollow",target:"_blank",children:"Microsoft Privacy Statement"}),chatManager:e,errorButtonText:`An error occurred when searching for \u{201C}${i}\u{201D}`,errorTitle:"An error occurred when searching the web",toolLink:"https://bing.com",toolName:"Bing search",functionCall:t,inProgressMessage:`Searching the web for \u{201C}${i}\u{201D}`,noResultsMessage:`No web search results for \u{201C}${i}\u{201D} were found`,resultsMapper:e=>(e.references?.[0]?.results??[]).map(e=>({title:e.title,url:e.url,description:e.excerpt,leadingIcon:r.GlobeIcon})),successButtonText:`Using web search results for \u{201C}${i}\u{201D}`,useSelectReference:!1})}function C({chatManager:e,functionCall:t,skillArgs:n}){let s=n.query;return(0,a.jsx)(L,{additionalFooterContent:(0,a.jsx)(h.A,{href:"https://privacy.microsoft.com/privacystatement",rel:"nofollow",target:"_blank",children:"Microsoft Privacy Statement"}),chatManager:e,errorButtonText:`An error occurred when searching for \u{201C}${s}\u{201D}`,errorTitle:"An error occurred when searching the web",toolLink:"https://gh.io/azure-ai-agent-with-bing-grounding",toolName:"Bing Search",functionCall:t,inProgressMessage:`Searching the web for \u{201C}${s}\u{201D}`,noResultsMessage:`No web search results for \u{201C}${s}\u{201D} were found`,resultsMapper:e=>{let t=e.references?.[0];return(t?.results??[]).map(e=>({title:e.title,url:e.url,leadingIcon:"bing_search"===e.reference_type?i._:r.GlobeIcon}))},successButtonText:`Using web search results for \u{201C}${s}\u{201D}`,useSelectReference:!1})}function N({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){var r;let s=n.query,o="scopingQuery"in n?n.scopingQuery:n.repoOwner&&n.repoName?`repo:${n.repoOwner}/${n.repoName}`:void 0;o&&(o=(r=o).startsWith("repo:")?r.substring(5):r);let l="semantic-code-search"===n.kind?"semantic":"lexical";return(0,a.jsx)(L,{chatManager:e,errorButtonText:`An error occurred when searching for \u{201C}${s}\u{201D}`,errorTitle:"An error occurred when searching code",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:`${l.charAt(0).toUpperCase()+l.slice(1)} search`,functionCall:t,inProgressMessage:`Searching for \u{201C}${s}\u{201D}${o&&` in ${o}`}`,noResultsMessage:`No results were found when ${l} searching for \u{201C}${s}\u{201D}${o&&` in ${o}`}`,resultsMapper:$,successButtonText:`Using ${l} search results for \u{201C}${s}\u{201D}${o&&` in ${o}`}`,useSelectReference:i})}function w({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){let r=n.query,s=n.kbID,{knowledgeBases:o}=(0,_.Pk)(),l=o.find(e=>e.id===s),c=l?.name??"the knowledge base";return(0,a.jsx)(L,{chatManager:e,errorButtonText:`An error occurred when searching for \u{201C}${r}\u{201D} in ${c}`,errorTitle:"An error occurred when searching the knowledge base",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:"Knowledge base search",functionCall:t,inProgressMessage:`Searching the ${c} knowledge base for \u{201C}${r}\u{201D}`,noResultsMessage:`No results were found when searching the ${c} knowledge base for \u{201C}${r}\u{201D}`,resultsMapper:$,successButtonText:`Using search results from the ${c} knowledge base for \u{201C}${r}\u{201D}`,useSelectReference:i})}function I({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){let{path:s,repo:o,ref:l}=n;return(0,a.jsx)(L,{chatManager:e,errorButtonText:k(`An error occurred when finding \u{201C}${s}\u{201D} in ${o}`,l),errorTitle:"An error occurred when finding a file",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:"Get file",functionCall:t,inProgressMessage:k(`File results for \u{201C}${s}\u{201D} in ${o}`,l),noResultsMessage:k(`No files matching \u{201C}${s}\u{201D} in ${o} were found`,l),resultsMapper:e=>(e.references??[]).map(e=>"file-v2"===e.type?{description:`${e.repoName}/${e.path}`,leadingIcon:r.FileIcon,reference:e,title:(0,v.Xo)(e),url:e.url}:void 0),successButtonText:k(`Using results for \u{201C}${s}\u{201D} in ${o}`,l),useSelectReference:i})}function S({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){let{path:s,repo:o,ref:l}=n;return(0,a.jsx)(L,{chatManager:e,errorButtonText:k(`An error occurred when finding file changes for \u{201C}${s}\u{201D} in ${o}`,l),errorTitle:"An error occurred when finding the file changes",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:"Get file changes",functionCall:t,inProgressMessage:k(`File changes results for \u{201C}${s} in ${o}`,l),noResultsMessage:k(`No files changes were found for \u{201C}${s}\u{201D} in ${o}`,l),resultsMapper:e=>(e.references??[]).map(e=>"file-changes"===e.type?{description:`${e.repository.name}/${s}`,leadingIcon:r.FileIcon,reference:e,title:(0,v.Xo)(e),url:e.url}:void 0),successButtonText:k(`Using results for \u{201C}${s}\u{201D} in ${o}`,l),useSelectReference:i})}let k=(e,t)=>t?`${e} on ref ${t}`:e;function T({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){return(0,a.jsx)(L,{chatManager:e,errorButtonText:`An error occurred when fetching alert information for ${n.url}`,errorTitle:"An error occurred when fetching alert information",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:"Get alert information",functionCall:t,inProgressMessage:"Fetching alert information",noResultsMessage:"Unable to fetch alert information",resultsMapper:e=>(e.references??[]).map(e=>"alert.api"===e.type?{description:"Alert",leadingIcon:()=>(0,a.jsx)(r.ShieldIcon,{}),title:"Alert"}:void 0),successButtonText:"Using alert information",useSelectReference:i})}function A({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){return(0,a.jsx)(L,{chatManager:e,errorButtonText:"An error occurred when fetching discussion",errorTitle:"An error occurred when fetching discussion",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:"Get discussion",functionCall:t,inProgressMessage:`Fetching discussion ${n.discussionNumber}`,noResultsMessage:`Unable to fetch discussion ${n.discussionNumber}`,resultsMapper:e=>(e.references??[]).map(e=>"discussion"===e.type?{title:e.title??"Discussion",description:`Using discussion #${e.number} for ${e.repository.owner}/${e.repository.name}`,url:e.url,leadingIcon:r.CommentDiscussionIcon}:void 0),successButtonText:`Using discussion #${n.discussionNumber}`,useSelectReference:i})}function E({children:e}){return(0,a.jsxs)("div",{className:b.functionLoading,children:[(0,a.jsx)("span",{className:b.spinner,children:(0,a.jsx)(g.A,{size:"small"})}),(0,a.jsx)("span",{children:e})]})}function R({functionCall:e}){let{status:t}=e;if("started"===t)return(0,a.jsx)(E,{children:"Coming up with a plan"})}function P({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){let s=D(n);return(0,a.jsx)(L,{chatManager:e,errorButtonText:`An error occurred when fetching logs for ${s} in ${n.repo}`,errorTitle:"An error occurred when fetching a commit",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:"Get job logs",functionCall:t,inProgressMessage:`Fetching logs for ${s} in ${n.repo}`,noResultsMessage:`Unable to fetch logs for ${s} in ${n.repo}`,resultsMapper:e=>(e.references??[]).filter(e=>"job"===e.type).map(e=>({description:`${e.id} \xb7 ${e.repoOwner}/${e.repoName}`,leadingIcon:r.PlayIcon,title:"Job"})),successButtonText:`Using logs for ${s} in ${n.repo}`,useSelectReference:i})}function D(e){return e.jobId?`job ${e.jobId}`:e.runId?`workflow run ${e.runId}`:e.pullRequestNumber?`pull request ${e.pullRequestNumber}`:e.workflowPath?`workflow ${e.workflowPath}`:"unknown job"}function L({additionalFooterContent:e,chatManager:t,errorButtonText:n,errorTitle:i,functionCall:o,inProgressMessage:l,noResultsMessage:c,resultsMapper:u,successButtonText:m,toolLink:p,toolName:h,useSelectReference:g}){let[v,_]=(0,d.useState)(!1),j=(0,d.useId)(),C=u(o),{status:N,errorMessage:w}=o;if(o.references?.length===1){let e=o.references[0];if(e)switch(e.type){case"text":N="error",w=e.text;break;case"unsupported":N="unsupported",w=e.text}}return"started"===N?(0,a.jsx)(E,{children:l}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Q,{"aria-expanded":v,"aria-controls":j,className:b.functionReferenceButton,leadingVisual:v?r.ChevronUpIcon:r.ChevronDownIcon,onClick:()=>_(e=>!e),variant:"invisible",sx:{marginBottom:1},children:(0,a.jsx)("span",{className:b.functionReferenceButtonContents,children:"error"===N?n:"unsupported"===N?c:m})}),v&&(0,a.jsxs)("div",{id:j,className:b.functionReferenceListContainer,children:[(0,a.jsx)(y.l,{children:"error"===N?(0,a.jsxs)(y.l.Item,{children:[i,(0,a.jsx)(y.l.Description,{variant:"block",children:w})]}):"unsupported"===N?(0,a.jsxs)(y.l.Item,{children:[w,(0,a.jsx)(y.l.Description,{truncate:!0,children:""})]}):0===C.length?(0,a.jsxs)(y.l.Item,{children:[c,(0,a.jsx)(y.l.Description,{truncate:!0,children:"Try modifying your query by reframing your question."})]}):C.map((e,n)=>e&&(0,a.jsxs)(y.l.LinkItem,{className:"width-fit",href:e.url,onClick:n=>{g&&e.reference&&(t.selectReference(e.reference),n.preventDefault())},target:"_blank",rel:"noopener",children:[e.leadingIcon&&(0,a.jsx)(y.l.LeadingVisual,{children:(0,a.jsx)(x.A,{icon:e.leadingIcon,sx:{...e.leadingIconColor&&{color:e.leadingIconColor}}})}),(0,a.jsx)(s.A,{className:b.functionReferenceTitle,title:e.title,children:e.title}),(0,a.jsx)(y.l.Description,{variant:"block",children:e.description})]},n))}),(0,a.jsxs)("span",{className:b.functionReferenceListFooter,children:["Copilot used the"," ",(0,a.jsx)("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:h})," ","tool",e&&(0,a.jsxs)(a.Fragment,{children:[". ",e]})]})]})]})}function M({chatManager:e,functionCall:t,skillArgs:n,useSelectReference:i}){let s="GitHub API",o=t.references?.[0];if(o){let e=o.type;if(e.endsWith(".api")){let t=e.split(".")[0];t&&(s=`${t.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")} API`)}else"api-response"===o.type&&(s=`${o.resourceType} API`)}let l=n.endpointDescription?{errorButtonText:`An error occurred when using the GitHub API to ${n.endpointDescription}`,inProgressMessage:`Using the GitHub API to ${n.endpointDescription}`,noResultsMessage:`Unable to use the GitHub API to ${n.endpointDescription}`,successButtonText:`Using the GitHub API to ${n.endpointDescription}`}:{errorButtonText:`An error occurred when fetching from ${n.endpoint}`,inProgressMessage:`Fetching endpoint ${n.endpoint}`,noResultsMessage:`Unable to fetch from ${n.endpoint}`,successButtonText:`Using endpoint ${n.endpoint}`};return(0,a.jsx)(L,{chatManager:e,errorTitle:"An error occurred when fetching data from the GitHub API",toolLink:"https://docs.github.com/en/enterprise-cloud@latest/copilot/github-copilot-enterprise/copilot-chat-in-github/using-github-copilot-chat-in-githubcom#currently-available-skills",toolName:s,functionCall:t,errorButtonText:l.errorButtonText,inProgressMessage:l.inProgressMessage,noResultsMessage:l.noResultsMessage,successButtonText:l.successButtonText,useSelectReference:i,resultsMapper:e=>e.references?.filter(e=>"text"!==e.type).map(e=>(function(e,t){switch(e.type){case"release.api":return{description:`Release ${e.tag_name} \xb7 ${t.repo}`,leadingIcon:r.TagIcon,title:e.name??"Release",url:e.html_url};case"issue.api":return{description:`#${e.number} \xb7 ${t.repo}`,leadingIcon:r.IssueOpenedIcon,title:e.title??"Issue",url:e.html_url};case"pull-request.api":return{description:`#${e.number} \xb7 ${t.repo}`,leadingIcon:r.GitPullRequestIcon,title:e.title??"Pull request",url:e.html_url};case"repository.api":return{description:e.description||"",title:e.name,leadingIcon:r.RepoIcon,url:e.html_url};case"commit.api":return{description:`${e.sha} \xb7 ${t.repo}`,leadingIcon:r.GitCommitIcon,title:e.commit.message??"Commit",url:e.html_url};case"topic.api":return{description:e.short_description||"",leadingIcon:r.HashIcon,title:e.display_name??e.name};case"api-response":switch(e.resourceType){case"Repository":return{description:e.data.description||"",title:e.data.name,leadingIcon:r.RepoIcon,url:e.data.html_url};case"Issue":return{description:`#${e.data.number} \xb7 ${t.repo}`,leadingIcon:r.IssueOpenedIcon,title:e.data.title??"Issue",url:e.data.html_url};case"Release":return{description:`Release ${e.data.tag_name} \xb7 ${t.repo}`,leadingIcon:r.TagIcon,title:e.data.name??"Release",url:e.data.html_url};case"PullRequest":return{description:`#${e.data.number} \xb7 ${t.repo}`,leadingIcon:r.GitPullRequestIcon,title:e.data.title??"Pull request",url:e.data.html_url};case"Commit":return{description:`${e.data.sha} \xb7 ${t.repo}`,leadingIcon:r.GitCommitIcon,title:e.data.commit.message??"Commit",url:e.data.html_url};case"Topic":return{description:e.data.short_description||"",leadingIcon:r.HashIcon,title:e.data.display_name??e.data.name};default:return{description:"API endpoint returned results successfully",leadingIcon:r.InfoIcon,title:"API results"}}default:return{description:"API endpoint returned results successfully",leadingIcon:r.InfoIcon,title:"API results"}}})(e,n))??[]})}function O({chatManager:e,functionCall:t,skillArgs:n}){return(0,a.jsx)(L,{chatManager:e,errorButtonText:`An error occurred when retrieving \u{201C}${n.name}\u{201D}`,errorTitle:"An error occurred retrieving Figma file",toolLink:"https://figma.com",toolName:"Get Figma",functionCall:t,inProgressMessage:`Getting Figma file \u{201C}${n.name}\u{201D}`,noResultsMessage:`Unable to retrieve \u{201C}${n.name}\u{201D}`,resultsMapper:e=>{let t=e.references?.[0];return[{title:t?.title||"",url:t?.url||"",description:""}]},successButtonText:`Using result from \u{201C}${n.name}\u{201D}`,useSelectReference:!1})}let B="https://docs.github.com/en/support/contacting-github-support/using-copilot-in-github-support";function F({chatManager:e,functionCall:t,skillArgs:n}){let i=n.rawUserQuery;return(0,a.jsx)(L,{additionalFooterContent:(0,a.jsx)(h.A,{href:B,rel:"nofollow",target:"_blank",children:"Information on using Copilot in GitHub Support"}),chatManager:e,errorButtonText:`An error occurred when searching for \u{201C}${i}\u{201D}`,errorTitle:"An error occurred when searching support documents",toolLink:B,toolName:"Support Search",functionCall:t,inProgressMessage:`Searching support documents for \u{201C}${i}\u{201D}`,noResultsMessage:`No support documents for \u{201C}${i}\u{201D} were found`,resultsMapper:e=>(e.references?.[0]?.results??[]).map(e=>({title:e.title,url:e.url,description:e.url})),successButtonText:`Using support search results for \u{201C}${i}\u{201D}`,useSelectReference:!1})}function $(e){return(e.references??[]).map(e=>"file"===e.type||"snippet"===e.type?{description:(0,v.Z8)(e),leadingIcon:r.CodeIcon,reference:e,title:(0,v.z$)(e),url:e.url}:void 0)}try{j.displayName||(j.displayName="BingFunctionButton")}catch{}try{C.displayName||(C.displayName="BingGroundingFunctionButton")}catch{}try{N.displayName||(N.displayName="CodeSearchButton")}catch{}try{w.displayName||(w.displayName="KnowledgeBaseSearchButton")}catch{}try{I.displayName||(I.displayName="GetFileButton")}catch{}try{S.displayName||(S.displayName="GetFileChangesButton")}catch{}try{T.displayName||(T.displayName="GetAlertButton")}catch{}try{A.displayName||(A.displayName="GetDiscussionButton")}catch{}try{E.displayName||(E.displayName="FunctionLoading")}catch{}try{R.displayName||(R.displayName="PlanButton")}catch{}try{P.displayName||(P.displayName="GetJobLogsButton")}catch{}try{L.displayName||(L.displayName="ExpandableFunctionButton")}catch{}try{M.displayName||(M.displayName="GetGitHubDataButton")}catch{}try{O.displayName||(O.displayName="FigmaButton")}catch{}try{F.displayName||(F.displayName="SupportSearchButton")}catch{}let U=()=>(0,a.jsx)(r.SearchIcon,{}),z=()=>(0,a.jsx)(r.FileIcon,{}),V=()=>(0,a.jsx)(r.TagIcon,{}),W=()=>(0,a.jsx)(r.PlayIcon,{}),H=()=>(0,a.jsx)(r.BookIcon,{}),q=()=>(0,a.jsx)(r.CommentDiscussionIcon,{}),G=()=>(0,a.jsx)(r.TasklistIcon,{}),K="planning response",Q=e=>{switch(e.kind){case"bing-search":return{id:"bing-search",referenceType:"web-search",loadingText:`Using Bing to search for "${e.query}"`,completedText:`Bing results for "${e.query}"`,icon:i._,name:"Bing search",activeSkillText:"searching Bing"};case"lexical-code-search":return{id:"codesearch",loadingText:`Search for "${e.query}" in "${e.scopingQuery}"`,completedText:`Search results for "${e.query}" in "${e.scopingQuery}"`,icon:U,name:"Code search",activeSkillText:"searching the codebase"};case"semantic-code-search":return{id:"codesearch",loadingText:`Search for "${e.query}" in "${e.repoOwner}/${e.repoName}"`,completedText:`Search results for "${e.query}" in "${e.repoOwner}/${e.repoName}"`,icon:U,name:"Code search",activeSkillText:"searching the codebase"};case"kb-search":return{id:"kb-search",loadingText:`Searching for "${e.query}" in the knowledge base`,completedText:`Knowledge base search results for "${e.query}"`,icon:H,name:"Knowledge base search",activeSkillText:"searching the knowledge base"};case"getalert":return{id:"getalert",loadingText:"Retrieving information about alerts",completedText:"Including information about alerts",icon:()=>(0,a.jsx)(r.ShieldIcon,{}),name:"Get alert",activeSkillText:"getting alert"};case"get-github-data":return{id:"get-github-data",loadingText:`Fetching ${e.endpoint}`,completedText:`Results of ${e.endpoint}`,icon:V,name:"Get GitHub Data",activeSkillText:"getting data"};case"get-actions-job-logs":{let t=D(e),n=t.charAt(0).toUpperCase()+t.slice(1);return{id:"get-actions-jog-logs",loadingText:`Retrieving ${t} in ${e.repo}`,completedText:`${n} in ${e.repo}`,icon:W,name:"Get job logs",activeSkillText:"getting job logs"}}case"getdiscussion":return{id:"getdiscussion",loadingText:`Fetching discussion ${e.discussionNumber}`,completedText:`Details about discussion #${e.discussionNumber}`,icon:q,name:"Get discussion",activeSkillText:"getting discussion"};case"getfile":return{id:"getfile",loadingText:"Searching for file",completedText:"Using results of get file",icon:z,name:"Get file",activeSkillText:"searching for file"};case"getfilechanges":return{id:"getfilechanges",loadingText:"Searching for file changes",completedText:`File changes for ${e.path} in ${e.repo}`,icon:z,name:"Get file changes",activeSkillText:"searching for file changes"};case"planskill":return{id:"planskill",loadingText:"Planning response...",completedText:"Plan created",icon:G,name:"Plan skill",activeSkillText:"planning response"};case"support-search":return{id:"supportsearch",loadingText:"Searching for support documents",completedText:"Using results of support search",icon:H,name:"Support search",activeSkillText:"searching for support documents"};case"get-figma":return{id:"getfigma",loadingText:"Analyzing Figma file",completedText:"Using results of Figma file",icon:H,name:"Get Figma",activeSkillText:"analyzing Figma file"};case"codesearchagentskill":return{id:"codesearchagentskill",loadingText:"Using the code search agent",completedText:"Using results of code search agent",icon:H,name:"Code Search Agent",activeSkillText:"searching the codebase"}}};function J({maxWidth:e,functionMetadata:t}){return(0,a.jsxs)(a.Fragment,{children:[t.icon(),(0,a.jsx)(s.A,{title:t.completedText,sx:{maxWidth:e},children:t.completedText})]})}function Z({maxWidth:e,functionMetadata:t}){return(0,a.jsxs)(a.Fragment,{children:[t.icon(),(0,a.jsx)(s.A,{title:t.loadingText,sx:{maxWidth:e},children:t.loadingText})]})}function X({functionCall:e,functionMetadata:t}){return(0,a.jsxs)(o.A,{sx:{p:2},children:[(0,a.jsxs)(l.A,{as:"h3",sx:{fontSize:1},children:["An error occurred while ",t.activeSkillText]}),(0,a.jsx)(c.A,{as:"p",sx:{m:0},children:e.errorMessage}),(0,a.jsxs)(c.A,{as:"p",sx:{mt:2,mb:0,fontSize:0,fontWeight:"normal",color:"fg.subtle"},children:["Copilot used the ",(0,a.jsx)(c.A,{sx:{fontWeight:"semibold"},children:t.name})," tool"]})]})}function Y({functionCall:e,functionMetadata:t,panelWidth:n}){let i=n?n-130:p.J.DEFAULT_PANEL_WIDTH,r=e?.status==="error"?(0,a.jsx)(X,{functionCall:e,functionMetadata:t}):e?.status==="completed"?(0,a.jsx)(J,{maxWidth:i,functionMetadata:t}):(0,a.jsx)(Z,{maxWidth:i,functionMetadata:t});return(0,a.jsx)(o.A,{sx:{display:"flex",gap:"6px",alignItems:"center"},children:r})}function ee(e,t,n,i,r,s){if(!e||"confirmation error"===e.errorMessage)return null;switch(r.kind){case"bing-search":if(m.W.bingGroundingUIEnabled)return(0,a.jsx)(C,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});return(0,a.jsx)(j,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"lexical-code-search":case"semantic-code-search":return(0,a.jsx)(N,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"getalert":return(0,a.jsx)(T,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"getfile":return(0,a.jsx)(I,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"getfilechanges":return(0,a.jsx)(S,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"getdiscussion":return(0,a.jsx)(A,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"get-actions-job-logs":return(0,a.jsx)(P,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"kb-search":return(0,a.jsx)(w,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"planskill":return(0,a.jsx)(R,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"get-github-data":return(0,a.jsx)(M,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"support-search":return(0,a.jsx)(F,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});case"get-figma":if(!m.W.immersiveFigmaIntegration)return(0,a.jsx)(a.Fragment,{});return(0,a.jsx)(O,{chatManager:n,functionCall:e,skillArgs:r,useSelectReference:s});default:return(0,a.jsx)("div",{className:"border rounded-2 p-2",children:(0,a.jsx)(Y,{functionCall:e,functionMetadata:t,panelWidth:i,parsedArgs:r})})}}function et(e){return(0,d.useMemo)(()=>{if(!e.arguments||!u.xP.includes(e.slug))return{functionMetadata:void 0,functionRenderer:void 0,parsedArgs:void 0};let t={...JSON.parse(e.arguments),kind:e.slug};return{functionMetadata:Q(t),functionRenderer:ee,parsedArgs:t}},[e])}function en(e){if(!e)return K;let t=function(e){if(e)return Q({...JSON.parse(e?.arguments||"{}"),kind:e.slug})}(e);return e.statusMessage??t?.activeSkillText??K}try{U.displayName||(U.displayName="CodeSearchIcon")}catch{}try{z.displayName||(z.displayName="GetFileIcon")}catch{}try{V.displayName||(V.displayName="ReleaseIcon")}catch{}try{W.displayName||(W.displayName="JobIcon")}catch{}try{H.displayName||(H.displayName="KnowledgeBaseIcon")}catch{}try{q.displayName||(q.displayName="DiscussionIcon")}catch{}try{G.displayName||(G.displayName="PlanIcon")}catch{}try{J.displayName||(J.displayName="FunctionCompleted")}catch{}try{Z.displayName||(Z.displayName="FunctionLoading")}catch{}try{X.displayName||(X.displayName="FunctionError")}catch{}try{Y.displayName||(Y.displayName="FunctionTitle")}catch{}},79887:(e,t,n)=>{n.d(t,{h:()=>o});var a=n(74848),i=n(37827),r=n(34164);let s={interruptedBanner:"InterruptedBanner-module__interruptedBanner--XDG6C",hasContent:"InterruptedBanner-module__hasContent--NwTH4"};function o({messageHasContent:e}){return(0,a.jsx)(i.l,{className:(0,r.$)(s.interruptedBanner,e&&s.hasContent),"data-testid":"chat-message-interrupted",description:"Copilot was interrupted before it could finish this message.",hideTitle:!0,title:"Message interrupted",variant:"info"})}try{o.displayName||(o.displayName="InterruptedBanner")}catch{}},54912:(e,t,n)=>{n.d(t,{E:()=>d});var a=n(74848),i=n(10871),r=n(55847),s=n(27331),o=n(96540);let l={dialog:"InterviewSurveyDialog-module__dialog--vBqY6",body:"InterviewSurveyDialog-module__body--zTKei",primaryText:"InterviewSurveyDialog-module__primaryText--E49Ba InterviewSurveyDialog-module__text--AnLTc",secondaryText:"InterviewSurveyDialog-module__secondaryText--uX6h1 InterviewSurveyDialog-module__text--AnLTc",surveyLink:"InterviewSurveyDialog-module__surveyLink--LnhEL",noThanksButton:"InterviewSurveyDialog-module__noThanksButton--loLSW"};function c({title:e="Give feedback",onClose:t},n){let[c,d]=(0,o.useState)(!1);(0,o.useImperativeHandle)(n,()=>({openDialog:()=>d(!0)}));let u=e=>{d(!1),t?.(e)};return c&&(0,a.jsx)(s.l,{className:l.dialog,onClose:()=>u("close"),title:e,renderBody:()=>(0,a.jsxs)("div",{className:l.body,children:[(0,a.jsx)("img",{alt:"Mona and Copilot flying a Hubot-themed spaceship",src:"/images/modules/copilot-chat/mona-copilot-hubot-spaceship.png",srcSet:"/images/modules/copilot-chat/mona-copilot-hubot-spaceship@2x.png 2x"}),(0,a.jsx)("span",{className:l.primaryText,children:"Would you like to participate in our research?"}),(0,a.jsx)("span",{className:l.secondaryText,children:"You will be compensated for your time"}),(0,a.jsx)(i.z,{variant:"primary",className:l.surveyLink,href:"/github-copilot/chat/feedback/interview-survey",target:"_blank",children:"Book a session"}),(0,a.jsx)(r.Q,{variant:"link",className:l.noThanksButton,onClick:()=>u("no-thanks"),children:"No, thanks"})]})})}let d=(0,o.forwardRef)(c);try{c.displayName||(c.displayName="InterviewSurveyDialogInner")}catch{}try{d.displayName||(d.displayName="InterviewSurveyDialog")}catch{}},25408:(e,t,n)=>{n.d(t,{Y:()=>I});var a,i=n(74848),r=n(70170),s=n(46988),o=n(53949),l=n(11499),c=n(38568),d=n(57572),u=n(16255),m=n(73451),p=n(19647),h=n(55847),g=n(27331),f=n(96540),y=n(40961),x=n(65615),v=n(7426);let _={footerContainer:"PersonalInstructionsDialog-module__footerContainer--YsPvr"};var b=n(38621),j=n(15385);let C={Role:{tooltip:"Role, domain, style, and focus areas",body:`Your role:
- {role_type} expert in {domain}
- Focus on {key_skill_area}
`},Communication:{tooltip:"Language, tone and format",body:`Communication:
- Write in {tone/language}
- Reference {source_type} documentation
- Structure responses as {format}
`},"Code preferences":{tooltip:"Code style, patterns, and conventions",body:`Code guidelines:
- Use {language} conventions
- Follow {pattern/code_guidelines}
- Optimize for {goal}
`}},N=(0,f.forwardRef)(function(e,t){let{onSelect:n}=e,[a,r]=(0,f.useState)(!1);return(0,i.jsxs)("div",{ref:t,className:"d-inline-flex flex-justify-between position-absolute bgColor-default right-0 left-0 bottom-0 ml-2 mr-3",style:{marginBottom:"1px"},children:[(0,i.jsx)(j.l,{className:"d-inline-flex flex-wrap gap-2 rounded-2",children:a&&Object.entries(C)?.map(([e,t])=>i.jsxs(j.l.Item,{"aria-label":`${t.tooltip}`,className:"mx-0 border fgColor-muted d-inline-block width-auto",onSelect:()=>n(e,t.body),children:[i.jsx(b.PlusIcon,{}),e]},e))}),(0,i.jsx)(j.l,{className:"d-flex flex-column flex-justify-end",children:(0,i.jsx)(j.l.Item,{"aria-label":a?"Hide templates":"Show templates","data-testid":"toggle-templates",className:"fgColor-muted d-inline-block width-auto flex-justify-end mx-0",style:{border:"1px solid transparent"},onSelect:()=>r(!a),children:a?(0,i.jsx)(b.XIcon,{}):(0,i.jsx)(b.LightBulbIcon,{})})})]})});try{N.displayName||(N.displayName="PersonalInstructionsTemplates")}catch{}try{(a=PersonalInstructionsTemplatesWithRef).displayName||(a.displayName="PersonalInstructionsTemplatesWithRef")}catch{}let w=(e,t=500)=>{let[n,a]=(0,f.useState)(48);return(0,f.useEffect)(()=>{let n=(0,r.s)(()=>{e?.current&&a(e.current.clientHeight??48)},t),i=new ResizeObserver(n);return e?.current&&i.observe(e.current),()=>{n.cancel(),i?.disconnect?.()}},[e,t]),n},I=({onDismiss:e,returnFocusRef:t})=>{let n=(0,x.Pk)(),a=(0,v.b)(),[r,b]=(0,f.useState)(n.personalInstructions??""),[j,C]=(0,f.useState)(void 0),[I,k]=(0,f.useState)(!1),T=(0,f.useRef)(null),A=(0,f.useRef)(null),[E,R]=(0,f.useState)(""),P=w(A);(0,c.N)(()=>{T?.current&&(T.current.scrollTop=T.current.scrollHeight)},[r]);let D=(0,f.useCallback)(async()=>{if(!I){k(!0),E&&(0,s.BI)("copilot_personal_instruction_template_usage",{content:E});try{let n=await (0,d.lS)("/copilot/personal_instructions",{method:"POST",body:{prompt:r}});if(n.ok)(0,s.BI)("dotcom_chat.activate",{target:"PERSONAL_INSTRUCTIONS_SAVE",mode:"immersive"}),a.dispatch({type:"SET_PERSONAL_INSTRUCTIONS",personalInstructions:r}),(0,y.flushSync)(()=>e()),t.current?.focus();else{let e=await n.json();C(String(e.errorMessage))}}catch{C("An error occurred while saving your personal instructions.")}finally{k(!1)}}},[I,r,a,t,e,E]),L=(e,t)=>{t&&(b(r?`${r}
${t}`:t),R(e),T?.current?.focus())},M=()=>{D()},O=(0,f.useCallback)(()=>{(0,s.BI)("dotcom_chat.dismiss",{target:"PERSONAL_INSTRUCTIONS_DISMISS",mode:"immersive"}),(0,y.flushSync)(()=>e()),t.current?.focus()},[e,t]);return(0,i.jsx)(u.Z,{children:(0,i.jsx)(g.l,{onClose:O,title:"Personal instructions",subtitle:"Set up Copilot to align with your workflows and preferences. These instructions will only impact your personal conversation.",width:"large",renderBody:()=>(0,i.jsx)(g.l.Body,{children:(0,i.jsx)("form",{onSubmit:D,children:(0,i.jsxs)(m.A,{children:[(0,i.jsx)(m.A.Label,{visuallyHidden:!0,children:"Instructions"}),(0,i.jsx)("div",{className:"width-full position-relative",children:(0,i.jsxs)(l.tL,{commands:{"github:submit-form":M},children:[(0,i.jsx)(p.Ay,{ref:T,className:"width-full",style:{paddingBottom:`${P}px`},"aria-label":"Prompt",rows:7,name:"prompt",placeholder:"Your instructions",value:r,validationStatus:j||r.length>600?"error":void 0,...(0,o.G)("prompt-input"),onChange:e=>{b(e.target.value),C(void 0)}}),(0,i.jsx)(N,{ref:A,onSelect:L})]})}),(0,i.jsx)(S,{text:r,promptCharLimit:600}),j&&(0,i.jsx)(m.A.Validation,{variant:"error",children:(0,i.jsx)("span",{...(0,o.G)("error-message"),children:j})})]})})}),renderFooter:()=>(0,i.jsxs)("div",{className:_.footerContainer,children:[(0,i.jsx)(h.Q,{variant:"default",onClick:O,children:"Cancel"}),(0,i.jsx)(h.Q,{loading:I,loadingAnnouncement:"Saving personal instructions",variant:"primary",onClick:D,children:"Save"})]})})})};function S({text:e,promptCharLimit:t}){let n=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"text-tabular-nums",...(0,o.G)("current-character-count"),children:e.length})," ","/ ",t," characters"]});return(0,i.jsx)(i.Fragment,{children:e.length>t?(0,i.jsx)(m.A.Validation,{variant:"error",children:n}):(0,i.jsx)(m.A.Caption,{children:n})})}try{I.displayName||(I.displayName="PersonalInstructionsDialog")}catch{}try{S.displayName||(S.displayName="CharacterCount")}catch{}},57393:(e,t,n)=>{n.d(t,{X:()=>x});var a=n(74848),i=n(38621),r=n(16255),s=n(73451),o=n(19647),l=n(9591),c=n(75177),d=n(46309),u=n(81679),m=n(87330),p=n(55847),h=n(27331),g=n(96540),f=n(37937),y=n(7426);let x=({onDismiss:e,promptDialogRef:t})=>{let n=(0,y.b)(),x=f.J.settings,[v,_]=(0,g.useState)(x?.instructionPrompt||void 0),[b,j]=(0,g.useState)(x?.skillOverrides??[]),[C,N]=(0,g.useState)(x?.temperature||.7),w=(0,g.useRef)(void 0),I=(0,g.useCallback)(async()=>{if(w.current){_(w.current);return}let e=await n.getSystemPrompt();w.current=e,_(e)},[n]);(0,g.useEffect)(()=>{(async()=>{void 0===v&&await I()})()},[I,n,v]);let S=(0,g.useCallback)(()=>{I(),j([]),N(.7)},[I]);return(0,a.jsx)(r.Z,{children:(0,a.jsxs)(h.l,{ref:t,onClose:e,title:"Prompt Settings",width:"xlarge",sx:{overflow:"auto"},children:[(0,a.jsxs)(h.l.Body,{children:[(0,a.jsxs)(s.A,{children:[(0,a.jsx)(s.A.Label,{children:"System Instructions"}),(0,a.jsx)(s.A.Caption,{children:(0,a.jsx)("span",{children:"Make adjustments to the system instructions or add new instructions."})}),(0,a.jsx)(o.Ay,{block:!0,sx:{my:2},"aria-label":"Prompt",name:"Prompt",value:v,onChange:e=>_(e.target.value)})]}),(0,a.jsxs)(s.A,{sx:{pt:3},children:[(0,a.jsx)(s.A.Label,{children:"Temperature"}),(0,a.jsx)(s.A.Caption,{children:"Controls the randomness of the model's responses. Lower temperatures are more deterministic, while higher temperatures are more random."}),(0,a.jsx)(l.A,{type:"number",min:"0",max:"1",step:"0.01",block:!0,value:C,onChange:e=>N(Number(e.target.value))})]}),(0,a.jsx)(c.A,{sx:{fontSize:3,py:3},children:"Tools"}),b.map((e,t)=>(0,a.jsxs)(g.Fragment,{children:[(0,a.jsxs)(d.B,{direction:"horizontal",sx:{py:2},children:[(0,a.jsxs)(s.A,{children:[(0,a.jsx)(s.A.Label,{children:"Name"}),(0,a.jsx)(s.A.Caption,{children:(0,a.jsx)("span",{children:"Slug of tool you want to adjust"})}),(0,a.jsx)(l.A,{defaultValue:e.slug,onChange:e=>{b.map((n,a)=>{a===t&&(n.slug=e.target.value)})}})]}),(0,a.jsxs)(s.A,{children:[(0,a.jsx)(s.A.Label,{children:"Description"}),(0,a.jsx)(s.A.Caption,{children:(0,a.jsx)("span",{children:"Make changes to the tool description"})}),(0,a.jsx)(l.A,{defaultValue:e.description,onChange:n=>{b.map((a,i)=>{i===t&&(e.description=n.target.value)})}})]}),(0,a.jsxs)(s.A,{children:[(0,a.jsx)(s.A.Label,{id:"toggle",children:"Enabled?"}),(0,a.jsx)(u.A,{size:"small","aria-labelledby":"toggle",defaultChecked:e.enabled,onChange:e=>{b.map((n,a)=>{a===t&&(n.enabled=e)})}})]}),(0,a.jsx)(m.K,{icon:i.TrashIcon,"aria-label":"Delete tool",variant:"invisible",sx:{mt:"20px"},onClick:()=>{let e=[...b];1===b.length?j([]):(e.splice(t,1),j(e))}})]}),t===b.length-1&&(0,a.jsx)(p.Q,{leadingVisual:(0,a.jsx)(i.PlusIcon,{}),onClick:()=>j([...b,{slug:"",description:"",enabled:!0}]),variant:"invisible",size:"small",children:"Add another tool"})]},`tool-${e.slug}-${Math.random()}`)),0===b.length&&(0,a.jsx)(p.Q,{leadingVisual:(0,a.jsx)(i.PlusIcon,{}),onClick:()=>j([...b,{slug:"",description:"",enabled:!0}]),variant:"invisible",size:"small",children:"Add a tool"})]}),(0,a.jsx)(h.l.Footer,{children:(0,a.jsx)(h.l.Buttons,{buttons:[{type:"button",onClick:e,content:"Cancel"},{type:"button",onClick:S,content:"Reset"},{type:"submit",onClick:()=>{let t=b.filter(e=>e.slug&&e.description);n.setCopilotSettings({instructionPrompt:v||"",skillOverrides:t,temperature:C}),e()},content:"Save",buttonType:"primary"}]})})]})})};try{x.displayName||(x.displayName="PromptDialog")}catch{}},60068:(e,t,n)=>{n.d(t,{B:()=>v,a:()=>_});var a,i=n(74848),r=n(91295),s=n(38621),o=n(87330),l=n(63867),c=n(35642),d=n(34164),u=n(96540),m=n(82610),p=n(65615),h=n(7426),g=n(54006),f=n(90591);let y={referenceToken:"ReferenceToken-module__referenceToken--MoDht",small:"ReferenceToken-module__small--LxJV_",loadingName:"ReferenceToken-module__loadingName--OEUm0",name:"ReferenceToken-module__name--Wq2Bs",trailingVisual:"ReferenceToken-module__trailingVisual--JeIeK",removeButton:"ReferenceToken-module__removeButton--BIbYP",icon:"ReferenceToken-module__icon--WJse5",openIcon:"ReferenceToken-module__openIcon--LVVWZ",closedIcon:"ReferenceToken-module__closedIcon--qYsTG",pullRequestClosedIcon:"ReferenceToken-module__pullRequestClosedIcon--ivG0w",pullRequestMergedIcon:"ReferenceToken-module__pullRequestMergedIcon--S1IFs",figmaIconOuter:"ReferenceToken-module__figmaIconOuter--PpoUe",figmaIcon:"ReferenceToken-module__figmaIcon--x5K98"};var x=n(12649);let v=(0,u.forwardRef)(function({reference:e,onClick:t,onRemove:n,size:a,getReferenceVersion:r},l){let g=(0,h.b)(),f=(0,p.pn)(e=>"immersive"===e.mode),v=_(e,(0,m.P)((0,p.A3)("currentTopic"))),b=(0,u.useId)(),j=r?.(e);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("a",{href:(0,m.JP)(e),className:(0,d.$)(y.referenceToken,"small"===a&&y.small),onKeyDown:e=>{n&&("Delete"===e.key||"Backspace"===e.key)&&(e.preventDefault(),n())},onClick:n=>{if((!t||(t(n,e),!n.defaultPrevented))&&!f){if(("issue"===e.type||"pull-request"===e.type||"discussion"===e.type)&&(window.open(e.url,"_blank"),self.focus()),["file","thread-scoped-file"].includes(e.type)){window.open("/copilot","_blank");return}["repository","folder","docset","third-party","image","issue","pull-request"].includes(e.type)||(n.preventDefault(),g.selectReference(e))}},ref:l,"aria-describedby":n&&b,children:[v&&(0,i.jsx)(v,{size:"small",className:(0,d.$)(y.icon,v===s.IssueOpenedIcon&&y.openIcon,v===s.GitPullRequestIcon&&y.openIcon,v===s.IssueClosedIcon&&y.closedIcon,v===s.GitPullRequestClosedIcon&&y.pullRequestClosedIcon,v===s.GitMergeIcon&&y.pullRequestMergedIcon)}),"loading"===e.type?(0,i.jsx)("span",{className:y.loadingName,children:(0,i.jsx)(c.r,{"aria-label":(0,m.z$)(e)})}):(0,i.jsx)("span",{className:y.name,children:(0,m.z$)(e)}),void 0!==j&&(0,i.jsx)("span",{className:y.trailingVisual,children:(0,i.jsx)(x.g,{version:j})}),n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.K,{tabIndex:-1,"aria-hidden":!0,size:a,icon:s.XIcon,"aria-label":"Remove",onClick:e=>{e.stopPropagation(),e.preventDefault(),n()},tooltipDirection:"n",variant:"invisible",className:y.removeButton}),(0,i.jsx)("span",{hidden:!0,id:b,children:"press backspace or delete to remove"})]})]})})});function _(e,t){switch(e.type){case"figma":return b;case"file":return s.FileIcon;case"folder":return s.FileDirectoryFillIcon;case"file-diff":return s.FileDiffIcon;case"snippet":return t&&"languageName"in e&&e.languageName&&g.Yr.has(e.languageName)?s.BookIcon:s.CodeIcon;case"repository":return s.RepoIcon;case"symbol":return s.CodeSquareIcon;case"docset":return s.BookIcon;case"commit":return s.GitCommitIcon;case"pull-request":return function(e){if("pull-request"===e.type){if(e.draft&&"open"===e.state)return s.GitPullRequestDraftIcon;switch(e.state){case"open":default:return s.GitPullRequestIcon;case"closed":return s.GitPullRequestClosedIcon;case"merged":return s.GitMergeIcon}}}(e);case"repo-instructions":case"org-instructions":return s.NoteIcon;case"image":return"attachment"in e&&!e.attachment.isLoaded?l.A:s.ImageIcon;case"issue":return function(e){if("issue"===e.type)switch(e.state){case"open":default:return s.IssueOpenedIcon;case"closed":return s.IssueClosedIcon;case"not_planned":return s.SkipIcon}}(e);case"draft-issue":return s.IssueDraftIcon;case"discussion":return s.CommentDiscussionIcon;case"web-search-result":return function(e){if("web-search-result"===e.type)return"bing_search"===e.reference_type?r._:s.GlobeIcon}(e);case"thread-scoped-file":return"language"in e&&g.Yr.has(e.language)?s.MarkdownIcon:s.CodeIcon;case"loading":return l.A;default:return}}function b(){return(0,i.jsx)("div",{className:y.figmaIconOuter,children:(0,i.jsx)(f._,{className:y.figmaIcon})})}try{v.displayName||(v.displayName="ReferenceToken")}catch{}try{(a=Icon).displayName||(a.displayName="Icon")}catch{}try{b.displayName||(b.displayName="StylizedFigmaIcon")}catch{}},82005:(e,t,n)=>{n.d(t,{$:()=>l});var a=n(74848),i=n(38621),r=n(87330),s=n(2914),o=n(80938);function l({handleRetryMessage:e,disabled:t=!1,showModelPicker:n=!1,model:l,navigateToNewThread:c}){let{isLicensedLimited:d}=(0,s.xR)();if(n&&(!c||!l))throw Error("navigateToNewThread and model must be provided in order to show the model picker");return n?(0,a.jsx)(o.Yb,{onNewThreadSelected:c,limited:d,type:"message-retry",selectedModel:l,onModelSelected:e,disabled:t}):(0,a.jsx)(r.K,{variant:"invisible","aria-label":"Retry","data-testid":"retry-button",onClick:()=>{e(l)},icon:i.SyncIcon,disabled:t})}try{l.displayName||(l.displayName="RetryButton")}catch{}},26443:(e,t,n)=>{n.d(t,{A:()=>x});var a=n(74848),i=n(52450),r=n(34164),s=n(96540);let o={scrollContainer:"ServiceView-module__scrollContainer--LFK5G",contentContainer:"ServiceView-module__contentContainer--DZVDS",content:"ServiceView-module__content--B7ctp",empty:"ServiceView-module__empty--I19W6",banner:"ServiceView-module__banner--kVai_",serviceHeader:"ServiceView-module__serviceHeader--R2TLR",serviceDescription:"ServiceView-module__serviceDescription--koXJM",serviceTitle:"ServiceView-module__serviceTitle--orySH",serviceIcon:"ServiceView-module__serviceIcon--a2C77",section:"ServiceView-module__section--_ycAN",sectionTitle:"ServiceView-module__sectionTitle--hD3JM",sectionGrid:"ServiceView-module__sectionGrid--Fa4lP",sectionGridEmpty:"ServiceView-module__sectionGridEmpty--KiT2u",skeletonCard:"ServiceView-module__skeletonCard--MT87J"};function l({children:e,empty:t}){let n=[],i=[];for(let t of s.Children.toArray(e))s.isValidElement(t)&&t.type===c?n.push(t):i.push(t);return(0,a.jsx)("div",{className:o.scrollContainer,children:(0,a.jsxs)("div",{className:o.contentContainer,children:[n,(0,a.jsx)("div",{className:(0,r.$)(o.content,{[o.empty]:t}),children:i})]})})}function c({children:e}){return(0,a.jsx)("div",{className:o.banner,children:e})}function d({children:e}){return(0,a.jsx)("div",{className:o.serviceHeader,children:e})}function u({children:e}){return(0,a.jsx)("section",{className:o.section,children:e})}function m({icon:e}){return(0,a.jsx)("div",{className:o.serviceIcon,children:e})}function p({children:e}){return(0,a.jsx)("h2",{className:o.serviceTitle,children:e})}function h({children:e}){return(0,a.jsx)("p",{className:o.serviceDescription,children:e})}function g({children:e}){return(0,a.jsx)("h3",{className:o.sectionTitle,children:e})}function f({children:e}){return(0,a.jsx)("div",{className:o.sectionGridEmpty,children:e})}function y({children:e,loading:t=!1}){if(t)return(0,a.jsx)("div",{className:o.sectionGrid,"data-testid":"service-view-skeleton",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(i.f,{className:o.skeletonCard},t))});let n=s.Children.toArray(e),r=n.find(e=>s.isValidElement(e)&&e.type===f),l=n.filter(e=>!(s.isValidElement(e)&&e.type===f));return 0===l.length&&r?(0,a.jsx)(a.Fragment,{children:r}):(0,a.jsx)("div",{className:o.sectionGrid,children:l})}y.Empty=f,u.Title=g,u.Grid=y;let x={Icon:m,Title:p,Description:h,Container:l,Banner:c,Header:d,Section:u};try{l.displayName||(l.displayName="ServiceContainer")}catch{}try{c.displayName||(c.displayName="ServiceBanner")}catch{}try{d.displayName||(d.displayName="ServiceHeader")}catch{}try{u.displayName||(u.displayName="ServiceSection")}catch{}try{m.displayName||(m.displayName="Icon")}catch{}try{p.displayName||(p.displayName="Title")}catch{}try{h.displayName||(h.displayName="Description")}catch{}try{g.displayName||(g.displayName="SectionTitle")}catch{}try{f.displayName||(f.displayName="SectionGridEmpty")}catch{}try{y.displayName||(y.displayName="SectionGrid")}catch{}},73786:(e,t,n)=>{n.d(t,{M:()=>o});var a=n(74848),i=n(69676),r=n(82678),s=n(96540);function o(e){let{className:t,...n}=e,o=(0,s.useRef)(null);return(0,r.G)({containerRef:o,focusInStrategy:"first",focusOutBehavior:"stop",bindKeys:i.z0.ArrowHorizontal|i.z0.HomeAndEnd}),(0,a.jsx)("div",{ref:o,className:t,role:"toolbar",...n,children:e.children})}try{o.displayName||(o.displayName="Toolbar")}catch{}},4181:(e,t,n)=>{n.d(t,{R:()=>c});var a=n(74848),i=n(34614),r=n(34164),s=n(21057);let o={container:"UserMessage-module__container--cAvvK"},l=RegExp(`^(?:${s.Z3}(\\S+))?(.*)`,"s");function c({children:e,className:t,accessibleHeader:n}){let[,i,s=""]=l.exec(e)??[];return(0,a.jsxs)(a.Fragment,{children:[n&&(0,a.jsx)("h3",{className:"sr-only",children:n}),(0,a.jsxs)("div",{className:(0,r.$)(o.container,t),children:[i&&(0,a.jsx)(d,{slug:i}),s]})]})}function d({slug:e}){let{availableAgents:t}=(0,s.JE)(),n=`${s.Z3}${e}`,r=t?.find(t=>t.slug===e);return r?(0,a.jsx)(i.A,{href:r.integrationUrl,"data-hovercard-url":`/integrations/${e}/hovercard`,className:"bgColor-accent-muted",children:n}):n}try{c.displayName||(c.displayName="UserMessage")}catch{}try{d.displayName||(d.displayName="AgentLink")}catch{}},12649:(e,t,n)=>{n.d(t,{g:()=>s});var a=n(74848),i=n(2676);let r={version:"VersionName-module__version--DI4zD"};function s({"data-testid":e,version:t}){return(0,a.jsxs)(i.A,{className:r.version,as:"span","data-testid":e,children:["v",t]})}try{s.displayName||(s.displayName="VersionName")}catch{}},90591:(e,t,n)=>{n.d(t,{_:()=>i});var a=n(74848);function i({className:e,...t}){return(0,a.jsxs)("svg",{"aria-label":"Figma logo",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,...t,children:[(0,a.jsxs)("g",{clipPath:"url(#clip0_216_3161)",children:[(0,a.jsx)("path",{d:"M7.99837 7.99967C7.99837 6.52683 9.1922 5.33301 10.665 5.33301C12.1379 5.33301 13.3317 6.52683 13.3317 7.99967C13.3317 9.47252 12.1379 10.6663 10.665 10.6663C9.1922 10.6663 7.99837 9.47252 7.99837 7.99967Z",fill:"#1ABCFE"}),(0,a.jsx)("path",{d:"M2.66504 13.3337C2.66504 11.8608 3.85886 10.667 5.33171 10.667H7.99837V13.3337C7.99837 14.8065 6.80455 16.0003 5.33171 16.0003C3.85886 16.0003 2.66504 14.8065 2.66504 13.3337Z",fill:"#0ACF83"}),(0,a.jsx)("path",{d:"M7.99837 0V5.33333H10.665C12.1379 5.33333 13.3317 4.13951 13.3317 2.66667C13.3317 1.19382 12.1379 0 10.665 0H7.99837Z",fill:"#FF7262"}),(0,a.jsx)("path",{d:"M2.665 2.66667C2.665 4.13951 3.85883 5.33333 5.33167 5.33333H7.99833V0H5.33167C3.85883 0 2.665 1.19382 2.665 2.66667Z",fill:"#F24E1E"}),(0,a.jsx)("path",{d:"M2.66504 7.99967C2.66504 9.47252 3.85886 10.6663 5.33171 10.6663H7.99837V5.33301H5.33171C3.85886 5.33301 2.66504 6.52683 2.66504 7.99967Z",fill:"#A259FF"})]}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_216_3161",children:(0,a.jsx)("rect",{width:"10.6667",height:"16",fill:"white",transform:"translate(2.665)"})})})]})}try{i.displayName||(i.displayName="FigmaIcon")}catch{}},2497:(e,t,n)=>{n.d(t,{Vx:()=>d});var a,i,r=n(74848),s=n(38621),o=n(96540),l=n(84976);let c={subList:"Navigation-module__subList--Ued7A",section:"Navigation-module__section--KRddB",expandButton:"Navigation-module__expandButton--v40lv",item:"Navigation-module__item--KtIqz",link:"Navigation-module__link--ybSvz",contextButton:"Navigation-module__contextButton--AhNds",icon:"Navigation-module__icon--szbQF",textWrapper:"Navigation-module__textWrapper--qEAz8",text:"Navigation-module__text--KFINZ"};function d({"aria-current":e,children:t,contextMenuComponent:n,expandOnClick:a=!0,hasItems:i,href:d,icon:u,iconOverride:m,onLinkClick:p,id:h,displayName:g}){let[f,y]=(0,o.useState)(!1),x={"aria-current":e,className:c.link,onClick:e=>{p?.(e,h),a&&y(!0)}};return(0,r.jsxs)("li",{className:c.section,children:[(0,r.jsxs)("div",{className:c.item,children:[i&&(0,r.jsx)("button",{"aria-label":"Expand","aria-expanded":f,className:c.expandButton,onClick:()=>{y(!f)},children:f?(0,r.jsx)(s.ChevronDownIcon,{size:12}):(0,r.jsx)(s.ChevronRightIcon,{size:12})}),(0,r.jsxs)(l.N_,{to:d,...x,children:[u?(0,r.jsx)(u,{size:16,className:c.icon}):m,(0,r.jsx)("div",{className:c.textWrapper,children:(0,r.jsx)("div",{className:c.text,children:g})})]}),n]}),f&&i&&(0,r.jsx)("ul",{className:c.subList,children:t})]})}try{d.displayName||(d.displayName="Navigation")}catch{}try{(a=function({"aria-current":e,contextMenuComponent:t,displayName:n,href:a,icon:i,iconOverride:s,onLinkClick:o}){return(0,r.jsxs)("li",{className:c.item,children:[(0,r.jsxs)(l.N_,{className:c.link,to:a,"aria-current":e,onClick:o,children:[i?(0,r.jsx)(i,{size:16,className:c.icon}):s,(0,r.jsx)("div",{className:c.textWrapper,children:(0,r.jsx)("div",{className:c.text,children:n})})]}),t]})}).displayName||(a.displayName="NavigationSubItem")}catch{}try{(i=function(e){return(0,r.jsx)("button",{...e,className:c.contextButton,children:(0,r.jsx)(s.KebabHorizontalIcon,{size:16})})}).displayName||(i.displayName="NavigationContextMenuButton")}catch{}},88104:(e,t,n)=>{n.d(t,{BH:()=>C,xx:()=>w});var a=n(74848),i=n(65615),r=n(2622),s=n(42252),o=n(26677),l=n(96540),c=n(32837),d=n(54533),u=n(7426),m=n(82610),p=n(80688),h=n(46996);let g=["thread-scoped-file","draft-issue"],f=e=>!!e.isUserEdited,y=(e,t)=>e.size===t.size&&Array.from(e).every(([e,n])=>(0,h.A)(t.get(e),n)),x=(e,t)=>!y(new Map(e.filter(e=>g.includes(e.type)).map(e=>[(0,m.Vb)(e),e])),new Map(t.filter(e=>g.includes(e.type)).map(e=>[(0,m.Vb)(e),e]))),v=(e,t)=>!y(new Map(Array.from(e).filter(([,e])=>f(e))),new Map(Array.from(t).filter(([,e])=>f(e)))),_=(0,l.createContext)(void 0),b=new Map,j=[];function C({children:e}){let[t,n]=(0,l.useState)(b),[o,h]=(0,l.useState)(j),[y,C]=(0,l.useState)(j),[w,I]=(0,l.useState)(void 0),[S,k,T]=(0,c.B)(!1),[A,E,R]=(0,c.B)(!1),P=(0,s.S)((0,i.pn)(e=>e.selectedThreadID)),D=(0,i.pn)(e=>e.selectedThreadID);(0,l.useEffect)(()=>{P&&P!==D&&(n(b),h(j),I(void 0),null===D&&T())},[T,D,P]);let L=(0,l.useCallback)((e,t=!0)=>{h(t=>{if(t.includes(e))return t;let n=(0,d.oy)(e),a=t.findIndex(e=>(0,d.oy)(e)===n),i=[...t];return -1===a?i.push(e):i.splice(a,1,e),i}),I(n=>t||void 0===n||(0,d.oy)(n)===(0,d.oy)(e)?e:n)},[]),M=(0,l.useCallback)(e=>{n(t=>{let n=new Map(t);return n.set(e.id,e),n})},[]),O=(0,l.useCallback)(e=>{let t=o.indexOf(e),n=o.toSpliced(t,1);w===e&&I(n[t-1]??n[0]),h(n)},[o,w]),B=(0,l.useCallback)(()=>{h(j),I(void 0)},[]),F=(0,l.useMemo)(()=>{let e=new Map;for(let[n,a]of t){let t=(0,d.oy)(n),i=e.get(t)??[];i.push(a.id),e.set(t,i)}for(let n of e.values())n.sort((e,n)=>{let a=t.get(e),i=t.get(n);return"timestamp"in a&&"timestamp"in i?a.timestamp.valueOf()-i.timestamp.valueOf():0});return e},[t]),$=(0,l.useCallback)(e=>{if(e){for(let t of e)if(n(e=>{let n=new Map(e);return n.delete(t)?n:e}),o.includes(t)){let e=(0,d.oy)(t),n=F.get(e),a=n?.indexOf(t)??-1,i=n?.[a-1];i?L(i,!1):O(t)}}else n(b),h(j),I(void 0)},[L,O,F,o]),U=(0,l.useMemo)(()=>({items:t,versionedItems:F,openItems:S?o:j,openItemsBeforeSubthreadChange:y,previewPaneOpen:S,selectedItem:w,updateItem:M,setOpenItemsBeforeSubthreadChange:C,openItem:L,closeItem:O,openPreviewPane:k,closePreviewPane:T,removeItems:$,showLoadingState:A,enableLoadingState:E,disableLoadingState:R,closeAllItems:B}),[t,F,S,o,y,w,M,L,O,k,T,$,A,E,R,B]);return N(U),!function({items:e,removeItems:t,updateItem:n}){let{currentReferences:a,messages:s,selectedThreadID:o}=(0,i.Pk)(),c=(0,u.b)(),h=(0,l.useRef)(e),y=(0,l.useRef)(a),_=(0,p.A)("sessionStorage");(0,l.useEffect)(()=>{let i=v(h.current,e);h.current=e;let l=x(y.current,a);if(y.current=a,i){let t=new Map(Array.from(e.values()).filter(f).map(e=>(0,d.g)(e)).filter(e=>null!=e).map(e=>[(0,m.Vb)(e),e])),n=new Set;for(let e of a)if(g.includes(e.type)){let a=(0,m.Vb)(e);n.add(a);let i=t.get(a);i?x([i],[e])&&c.addReference(i,"content-preview"):c.removeReference(e)}for(let[e,a]of t)n.has(e)||c.addReference(a,"content-preview")}else if(l){let i=new Map(a.map(e=>(0,d.oR)({ref:e,messageIndex:s.length})).filter(e=>null!=e).map(e=>[e.id,e])),l=new Set;for(let[a,s]of e)if(f(s)){l.add(a);let e=i.get(a);null!=e?v(new Map([[e.id,e]]),new Map([[s.id,s]]))&&n(e):(t([a]),r.W.copilotPersistEditedDraftIssues&&_.removeItem(`edited-${o}-${a}`))}for(let[e,t]of i)l.has(e)||n(t)}},[e,c,a,s.length,t,n,_,o])}(U),(0,a.jsx)(_.Provider,{value:U,children:e})}let N=({updateItem:e})=>{let{messagesLoading:t,selectedThreadID:n}=(0,i.Pk)(),a=`edited-${n}`,s=(0,l.useMemo)(()=>r.W.copilotPersistEditedDraftIssues?(0,o.MV)(a):[],[a]);(0,l.useEffect)(()=>{if(s&&"loaded"===t.state)for(let t of s)e(t)},[s,e,t.state])};function w(){let e=(0,l.useContext)(_);if(!e)throw Error("useContentPreview must be used within ContentPreviewContextProvider");return e}try{_.displayName||(_.displayName="ContentPreviewContext")}catch{}try{C.displayName||(C.displayName="ContentPreviewProvider")}catch{}},16184:(e,t,n)=>{n.d(t,{O:()=>N});var a=n(74848),i=n(38621),r=n(75177),s=n(84217),o=n(87330),l=n(55847),c=n(15385),d=n(63867),u=n(30729),m=n(96540);function p({children:e}){return(0,a.jsx)(r.A,{sx:{overflow:"auto",maxHeight:"calc(100dvh - 64px - 52px)"},children:(0,a.jsx)(r.A,{sx:{overflow:"hidden",backgroundColor:"canvas.default"},children:(0,a.jsx)(r.A,{sx:{display:"flex",flexDirection:"column"},children:e})})})}function h({children:e,onDismiss:t}){return(0,a.jsxs)(s.A,{as:"h3",sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:"16px",fontSize:1},children:[(0,a.jsx)(r.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",minWidth:0,"@media screen and (max-width: 768px)":{maxWidth:"80%"}},children:e}),t&&(0,a.jsx)(o.K,{unsafeDisableTooltip:!0,"aria-label":"Dismiss",icon:i.XIcon,onClick:t,variant:"invisible",sx:{flexShrink:0}})]})}function g({children:e}){return(0,a.jsx)(r.A,{sx:{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))",borderTop:"1px solid var(--borderColor-default, var(--color-border-default))",backgroundColor:"canvas.subtle",px:3,py:2},children:e})}function f({children:e,title:t,initiallyOpen:n}){let[r,s]=(0,m.useState)(n??!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.Q,{onClick:()=>s(e=>!e),sx:{borderRadius:0,backgroundColor:"canvas.default",border:"none",borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))",'[data-component="buttonContent"]':{justifyContent:"start"}},children:[(0,a.jsx)(u.A,{icon:r?i.ChevronDownIcon:i.ChevronRightIcon,sx:{mr:2}}),t]}),r&&e]})}function y({children:e}){return(0,a.jsx)(r.A,{sx:{padding:3},children:e})}function x({direction:e,onExpand:t}){return(0,a.jsx)(l.Q,{onClick:t,sx:{borderRadius:0,backgroundColor:"canvas.default",border:"none",px:3,py:2,width:"100%",fontSize:0,fontWeight:"normal",color:"fg.muted",'[data-component="buttonContent"]':{justifyContent:"start"},..."above"===e?{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))"}:{borderTop:"1px solid var(--borderColor-default, var(--color-border-default))"}},children:(0,a.jsxs)(r.A,{sx:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(u.A,{icon:"below"===e?i.FoldDownIcon:i.FoldUpIcon,sx:{mr:2}}),"Show content ",e]})})}function v({children:e}){return(0,a.jsx)(c.l,{children:(0,a.jsxs)(c.l.Group,{children:[(0,a.jsx)(c.l.GroupHeading,{as:"h3",children:"Reference details"}),e]})})}function _({children:e,href:t,icon:n}){return(0,a.jsxs)(c.l.LinkItem,{href:t,children:[(0,a.jsx)(c.l.LeadingVisual,{children:(0,a.jsx)(u.A,{icon:n})}),e]})}function b(){return(0,a.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",m:"auto",p:3},children:[(0,a.jsx)(d.A,{sx:{mb:2}}),(0,a.jsx)("div",{children:"Loading..."})]})}function j(){return(0,a.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,a.jsx)(r.A,{sx:{color:"danger.fg",fontWeight:"bold"},children:"Failed to load reference details"})})}function C({children:e,detailsError:t,detailsLoading:n}){return t?(0,a.jsx)(j,{}):n?(0,a.jsx)(b,{}):(0,a.jsx)(a.Fragment,{children:e})}let N={Frame:p,Header:h,Body:C,Content:y,CollapsibleSubsection:f,ContentExpander:x,Details:v,DetailLink:_,SectionDivider:g};try{p.displayName||(p.displayName="Frame")}catch{}try{h.displayName||(h.displayName="Header")}catch{}try{g.displayName||(g.displayName="SectionDivider")}catch{}try{f.displayName||(f.displayName="CollapsibleSubsection")}catch{}try{y.displayName||(y.displayName="Content")}catch{}try{x.displayName||(x.displayName="ContentExpander")}catch{}try{v.displayName||(v.displayName="Details")}catch{}try{_.displayName||(_.displayName="DetailLink")}catch{}try{b.displayName||(b.displayName="Loading")}catch{}try{j.displayName||(j.displayName="Error")}catch{}try{C.displayName||(C.displayName="Body")}catch{}},91295:(e,t,n)=>{n.d(t,{_:()=>d,I:()=>c});var a=n(74848),i=n(75177),r=n(52464),s=n(34614),o=n(16184);let l={"bing-icon":"WebSearchReferencePreview-module__bing-icon--kFZ4I"};function c({reference:e,onDismiss:t}){return(0,a.jsxs)(o.O.Frame,{children:[(0,a.jsx)(o.O.Header,{onDismiss:t,children:(0,a.jsxs)(i.A,{sx:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:2},children:[(0,a.jsx)(d,{}),(0,a.jsxs)(r.A,{sx:{fontSize:0,fontWeight:400,color:"fg.muted"},children:[(0,a.jsxs)(r.A,{sx:{fontSize:1,fontWeight:600,color:"fg.default"},children:[e.results.length," ",1===e.results.length?" result ":" results "]}),"from Bing search."]})]})}),(0,a.jsx)(o.O.Body,{detailsError:!1,detailsLoading:!1,children:(0,a.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",px:3,gap:3,pb:3},children:[e.results.map((e,t)=>(0,a.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:1,border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"6px",padding:3},children:[(0,a.jsx)(s.A,{sx:{fontWeight:600,fontSize:2},href:e.url,rel:"nofollow",children:e.title}),(0,a.jsx)("div",{children:e.excerpt}),(0,a.jsx)(i.A,{sx:{fontSize:0,color:"fg.muted"},children:e.url})]},t)),(0,a.jsx)(r.A,{sx:{fontSize:0,fontWeight:400},children:(0,a.jsx)(s.A,{href:"https://privacy.microsoft.com/en-us/privacystatement",rel:"nofollow",target:"_blank",children:"Microsoft Privacy Statement"})})]})})]})}let d=()=>(0,a.jsx)("div",{className:l["bing-icon"]});try{c.displayName||(c.displayName="WebSearchReferencePreview")}catch{}try{d.displayName||(d.displayName="BingIcon")}catch{}},18427:(e,t,n)=>{n.d(t,{B:()=>g});var a=n(74848),i=n(2622),r=n(46988),s=n(38621),o=n(91321),l=n(10871),c=n(89323),d=n(87330),u=n(15385);let m={actions:"EditorMenu-module__actions--AddF7",editorButton:"EditorMenu-module__editorButton--_thrU"};var p=n(64633),h=n(87913);function g({menuLocation:e,mode:t,onButtonClick:n}){let g=(n,a)=>{i.W.freeToPaidTelemetry?(0,p.F)(n,e,t,a):(0,r.BI)("dotcom_chat.activate",{target:`EDITOR_UPSELL_BANNER_${n.toUpperCase()}`,mode:t})};return(0,a.jsxs)(o.A,{className:m.actions,children:[(0,a.jsx)(l.z,{className:m.editorButton,href:h.A.vscode.url,leadingVisual:(0,a.jsx)("img",{src:h.A.vscode.icon,alt:"",height:"20",width:"20"}),onClick:()=>{n?.(),g("vscode","ide_menu_primary_button_click")},children:h.A.vscode.name}),(0,a.jsxs)(c.W,{children:[(0,a.jsx)(c.W.Anchor,{children:(0,a.jsx)(d.K,{"aria-label":"More editors",icon:s.TriangleDownIcon,unsafeDisableTooltip:!0,onClick:()=>{g("menu","ide_menu_open")},"data-testid":"editor-dropdown-button"})}),(0,a.jsx)(c.W.Overlay,{align:"end",children:(0,a.jsx)(u.l,{children:(0,a.jsx)(p.t,{menuLocation:e,mode:t,onItemClick:n})})})]})]})}try{g.displayName||(g.displayName="EditorMenu")}catch{}},64633:(e,t,n)=>{n.d(t,{F:()=>l,t:()=>c});var a=n(74848),i=n(2622),r=n(46988),s=n(15385),o=n(87913);function l(e,t,n,a,i){let s=`${t.toUpperCase()}_${e.toUpperCase()}`;(0,r.BI)("dotcom_chat.activate",{target:s,text:i,category:t,action:a,mode:n})}function c({menuLocation:e,mode:t,onItemClick:n}){return Object.entries(o.A).map(([r,{name:o,url:c,icon:d}])=>(0,a.jsxs)(s.l.LinkItem,{href:c,onClick:()=>{n?.(),i.W.freeToPaidTelemetry&&l(r,e,t,"menu_item_click",o)},children:[o,(0,a.jsx)(s.l.LeadingVisual,{children:(0,a.jsx)("img",{src:d,alt:"",height:"20",width:"20"})})]},r))}try{c.displayName||(c.displayName="EditorMenuItems")}catch{}},72819:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(74848),i=n(21728),r=n(96540),s=n(84976),o=n(13250);let l={cardContainer:"Card-module__cardContainer--Jk2It",cardContent:"Card-module__cardContent--A8hpe",cardMenu:"Card-module__cardMenu--o6v0Y",itemHeader:"Card-module__itemHeader--WIpbQ",edgeToEdge:"Card-module__edgeToEdge--o6nFA",itemImage:"Card-module__itemImage--fVqUU",itemMain:"Card-module__itemMain--M__Bj",itemContent:"Card-module__itemContent--QdREU",itemHeaderTitle:"Card-module__itemHeaderTitle--TwWdH",itemHeaderDescription:"Card-module__itemHeaderDescription--KFU1e",itemMetadata:"Card-module__itemMetadata--DWvmz",itemMetadataItem:"Card-module__itemMetadataItem--t_AWQ"};var c=n(34164);let d=e=>{let t,n,o,d,y,x,v,_,b,j,C;let N=(0,i.c)(47),w=null,I=null,S=null,k=null,T=null,A=null;if(N[0]!==e.children){for(let t of r.Children.toArray(e.children))r.isValidElement(t)&&(t.type===u?w=t:t.type===m?I=t:t.type===p?S=t:t.type===h?k=t:t.type===f?T=t:t.type===g&&(A=t));N[0]=e.children,N[1]=w,N[2]=I,N[3]=S,N[4]=k,N[5]=T,N[6]=A}else w=N[1],I=N[2],S=N[3],k=N[4],T=N[5],A=N[6];N[7]!==I?(t=(0,c.$)(l.itemHeader,I&&l.edgeToEdge),N[7]=I,N[8]=t):t=N[8];let E=w||I;N[9]!==t||N[10]!==E?(n=(0,a.jsx)("div",{className:t,children:E}),N[9]=t,N[10]=E,N[11]=n):n=N[11],N[12]!==k||N[13]!==S?(o=(0,a.jsxs)("div",{className:l.itemContent,children:[S,k]}),N[12]=k,N[13]=S,N[14]=o):o=N[14],N[15]!==T?(d=(0,a.jsx)("div",{className:l.itemMetadata,children:T}),N[15]=T,N[16]=d):d=N[16],N[17]!==o||N[18]!==d?(y=(0,a.jsxs)("div",{className:l.itemMain,children:[o,d]}),N[17]=o,N[18]=d,N[19]=y):y=N[19],N[20]!==n||N[21]!==y?(x=(0,a.jsxs)(a.Fragment,{children:[n,y]}),N[20]=n,N[21]=y,N[22]=x):x=N[22];let R=x;if("href"in e){let t,n,i,r,o;return N[23]!==e?({href:t,...n}=e,N[23]=e,N[24]=t,N[25]=n):(t=N[24],n=N[25]),N[26]!==R||N[27]!==t||N[28]!==n?(i=(0,a.jsx)(s.N_,{...n,to:t,className:l.cardContent,children:R}),N[26]=R,N[27]=t,N[28]=n,N[29]=i):i=N[29],N[30]!==A?(r=A?(0,a.jsx)("div",{className:l.cardMenu,children:A}):null,N[30]=A,N[31]=r):r=N[31],N[32]!==i||N[33]!==r?(o=(0,a.jsxs)("div",{className:l.cardContainer,children:[i,r]}),N[32]=i,N[33]=r,N[34]=o):o=N[34],o}return N[35]!==e?({onClick:v,..._}=e,N[35]=e,N[36]=v,N[37]=_):(v=N[36],_=N[37]),N[38]!==R||N[39]!==v||N[40]!==_?(b=(0,a.jsx)("button",{..._,className:l.cardContent,onClick:v,children:R}),N[38]=R,N[39]=v,N[40]=_,N[41]=b):b=N[41],N[42]!==A?(j=A?(0,a.jsx)("div",{className:l.cardMenu,children:A}):null,N[42]=A,N[43]=j):j=N[43],N[44]!==b||N[45]!==j?(C=(0,a.jsxs)("div",{className:l.cardContainer,children:[b,j]}),N[44]=b,N[45]=j,N[46]=C):C=N[46],C},u=e=>{let t;let n=(0,i.c)(3),{icon:r,color:s}=e;return n[0]!==s||n[1]!==r?(t=(0,a.jsx)(o.I,{icon:r,hasBackground:!0,color:s,size:16}),n[0]=s,n[1]=r,n[2]=t):t=n[2],t},m=e=>{let t;let n=(0,i.c)(3),{img:r,alt:s}=e,o=void 0===s?"":s;return n[0]!==o||n[1]!==r?(t=(0,a.jsx)("img",{src:r,alt:o,className:l.itemImage}),n[0]=o,n[1]=r,n[2]=t):t=n[2],t},p=e=>{let t;let n=(0,i.c)(2),{children:r}=e;return n[0]!==r?(t=(0,a.jsx)("h3",{className:l.itemHeaderTitle,children:r}),n[0]=r,n[1]=t):t=n[1],t},h=e=>{let t;let n=(0,i.c)(2),{children:r}=e;return n[0]!==r?(t=(0,a.jsx)("p",{className:l.itemHeaderDescription,children:r}),n[0]=r,n[1]=t):t=n[1],t},g=e=>{let t;let n=(0,i.c)(2),{children:r}=e;return n[0]!==r?(t=(0,a.jsx)(a.Fragment,{children:r}),n[0]=r,n[1]=t):t=n[1],t},f=e=>{let t;let n=(0,i.c)(2),{children:r}=e;return n[0]!==r?(t=(0,a.jsx)("div",{className:l.itemMetadataItem,children:r}),n[0]=r,n[1]=t):t=n[1],t};d.Icon=u,d.Image=m,d.Heading=p,d.Description=h,d.Menu=g,d.Metadata=f;try{d.displayName||(d.displayName="Card")}catch{}try{u.displayName||(u.displayName="Icon")}catch{}try{m.displayName||(m.displayName="Image")}catch{}try{p.displayName||(p.displayName="Heading")}catch{}try{h.displayName||(h.displayName="Description")}catch{}try{g.displayName||(g.displayName="Menu")}catch{}try{f.displayName||(f.displayName="Metadata")}catch{}},50781:(e,t,n)=>{n.d(t,{GS:()=>r,LP:()=>c,OZ:()=>d});var a=n(74848),i=n(21728);let r=e=>{let t,n,r,s,o;let l=(0,i.c)(7);l[0]!==e?(t=void 0===e?{}:e,l[0]=e,l[1]=t):t=l[1];let{size:c}=t,d=void 0===c?16:c;return l[2]===Symbol.for("react.memo_cache_sentinel")?(n={color:"var(--fgColor-muted)",display:"inline-block",verticalAlign:"text-bottom"},r=(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M.5 6v4.5A2.5 2.5 0 0 0 3 13h1.645a3.5 3.5 0 0 1-.11-1.5H3a1 1 0 0 1-1-1V6zM14 6v4.5a1 1 0 0 1-1 1h-1.535a3.5 3.5 0 0 1-.11 1.5H13a2.5 2.5 0 0 0 2.5-2.5V6zm-4 6a2 2 0 1 1-4 0 2 2 0 0 1 4 0",clipRule:"evenodd"}),s=(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M15.5 10V5.5A2.5 2.5 0 0 0 13 3h-1.645a3.5 3.5 0 0 1 .11 1.5H13a1 1 0 0 1 1 1V10zM2 10V5.5a1 1 0 0 1 1-1h1.535a3.5 3.5 0 0 1 .11-1.5H3A2.5 2.5 0 0 0 .5 5.5V10zm4-6a2 2 0 1 1 4 0 2 2 0 0 1-4 0",clipRule:"evenodd"}),l[2]=n,l[3]=r,l[4]=s):(n=l[2],r=l[3],s=l[4]),l[5]!==d?(o=(0,a.jsxs)("svg",{width:d,height:d,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:n,children:[r,s]}),l[5]=d,l[6]=o):o=l[6],o},s=e=>{let t,n,r,s;let o=(0,i.c)(6);o[0]!==e?(t=void 0===e?{}:e,o[0]=e,o[1]=t):t=o[1];let{size:l}=t,c=void 0===l?16:l;return o[2]===Symbol.for("react.memo_cache_sentinel")?(n={color:"var(--fgColor-muted",display:"inline-block",verticalAlign:"text-bottom"},r=(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.515.456a1.555 1.555 0 00-2.2 0L6.58 6.19a1.556 1.556 0 00-.396.673l-.825 2.89a.667.667 0 00.824.824l2.89-.826c.254-.072.485-.209.672-.396l5.735-5.734a1.556 1.556 0 000-2.2l-.965-.965zm-1.257.942a.222.222 0 01.314 0l.965.966a.222.222 0 010 .314L13.415 3.8l-1.28-1.28 1.123-1.122zm-2.065 2.066l1.279 1.279-3.67 3.67a.221.221 0 01-.096.056l-1.736.496.496-1.736c.01-.036.03-.07.057-.096l3.67-3.67zM1.639 4.778a2.25 2.25 0 012.25-2.25h3.154a.75.75 0 000-1.5H3.889a3.75 3.75 0 00-3.75 3.75v7.333a3.75 3.75 0 003.75 3.75h7.333a3.75 3.75 0 003.75-3.75V8.445a.75.75 0 00-1.5 0v3.666a2.25 2.25 0 01-2.25 2.25H3.889a2.25 2.25 0 01-2.25-2.25V4.778z",clipRule:"evenodd"}),o[2]=n,o[3]=r):(n=o[2],r=o[3]),o[4]!==c?(s=(0,a.jsx)("svg",{width:c,height:c,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:n,children:r}),o[4]=c,o[5]=s):s=o[5],s},o=e=>{let t,n,r,s;let o=(0,i.c)(6);o[0]!==e?(t=void 0===e?{}:e,o[0]=e,o[1]=t):t=o[1];let{size:l}=t,c=void 0===l?16:l;return o[2]===Symbol.for("react.memo_cache_sentinel")?(n={color:"var(--fgColor-muted",display:"inline-block",verticalAlign:"text-bottom"},r=(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M13 .5H3A2.5 2.5 0 0 0 .5 3v10A2.5 2.5 0 0 0 3 15.5h10a2.5 2.5 0 0 0 2.5-2.5V3A2.5 2.5 0 0 0 13 .5M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm6 6.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5M12.25 5a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0M5 12.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"}),o[2]=n,o[3]=r):(n=o[2],r=o[3]),o[4]!==c?(s=(0,a.jsx)("svg",{width:c,height:c,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:n,children:r}),o[4]=c,o[5]=s):s=o[5],s},l=e=>{let t,n,r,s;let o=(0,i.c)(6);o[0]!==e?(t=void 0===e?{}:e,o[0]=e,o[1]=t):t=o[1];let{size:l}=t,c=void 0===l?16:l;return o[2]===Symbol.for("react.memo_cache_sentinel")?(n={color:"var(--fgColor-muted",display:"inline-block",verticalAlign:"text-bottom"},r=(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.9853 4.76795c.2467 1.23107.1819 2.55631-.3218 3.71134 1.0897-1.00527 1.7464-2.46826 1.7464-3.86921 0-.41421.3357-.75.75-.75.4142 0 .75.33579.75.75 0 2.80515-2.0553 5.92172-5.26314 6.53282.12999.0339.26315.0635.39904.0885 1.3486.2485 2.7916.0174 3.7282-.5446.3552-.2131.8159-.0979 1.029.2573.2131.3552.0979.8159-.2573 1.029-1.3033.782-3.1303 1.0359-4.77168.7335-1.47895-.2726-2.95185-1.0297-3.73462-2.4328.03609.3407.0998.6912.19117 1.0445.39625 1.5319 1.23152 2.7976 2.12066 3.2689.36598.194.5054.6479.31141 1.0139-.19399.366-.64793.5054-1.01391.3114-1.41889-.7521-2.42362-2.4914-2.87037-4.2186-.37219-1.439-.41354-3.09054.18406-4.40236-.18676.13263-.36743.27694-.54001.43237-1.03593.93306-1.73142 2.22122-1.73142 3.69879 0 .4142-.33579.75-.75.75-.41422 0-.75-.3358-.75-.75 0-1.97509.934-3.64826 2.22755-4.81334.88055-.7931 1.9505-1.37217 3.05387-1.65822-.11043-.0376-.22261-.07252-.33631-.10464-1.50098-.42402-2.98649-.28172-3.84609.36302-.33136.24853-.80147.18139-1.05-.14998-.24854-.33136-.1814-.80146.14997-1.05 1.38041-1.03537 3.4149-1.0978 5.1539-.60654 1.67421.47295 3.33259 1.53108 4.06402 3.11319l.0038.00674c.035-.47081.0022-.96424-.0972-1.46029-.2603-1.29954-.95701-2.50156-1.90466-3.21238-.33135-.24854-.39848-.71865-.14994-1.050006.24855-.331356.71865-.398487 1.05001-.14994C10.8023 1.6197 11.6657 3.17263 11.9853 4.76795ZM7.99998 6.0001c-1.10457 0-2 .89543-2 2s.89543 2 2 2 2-.89543 2-2-.89543-2-2-2Z",fill:"currentColor"}),o[2]=n,o[3]=r):(n=o[2],r=o[3]),o[4]!==c?(s=(0,a.jsx)("svg",{width:c,height:c,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:n,children:r}),o[4]=c,o[5]=s):s=o[5],s},c=e=>{let t,n,r,s;let o=(0,i.c)(6);o[0]!==e?(t=void 0===e?{}:e,o[0]=e,o[1]=t):t=o[1];let{size:l}=t,c=void 0===l?16:l;return o[2]===Symbol.for("react.memo_cache_sentinel")?(n={color:"var(--fgColor-muted",display:"inline-block",verticalAlign:"text-bottom"},r=(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",fill:"currentColor",d:"M8 6.984c.59-.533 1.204-1.066 1.825-1.493.797-.548 1.7-.991 2.675-.991C14.414 4.5 16 6.086 16 8s-1.586 3.5-3.5 3.5c-.975 0-1.878-.444-2.675-.991-.621-.427-1.235-.96-1.825-1.493-.59.533-1.204 1.066-1.825 1.493-.797.547-1.7.991-2.675.991C1.586 11.5 0 9.914 0 8s1.586-3.5 3.5-3.5c.975 0 1.878.443 2.675.991.621.427 1.235.96 1.825 1.493ZM9.114 8c.536.483 1.052.922 1.56 1.273.704.483 1.3.727 1.826.727 1.086 0 2-.914 2-2 0-1.086-.914-2-2-2-.525 0-1.122.244-1.825.727-.51.35-1.025.79-1.561 1.273ZM3.5 6c-1.086 0-2 .914-2 2 0 1.086.914 2 2 2 .525 0 1.122-.244 1.825-.727.51-.35 1.025-.79 1.561-1.273-.536-.483-1.052-.922-1.56-1.273C4.621 6.244 4.025 6 3.5 6Z"}),o[2]=n,o[3]=r):(n=o[2],r=o[3]),o[4]!==c?(s=(0,a.jsx)("svg",{width:c,height:c,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:n,children:r}),o[4]=c,o[5]=s):s=o[5],s},d={compose:s,dice:o,loops:c,node:r,spaces:l};try{r.displayName||(r.displayName="NodeIcon")}catch{}try{s.displayName||(s.displayName="ComposeIcon")}catch{}try{o.displayName||(o.displayName="DiceIcon")}catch{}try{l.displayName||(l.displayName="SpacesIcon")}catch{}try{c.displayName||(c.displayName="LoopsIcon")}catch{}},13250:(e,t,n)=>{n.d(t,{I:()=>l});var a=n(74848),i=n(21728),r=n(34164),s=n(50781);let o={container:"Icon-module__container--QOYOK",hasBackground:"Icon-module__hasBackground--zz0fp",auburn:"Icon-module__auburn--qIzKn",blue:"Icon-module__blue--Ydgzj",brown:"Icon-module__brown--MphUd",coral:"Icon-module__coral--Jjxvj",cyan:"Icon-module__cyan--O0g_g",gray:"Icon-module__gray--rvF4R",green:"Icon-module__green--nHw65",indigo:"Icon-module__indigo--S8x7A",lemon:"Icon-module__lemon--Nc7fm",lime:"Icon-module__lime--ghjuW",olive:"Icon-module__olive--v6fBi",orange:"Icon-module__orange--AmLH_",pine:"Icon-module__pine--j5Ka1",pink:"Icon-module__pink--QHUu5",plum:"Icon-module__plum--JvLfU",purple:"Icon-module__purple--CLqTs",red:"Icon-module__red--ayaY4",teal:"Icon-module__teal--xmOZK",yellow:"Icon-module__yellow--Y3ymS"};function l(e){let t,n,l,c;let d=(0,i.c)(12),{icon:u,hasBackground:m,color:p,size:h}=e,g=void 0!==m&&m,f=void 0===h?16:h,y="string"==typeof u&&u in s.OZ?s.OZ[u]:u,x=`${g?2*f:f}px`;d[0]!==x?(t={"--custom-size":x},d[0]=x,d[1]=t):t=d[1];let v=t,_=o[void 0===p?"gray":p]??o.gray,b=g&&o.hasBackground;return d[2]!==_||d[3]!==b?(n=(0,r.$)(o.container,_,b),d[2]=_,d[3]=b,d[4]=n):n=d[4],d[5]!==y||d[6]!==f?(l=(0,a.jsx)(y,{size:f}),d[5]=y,d[6]=f,d[7]=l):l=d[7],d[8]!==l||d[9]!==v||d[10]!==n?(c=(0,a.jsx)("div",{style:v,className:n,children:l}),d[8]=l,d[9]=v,d[10]=n,d[11]=c):c=d[11],c}try{l.displayName||(l.displayName="Icon")}catch{}},18347:(e,t,n)=>{n.d(t,{BP:()=>u,D3:()=>d,O8:()=>l});var a=n(74848),i=n(21728),r=n(96540),s=n(47584),o=n(38568);let l={ServerRender:"ServerRender",ClientHydrate:"ClientHydrate",ClientRender:"ClientRender"},c=(0,r.createContext)(l.ClientRender);function d(e){let t,n,d,u;let m=(0,i.c)(8),{wasServerRendered:p,children:h}=e;m[0]!==p?(t=()=>s.X3?l.ServerRender:p?l.ClientHydrate:l.ClientRender,m[0]=p,m[1]=t):t=m[1];let[g,f]=(0,r.useState)(t);return m[2]!==g?(n=()=>{g!==l.ClientRender&&f(l.ClientRender)},d=[g],m[2]=g,m[3]=n,m[4]=d):(n=m[3],d=m[4]),(0,o.N)(n,d),m[5]!==h||m[6]!==g?(u=(0,a.jsx)(c.Provider,{value:g,children:h}),m[5]=h,m[6]=g,m[7]=u):u=m[7],u}function u(){return(0,r.useContext)(c)}try{c.displayName||(c.displayName="RenderPhaseContext")}catch{}try{d.displayName||(d.displayName="RenderPhaseProvider")}catch{}},34407:(e,t,n)=>{n.d(t,{O:()=>u});var a=n(75177),i=n(59299),r=n(44999),s=n(38267);let o=(0,s.i7)(["0%{transform:translateX(-100%);}50%{transform:translateX(100%);}100%{transform:translateX(100%);}"]),l=(0,s.AH)(["animation:"," 1.5s infinite linear;"],o),c=(0,s.i7)(["0%{opacity:.3;}10%{opacity:1;}100%{opacity:.3;}"]),d=(0,s.AH)(["animation:"," 2s infinite linear;"],c),u=(0,s.Ay)(a.A).withConfig({displayName:"LoadingSkeleton",componentId:"sc-bcbf24f9-0"})(["position:relative;overflow:hidden;mask-image:radial-gradient(white,black);",";&::after{",";background:linear-gradient(90deg,transparent,",",transparent);content:'';position:absolute;transform:translateX(-100%);bottom:0;left:0;right:0;top:0;}background-color:",";border-radius:",";display:block;height:1.2em;"," width:",";height:",";",""],({animationStyle:e})=>"pulse"===e&&d,({animationStyle:e})=>"pulse"!==e&&l,(0,i.Jt)("colors.neutral.subtle"),(0,i.Jt)("colors.neutral.subtle"),({theme:e,variant:t})=>{switch(t){case"rounded":return(0,i.Jt)("radii.1")(e);case"pill":return"100px";case"elliptical":return"50%";default:return"0"}},({variant:e})=>"elliptical"===e&&{borderRadius:"50%"},({width:e})=>{switch(e){case"random":return`${Math.floor(40*Math.random()+40)}%`;case"xl":return"32px";case"lg":return"24px";case"md":return"20px";case"sm":return"16px";default:return e}},({height:e})=>{switch(e){case"xl":return"32px";case"lg":return"24px";case"md":return"20px";case"sm":return"16px";default:return e}},r.A);try{u.displayName||(u.displayName="LoadingSkeleton")}catch{}},13253:(e,t,n)=>{n.d(t,{Z:()=>d});var a,i=n(74848),r=n(21728),s=n(44968),o=n(38621);let l={suggestionButton:"Suggestion-module__suggestionButton--Es9kF",icon:"Suggestion-module__icon--hAedH"},c=e=>e in o;function d(e){let t,n,a,d;let u=(0,r.c)(11),{titleHtml:m,icon:p,color:h,onClick:g}=e;u[0]!==p?(t=function(e){let t=`${e.replaceAll(/(?:^|-)(\w)/g,(e,t)=>t.toUpperCase())}Icon`;return c(t)?o[t]:void 0}(p),u[0]=p,u[1]=t):t=u[1];let f=t;return u[2]!==f||u[3]!==h?(n=f&&(0,i.jsx)("div",{className:l.icon,style:{color:h},children:(0,i.jsx)(f,{})}),u[2]=f,u[3]=h,u[4]=n):n=u[4],u[5]!==m?(a=(0,i.jsx)(s.mo,{html:m}),u[5]=m,u[6]=a):a=u[6],u[7]!==g||u[8]!==n||u[9]!==a?(d=(0,i.jsxs)("button",{className:l.suggestionButton,onClick:g,children:[n,a]}),u[7]=g,u[8]=n,u[9]=a,u[10]=d):d=u[10],d}try{d.displayName||(d.displayName="SuggestionCard")}catch{}try{(a=Icon).displayName||(a.displayName="Icon")}catch{}},67136:(e,t,n)=>{n.d(t,{Qn:()=>l,T8:()=>d,Y6:()=>m,k6:()=>u});var a=n(74848),i=n(65556),r=n(96540),s=n(73218),o=n(82060);let l=5e3,c=(0,r.createContext)({addToast:s.l,addPersistedToast:s.l,clearPersistedToast:s.l}),d=(0,r.createContext)({toasts:[],persistedToast:null});function u({children:e}){let[t,n]=(0,o.A)([]),[s,u]=(0,r.useState)(null),{safeSetTimeout:m}=(0,i.A)(),p=(0,r.useCallback)(function(e){n([...t,e]),m(()=>n(t.slice(1)),l)},[t,m,n]),h=(0,r.useCallback)(function(e){u(e)},[u]),g=(0,r.useCallback)(function(){u(null)},[u]),f=(0,r.useMemo)(()=>({addToast:p,addPersistedToast:h,clearPersistedToast:g}),[h,p,g]),y=(0,r.useMemo)(()=>({toasts:t,persistedToast:s}),[t,s]);return(0,a.jsx)(c.Provider,{value:f,children:(0,a.jsx)(d.Provider,{value:y,children:e})})}function m(){return(0,r.useContext)(c)}try{c.displayName||(c.displayName="ToastContext")}catch{}try{d.displayName||(d.displayName="InternalToastsContext")}catch{}try{u.displayName||(u.displayName="ToastContextProvider")}catch{}},91958:(e,t,n)=>{n.d(t,{V:()=>m});var a=n(74848),i=n(96540),r=n(67136),s=n(38621),o=n(65556),l=n(16255);let c={info:"",success:"Toast--success",error:"Toast--error"},d={info:(0,a.jsx)(s.InfoIcon,{}),success:(0,a.jsx)(s.CheckIcon,{}),error:(0,a.jsx)(s.StopIcon,{})},u=({message:e,timeToLive:t,icon:n,type:r="info",role:s="log"})=>{let[u,m]=i.useState(!0),{safeSetTimeout:p}=(0,o.A)();return(0,i.useEffect)(()=>{t&&p(()=>m(!1),t-300)},[p,t]),(0,a.jsx)(l.Z,{children:(0,a.jsx)("div",{className:"p-1 position-fixed bottom-0 left-0 mb-3 ml-3",children:(0,a.jsxs)("div",{className:`Toast ${c[r]} ${u?"Toast--animateIn":"Toast--animateOut"}`,id:"ui-app-toast","data-testid":`ui-app-toast-${r}`,role:s,children:[(0,a.jsx)("span",{className:"Toast-icon",children:n||d[r]}),(0,a.jsx)("span",{className:"Toast-content",children:e})]})})})};try{u.displayName||(u.displayName="Toast")}catch{}function m(){let{toasts:e,persistedToast:t}=(0,i.useContext)(r.T8);return(0,a.jsxs)(a.Fragment,{children:[e.map((e,t)=>(0,a.jsx)(u,{message:e.message,icon:e.icon,timeToLive:r.Qn,type:e.type,role:e.role},t)),t&&(0,a.jsx)(u,{message:t.message,icon:t.icon,type:t.type,role:t.role})]})}try{m.displayName||(m.displayName="Toasts")}catch{}},51349:(e,t,n)=>{n.d(t,{N:()=>f});var a=n(74848),i=n(96540),r=n(73451),s=n(19647),o=n(34614),l=n(42522),c=n(55847),d=n(27331),u=n(38621);let m={bodyContainer:"UserFeedback-module__bodyContainer--O4i85",ratingContainer:"UserFeedback-module__ratingContainer--i0uZJ",ratingOption:"UserFeedback-module__ratingOption--hic5K",ratingButton:"UserFeedback-module__ratingButton--HsIWu",ratingCaption:"UserFeedback-module__ratingCaption--qUJIU",footerContainer:"UserFeedback-module__footerContainer--u06YH",footerActionButtonGroup:"UserFeedback-module__footerActionButtonGroup--t8_wz",copyLogsSuccessIcon:"UserFeedback-module__copyLogsSuccessIcon--zNnJA",messageContainer:"UserFeedback-module__messageContainer--cT4Rk",validationError:"UserFeedback-module__validationError--zjQhN",privacyText:"UserFeedback-module__privacyText--qSsVA",Dialog:"UserFeedback-module__Dialog--d4Z0e"},p={verySatisfied:"UserFeedbackColors-module__verySatisfied--Ypo1v",good:"UserFeedbackColors-module__good--iI67T",satisfied:"UserFeedbackColors-module__satisfied--MpwOG",dissatisfied:"UserFeedbackColors-module__dissatisfied--Kuqhh",veryDissatisfied:"UserFeedbackColors-module__veryDissatisfied--m5jfW",bad:"UserFeedbackColors-module__bad--TcLP4"};var h=n(34164);function g({title:e="Give feedback",requestID:t,options:n,returnFocusRef:g,onSubmit:f,onClose:y},x){let[v,_]=(0,i.useState)(null),[b,j]=(0,i.useState)(""),[C,N]=(0,i.useState)([]),[w,I]=(0,i.useState)(!1),[S,k]=(0,i.useState)(!1);(0,i.useImperativeHandle)(x,()=>({openDialog:e=>{if(null!=e){if(!n.some(t=>t.value===e))throw Error("invalid initial option value");_(e)}I(!0)}}));let T=async e=>{e.preventDefault();let t=[];try{t=await f(v,b)}catch{t=["An error occurred while submitting your feedback."]}N(t),0===t.length&&E()},A=()=>{_(null),j(""),N([])},E=()=>{A(),I(!1),y?.()},R=e=>{_(e),N([])},P=e=>{j(e.target.value),N([])},D=async()=>{if(t){try{await navigator.clipboard.writeText(`Request ID: ${t}`)}catch{N(e=>[...e,"Failed to copy logs."]);return}k(!0),setTimeout(()=>{k(!1)},1e3)}};return(0,a.jsx)(a.Fragment,{children:w&&(0,a.jsx)(d.l,{onClose:E,title:e,renderBody:()=>(0,a.jsxs)("div",{className:m.bodyContainer,children:[(0,a.jsxs)(r.A,{required:!0,children:[(0,a.jsx)(r.A.Label,{visuallyHidden:!0,children:"Rating"}),(0,a.jsx)("div",{className:m.ratingContainer,children:n.map(e=>(0,a.jsxs)("div",{className:m.ratingOption,children:[(0,a.jsx)("button",{type:"button",role:"radio","aria-label":e.name,"aria-checked":v===e.value,onClick:()=>R(e.value),className:(0,h.$)(m.ratingButton,p[e.color]),children:e.icon}),(0,a.jsx)("span",{className:m.ratingCaption,children:e.name})]},e.name))})]}),(0,a.jsxs)("div",{className:m.messageContainer,children:[(0,a.jsxs)(r.A,{children:[(0,a.jsx)(r.A.Label,{children:"Message"}),(0,a.jsx)(s.Ay,{placeholder:"Tell us what you liked or what could be better",value:b,onChange:P,resize:"vertical",block:!0,rows:5})]}),(0,a.jsxs)("span",{className:m.privacyText,children:["Please don\u2019t include sensitive, confidential, or personal data. Your feedback helps us improve our services in line with our"," ",(0,a.jsx)(o.A,{href:"https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement",inline:!0,muted:!0,children:"Privacy Policy"}),"."]}),C.length>0&&(0,a.jsx)("div",{className:m.validationError,children:C.map(e=>(0,a.jsx)("div",{children:e},e))})]})]}),renderFooter:()=>(0,a.jsxs)("div",{className:m.footerContainer,children:[(0,a.jsx)("div",{children:t&&(0,a.jsx)(l.m,{text:"Copy logs to add in feedback",direction:"n",children:(0,a.jsx)(c.Q,{leadingVisual:S?(0,a.jsx)(u.CheckIcon,{className:m.copyLogsSuccessIcon,size:16}):(0,a.jsx)(u.CopyIcon,{size:16}),onClick:D,variant:"default",children:S?"Copied!":"Copy logs"})})}),(0,a.jsxs)("div",{className:m.footerActionButtonGroup,children:[(0,a.jsx)(c.Q,{onClick:E,children:"Cancel"}),(0,a.jsx)(c.Q,{variant:"primary",type:"submit",onClick:T,children:"Send"})]})]}),className:m.Dialog,returnFocusRef:g})})}let f=(0,i.forwardRef)(g);try{g.displayName||(g.displayName="UserFeedbackInner")}catch{}try{f.displayName||(f.displayName="UserFeedback")}catch{}},70775:(e,t,n)=>{n.d(t,{SW:()=>r});var a=n(96540);let i=async e=>{let t=await new Promise((t,n)=>{let a=new FileReader;a.onload=e=>{if(!e.target||"string"!=typeof e.target.result){n(Error("Failed to read file"));return}t(e.target.result)},a.onerror=()=>{n(Error("Error reading file"))},a.readAsDataURL(e)});return{media_type:e.type,name:e.name,url:t}};function r(){let[e,t]=(0,a.useState)(void 0),[n,r]=(0,a.useState)(void 0),s=(0,a.useCallback)(()=>{t(void 0),r(void 0)},[]),o=(0,a.useCallback)(async n=>{if(!n.target.files)return;let a=n.target.files[0];if(n.currentTarget.value="",a)try{if(e)throw Error("Only one image can be attached at a time.");if(a.size>384e4)throw Error("File size exceeds 3840KB");let n=await i(a);t(n),r(void 0)}catch(e){r(e instanceof Error?e.message:String(e))}},[e]);return{promptImage:e,imageUploadError:n,setPromptImage:t,setImageUploadError:r,attachImage:o,clearImageAttachment:s}}},46429:(e,t,n)=>{n.d(t,{_:()=>a});let a=["image/jpeg","image/png","image/webp"]}},e=>{var t=t=>e(e.s=t);e.O(0,["primer-react","react-core","react-lib","octicons-react","vendors-node_modules_primer_behaviors_dist_esm_index_mjs","vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_stacktrace-parser_dist_s-1d3d52","vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-b1c483","vendors-node_modules_github_catalyst_lib_index_js-node_modules_primer_live-region-element_dis-b2aea6","vendors-node_modules_dompurify_dist_purify_es_mjs","vendors-node_modules_lodash-es__Stack_js-node_modules_lodash-es__Uint8Array_js-node_modules_l-4faaa6","vendors-node_modules_date-fns_format_mjs","vendors-node_modules_date-fns_addWeeks_mjs-node_modules_date-fns_addYears_mjs-node_modules_da-827f4f","vendors-node_modules_github_relative-time-element_dist_index_js","vendors-node_modules_tanstack_query-core_build_modern_queryObserver_js-node_modules_tanstack_-defd52","vendors-node_modules_focus-visible_dist_focus-visible_js-node_modules_github_hotkey_dist_inde-70f9af","vendors-node_modules_lodash-es_isEqual_js","vendors-node_modules_dnd-kit_modifiers_dist_modifiers_esm_js-node_modules_dnd-kit_sortable_di-72228e","vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec","vendors-node_modules_react-relay_index_js","vendors-node_modules_d3-interpolate_src_value_js-node_modules_d3-selection_src_select_js","vendors-node_modules_github_combobox-nav_dist_index_js-node_modules_lit-labs_react_index_js-n-dddfa0","vendors-node_modules_remark-gfm_lib_index_js-node_modules_remark-parse_lib_index_js-node_modu-44d0fc","vendors-node_modules_fzy_js_index_js-node_modules_github_paste-markdown_dist_index_js","vendors-node_modules_hastscript_lib_index_js-node_modules_lowlight_lib_all_js-node_modules_re-713cc1","vendors-node_modules_codemirror_autocomplete_dist_index_js-node_modules_codemirror_search_dis-aafe81","vendors-node_modules_codemirror_commands_dist_index_js-node_modules_codemirror_language-data_-92b5c9","vendors-node_modules_buffer_index_js","vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_accname_dist_access-690142","vendors-node_modules_js-yaml_index_js","vendors-node_modules_d3-zoom_src_index_js","vendors-node_modules_d3-dag_bundle_d3-dag_esm_min_js-node_modules_d3_src_index_js-node_module-3b0c88","vendors-node_modules_github_quote-selection_dist_index_js-node_modules_react-relay_hooks_js-n-81314d","ui_packages_paths_index_ts","ui_packages_ui-commands_ui-commands_ts","ui_packages_date-picker_date-picker_ts","ui_packages_drag-and-drop_drag-and-drop_ts-ui_packages_hydro-analytics_hydro-analytics_ts","ui_packages_list-view_src_hooks_use-next-header-tag_ts-ui_packages_verified-fetch_verified-fe-1f4c4d","ui_packages_item-picker_components_RepositoryPicker_tsx","ui_packages_copilot-chat_utils_copilot-chat-helpers_ts","ui_packages_relay-environment_relay-environment_ts-ui_packages_use-named-color_use-named-colo-bdf255","ui_packages_copilot-markdown_MarkdownRenderer_tsx","ui_packages_commenting_constants_values_ts-ui_packages_commenting_components_ActivityHeader_t-f9065d","ui_packages_copilot-chat_utils_CopilotChatContext_tsx-ui_packages_safe-html_SafeHTML_tsx","ui_packages_app-uuid_app-uuid_ts-ui_packages_signed-commit-badge_index_ts","ui_packages_commenting_hooks_use-markdown-body_ts-ui_packages_commenting_utils_blocked-commen-338167","ui_packages_copilot-chat_components_CopilotIconAnimation_tsx-ui_packages_copilot-chat_compone-8be2e4","ui_packages_issue-viewer_constants_labels_ts-ui_packages_item-picker_components_BranchPicker_-bc1aa3","ui_packages_issue-viewer_components_IssueViewer_tsx-ui_packages_issue-viewer_contexts_IssueVi-135fec","ui_packages_custom-copilots_components_MultiFilePicker_tsx"],()=>t(66667)),e.O()}]);
//# sourceMappingURL=copilot-immersive-v1-0e9074df6b44.js.map